

============================== 2022-05-21 16:22:09.522198 | ff16af0b-82a7-463a-9be8-e082df7830af ==============================
16:22:09.522299 [info ] [MainThread]: Running with dbt=1.1.0
16:22:09.525152 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
16:22:09.530885 [debug] [MainThread]: Tracking: tracking
16:22:09.568041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2544ab5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2544ab760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2544c0dc0>]}
16:22:10.043004 [debug] [MainThread]: Executing "git --help"
16:22:10.059246 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
16:22:10.068037 [debug] [MainThread]: STDERR: "b''"
16:22:10.083817 [debug] [MainThread]: Acquiring new redshift connection "debug"
16:22:10.093541 [debug] [MainThread]: Using redshift connection "debug"
16:22:10.103216 [debug] [MainThread]: On debug: select 1 as id
16:22:10.112326 [debug] [MainThread]: Opening a new connection, currently in state init
16:22:10.117888 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
16:22:11.421959 [debug] [MainThread]: SQL status: SELECT in 1.31 seconds
16:22:11.430895 [debug] [MainThread]: On debug: Close
16:22:11.437602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2527d4a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2527d4fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2527d46d0>]}
16:22:12.084815 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2022-05-21 17:28:04.287281 | e348dc55-8ce2-4860-a7da-24f38d45b557 ==============================
17:28:04.287305 [info ] [MainThread]: Running with dbt=1.1.0
17:28:04.291324 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
17:28:04.298459 [debug] [MainThread]: Tracking: tracking
17:28:04.331071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31314184c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31314187f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31314188b0>]}
17:28:04.410119 [debug] [MainThread]: Executing "git --help"
17:28:04.441121 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
17:28:04.447582 [debug] [MainThread]: STDERR: "b''"
17:28:04.454430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f313149e6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f313139fca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f313139fb80>]}


============================== 2022-05-21 17:33:00.169329 | 3adaf19a-6b7c-41b1-8781-e5f9d5dfb3e0 ==============================
17:33:00.169354 [info ] [MainThread]: Running with dbt=1.1.0
17:33:00.173019 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
17:33:00.178193 [debug] [MainThread]: Tracking: tracking
17:33:00.209691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f533acc6370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f533ac4f760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f533ac4f700>]}
17:33:00.320625 [debug] [MainThread]: Executing "git --help"
17:33:00.349233 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
17:33:00.353257 [debug] [MainThread]: STDERR: "b''"
17:33:00.365792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f533acb2f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f533ac34760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f533ac34940>]}


============================== 2022-05-21 17:34:41.353885 | 45fd8477-2165-4614-95c7-dc1f37d01340 ==============================
17:34:41.353925 [info ] [MainThread]: Running with dbt=1.1.0
17:34:41.356862 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
17:34:41.362794 [debug] [MainThread]: Tracking: tracking
17:34:41.399991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbac699d3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbac699d700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbac699d7c0>]}
17:34:41.483185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbac6987f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbac6996520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbac6996250>]}


============================== 2022-05-21 17:35:58.802334 | b759c4ea-17ad-498b-b254-932a61d6f1d8 ==============================
17:35:58.802354 [info ] [MainThread]: Running with dbt=1.1.0
17:35:58.805642 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
17:35:58.809817 [debug] [MainThread]: Tracking: tracking
17:35:58.843036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b5a069400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b5a069730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b5a0697f0>]}
17:35:58.892607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b5a053970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b5a0620d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b5a062880>]}


============================== 2022-05-21 17:38:15.400598 | a7dc8f64-3928-4bb6-9244-49643c05d9dc ==============================
17:38:15.400616 [info ] [MainThread]: Running with dbt=1.1.0
17:38:15.404830 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
17:38:15.410558 [debug] [MainThread]: Tracking: tracking
17:38:15.449733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6301801760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6301801a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6301816c40>]}
17:38:15.908823 [debug] [MainThread]: Executing "git --help"
17:38:15.933421 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
17:38:15.938759 [debug] [MainThread]: STDERR: "b''"
17:38:15.956746 [debug] [MainThread]: Acquiring new redshift connection "debug"
17:38:15.967862 [debug] [MainThread]: Using redshift connection "debug"
17:38:15.971218 [debug] [MainThread]: On debug: select 1 as id
17:38:15.975798 [debug] [MainThread]: Opening a new connection, currently in state init
17:38:15.980614 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
17:38:17.316482 [debug] [MainThread]: SQL status: SELECT in 1.34 seconds
17:38:17.321747 [debug] [MainThread]: On debug: Close
17:38:17.325658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f62ffb30a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f62ffb30d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f62ffb30610>]}
17:38:17.974789 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2022-05-21 18:12:01.320818 | 5d79724c-6e51-42e2-843c-d969f68f1a49 ==============================
18:12:01.320837 [info ] [MainThread]: Running with dbt=1.1.0
18:12:01.324765 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
18:12:01.328196 [debug] [MainThread]: Tracking: tracking
18:12:01.363526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc1ef087f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc1ef08970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc1ef1fc70>]}
18:12:01.841169 [debug] [MainThread]: Executing "git --help"
18:12:01.860569 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
18:12:01.863878 [debug] [MainThread]: STDERR: "b''"
18:12:01.890880 [debug] [MainThread]: Acquiring new redshift connection "debug"
18:12:01.896896 [debug] [MainThread]: Using redshift connection "debug"
18:12:01.917488 [debug] [MainThread]: On debug: select 1 as id
18:12:01.923444 [debug] [MainThread]: Opening a new connection, currently in state init
18:12:01.928396 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
18:12:03.262887 [debug] [MainThread]: SQL status: SELECT in 1.34 seconds
18:12:03.272062 [debug] [MainThread]: On debug: Close
18:12:03.279289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc1d22aa60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc1d22adc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc1d22a5e0>]}
18:12:03.945375 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2022-05-21 18:13:05.226913 | f25269d9-c687-4521-84fe-2a88c9ce0c95 ==============================
18:13:05.226934 [info ] [MainThread]: Running with dbt=1.1.0
18:13:05.230310 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
18:13:05.246244 [debug] [MainThread]: Tracking: tracking
18:13:05.290728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f634e8786d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f634e878790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f634e8787c0>]}
18:13:05.339762 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
18:13:05.343453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f25269d9-c687-4521-84fe-2a88c9ce0c95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f634e891e50>]}
18:13:05.575375 [debug] [MainThread]: Parsing macros/adapters.sql
18:13:05.672131 [debug] [MainThread]: Parsing macros/relations.sql
18:13:05.676878 [debug] [MainThread]: Parsing macros/catalog.sql
18:13:05.711401 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
18:13:05.715633 [debug] [MainThread]: Parsing macros/adapters.sql
18:13:05.777042 [debug] [MainThread]: Parsing macros/relations.sql
18:13:05.783146 [debug] [MainThread]: Parsing macros/catalog.sql
18:13:05.791793 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
18:13:05.799001 [debug] [MainThread]: Parsing macros/adapters/columns.sql
18:13:05.826627 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
18:13:05.839304 [debug] [MainThread]: Parsing macros/adapters/relation.sql
18:13:05.867671 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
18:13:05.882177 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
18:13:05.896392 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
18:13:05.918451 [debug] [MainThread]: Parsing macros/adapters/schema.sql
18:13:05.927244 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
18:13:05.931422 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
18:13:05.937943 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
18:13:05.943200 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
18:13:05.948093 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
18:13:05.960460 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
18:13:05.970401 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
18:13:05.977283 [debug] [MainThread]: Parsing macros/etc/datetime.sql
18:13:06.000993 [debug] [MainThread]: Parsing macros/etc/statement.sql
18:13:06.015421 [debug] [MainThread]: Parsing macros/materializations/configs.sql
18:13:06.024737 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
18:13:06.036703 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
18:13:06.076836 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
18:13:06.121286 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
18:13:06.148933 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
18:13:06.156038 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
18:13:06.183176 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
18:13:06.200273 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
18:13:06.210877 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
18:13:06.261743 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
18:13:06.322776 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
18:13:06.345235 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
18:13:06.354257 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
18:13:06.360163 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
18:13:06.370367 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
18:13:06.383415 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
18:13:06.402941 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
18:13:06.416569 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
18:13:06.426041 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
18:13:06.432343 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
18:13:06.474481 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
18:13:06.492854 [debug] [MainThread]: Parsing tests/generic/builtin.sql
18:13:06.955969 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
18:13:06.987852 [debug] [MainThread]: 1699: static parser successfully parsed example/my_second_dbt_model.sql
18:13:07.163573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f25269d9-c687-4521-84fe-2a88c9ce0c95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f634e2f3850>]}
18:13:07.203803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f25269d9-c687-4521-84fe-2a88c9ce0c95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f634e891b20>]}
18:13:07.208956 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 193 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
18:13:07.212734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f25269d9-c687-4521-84fe-2a88c9ce0c95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f634e891760>]}
18:13:07.231650 [info ] [MainThread]: 
18:13:07.240500 [debug] [MainThread]: Acquiring new redshift connection "master"
18:13:07.252442 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev"
18:13:07.358637 [debug] [ThreadPool]: Using redshift connection "list_dev"
18:13:07.363074 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
  
18:13:07.368847 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:13:07.372213 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
18:13:08.714419 [debug] [ThreadPool]: SQL status: SELECT in 1.35 seconds
18:13:08.720394 [debug] [ThreadPool]: On list_dev: Close
18:13:08.727328 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev_public"
18:13:08.752878 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
18:13:08.772945 [debug] [ThreadPool]: On list_dev_public: BEGIN
18:13:08.776887 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:13:08.779802 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
18:13:10.170875 [debug] [ThreadPool]: SQL status: BEGIN in 1.39 seconds
18:13:10.174027 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
18:13:10.177134 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev_public"} */
select
      'dev' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dev' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
18:13:10.331728 [debug] [ThreadPool]: SQL status: SELECT in 0.15 seconds
18:13:10.340856 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
18:13:10.487942 [debug] [ThreadPool]: On list_dev_public: Close
18:13:10.519837 [debug] [MainThread]: Using redshift connection "master"
18:13:10.529330 [debug] [MainThread]: On master: BEGIN
18:13:10.536475 [debug] [MainThread]: Opening a new connection, currently in state init
18:13:10.553804 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
18:13:11.926653 [debug] [MainThread]: SQL status: BEGIN in 1.39 seconds
18:13:11.930217 [debug] [MainThread]: Using redshift connection "master"
18:13:11.934092 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
18:13:12.107822 [debug] [MainThread]: SQL status: SELECT in 0.17 seconds
18:13:12.113360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f25269d9-c687-4521-84fe-2a88c9ce0c95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f634e2fbee0>]}
18:13:12.115657 [debug] [MainThread]: On master: ROLLBACK
18:13:12.256977 [debug] [MainThread]: Using redshift connection "master"
18:13:12.261483 [debug] [MainThread]: On master: BEGIN
18:13:12.544647 [debug] [MainThread]: SQL status: BEGIN in 0.28 seconds
18:13:12.548834 [debug] [MainThread]: On master: COMMIT
18:13:12.551172 [debug] [MainThread]: Using redshift connection "master"
18:13:12.553061 [debug] [MainThread]: On master: COMMIT
18:13:12.694101 [debug] [MainThread]: SQL status: COMMIT in 0.14 seconds
18:13:12.697241 [debug] [MainThread]: On master: Close
18:13:12.700682 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
18:13:12.704518 [info ] [MainThread]: 
18:13:12.730796 [debug] [Thread-1  ]: Began running node model.analytics_dbt.my_first_dbt_model
18:13:12.736911 [info ] [Thread-1  ]: 1 of 2 START table model public.my_first_dbt_model ............................. [RUN]
18:13:12.752613 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.my_first_dbt_model"
18:13:12.760022 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.my_first_dbt_model
18:13:12.767161 [debug] [Thread-1  ]: Compiling model.analytics_dbt.my_first_dbt_model
18:13:12.785156 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.my_first_dbt_model"
18:13:12.833057 [debug] [Thread-1  ]: finished collecting timing info
18:13:12.835887 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.my_first_dbt_model
18:13:12.925073 [debug] [Thread-1  ]: Writing runtime SQL for node "model.analytics_dbt.my_first_dbt_model"
18:13:12.953931 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
18:13:12.956832 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: BEGIN
18:13:12.959207 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:13:12.961629 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
18:13:14.226035 [debug] [Thread-1  ]: SQL status: BEGIN in 1.27 seconds
18:13:14.230849 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
18:13:14.234726 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */


  create  table
    "dev"."public"."my_first_dbt_model__dbt_tmp"
    
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
18:13:14.857051 [debug] [Thread-1  ]: SQL status: SELECT in 0.62 seconds
18:13:14.886721 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
18:13:14.890783 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
alter table "dev"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
18:13:15.034844 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.14 seconds
18:13:15.086136 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: COMMIT
18:13:15.088727 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
18:13:15.092341 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: COMMIT
18:13:15.303223 [debug] [Thread-1  ]: SQL status: COMMIT in 0.21 seconds
18:13:15.308183 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
18:13:15.310695 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: BEGIN
18:13:15.453735 [debug] [Thread-1  ]: SQL status: BEGIN in 0.14 seconds
18:13:15.473762 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
18:13:15.477236 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
drop table if exists "dev"."public"."my_first_dbt_model__dbt_backup" cascade
18:13:15.619505 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.14 seconds
18:13:15.626224 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: COMMIT
18:13:15.629743 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
18:13:15.633983 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: COMMIT
18:13:15.781011 [debug] [Thread-1  ]: SQL status: COMMIT in 0.14 seconds
18:13:15.783689 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
18:13:15.785526 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: BEGIN
18:13:15.928753 [debug] [Thread-1  ]: SQL status: BEGIN in 0.14 seconds
18:13:15.934260 [debug] [Thread-1  ]: finished collecting timing info
18:13:15.936784 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: ROLLBACK
18:13:16.079947 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: Close
18:13:16.091398 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f25269d9-c687-4521-84fe-2a88c9ce0c95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f634e2e7190>]}
18:13:16.097018 [info ] [Thread-1  ]: 1 of 2 OK created table model public.my_first_dbt_model ........................ [[32mSELECT[0m in 3.34s]
18:13:16.107575 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.my_first_dbt_model
18:13:16.122006 [debug] [Thread-1  ]: Began running node model.analytics_dbt.my_second_dbt_model
18:13:16.146695 [info ] [Thread-1  ]: 2 of 2 START view model public.my_second_dbt_model ............................. [RUN]
18:13:16.177972 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.my_second_dbt_model"
18:13:16.207986 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.my_second_dbt_model
18:13:16.220176 [debug] [Thread-1  ]: Compiling model.analytics_dbt.my_second_dbt_model
18:13:16.299931 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.my_second_dbt_model"
18:13:16.319083 [debug] [Thread-1  ]: finished collecting timing info
18:13:16.323594 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.my_second_dbt_model
18:13:16.396767 [debug] [Thread-1  ]: Writing runtime SQL for node "model.analytics_dbt.my_second_dbt_model"
18:13:16.409772 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
18:13:16.412867 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: BEGIN
18:13:16.416740 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:13:16.420118 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
18:13:17.724391 [debug] [Thread-1  ]: SQL status: BEGIN in 1.31 seconds
18:13:17.727439 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
18:13:17.731054 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */


  create view "dev"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."public"."my_first_dbt_model"
where id = 1
  ) ;

18:13:17.878826 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.14 seconds
18:13:17.905738 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
18:13:17.911787 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */
alter table "dev"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
18:13:18.075805 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.16 seconds
18:13:18.084485 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: COMMIT
18:13:18.091049 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
18:13:18.094337 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: COMMIT
18:13:18.265234 [debug] [Thread-1  ]: SQL status: COMMIT in 0.17 seconds
18:13:18.270652 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
18:13:18.273689 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: BEGIN
18:13:18.418059 [debug] [Thread-1  ]: SQL status: BEGIN in 0.14 seconds
18:13:18.424486 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
18:13:18.430261 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */
drop view if exists "dev"."public"."my_second_dbt_model__dbt_backup" cascade
18:13:18.575920 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.14 seconds
18:13:18.583344 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: COMMIT
18:13:18.589818 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
18:13:18.593916 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: COMMIT
18:13:18.759370 [debug] [Thread-1  ]: SQL status: COMMIT in 0.16 seconds
18:13:18.762386 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
18:13:18.765822 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: BEGIN
18:13:18.910839 [debug] [Thread-1  ]: SQL status: BEGIN in 0.14 seconds
18:13:18.914844 [debug] [Thread-1  ]: finished collecting timing info
18:13:18.918232 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: ROLLBACK
18:13:19.061228 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: Close
18:13:19.066056 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f25269d9-c687-4521-84fe-2a88c9ce0c95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f634c243bb0>]}
18:13:19.069082 [info ] [Thread-1  ]: 2 of 2 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 2.89s]
18:13:19.072888 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.my_second_dbt_model
18:13:19.081292 [debug] [MainThread]: Acquiring new redshift connection "master"
18:13:19.092518 [debug] [MainThread]: Using redshift connection "master"
18:13:19.096092 [debug] [MainThread]: On master: BEGIN
18:13:19.100030 [debug] [MainThread]: Opening a new connection, currently in state closed
18:13:19.103552 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
18:13:20.422132 [debug] [MainThread]: SQL status: BEGIN in 1.32 seconds
18:13:20.426239 [debug] [MainThread]: On master: COMMIT
18:13:20.430348 [debug] [MainThread]: Using redshift connection "master"
18:13:20.432807 [debug] [MainThread]: On master: COMMIT
18:13:20.574168 [debug] [MainThread]: SQL status: COMMIT in 0.14 seconds
18:13:20.577151 [debug] [MainThread]: On master: Close
18:13:20.580650 [info ] [MainThread]: 
18:13:20.583674 [info ] [MainThread]: Finished running 1 table model, 1 view model in 13.34s.
18:13:20.588756 [debug] [MainThread]: Connection 'master' was properly closed.
18:13:20.596339 [debug] [MainThread]: Connection 'list_dev' was properly closed.
18:13:20.603487 [debug] [MainThread]: Connection 'model.analytics_dbt.my_second_dbt_model' was properly closed.
18:13:20.654826 [info ] [MainThread]: 
18:13:20.671207 [info ] [MainThread]: [32mCompleted successfully[0m
18:13:20.695086 [info ] [MainThread]: 
18:13:20.718852 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
18:13:20.768640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f634c1f2c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f634c1f2be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f634c1f2220>]}


============================== 2022-05-21 18:32:16.202365 | 5ce2c7aa-70bb-4b78-8ff7-2fd871eb030f ==============================
18:32:16.202404 [info ] [MainThread]: Running with dbt=1.1.0
18:32:16.208191 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['views/vw_sales.sql'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
18:32:16.214754 [debug] [MainThread]: Tracking: tracking
18:32:16.254898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa69c891700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa69c8917c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa69c8917f0>]}
18:32:16.363950 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
18:32:16.371961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5ce2c7aa-70bb-4b78-8ff7-2fd871eb030f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa69c8adf40>]}
18:32:16.474753 [debug] [MainThread]: Parsing macros/adapters.sql
18:32:16.569196 [debug] [MainThread]: Parsing macros/relations.sql
18:32:16.575306 [debug] [MainThread]: Parsing macros/catalog.sql
18:32:16.620751 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
18:32:16.626858 [debug] [MainThread]: Parsing macros/adapters.sql
18:32:16.690875 [debug] [MainThread]: Parsing macros/relations.sql
18:32:16.699866 [debug] [MainThread]: Parsing macros/catalog.sql
18:32:16.711744 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
18:32:16.724206 [debug] [MainThread]: Parsing macros/adapters/columns.sql
18:32:16.759047 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
18:32:16.774107 [debug] [MainThread]: Parsing macros/adapters/relation.sql
18:32:16.806007 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
18:32:16.818501 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
18:32:16.834347 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
18:32:16.857470 [debug] [MainThread]: Parsing macros/adapters/schema.sql
18:32:16.867187 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
18:32:16.873294 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
18:32:16.886935 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
18:32:16.894441 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
18:32:16.899745 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
18:32:16.907299 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
18:32:16.918208 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
18:32:16.924570 [debug] [MainThread]: Parsing macros/etc/datetime.sql
18:32:16.951407 [debug] [MainThread]: Parsing macros/etc/statement.sql
18:32:16.966950 [debug] [MainThread]: Parsing macros/materializations/configs.sql
18:32:16.976674 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
18:32:16.991623 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
18:32:17.029465 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
18:32:17.076515 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
18:32:17.107084 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
18:32:17.115244 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
18:32:17.142879 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
18:32:17.160719 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
18:32:17.167434 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
18:32:17.209522 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
18:32:17.273825 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
18:32:17.299453 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
18:32:17.310019 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
18:32:17.316622 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
18:32:17.326470 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
18:32:17.335844 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
18:32:17.357024 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
18:32:17.371555 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
18:32:17.384627 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
18:32:17.392826 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
18:32:17.435870 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
18:32:17.455094 [debug] [MainThread]: Parsing tests/generic/builtin.sql
18:32:17.934619 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
18:32:17.967686 [debug] [MainThread]: 1699: static parser successfully parsed example/my_second_dbt_model.sql
18:32:17.976159 [debug] [MainThread]: 1699: static parser successfully parsed views/vw_sales.sql
18:32:18.129936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5ce2c7aa-70bb-4b78-8ff7-2fd871eb030f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa69c3677f0>]}
18:32:18.161004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5ce2c7aa-70bb-4b78-8ff7-2fd871eb030f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa69c8ad7c0>]}
18:32:18.164637 [info ] [MainThread]: Found 3 models, 4 tests, 0 snapshots, 0 analyses, 193 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
18:32:18.167423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5ce2c7aa-70bb-4b78-8ff7-2fd871eb030f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa69c8ad460>]}
18:32:18.175892 [warn ] [MainThread]: The selection criterion 'views/vw_sales.sql' does not match any nodes
18:32:18.188450 [info ] [MainThread]: 
18:32:18.196749 [warn ] [MainThread]: [[33mWARNING[0m]: Nothing to do. Try checking your model configs and model specification args
18:32:18.290336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa69c30b430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa69c30b1c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa69c30b4f0>]}


============================== 2022-05-21 18:32:57.313807 | 59bac8c5-4a1a-4dd4-a7d6-09352436abd9 ==============================
18:32:57.313828 [info ] [MainThread]: Running with dbt=1.1.0
18:32:57.318315 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
18:32:57.324892 [debug] [MainThread]: Tracking: tracking
18:32:57.366217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c53b306d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c53b30760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c53b30790>]}
18:32:57.489114 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
18:32:57.492500 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
18:32:57.508982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '59bac8c5-4a1a-4dd4-a7d6-09352436abd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c53a55f40>]}
18:32:57.538386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '59bac8c5-4a1a-4dd4-a7d6-09352436abd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c53b11a90>]}
18:32:57.542755 [info ] [MainThread]: Found 3 models, 4 tests, 0 snapshots, 0 analyses, 193 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
18:32:57.548060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '59bac8c5-4a1a-4dd4-a7d6-09352436abd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c53b11c10>]}
18:32:57.558907 [info ] [MainThread]: 
18:32:57.566894 [debug] [MainThread]: Acquiring new redshift connection "master"
18:32:57.581728 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev"
18:32:57.648059 [debug] [ThreadPool]: Using redshift connection "list_dev"
18:32:57.651571 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
  
18:32:57.655290 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:32:57.660336 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
18:32:59.191259 [debug] [ThreadPool]: SQL status: SELECT in 1.54 seconds
18:32:59.196078 [debug] [ThreadPool]: On list_dev: Close
18:32:59.203403 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev_public"
18:32:59.226211 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
18:32:59.229269 [debug] [ThreadPool]: On list_dev_public: BEGIN
18:32:59.232018 [debug] [ThreadPool]: Opening a new connection, currently in state closed
18:32:59.237289 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
18:33:00.505598 [debug] [ThreadPool]: SQL status: BEGIN in 1.27 seconds
18:33:00.508663 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
18:33:00.511653 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev_public"} */
select
      'dev' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dev' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
18:33:00.662952 [debug] [ThreadPool]: SQL status: SELECT in 0.15 seconds
18:33:00.669021 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
18:33:00.810508 [debug] [ThreadPool]: On list_dev_public: Close
18:33:00.822644 [debug] [MainThread]: Using redshift connection "master"
18:33:00.825361 [debug] [MainThread]: On master: BEGIN
18:33:00.828037 [debug] [MainThread]: Opening a new connection, currently in state init
18:33:00.830489 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
18:33:02.094289 [debug] [MainThread]: SQL status: BEGIN in 1.27 seconds
18:33:02.098518 [debug] [MainThread]: Using redshift connection "master"
18:33:02.103286 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
18:33:02.279316 [debug] [MainThread]: SQL status: SELECT in 0.17 seconds
18:33:02.284557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '59bac8c5-4a1a-4dd4-a7d6-09352436abd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c53b11790>]}
18:33:02.287635 [debug] [MainThread]: On master: ROLLBACK
18:33:02.427968 [debug] [MainThread]: Using redshift connection "master"
18:33:02.431772 [debug] [MainThread]: On master: BEGIN
18:33:02.709909 [debug] [MainThread]: SQL status: BEGIN in 0.28 seconds
18:33:02.713418 [debug] [MainThread]: On master: COMMIT
18:33:02.716262 [debug] [MainThread]: Using redshift connection "master"
18:33:02.719154 [debug] [MainThread]: On master: COMMIT
18:33:02.872084 [debug] [MainThread]: SQL status: COMMIT in 0.15 seconds
18:33:02.877236 [debug] [MainThread]: On master: Close
18:33:02.880900 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
18:33:02.884124 [info ] [MainThread]: 
18:33:02.903008 [debug] [Thread-1  ]: Began running node model.analytics_dbt.my_first_dbt_model
18:33:02.936217 [info ] [Thread-1  ]: 1 of 3 START table model public.my_first_dbt_model ............................. [RUN]
18:33:02.954072 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.my_first_dbt_model"
18:33:02.965488 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.my_first_dbt_model
18:33:02.973485 [debug] [Thread-1  ]: Compiling model.analytics_dbt.my_first_dbt_model
18:33:02.992194 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.my_first_dbt_model"
18:33:03.012464 [debug] [Thread-1  ]: finished collecting timing info
18:33:03.017064 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.my_first_dbt_model
18:33:03.122775 [debug] [Thread-1  ]: Writing runtime SQL for node "model.analytics_dbt.my_first_dbt_model"
18:33:03.132193 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
18:33:03.135233 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: BEGIN
18:33:03.138964 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:33:03.142508 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
18:33:04.436267 [debug] [Thread-1  ]: SQL status: BEGIN in 1.3 seconds
18:33:04.439592 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
18:33:04.444590 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */


  create  table
    "dev"."public"."my_first_dbt_model__dbt_tmp"
    
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
18:33:04.628993 [debug] [Thread-1  ]: SQL status: SELECT in 0.18 seconds
18:33:04.647047 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
18:33:04.649597 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
alter table "dev"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
18:33:04.797786 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.15 seconds
18:33:04.809284 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
18:33:04.814478 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
alter table "dev"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
18:33:04.959882 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.14 seconds
18:33:04.986875 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: COMMIT
18:33:04.989295 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
18:33:04.992089 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: COMMIT
18:33:05.171027 [debug] [Thread-1  ]: SQL status: COMMIT in 0.18 seconds
18:33:05.174642 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
18:33:05.177893 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: BEGIN
18:33:05.320634 [debug] [Thread-1  ]: SQL status: BEGIN in 0.14 seconds
18:33:05.337035 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
18:33:05.340243 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
drop table if exists "dev"."public"."my_first_dbt_model__dbt_backup" cascade
18:33:05.490914 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.15 seconds
18:33:05.494505 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: COMMIT
18:33:05.496881 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
18:33:05.499120 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: COMMIT
18:33:05.664179 [debug] [Thread-1  ]: SQL status: COMMIT in 0.16 seconds
18:33:05.666563 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
18:33:05.668623 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: BEGIN
18:33:05.812871 [debug] [Thread-1  ]: SQL status: BEGIN in 0.14 seconds
18:33:05.816449 [debug] [Thread-1  ]: finished collecting timing info
18:33:05.818558 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: ROLLBACK
18:33:05.961664 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: Close
18:33:05.966403 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '59bac8c5-4a1a-4dd4-a7d6-09352436abd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c53182df0>]}
18:33:05.970013 [info ] [Thread-1  ]: 1 of 3 OK created table model public.my_first_dbt_model ........................ [[32mSELECT[0m in 3.01s]
18:33:05.982755 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.my_first_dbt_model
18:33:05.993532 [debug] [Thread-1  ]: Began running node model.analytics_dbt.vw_sales
18:33:05.998476 [info ] [Thread-1  ]: 2 of 3 START view model public.vw_sales ........................................ [RUN]
18:33:06.005300 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.vw_sales"
18:33:06.020918 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.vw_sales
18:33:06.033244 [debug] [Thread-1  ]: Compiling model.analytics_dbt.vw_sales
18:33:06.056656 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.vw_sales"
18:33:06.084673 [debug] [Thread-1  ]: finished collecting timing info
18:33:06.090127 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.vw_sales
18:33:06.147434 [debug] [Thread-1  ]: Writing runtime SQL for node "model.analytics_dbt.vw_sales"
18:33:06.166024 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
18:33:06.169085 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: BEGIN
18:33:06.173042 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:33:06.176277 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
18:33:07.447584 [debug] [Thread-1  ]: SQL status: BEGIN in 1.27 seconds
18:33:07.451230 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
18:33:07.453708 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */


  create view "dev"."public"."vw_sales__dbt_tmp" as (
    with source_sales as (
    select *
    from sales

),

renamed as (
    select
        SALESID AS ID_VENDA,
        LISTID AS ID_LISTA,
        SELLERID AS ID_VENDEDOR,
        BUYERID AS ID_COMPRADOR,
        EVENTID AS ID_EVENTO,
        DATEID AS ID_DATE,
        QTYSOLD AS QUANTIDADE_VENDIDA,
        PRICEPAID AS VALOR_PAGO,
        COMMISSION AS COMISSÃO,
        SALETIME AS DATA_VENDA
    
    FROM source_sales

)

select * from renamed
  ) ;

18:33:07.599104 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.14 seconds
18:33:07.608387 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
18:33:07.611406 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */
alter table "dev"."public"."vw_sales__dbt_tmp" rename to "vw_sales"
18:33:07.753110 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.14 seconds
18:33:07.759187 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: COMMIT
18:33:07.762191 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
18:33:07.765789 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: COMMIT
18:33:07.935482 [debug] [Thread-1  ]: SQL status: COMMIT in 0.17 seconds
18:33:07.939399 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
18:33:07.942378 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: BEGIN
18:33:08.083966 [debug] [Thread-1  ]: SQL status: BEGIN in 0.14 seconds
18:33:08.089657 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
18:33:08.092575 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */
drop view if exists "dev"."public"."vw_sales__dbt_backup" cascade
18:33:08.235487 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.14 seconds
18:33:08.240676 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: COMMIT
18:33:08.243205 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
18:33:08.247165 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: COMMIT
18:33:08.407555 [debug] [Thread-1  ]: SQL status: COMMIT in 0.16 seconds
18:33:08.410046 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
18:33:08.412294 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: BEGIN
18:33:08.553952 [debug] [Thread-1  ]: SQL status: BEGIN in 0.14 seconds
18:33:08.558505 [debug] [Thread-1  ]: finished collecting timing info
18:33:08.562480 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: ROLLBACK
18:33:08.766901 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: Close
18:33:08.771232 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '59bac8c5-4a1a-4dd4-a7d6-09352436abd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c531d9d30>]}
18:33:08.774597 [info ] [Thread-1  ]: 2 of 3 OK created view model public.vw_sales ................................... [[32mCREATE VIEW[0m in 2.77s]
18:33:08.779324 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.vw_sales
18:33:08.783970 [debug] [Thread-1  ]: Began running node model.analytics_dbt.my_second_dbt_model
18:33:08.797245 [info ] [Thread-1  ]: 3 of 3 START view model public.my_second_dbt_model ............................. [RUN]
18:33:08.803594 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.my_second_dbt_model"
18:33:08.815647 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.my_second_dbt_model
18:33:08.819374 [debug] [Thread-1  ]: Compiling model.analytics_dbt.my_second_dbt_model
18:33:08.832105 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.my_second_dbt_model"
18:33:08.857367 [debug] [Thread-1  ]: finished collecting timing info
18:33:08.864579 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.my_second_dbt_model
18:33:08.886418 [debug] [Thread-1  ]: Writing runtime SQL for node "model.analytics_dbt.my_second_dbt_model"
18:33:08.894845 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
18:33:08.897992 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: BEGIN
18:33:08.900297 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:33:08.902661 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
18:33:10.208403 [debug] [Thread-1  ]: SQL status: BEGIN in 1.31 seconds
18:33:10.212095 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
18:33:10.214561 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */


  create view "dev"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."public"."my_first_dbt_model"
where id = 1
  ) ;

18:33:10.360038 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.14 seconds
18:33:10.368407 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
18:33:10.370731 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */
alter table "dev"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
18:33:10.517864 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.14 seconds
18:33:10.522510 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: COMMIT
18:33:10.524861 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
18:33:10.529177 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: COMMIT
18:33:10.695546 [debug] [Thread-1  ]: SQL status: COMMIT in 0.16 seconds
18:33:10.699009 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
18:33:10.702445 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: BEGIN
18:33:10.843895 [debug] [Thread-1  ]: SQL status: BEGIN in 0.14 seconds
18:33:10.850406 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
18:33:10.853279 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */
drop view if exists "dev"."public"."my_second_dbt_model__dbt_backup" cascade
18:33:10.995364 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.14 seconds
18:33:10.999394 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: COMMIT
18:33:11.001679 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
18:33:11.004664 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: COMMIT
18:33:11.167680 [debug] [Thread-1  ]: SQL status: COMMIT in 0.16 seconds
18:33:11.171048 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
18:33:11.172985 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: BEGIN
18:33:11.314911 [debug] [Thread-1  ]: SQL status: BEGIN in 0.14 seconds
18:33:11.317887 [debug] [Thread-1  ]: finished collecting timing info
18:33:11.319980 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: ROLLBACK
18:33:11.461425 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: Close
18:33:11.465311 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '59bac8c5-4a1a-4dd4-a7d6-09352436abd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c5191c6d0>]}
18:33:11.468496 [info ] [Thread-1  ]: 3 of 3 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 2.66s]
18:33:11.471890 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.my_second_dbt_model
18:33:11.481225 [debug] [MainThread]: Acquiring new redshift connection "master"
18:33:11.486266 [debug] [MainThread]: Using redshift connection "master"
18:33:11.493312 [debug] [MainThread]: On master: BEGIN
18:33:11.499157 [debug] [MainThread]: Opening a new connection, currently in state closed
18:33:11.503969 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
18:33:12.800711 [debug] [MainThread]: SQL status: BEGIN in 1.3 seconds
18:33:12.804686 [debug] [MainThread]: On master: COMMIT
18:33:12.807193 [debug] [MainThread]: Using redshift connection "master"
18:33:12.810178 [debug] [MainThread]: On master: COMMIT
18:33:12.952659 [debug] [MainThread]: SQL status: COMMIT in 0.14 seconds
18:33:12.955923 [debug] [MainThread]: On master: Close
18:33:12.959370 [info ] [MainThread]: 
18:33:12.962493 [info ] [MainThread]: Finished running 1 table model, 2 view models in 15.39s.
18:33:12.966774 [debug] [MainThread]: Connection 'master' was properly closed.
18:33:12.974423 [debug] [MainThread]: Connection 'model.analytics_dbt.my_second_dbt_model' was properly closed.
18:33:13.036216 [info ] [MainThread]: 
18:33:13.039814 [info ] [MainThread]: [32mCompleted successfully[0m
18:33:13.062308 [info ] [MainThread]: 
18:33:13.075976 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
18:33:13.112299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c519114f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c51911400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c51911af0>]}


============================== 2022-05-21 19:08:33.446561 | f822d407-89e7-4884-9f1e-a34e47630d25 ==============================
19:08:33.446584 [info ] [MainThread]: Running with dbt=1.1.0
19:08:33.456615 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['views/vw_sales.sql'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
19:08:33.464848 [debug] [MainThread]: Tracking: tracking
19:08:33.549866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad62bc3670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad62bc3730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad62bc3760>]}
19:08:33.678205 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
19:08:33.682290 [debug] [MainThread]: Partial parsing: updated file: analytics_dbt://models/views/vw_sales.sql
19:08:33.716548 [debug] [MainThread]: 1699: static parser successfully parsed views/vw_sales.sql
19:08:33.783084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f822d407-89e7-4884-9f1e-a34e47630d25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad62a9bdc0>]}
19:08:33.823471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f822d407-89e7-4884-9f1e-a34e47630d25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad62accf10>]}
19:08:33.826986 [info ] [MainThread]: Found 3 models, 4 tests, 0 snapshots, 0 analyses, 193 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
19:08:33.830172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f822d407-89e7-4884-9f1e-a34e47630d25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad62ac4b20>]}
19:08:33.849281 [warn ] [MainThread]: The selection criterion 'views/vw_sales.sql' does not match any nodes
19:08:33.923158 [info ] [MainThread]: 
19:08:33.927288 [warn ] [MainThread]: [[33mWARNING[0m]: Nothing to do. Try checking your model configs and model specification args
19:08:34.016635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad62ac4ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad62bd1760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad62bd14f0>]}


============================== 2022-05-21 19:09:22.876409 | e3782f7a-9f1a-4155-aa66-5e730ae06990 ==============================
19:09:22.876441 [info ] [MainThread]: Running with dbt=1.1.0
19:09:22.884278 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
19:09:22.900089 [debug] [MainThread]: Tracking: tracking
19:09:22.948692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02afb3e400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02afb3e460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02afb3e4c0>]}
19:09:23.096398 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
19:09:23.099244 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
19:09:23.118446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e3782f7a-9f1a-4155-aa66-5e730ae06990', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02afa66ee0>]}
19:09:23.150726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e3782f7a-9f1a-4155-aa66-5e730ae06990', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02afa7ab20>]}
19:09:23.156374 [info ] [MainThread]: Found 3 models, 4 tests, 0 snapshots, 0 analyses, 193 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
19:09:23.160611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e3782f7a-9f1a-4155-aa66-5e730ae06990', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02afa7aca0>]}
19:09:23.178403 [info ] [MainThread]: 
19:09:23.200284 [debug] [MainThread]: Acquiring new redshift connection "master"
19:09:23.204823 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev"
19:09:23.251529 [debug] [ThreadPool]: Using redshift connection "list_dev"
19:09:23.255224 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
  
19:09:23.259759 [debug] [ThreadPool]: Opening a new connection, currently in state init
19:09:23.264739 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
19:09:24.613152 [debug] [ThreadPool]: SQL status: SELECT in 1.35 seconds
19:09:24.620423 [debug] [ThreadPool]: On list_dev: Close
19:09:24.628428 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev_public"
19:09:24.649782 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
19:09:24.652520 [debug] [ThreadPool]: On list_dev_public: BEGIN
19:09:24.654485 [debug] [ThreadPool]: Opening a new connection, currently in state closed
19:09:24.656489 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
19:09:25.971704 [debug] [ThreadPool]: SQL status: BEGIN in 1.32 seconds
19:09:25.974312 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
19:09:25.976412 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev_public"} */
select
      'dev' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dev' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
19:09:26.131084 [debug] [ThreadPool]: SQL status: SELECT in 0.15 seconds
19:09:26.137035 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
19:09:26.279994 [debug] [ThreadPool]: On list_dev_public: Close
19:09:26.293476 [debug] [MainThread]: Using redshift connection "master"
19:09:26.295601 [debug] [MainThread]: On master: BEGIN
19:09:26.297968 [debug] [MainThread]: Opening a new connection, currently in state init
19:09:26.300332 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
19:09:27.595116 [debug] [MainThread]: SQL status: BEGIN in 1.3 seconds
19:09:27.599472 [debug] [MainThread]: Using redshift connection "master"
19:09:27.602565 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
19:09:27.778159 [debug] [MainThread]: SQL status: SELECT in 0.17 seconds
19:09:27.782814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e3782f7a-9f1a-4155-aa66-5e730ae06990', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02afb3e4c0>]}
19:09:27.785334 [debug] [MainThread]: On master: ROLLBACK
19:09:27.927667 [debug] [MainThread]: Using redshift connection "master"
19:09:27.930320 [debug] [MainThread]: On master: BEGIN
19:09:28.225860 [debug] [MainThread]: SQL status: BEGIN in 0.29 seconds
19:09:28.229554 [debug] [MainThread]: On master: COMMIT
19:09:28.232090 [debug] [MainThread]: Using redshift connection "master"
19:09:28.235039 [debug] [MainThread]: On master: COMMIT
19:09:28.377121 [debug] [MainThread]: SQL status: COMMIT in 0.14 seconds
19:09:28.379859 [debug] [MainThread]: On master: Close
19:09:28.384233 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
19:09:28.386812 [info ] [MainThread]: 
19:09:28.400727 [debug] [Thread-1  ]: Began running node model.analytics_dbt.my_first_dbt_model
19:09:28.413421 [info ] [Thread-1  ]: 1 of 3 START table model public.my_first_dbt_model ............................. [RUN]
19:09:28.429832 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.my_first_dbt_model"
19:09:28.447544 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.my_first_dbt_model
19:09:28.451692 [debug] [Thread-1  ]: Compiling model.analytics_dbt.my_first_dbt_model
19:09:28.478246 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.my_first_dbt_model"
19:09:28.496047 [debug] [Thread-1  ]: finished collecting timing info
19:09:28.498987 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.my_first_dbt_model
19:09:28.608249 [debug] [Thread-1  ]: Writing runtime SQL for node "model.analytics_dbt.my_first_dbt_model"
19:09:28.620996 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
19:09:28.625016 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: BEGIN
19:09:28.628479 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:09:28.631581 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
19:09:29.900683 [debug] [Thread-1  ]: SQL status: BEGIN in 1.27 seconds
19:09:29.904595 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
19:09:29.908640 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */


  create  table
    "dev"."public"."my_first_dbt_model__dbt_tmp"
    
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
19:09:30.113807 [debug] [Thread-1  ]: SQL status: SELECT in 0.2 seconds
19:09:30.130052 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
19:09:30.132426 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
alter table "dev"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
19:09:30.276028 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.14 seconds
19:09:30.283140 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
19:09:30.286808 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
alter table "dev"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
19:09:30.427522 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.14 seconds
19:09:30.455380 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: COMMIT
19:09:30.458045 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
19:09:30.460410 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: COMMIT
19:09:30.634285 [debug] [Thread-1  ]: SQL status: COMMIT in 0.17 seconds
19:09:30.638801 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
19:09:30.641421 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: BEGIN
19:09:30.783202 [debug] [Thread-1  ]: SQL status: BEGIN in 0.14 seconds
19:09:30.799570 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
19:09:30.802804 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
drop table if exists "dev"."public"."my_first_dbt_model__dbt_backup" cascade
19:09:30.946408 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.14 seconds
19:09:30.952416 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: COMMIT
19:09:30.955445 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
19:09:30.958225 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: COMMIT
19:09:31.123531 [debug] [Thread-1  ]: SQL status: COMMIT in 0.16 seconds
19:09:31.126459 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
19:09:31.129857 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: BEGIN
19:09:31.270104 [debug] [Thread-1  ]: SQL status: BEGIN in 0.14 seconds
19:09:31.275396 [debug] [Thread-1  ]: finished collecting timing info
19:09:31.277610 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: ROLLBACK
19:09:31.418063 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: Close
19:09:31.422244 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3782f7a-9f1a-4155-aa66-5e730ae06990', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02af1969d0>]}
19:09:31.426797 [info ] [Thread-1  ]: 1 of 3 OK created table model public.my_first_dbt_model ........................ [[32mSELECT[0m in 2.99s]
19:09:31.429971 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.my_first_dbt_model
19:09:31.433590 [debug] [Thread-1  ]: Began running node model.analytics_dbt.vw_sales
19:09:31.437043 [info ] [Thread-1  ]: 2 of 3 START view model public.vw_sales ........................................ [RUN]
19:09:31.441152 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.vw_sales"
19:09:31.447663 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.vw_sales
19:09:31.451997 [debug] [Thread-1  ]: Compiling model.analytics_dbt.vw_sales
19:09:31.461009 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.vw_sales"
19:09:31.486713 [debug] [Thread-1  ]: finished collecting timing info
19:09:31.490551 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.vw_sales
19:09:31.565505 [debug] [Thread-1  ]: Writing runtime SQL for node "model.analytics_dbt.vw_sales"
19:09:31.580570 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
19:09:31.583793 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: BEGIN
19:09:31.588155 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:09:31.591513 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
19:09:32.908169 [debug] [Thread-1  ]: SQL status: BEGIN in 1.32 seconds
19:09:32.923730 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
19:09:32.926269 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */


  create view "dev"."public"."vw_sales__dbt_tmp" as (
    with source_sales as (
    select *
    from sales

),

renamed as (
    select
        SALESID AS ID_VENDA,
        LISTID AS ID_LISTA,
        SELLERID AS ID_VENDEDOR,
        BUYERID AS ID_COMPRADOR,
        EVENTID AS ID_EVENTO,
        DATEID AS ID_DATE,
        QTYSOLD AS QUANTIDADE_VENDIDA,
        PRICEPAID AS VALOR_PAGO,
        COMMISSION AS COMISSÃO,
        TO_CHAR(saletime, 'dd/mm/yyyy HH24:MI:SS') AS DATA_HORA_VENDA,
        TO_CHAR(saletime, 'HH24:MI:SS') AS HORA_VENDA,
        cast(saletime as date) AS DATA_VENDA

  
    FROM source_sales

)

select * from renamed
  ) ;

19:09:33.075522 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.15 seconds
19:09:33.082370 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
19:09:33.084770 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */
alter table "dev"."public"."vw_sales" rename to "vw_sales__dbt_backup"
19:09:33.229839 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.14 seconds
19:09:33.237995 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
19:09:33.240577 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */
alter table "dev"."public"."vw_sales__dbt_tmp" rename to "vw_sales"
19:09:33.387071 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.14 seconds
19:09:33.392379 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: COMMIT
19:09:33.394640 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
19:09:33.397188 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: COMMIT
19:09:33.569285 [debug] [Thread-1  ]: SQL status: COMMIT in 0.17 seconds
19:09:33.574274 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
19:09:33.581764 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: BEGIN
19:09:33.728796 [debug] [Thread-1  ]: SQL status: BEGIN in 0.14 seconds
19:09:33.734189 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
19:09:33.736759 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */
drop view if exists "dev"."public"."vw_sales__dbt_backup" cascade
19:09:33.882865 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.14 seconds
19:09:33.887812 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: COMMIT
19:09:33.890753 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
19:09:33.893535 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: COMMIT
19:09:34.060810 [debug] [Thread-1  ]: SQL status: COMMIT in 0.16 seconds
19:09:34.065470 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
19:09:34.068435 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: BEGIN
19:09:34.213230 [debug] [Thread-1  ]: SQL status: BEGIN in 0.14 seconds
19:09:34.216426 [debug] [Thread-1  ]: finished collecting timing info
19:09:34.219475 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: ROLLBACK
19:09:34.363503 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: Close
19:09:34.369276 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3782f7a-9f1a-4155-aa66-5e730ae06990', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02af1889d0>]}
19:09:34.372672 [info ] [Thread-1  ]: 2 of 3 OK created view model public.vw_sales ................................... [[32mCREATE VIEW[0m in 2.93s]
19:09:34.377744 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.vw_sales
19:09:34.382232 [debug] [Thread-1  ]: Began running node model.analytics_dbt.my_second_dbt_model
19:09:34.389198 [info ] [Thread-1  ]: 3 of 3 START view model public.my_second_dbt_model ............................. [RUN]
19:09:34.397737 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.my_second_dbt_model"
19:09:34.407304 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.my_second_dbt_model
19:09:34.414112 [debug] [Thread-1  ]: Compiling model.analytics_dbt.my_second_dbt_model
19:09:34.430492 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.my_second_dbt_model"
19:09:34.465336 [debug] [Thread-1  ]: finished collecting timing info
19:09:34.469658 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.my_second_dbt_model
19:09:34.482438 [debug] [Thread-1  ]: Writing runtime SQL for node "model.analytics_dbt.my_second_dbt_model"
19:09:34.491632 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
19:09:34.494130 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: BEGIN
19:09:34.496387 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:09:34.498918 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
19:09:35.789151 [debug] [Thread-1  ]: SQL status: BEGIN in 1.29 seconds
19:09:35.792244 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
19:09:35.795000 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */


  create view "dev"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."public"."my_first_dbt_model"
where id = 1
  ) ;

19:09:35.939524 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.14 seconds
19:09:35.948078 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
19:09:35.950243 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */
alter table "dev"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
19:09:36.093441 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.14 seconds
19:09:36.101989 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: COMMIT
19:09:36.104208 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
19:09:36.107305 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: COMMIT
19:09:36.279509 [debug] [Thread-1  ]: SQL status: COMMIT in 0.17 seconds
19:09:36.282628 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
19:09:36.285173 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: BEGIN
19:09:36.431196 [debug] [Thread-1  ]: SQL status: BEGIN in 0.14 seconds
19:09:36.436787 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
19:09:36.439292 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */
drop view if exists "dev"."public"."my_second_dbt_model__dbt_backup" cascade
19:09:36.580337 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.14 seconds
19:09:36.588496 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: COMMIT
19:09:36.591849 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
19:09:36.594316 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: COMMIT
19:09:36.758719 [debug] [Thread-1  ]: SQL status: COMMIT in 0.16 seconds
19:09:36.762108 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
19:09:36.764331 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: BEGIN
19:09:36.906062 [debug] [Thread-1  ]: SQL status: BEGIN in 0.14 seconds
19:09:36.909543 [debug] [Thread-1  ]: finished collecting timing info
19:09:36.912001 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: ROLLBACK
19:09:37.059435 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: Close
19:09:37.064720 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3782f7a-9f1a-4155-aa66-5e730ae06990', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02af1ede50>]}
19:09:37.068115 [info ] [Thread-1  ]: 3 of 3 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 2.67s]
19:09:37.071563 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.my_second_dbt_model
19:09:37.080851 [debug] [MainThread]: Acquiring new redshift connection "master"
19:09:37.085747 [debug] [MainThread]: Using redshift connection "master"
19:09:37.095562 [debug] [MainThread]: On master: BEGIN
19:09:37.101028 [debug] [MainThread]: Opening a new connection, currently in state closed
19:09:37.110099 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
19:09:38.388827 [debug] [MainThread]: SQL status: BEGIN in 1.29 seconds
19:09:38.392386 [debug] [MainThread]: On master: COMMIT
19:09:38.395224 [debug] [MainThread]: Using redshift connection "master"
19:09:38.398060 [debug] [MainThread]: On master: COMMIT
19:09:38.538538 [debug] [MainThread]: SQL status: COMMIT in 0.14 seconds
19:09:38.542176 [debug] [MainThread]: On master: Close
19:09:38.547701 [info ] [MainThread]: 
19:09:38.552307 [info ] [MainThread]: Finished running 1 table model, 2 view models in 15.35s.
19:09:38.558955 [debug] [MainThread]: Connection 'master' was properly closed.
19:09:38.568603 [debug] [MainThread]: Connection 'model.analytics_dbt.my_second_dbt_model' was properly closed.
19:09:38.636873 [info ] [MainThread]: 
19:09:38.641432 [info ] [MainThread]: [32mCompleted successfully[0m
19:09:38.650213 [info ] [MainThread]: 
19:09:38.660165 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
19:09:38.672335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02ad8bbca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02ad8bba60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02ad8bba90>]}


============================== 2022-05-21 19:17:39.197869 | 61b51e1b-3001-4e1f-a40b-09cfb33e4711 ==============================
19:17:39.197893 [info ] [MainThread]: Running with dbt=1.1.0
19:17:39.203799 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['models/tb_10_compradores.sql'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
19:17:39.215789 [debug] [MainThread]: Tracking: tracking
19:17:39.247360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d41455730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d414557f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d41455820>]}
19:17:39.400454 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
19:17:39.403968 [debug] [MainThread]: Partial parsing: added file: analytics_dbt://models/tb_10_compradores.sql
19:17:39.432954 [debug] [MainThread]: 1699: static parser successfully parsed tb_10_compradores.sql
19:17:39.485299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '61b51e1b-3001-4e1f-a40b-09cfb33e4711', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d41330eb0>]}
19:17:39.522281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '61b51e1b-3001-4e1f-a40b-09cfb33e4711', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d4143ad00>]}
19:17:39.525193 [info ] [MainThread]: Found 4 models, 4 tests, 0 snapshots, 0 analyses, 193 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
19:17:39.529112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '61b51e1b-3001-4e1f-a40b-09cfb33e4711', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d4143af10>]}
19:17:39.542033 [info ] [MainThread]: 
19:17:39.554338 [debug] [MainThread]: Acquiring new redshift connection "master"
19:17:39.580563 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev"
19:17:39.621476 [debug] [ThreadPool]: Using redshift connection "list_dev"
19:17:39.624147 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
  
19:17:39.626506 [debug] [ThreadPool]: Opening a new connection, currently in state init
19:17:39.629359 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
19:17:40.958055 [debug] [ThreadPool]: SQL status: SELECT in 1.33 seconds
19:17:40.962308 [debug] [ThreadPool]: On list_dev: Close
19:17:40.968113 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev_public"
19:17:40.987231 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
19:17:40.992160 [debug] [ThreadPool]: On list_dev_public: BEGIN
19:17:40.995254 [debug] [ThreadPool]: Opening a new connection, currently in state closed
19:17:40.998045 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
19:17:42.262895 [debug] [ThreadPool]: SQL status: BEGIN in 1.27 seconds
19:17:42.266083 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
19:17:42.269899 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev_public"} */
select
      'dev' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dev' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
19:17:42.422253 [debug] [ThreadPool]: SQL status: SELECT in 0.15 seconds
19:17:42.427725 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
19:17:42.567214 [debug] [ThreadPool]: On list_dev_public: Close
19:17:42.580719 [debug] [MainThread]: Using redshift connection "master"
19:17:42.583184 [debug] [MainThread]: On master: BEGIN
19:17:42.585675 [debug] [MainThread]: Opening a new connection, currently in state init
19:17:42.588276 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
19:17:43.898905 [debug] [MainThread]: SQL status: BEGIN in 1.31 seconds
19:17:43.902710 [debug] [MainThread]: Using redshift connection "master"
19:17:43.905205 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
19:17:44.088015 [debug] [MainThread]: SQL status: SELECT in 0.18 seconds
19:17:44.094174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '61b51e1b-3001-4e1f-a40b-09cfb33e4711', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d414715b0>]}
19:17:44.096824 [debug] [MainThread]: On master: ROLLBACK
19:17:44.238968 [debug] [MainThread]: Using redshift connection "master"
19:17:44.242043 [debug] [MainThread]: On master: BEGIN
19:17:44.526153 [debug] [MainThread]: SQL status: BEGIN in 0.28 seconds
19:17:44.529784 [debug] [MainThread]: On master: COMMIT
19:17:44.532064 [debug] [MainThread]: Using redshift connection "master"
19:17:44.534366 [debug] [MainThread]: On master: COMMIT
19:17:44.676366 [debug] [MainThread]: SQL status: COMMIT in 0.14 seconds
19:17:44.680086 [debug] [MainThread]: On master: Close
19:17:44.683146 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
19:17:44.686372 [info ] [MainThread]: 
19:17:44.701535 [debug] [Thread-1  ]: Began running node model.analytics_dbt.tb_10_compradores
19:17:44.715206 [info ] [Thread-1  ]: 1 of 1 START view model public.tb_10_compradores ............................... [RUN]
19:17:44.727154 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.tb_10_compradores"
19:17:44.734729 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.tb_10_compradores
19:17:44.741785 [debug] [Thread-1  ]: Compiling model.analytics_dbt.tb_10_compradores
19:17:44.757417 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.tb_10_compradores"
19:17:44.770962 [debug] [Thread-1  ]: finished collecting timing info
19:17:44.776951 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.tb_10_compradores
19:17:44.838548 [debug] [Thread-1  ]: Writing runtime SQL for node "model.analytics_dbt.tb_10_compradores"
19:17:44.848025 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_10_compradores"
19:17:44.850870 [debug] [Thread-1  ]: On model.analytics_dbt.tb_10_compradores: BEGIN
19:17:44.854602 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:17:44.857511 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
19:17:46.160510 [debug] [Thread-1  ]: SQL status: BEGIN in 1.31 seconds
19:17:46.165044 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_10_compradores"
19:17:46.167270 [debug] [Thread-1  ]: On model.analytics_dbt.tb_10_compradores: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.tb_10_compradores"} */


  create view "dev"."public"."tb_10_compradores__dbt_tmp" as (
    with sales as (

    select * from "dev"."public"."vw_sales"

)

compradores as (

    SELECT
        (firstname ||' '|| lastname) as Nome_Completo,
        userid
    FROM users
)

top_10_compradores as (

    SELECT
        compradores.Nome_Completo as Nome_Completo,
        sum(sales.quantidade_vendida) as Vendas_totais,
        sales.comisão as Comissão
    FROM sales INNER JOIN compradores
    ON sales.id_comprador = compradores.userid
    GROUP BY compradores.userid
    ORDER BY Vendas_totais DESC
    LIMIT 10

)

select * from top_10_compradores
  ) ;

19:17:46.321887 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near "compradores"
LINE 11: compradores as (
         ^

19:17:46.325828 [debug] [Thread-1  ]: On model.analytics_dbt.tb_10_compradores: ROLLBACK
19:17:46.469808 [debug] [Thread-1  ]: finished collecting timing info
19:17:46.473316 [debug] [Thread-1  ]: On model.analytics_dbt.tb_10_compradores: Close
19:17:46.477293 [debug] [Thread-1  ]: Database Error in model tb_10_compradores (models/tb_10_compradores.sql)
  syntax error at or near "compradores"
  LINE 11: compradores as (
           ^
  compiled SQL at target/run/analytics_dbt/models/tb_10_compradores.sql
19:17:46.480395 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61b51e1b-3001-4e1f-a40b-09cfb33e4711', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d4067fac0>]}
19:17:46.483084 [error] [Thread-1  ]: 1 of 1 ERROR creating view model public.tb_10_compradores ...................... [[31mERROR[0m in 1.75s]
19:17:46.486268 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.tb_10_compradores
19:17:46.494544 [debug] [MainThread]: Acquiring new redshift connection "master"
19:17:46.508396 [debug] [MainThread]: Using redshift connection "master"
19:17:46.512816 [debug] [MainThread]: On master: BEGIN
19:17:46.518455 [debug] [MainThread]: Opening a new connection, currently in state closed
19:17:46.524039 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
19:17:47.822458 [debug] [MainThread]: SQL status: BEGIN in 1.3 seconds
19:17:47.826237 [debug] [MainThread]: On master: COMMIT
19:17:47.828995 [debug] [MainThread]: Using redshift connection "master"
19:17:47.831228 [debug] [MainThread]: On master: COMMIT
19:17:47.977604 [debug] [MainThread]: SQL status: COMMIT in 0.14 seconds
19:17:47.981043 [debug] [MainThread]: On master: Close
19:17:47.984942 [info ] [MainThread]: 
19:17:47.989282 [info ] [MainThread]: Finished running 1 view model in 8.43s.
19:17:47.994465 [debug] [MainThread]: Connection 'master' was properly closed.
19:17:48.003040 [debug] [MainThread]: Connection 'model.analytics_dbt.tb_10_compradores' was properly closed.
19:17:48.060593 [info ] [MainThread]: 
19:17:48.069368 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
19:17:48.081766 [info ] [MainThread]: 
19:17:48.085286 [error] [MainThread]: [33mDatabase Error in model tb_10_compradores (models/tb_10_compradores.sql)[0m
19:17:48.089152 [error] [MainThread]:   syntax error at or near "compradores"
19:17:48.103826 [error] [MainThread]:   LINE 11: compradores as (
19:17:48.119364 [error] [MainThread]:            ^
19:17:48.131264 [error] [MainThread]:   compiled SQL at target/run/analytics_dbt/models/tb_10_compradores.sql
19:17:48.146989 [info ] [MainThread]: 
19:17:48.164874 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
19:17:48.176202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d41366f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d4143a700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d40690fa0>]}


============================== 2022-05-21 19:18:10.185224 | f3e5b86c-d58f-4bbe-9008-6ab527e0e442 ==============================
19:18:10.185247 [info ] [MainThread]: Running with dbt=1.1.0
19:18:10.191113 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['models/tb_10_compradores.sql'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
19:18:10.197569 [debug] [MainThread]: Tracking: tracking
19:18:10.229317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1c7d6a5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1c7d6a670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1c7d6a6a0>]}
19:18:10.341149 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
19:18:10.343899 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
19:18:10.358506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f3e5b86c-d58f-4bbe-9008-6ab527e0e442', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1c7c8fbe0>]}
19:18:10.384427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f3e5b86c-d58f-4bbe-9008-6ab527e0e442', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1c7cb5d90>]}
19:18:10.388833 [info ] [MainThread]: Found 4 models, 4 tests, 0 snapshots, 0 analyses, 193 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
19:18:10.393807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f3e5b86c-d58f-4bbe-9008-6ab527e0e442', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1c7cb5e80>]}
19:18:10.408226 [info ] [MainThread]: 
19:18:10.417109 [debug] [MainThread]: Acquiring new redshift connection "master"
19:18:10.423525 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev"
19:18:10.473581 [debug] [ThreadPool]: Using redshift connection "list_dev"
19:18:10.477471 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
  
19:18:10.481683 [debug] [ThreadPool]: Opening a new connection, currently in state init
19:18:10.485272 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
19:18:11.770117 [debug] [ThreadPool]: SQL status: SELECT in 1.29 seconds
19:18:11.778267 [debug] [ThreadPool]: On list_dev: Close
19:18:11.786475 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev_public"
19:18:11.809221 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
19:18:11.812812 [debug] [ThreadPool]: On list_dev_public: BEGIN
19:18:11.815883 [debug] [ThreadPool]: Opening a new connection, currently in state init
19:18:11.819344 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
19:18:13.117540 [debug] [ThreadPool]: SQL status: BEGIN in 1.3 seconds
19:18:13.121641 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
19:18:13.123536 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev_public"} */
select
      'dev' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dev' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
19:18:13.278937 [debug] [ThreadPool]: SQL status: SELECT in 0.15 seconds
19:18:13.284557 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
19:18:13.428033 [debug] [ThreadPool]: On list_dev_public: Close
19:18:13.440893 [debug] [MainThread]: Using redshift connection "master"
19:18:13.443559 [debug] [MainThread]: On master: BEGIN
19:18:13.446212 [debug] [MainThread]: Opening a new connection, currently in state init
19:18:13.448523 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
19:18:14.734474 [debug] [MainThread]: SQL status: BEGIN in 1.29 seconds
19:18:14.738200 [debug] [MainThread]: Using redshift connection "master"
19:18:14.740670 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
19:18:14.915014 [debug] [MainThread]: SQL status: SELECT in 0.17 seconds
19:18:14.920065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f3e5b86c-d58f-4bbe-9008-6ab527e0e442', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1c7cb5af0>]}
19:18:14.922979 [debug] [MainThread]: On master: ROLLBACK
19:18:15.064111 [debug] [MainThread]: Using redshift connection "master"
19:18:15.067087 [debug] [MainThread]: On master: BEGIN
19:18:15.350058 [debug] [MainThread]: SQL status: BEGIN in 0.28 seconds
19:18:15.353443 [debug] [MainThread]: On master: COMMIT
19:18:15.356262 [debug] [MainThread]: Using redshift connection "master"
19:18:15.358330 [debug] [MainThread]: On master: COMMIT
19:18:15.500199 [debug] [MainThread]: SQL status: COMMIT in 0.14 seconds
19:18:15.503271 [debug] [MainThread]: On master: Close
19:18:15.506578 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
19:18:15.509850 [info ] [MainThread]: 
19:18:15.530361 [debug] [Thread-1  ]: Began running node model.analytics_dbt.tb_10_compradores
19:18:15.539582 [info ] [Thread-1  ]: 1 of 1 START view model public.tb_10_compradores ............................... [RUN]
19:18:15.549878 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.tb_10_compradores"
19:18:15.561809 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.tb_10_compradores
19:18:15.565764 [debug] [Thread-1  ]: Compiling model.analytics_dbt.tb_10_compradores
19:18:15.584400 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.tb_10_compradores"
19:18:15.606347 [debug] [Thread-1  ]: finished collecting timing info
19:18:15.609912 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.tb_10_compradores
19:18:15.666382 [debug] [Thread-1  ]: Writing runtime SQL for node "model.analytics_dbt.tb_10_compradores"
19:18:15.678577 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_10_compradores"
19:18:15.683000 [debug] [Thread-1  ]: On model.analytics_dbt.tb_10_compradores: BEGIN
19:18:15.685590 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:18:15.688474 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
19:18:16.981005 [debug] [Thread-1  ]: SQL status: BEGIN in 1.3 seconds
19:18:16.985089 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_10_compradores"
19:18:16.987585 [debug] [Thread-1  ]: On model.analytics_dbt.tb_10_compradores: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.tb_10_compradores"} */


  create view "dev"."public"."tb_10_compradores__dbt_tmp" as (
    with sales as (

    select * from "dev"."public"."vw_sales"

)

compradores as (

    SELECT
        (firstname ||' '|| lastname) as Nome_Completo,
        userid
    FROM users
)

top_10_compradores as (

    SELECT
        compradores.Nome_Completo as Nome_Completo,
        sum(sales.quantidade_vendida) as Vendas_totais,
        sales.comisão as Comissão
    FROM sales INNER JOIN compradores
    ON sales.id_comprador = compradores.userid
    GROUP BY compradores.userid
    ORDER BY Vendas_totais DESC
    LIMIT 10

)

select * from top_10_compradores
  ) ;

19:18:17.132321 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near "compradores"
LINE 11: compradores as (
         ^

19:18:17.135585 [debug] [Thread-1  ]: On model.analytics_dbt.tb_10_compradores: ROLLBACK
19:18:17.279511 [debug] [Thread-1  ]: finished collecting timing info
19:18:17.282832 [debug] [Thread-1  ]: On model.analytics_dbt.tb_10_compradores: Close
19:18:17.285862 [debug] [Thread-1  ]: Database Error in model tb_10_compradores (models/tb_10_compradores.sql)
  syntax error at or near "compradores"
  LINE 11: compradores as (
           ^
  compiled SQL at target/run/analytics_dbt/models/tb_10_compradores.sql
19:18:17.288284 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f3e5b86c-d58f-4bbe-9008-6ab527e0e442', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1c6bce5e0>]}
19:18:17.291509 [error] [Thread-1  ]: 1 of 1 ERROR creating view model public.tb_10_compradores ...................... [[31mERROR[0m in 1.74s]
19:18:17.295006 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.tb_10_compradores
19:18:17.303492 [debug] [MainThread]: Acquiring new redshift connection "master"
19:18:17.306741 [debug] [MainThread]: Using redshift connection "master"
19:18:17.312583 [debug] [MainThread]: On master: BEGIN
19:18:17.315170 [debug] [MainThread]: Opening a new connection, currently in state closed
19:18:17.320176 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
19:18:18.622188 [debug] [MainThread]: SQL status: BEGIN in 1.31 seconds
19:18:18.625152 [debug] [MainThread]: On master: COMMIT
19:18:18.628576 [debug] [MainThread]: Using redshift connection "master"
19:18:18.631796 [debug] [MainThread]: On master: COMMIT
19:18:18.774218 [debug] [MainThread]: SQL status: COMMIT in 0.14 seconds
19:18:18.778651 [debug] [MainThread]: On master: Close
19:18:18.782578 [info ] [MainThread]: 
19:18:18.785120 [info ] [MainThread]: Finished running 1 view model in 8.37s.
19:18:18.790595 [debug] [MainThread]: Connection 'master' was properly closed.
19:18:18.796656 [debug] [MainThread]: Connection 'list_dev' was properly closed.
19:18:18.803989 [debug] [MainThread]: Connection 'model.analytics_dbt.tb_10_compradores' was properly closed.
19:18:18.844079 [info ] [MainThread]: 
19:18:18.848571 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
19:18:18.855185 [info ] [MainThread]: 
19:18:18.865825 [error] [MainThread]: [33mDatabase Error in model tb_10_compradores (models/tb_10_compradores.sql)[0m
19:18:18.875817 [error] [MainThread]:   syntax error at or near "compradores"
19:18:18.899133 [error] [MainThread]:   LINE 11: compradores as (
19:18:18.913266 [error] [MainThread]:            ^
19:18:18.929735 [error] [MainThread]:   compiled SQL at target/run/analytics_dbt/models/tb_10_compradores.sql
19:18:18.949227 [info ] [MainThread]: 
19:18:18.964347 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
19:18:18.980839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1c740e880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1c740eee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1c740eeb0>]}


============================== 2022-05-21 19:25:40.464420 | 370ea4d4-f4d5-4d50-95e6-92f87e060303 ==============================
19:25:40.464449 [info ] [MainThread]: Running with dbt=1.1.0
19:25:40.467656 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['models/views/vw_sales.sql'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
19:25:40.472688 [debug] [MainThread]: Tracking: tracking
19:25:40.497475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a4fd33820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a4fd338e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a4fd33910>]}
19:25:40.600864 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
19:25:40.605225 [debug] [MainThread]: Partial parsing: updated file: analytics_dbt://models/views/vw_sales.sql
19:25:40.635015 [debug] [MainThread]: 1699: static parser successfully parsed views/vw_sales.sql
19:25:40.703805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '370ea4d4-f4d5-4d50-95e6-92f87e060303', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a4fc11190>]}
19:25:40.741543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '370ea4d4-f4d5-4d50-95e6-92f87e060303', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a4fcba700>]}
19:25:40.746617 [info ] [MainThread]: Found 4 models, 4 tests, 0 snapshots, 0 analyses, 193 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
19:25:40.756009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '370ea4d4-f4d5-4d50-95e6-92f87e060303', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a4fc3cd60>]}
19:25:40.766073 [info ] [MainThread]: 
19:25:40.774055 [debug] [MainThread]: Acquiring new redshift connection "master"
19:25:40.780517 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev"
19:25:40.811051 [debug] [ThreadPool]: Using redshift connection "list_dev"
19:25:40.814897 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
  
19:25:40.819312 [debug] [ThreadPool]: Opening a new connection, currently in state init
19:25:40.822292 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
19:25:42.208379 [debug] [ThreadPool]: SQL status: SELECT in 1.39 seconds
19:25:42.216334 [debug] [ThreadPool]: On list_dev: Close
19:25:42.224175 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev_public"
19:25:42.242039 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
19:25:42.245259 [debug] [ThreadPool]: On list_dev_public: BEGIN
19:25:42.247741 [debug] [ThreadPool]: Opening a new connection, currently in state init
19:25:42.249989 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
19:25:43.547521 [debug] [ThreadPool]: SQL status: BEGIN in 1.3 seconds
19:25:43.550443 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
19:25:43.553397 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev_public"} */
select
      'dev' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dev' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
19:25:43.707139 [debug] [ThreadPool]: SQL status: SELECT in 0.15 seconds
19:25:43.713816 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
19:25:43.861532 [debug] [ThreadPool]: On list_dev_public: Close
19:25:43.881173 [debug] [MainThread]: Using redshift connection "master"
19:25:43.884270 [debug] [MainThread]: On master: BEGIN
19:25:43.887329 [debug] [MainThread]: Opening a new connection, currently in state init
19:25:43.890395 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
19:25:45.233168 [debug] [MainThread]: SQL status: BEGIN in 1.35 seconds
19:25:45.236811 [debug] [MainThread]: Using redshift connection "master"
19:25:45.239181 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
19:25:45.416669 [debug] [MainThread]: SQL status: SELECT in 0.18 seconds
19:25:45.426657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '370ea4d4-f4d5-4d50-95e6-92f87e060303', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a4fc7fc10>]}
19:25:45.431042 [debug] [MainThread]: On master: ROLLBACK
19:25:45.576338 [debug] [MainThread]: Using redshift connection "master"
19:25:45.580237 [debug] [MainThread]: On master: BEGIN
19:25:45.871027 [debug] [MainThread]: SQL status: BEGIN in 0.29 seconds
19:25:45.874859 [debug] [MainThread]: On master: COMMIT
19:25:45.877672 [debug] [MainThread]: Using redshift connection "master"
19:25:45.880043 [debug] [MainThread]: On master: COMMIT
19:25:46.024557 [debug] [MainThread]: SQL status: COMMIT in 0.14 seconds
19:25:46.027626 [debug] [MainThread]: On master: Close
19:25:46.031244 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
19:25:46.035438 [info ] [MainThread]: 
19:25:46.059765 [debug] [Thread-1  ]: Began running node model.analytics_dbt.vw_sales
19:25:46.066287 [info ] [Thread-1  ]: 1 of 1 START view model public.vw_sales ........................................ [RUN]
19:25:46.077499 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.vw_sales"
19:25:46.091593 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.vw_sales
19:25:46.095588 [debug] [Thread-1  ]: Compiling model.analytics_dbt.vw_sales
19:25:46.107448 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.vw_sales"
19:25:46.134287 [debug] [Thread-1  ]: finished collecting timing info
19:25:46.140075 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.vw_sales
19:25:46.205636 [debug] [Thread-1  ]: Writing runtime SQL for node "model.analytics_dbt.vw_sales"
19:25:46.214749 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
19:25:46.218748 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: BEGIN
19:25:46.222075 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:25:46.224836 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
19:25:47.527483 [debug] [Thread-1  ]: SQL status: BEGIN in 1.31 seconds
19:25:47.530439 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
19:25:47.532953 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */


  create view "dev"."public"."vw_sales__dbt_tmp" as (
    with source_sales as (
    select *
    from sales

),

renamed as (
    select
        SALESID AS ID_VENDA,
        LISTID AS ID_LISTA,
        SELLERID AS ID_VENDEDOR,
        BUYERID AS ID_COMPRADOR,
        EVENTID AS ID_EVENTO,
        DATEID AS ID_DATE,
        QTYSOLD AS QUANTIDADE_VENDIDA,
        PRICEPAID AS VALOR_PAGO,
        COMMISSION AS COMISSAO,
        TO_CHAR(saletime, 'dd/mm/yyyy HH24:MI:SS') AS DATA_HORA_VENDA,
        TO_CHAR(saletime, 'HH24:MI:SS') AS HORA_VENDA,
        cast(saletime as date) AS DATA_VENDA

  
    FROM source_sales

)

select * from renamed
  ) ;

19:25:47.683249 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.15 seconds
19:25:47.699726 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
19:25:47.702301 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */
alter table "dev"."public"."vw_sales" rename to "vw_sales__dbt_backup"
19:25:47.846833 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.14 seconds
19:25:47.853062 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
19:25:47.855544 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */
alter table "dev"."public"."vw_sales__dbt_tmp" rename to "vw_sales"
19:25:47.999922 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.14 seconds
19:25:48.020655 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: COMMIT
19:25:48.023916 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
19:25:48.026501 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: COMMIT
19:25:48.198430 [debug] [Thread-1  ]: SQL status: COMMIT in 0.17 seconds
19:25:48.202108 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
19:25:48.205097 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: BEGIN
19:25:48.349489 [debug] [Thread-1  ]: SQL status: BEGIN in 0.14 seconds
19:25:48.361354 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
19:25:48.364055 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */
drop view if exists "dev"."public"."vw_sales__dbt_backup" cascade
19:25:48.510064 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.14 seconds
19:25:48.515025 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: COMMIT
19:25:48.521597 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
19:25:48.524685 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: COMMIT
19:25:48.694167 [debug] [Thread-1  ]: SQL status: COMMIT in 0.17 seconds
19:25:48.697744 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
19:25:48.699980 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: BEGIN
19:25:48.845612 [debug] [Thread-1  ]: SQL status: BEGIN in 0.14 seconds
19:25:48.848937 [debug] [Thread-1  ]: finished collecting timing info
19:25:48.851457 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: ROLLBACK
19:25:48.995330 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: Close
19:25:49.000558 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '370ea4d4-f4d5-4d50-95e6-92f87e060303', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a4fd50b50>]}
19:25:49.003814 [info ] [Thread-1  ]: 1 of 1 OK created view model public.vw_sales ................................... [[32mCREATE VIEW[0m in 2.92s]
19:25:49.007596 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.vw_sales
19:25:49.015091 [debug] [MainThread]: Acquiring new redshift connection "master"
19:25:49.024360 [debug] [MainThread]: Using redshift connection "master"
19:25:49.029854 [debug] [MainThread]: On master: BEGIN
19:25:49.034694 [debug] [MainThread]: Opening a new connection, currently in state closed
19:25:49.040558 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
19:25:50.371495 [debug] [MainThread]: SQL status: BEGIN in 1.34 seconds
19:25:50.374627 [debug] [MainThread]: On master: COMMIT
19:25:50.376779 [debug] [MainThread]: Using redshift connection "master"
19:25:50.378923 [debug] [MainThread]: On master: COMMIT
19:25:50.522798 [debug] [MainThread]: SQL status: COMMIT in 0.14 seconds
19:25:50.526071 [debug] [MainThread]: On master: Close
19:25:50.529816 [info ] [MainThread]: 
19:25:50.533546 [info ] [MainThread]: Finished running 1 view model in 9.76s.
19:25:50.539149 [debug] [MainThread]: Connection 'master' was properly closed.
19:25:50.547016 [debug] [MainThread]: Connection 'list_dev' was properly closed.
19:25:50.553833 [debug] [MainThread]: Connection 'model.analytics_dbt.vw_sales' was properly closed.
19:25:50.599850 [info ] [MainThread]: 
19:25:50.603948 [info ] [MainThread]: [32mCompleted successfully[0m
19:25:50.610103 [info ] [MainThread]: 
19:25:50.619240 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
19:25:50.632771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a4fc7ffd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a4fcdebe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a4fc3cdf0>]}


============================== 2022-05-21 19:41:14.617471 | 38bd1029-a1f9-4070-b5e4-db03ef315860 ==============================
19:41:14.617503 [info ] [MainThread]: Running with dbt=1.1.0
19:41:14.622206 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
19:41:14.633034 [debug] [MainThread]: Tracking: tracking
19:41:14.664039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c65c5d730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c65c5d7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c65c5d7f0>]}
19:41:14.736287 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
19:41:14.744203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '38bd1029-a1f9-4070-b5e4-db03ef315860', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c65c77f70>]}
19:41:14.841000 [debug] [MainThread]: Parsing macros/adapters.sql
19:41:14.937505 [debug] [MainThread]: Parsing macros/relations.sql
19:41:14.954973 [debug] [MainThread]: Parsing macros/catalog.sql
19:41:14.998169 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
19:41:15.003494 [debug] [MainThread]: Parsing macros/adapters.sql
19:41:15.072597 [debug] [MainThread]: Parsing macros/relations.sql
19:41:15.078497 [debug] [MainThread]: Parsing macros/catalog.sql
19:41:15.087425 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
19:41:15.097550 [debug] [MainThread]: Parsing macros/adapters/columns.sql
19:41:15.127130 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
19:41:15.142282 [debug] [MainThread]: Parsing macros/adapters/relation.sql
19:41:15.172083 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
19:41:15.187267 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
19:41:15.200721 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
19:41:15.233073 [debug] [MainThread]: Parsing macros/adapters/schema.sql
19:41:15.240887 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
19:41:15.246430 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
19:41:15.260314 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
19:41:15.266576 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
19:41:15.273601 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
19:41:15.285334 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
19:41:15.298465 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
19:41:15.307744 [debug] [MainThread]: Parsing macros/etc/datetime.sql
19:41:15.337042 [debug] [MainThread]: Parsing macros/etc/statement.sql
19:41:15.354427 [debug] [MainThread]: Parsing macros/materializations/configs.sql
19:41:15.362592 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
19:41:15.376262 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
19:41:15.414279 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
19:41:15.460878 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
19:41:15.490399 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
19:41:15.497725 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
19:41:15.524929 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
19:41:15.539921 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
19:41:15.546936 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
19:41:15.592604 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
19:41:15.639392 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
19:41:15.666953 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
19:41:15.681395 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
19:41:15.692166 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
19:41:15.708635 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
19:41:15.719319 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
19:41:15.740563 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
19:41:15.758823 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
19:41:15.770757 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
19:41:15.781524 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
19:41:15.827573 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
19:41:15.844376 [debug] [MainThread]: Parsing tests/generic/builtin.sql
19:41:16.301192 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
19:41:16.328142 [debug] [MainThread]: 1699: static parser successfully parsed example/my_second_dbt_model.sql
19:41:16.336484 [debug] [MainThread]: 1699: static parser successfully parsed tables/tb_10_compradores.sql
19:41:16.344366 [debug] [MainThread]: 1699: static parser successfully parsed views/vw_sales.sql
19:41:16.495749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '38bd1029-a1f9-4070-b5e4-db03ef315860', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c6571db20>]}
19:41:16.524809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '38bd1029-a1f9-4070-b5e4-db03ef315860', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c65c77cd0>]}
19:41:16.527461 [info ] [MainThread]: Found 4 models, 4 tests, 0 snapshots, 0 analyses, 193 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
19:41:16.530615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '38bd1029-a1f9-4070-b5e4-db03ef315860', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c65c775b0>]}
19:41:16.546071 [info ] [MainThread]: 
19:41:16.563672 [debug] [MainThread]: Acquiring new redshift connection "master"
19:41:16.579765 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev"
19:41:16.623508 [debug] [ThreadPool]: Using redshift connection "list_dev"
19:41:16.625844 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
  
19:41:16.627985 [debug] [ThreadPool]: Opening a new connection, currently in state init
19:41:16.630375 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
19:41:17.981854 [debug] [ThreadPool]: SQL status: SELECT in 1.35 seconds
19:41:17.988688 [debug] [ThreadPool]: On list_dev: Close
19:41:17.995374 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev_public"
19:41:18.023306 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
19:41:18.026191 [debug] [ThreadPool]: On list_dev_public: BEGIN
19:41:18.029198 [debug] [ThreadPool]: Opening a new connection, currently in state init
19:41:18.032144 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
19:41:19.361157 [debug] [ThreadPool]: SQL status: BEGIN in 1.33 seconds
19:41:19.364230 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
19:41:19.367532 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev_public"} */
select
      'dev' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dev' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
19:41:19.530596 [debug] [ThreadPool]: SQL status: SELECT in 0.16 seconds
19:41:19.536336 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
19:41:19.683052 [debug] [ThreadPool]: On list_dev_public: Close
19:41:19.696623 [debug] [MainThread]: Using redshift connection "master"
19:41:19.699744 [debug] [MainThread]: On master: BEGIN
19:41:19.702270 [debug] [MainThread]: Opening a new connection, currently in state init
19:41:19.705049 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
19:41:21.000280 [debug] [MainThread]: SQL status: BEGIN in 1.3 seconds
19:41:21.004031 [debug] [MainThread]: Using redshift connection "master"
19:41:21.008020 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
19:41:21.182204 [debug] [MainThread]: SQL status: SELECT in 0.17 seconds
19:41:21.188845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '38bd1029-a1f9-4070-b5e4-db03ef315860', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c65b6ed60>]}
19:41:21.191969 [debug] [MainThread]: On master: ROLLBACK
19:41:21.334026 [debug] [MainThread]: Using redshift connection "master"
19:41:21.337928 [debug] [MainThread]: On master: BEGIN
19:41:21.642677 [debug] [MainThread]: SQL status: BEGIN in 0.3 seconds
19:41:21.646192 [debug] [MainThread]: On master: COMMIT
19:41:21.649386 [debug] [MainThread]: Using redshift connection "master"
19:41:21.651860 [debug] [MainThread]: On master: COMMIT
19:41:21.794684 [debug] [MainThread]: SQL status: COMMIT in 0.14 seconds
19:41:21.798456 [debug] [MainThread]: On master: Close
19:41:21.802056 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
19:41:21.806642 [info ] [MainThread]: 
19:41:21.826092 [debug] [Thread-1  ]: Began running node model.analytics_dbt.my_first_dbt_model
19:41:21.833707 [info ] [Thread-1  ]: 1 of 4 START table model public.my_first_dbt_model ............................. [RUN]
19:41:21.840559 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.my_first_dbt_model"
19:41:21.850816 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.my_first_dbt_model
19:41:21.863047 [debug] [Thread-1  ]: Compiling model.analytics_dbt.my_first_dbt_model
19:41:21.884876 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.my_first_dbt_model"
19:41:21.901110 [debug] [Thread-1  ]: finished collecting timing info
19:41:21.905921 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.my_first_dbt_model
19:41:21.997426 [debug] [Thread-1  ]: Writing runtime SQL for node "model.analytics_dbt.my_first_dbt_model"
19:41:22.006701 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
19:41:22.010280 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: BEGIN
19:41:22.013364 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:41:22.017023 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
19:41:23.266211 [debug] [Thread-1  ]: SQL status: BEGIN in 1.25 seconds
19:41:23.271918 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
19:41:23.276587 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */


  create  table
    "dev"."public"."my_first_dbt_model__dbt_tmp"
    
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
19:41:23.486461 [debug] [Thread-1  ]: SQL status: SELECT in 0.21 seconds
19:41:23.502885 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
19:41:23.505652 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
alter table "dev"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
19:41:23.646590 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.14 seconds
19:41:23.653841 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
19:41:23.656007 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
alter table "dev"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
19:41:23.797807 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.14 seconds
19:41:23.826844 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: COMMIT
19:41:23.829965 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
19:41:23.832776 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: COMMIT
19:41:24.010421 [debug] [Thread-1  ]: SQL status: COMMIT in 0.18 seconds
19:41:24.013993 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
19:41:24.016115 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: BEGIN
19:41:24.162881 [debug] [Thread-1  ]: SQL status: BEGIN in 0.14 seconds
19:41:24.183604 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
19:41:24.186745 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
drop table if exists "dev"."public"."my_first_dbt_model__dbt_backup" cascade
19:41:24.341699 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.15 seconds
19:41:24.348356 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: COMMIT
19:41:24.351452 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
19:41:24.355020 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: COMMIT
19:41:24.520672 [debug] [Thread-1  ]: SQL status: COMMIT in 0.16 seconds
19:41:24.524791 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
19:41:24.526909 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: BEGIN
19:41:24.673790 [debug] [Thread-1  ]: SQL status: BEGIN in 0.14 seconds
19:41:24.677099 [debug] [Thread-1  ]: finished collecting timing info
19:41:24.679876 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: ROLLBACK
19:41:24.820121 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: Close
19:41:24.825531 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38bd1029-a1f9-4070-b5e4-db03ef315860', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c65bc3a30>]}
19:41:24.828578 [info ] [Thread-1  ]: 1 of 4 OK created table model public.my_first_dbt_model ........................ [[32mSELECT[0m in 2.99s]
19:41:24.832816 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.my_first_dbt_model
19:41:24.837167 [debug] [Thread-1  ]: Began running node model.analytics_dbt.vw_sales
19:41:24.841882 [info ] [Thread-1  ]: 2 of 4 START view model public.vw_sales ........................................ [RUN]
19:41:24.849844 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.vw_sales"
19:41:24.854989 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.vw_sales
19:41:24.857784 [debug] [Thread-1  ]: Compiling model.analytics_dbt.vw_sales
19:41:24.876533 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.vw_sales"
19:41:24.888241 [debug] [Thread-1  ]: finished collecting timing info
19:41:24.890685 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.vw_sales
19:41:24.946709 [debug] [Thread-1  ]: Writing runtime SQL for node "model.analytics_dbt.vw_sales"
19:41:24.959249 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
19:41:24.967215 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: BEGIN
19:41:24.970002 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:41:24.973941 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
19:41:26.249750 [debug] [Thread-1  ]: SQL status: BEGIN in 1.28 seconds
19:41:26.253514 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
19:41:26.255503 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */


  create view "dev"."public"."vw_sales__dbt_tmp" as (
    with source_sales as (
    select *
    from sales

),

renamed as (
    select
        SALESID AS ID_VENDA,
        LISTID AS ID_LISTA,
        SELLERID AS ID_VENDEDOR,
        BUYERID AS ID_COMPRADOR,
        EVENTID AS ID_EVENTO,
        DATEID AS ID_DATE,
        QTYSOLD AS QUANTIDADE_VENDIDA,
        PRICEPAID AS VALOR_PAGO,
        COMMISSION AS COMISSAO,
        TO_CHAR(saletime, 'dd/mm/yyyy HH24:MI:SS') AS DATA_HORA_VENDA,
        TO_CHAR(saletime, 'HH24:MI:SS') AS HORA_VENDA,
        cast(saletime as date) AS DATA_VENDA

  
    FROM source_sales

)

select * from renamed
  ) ;

19:41:26.399976 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.14 seconds
19:41:26.408357 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
19:41:26.410675 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */
alter table "dev"."public"."vw_sales" rename to "vw_sales__dbt_backup"
19:41:26.551888 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.14 seconds
19:41:26.560069 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
19:41:26.563012 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */
alter table "dev"."public"."vw_sales__dbt_tmp" rename to "vw_sales"
19:41:26.709810 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.14 seconds
19:41:26.716524 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: COMMIT
19:41:26.718887 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
19:41:26.721426 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: COMMIT
19:41:26.884622 [debug] [Thread-1  ]: SQL status: COMMIT in 0.16 seconds
19:41:26.889580 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
19:41:26.892359 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: BEGIN
19:41:27.033326 [debug] [Thread-1  ]: SQL status: BEGIN in 0.14 seconds
19:41:27.038242 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
19:41:27.040418 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */
drop view if exists "dev"."public"."vw_sales__dbt_backup" cascade
19:41:27.183298 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.14 seconds
19:41:27.187754 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: COMMIT
19:41:27.189660 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
19:41:27.191623 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: COMMIT
19:41:27.355415 [debug] [Thread-1  ]: SQL status: COMMIT in 0.16 seconds
19:41:27.357601 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
19:41:27.360359 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: BEGIN
19:41:27.501079 [debug] [Thread-1  ]: SQL status: BEGIN in 0.14 seconds
19:41:27.504580 [debug] [Thread-1  ]: finished collecting timing info
19:41:27.506914 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: ROLLBACK
19:41:27.646494 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: Close
19:41:27.650954 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38bd1029-a1f9-4070-b5e4-db03ef315860', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c65bc3a30>]}
19:41:27.654549 [info ] [Thread-1  ]: 2 of 4 OK created view model public.vw_sales ................................... [[32mCREATE VIEW[0m in 2.80s]
19:41:27.657820 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.vw_sales
19:41:27.663241 [debug] [Thread-1  ]: Began running node model.analytics_dbt.my_second_dbt_model
19:41:27.671897 [info ] [Thread-1  ]: 3 of 4 START view model public.my_second_dbt_model ............................. [RUN]
19:41:27.675536 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.my_second_dbt_model"
19:41:27.678939 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.my_second_dbt_model
19:41:27.683869 [debug] [Thread-1  ]: Compiling model.analytics_dbt.my_second_dbt_model
19:41:27.693586 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.my_second_dbt_model"
19:41:27.711414 [debug] [Thread-1  ]: finished collecting timing info
19:41:27.716576 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.my_second_dbt_model
19:41:27.728956 [debug] [Thread-1  ]: Writing runtime SQL for node "model.analytics_dbt.my_second_dbt_model"
19:41:27.742836 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
19:41:27.745846 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: BEGIN
19:41:27.748596 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:41:27.751228 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
19:41:29.044349 [debug] [Thread-1  ]: SQL status: BEGIN in 1.3 seconds
19:41:29.047938 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
19:41:29.050292 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */


  create view "dev"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."public"."my_first_dbt_model"
where id = 1
  ) ;

19:41:29.197512 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.14 seconds
19:41:29.207545 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
19:41:29.210200 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */
alter table "dev"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
19:41:29.353986 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.14 seconds
19:41:29.359911 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: COMMIT
19:41:29.362566 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
19:41:29.366133 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: COMMIT
19:41:29.534532 [debug] [Thread-1  ]: SQL status: COMMIT in 0.17 seconds
19:41:29.538282 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
19:41:29.541077 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: BEGIN
19:41:29.684848 [debug] [Thread-1  ]: SQL status: BEGIN in 0.14 seconds
19:41:29.690689 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
19:41:29.693273 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */
drop view if exists "dev"."public"."my_second_dbt_model__dbt_backup" cascade
19:41:29.836802 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.14 seconds
19:41:29.840851 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: COMMIT
19:41:29.843347 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
19:41:29.845528 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: COMMIT
19:41:30.008438 [debug] [Thread-1  ]: SQL status: COMMIT in 0.16 seconds
19:41:30.011464 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
19:41:30.013689 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: BEGIN
19:41:30.159171 [debug] [Thread-1  ]: SQL status: BEGIN in 0.14 seconds
19:41:30.162831 [debug] [Thread-1  ]: finished collecting timing info
19:41:30.165903 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: ROLLBACK
19:41:30.309451 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: Close
19:41:30.313631 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38bd1029-a1f9-4070-b5e4-db03ef315860', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c6465cfd0>]}
19:41:30.317457 [info ] [Thread-1  ]: 3 of 4 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 2.64s]
19:41:30.321370 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.my_second_dbt_model
19:41:30.324734 [debug] [Thread-1  ]: Began running node model.analytics_dbt.tb_10_compradores
19:41:30.329084 [info ] [Thread-1  ]: 4 of 4 START table model public.tb_10_compradores .............................. [RUN]
19:41:30.337690 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.tb_10_compradores"
19:41:30.343765 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.tb_10_compradores
19:41:30.346355 [debug] [Thread-1  ]: Compiling model.analytics_dbt.tb_10_compradores
19:41:30.359575 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.tb_10_compradores"
19:41:30.381967 [debug] [Thread-1  ]: finished collecting timing info
19:41:30.386384 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.tb_10_compradores
19:41:30.400024 [debug] [Thread-1  ]: Writing runtime SQL for node "model.analytics_dbt.tb_10_compradores"
19:41:30.417001 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_10_compradores"
19:41:30.419817 [debug] [Thread-1  ]: On model.analytics_dbt.tb_10_compradores: BEGIN
19:41:30.424236 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:41:30.426861 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
19:41:31.696875 [debug] [Thread-1  ]: SQL status: BEGIN in 1.27 seconds
19:41:31.699916 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_10_compradores"
19:41:31.702756 [debug] [Thread-1  ]: On model.analytics_dbt.tb_10_compradores: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.tb_10_compradores"} */


  create  table
    "dev"."public"."tb_10_compradores__dbt_tmp"
    
    
    
  as (
    with sales as (

    select * from "dev"."public"."vw_sales"

)

compradores as (

    SELECT
        (firstname ||' '|| lastname) as Nome_Completo,
        userid
    FROM users
)

top_10_compradores as (

    SELECT
        compradores.Nome_Completo as Nome_Completo,
        sum(sales.quantidade_vendida) as Vendas_totais,
        sales.comisão as Comissão
    FROM sales INNER JOIN compradores
    ON sales.id_comprador = compradores.userid
    GROUP BY compradores.userid
    ORDER BY Vendas_totais DESC
    LIMIT 10

)

select * from top_10_compradores
  );
19:41:31.846318 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near "compradores"
LINE 16: compradores as (
         ^

19:41:31.850323 [debug] [Thread-1  ]: On model.analytics_dbt.tb_10_compradores: ROLLBACK
19:41:31.991011 [debug] [Thread-1  ]: finished collecting timing info
19:41:31.994017 [debug] [Thread-1  ]: On model.analytics_dbt.tb_10_compradores: Close
19:41:31.997861 [debug] [Thread-1  ]: Database Error in model tb_10_compradores (models/tables/tb_10_compradores.sql)
  syntax error at or near "compradores"
  LINE 16: compradores as (
           ^
  compiled SQL at target/run/analytics_dbt/models/tables/tb_10_compradores.sql
19:41:32.001154 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38bd1029-a1f9-4070-b5e4-db03ef315860', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c645fae50>]}
19:41:32.004916 [error] [Thread-1  ]: 4 of 4 ERROR creating table model public.tb_10_compradores ..................... [[31mERROR[0m in 1.67s]
19:41:32.008474 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.tb_10_compradores
19:41:32.017204 [debug] [MainThread]: Acquiring new redshift connection "master"
19:41:32.021897 [debug] [MainThread]: Using redshift connection "master"
19:41:32.025531 [debug] [MainThread]: On master: BEGIN
19:41:32.029354 [debug] [MainThread]: Opening a new connection, currently in state closed
19:41:32.032327 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
19:41:33.317241 [debug] [MainThread]: SQL status: BEGIN in 1.29 seconds
19:41:33.322226 [debug] [MainThread]: On master: COMMIT
19:41:33.330677 [debug] [MainThread]: Using redshift connection "master"
19:41:33.336476 [debug] [MainThread]: On master: COMMIT
19:41:33.485182 [debug] [MainThread]: SQL status: COMMIT in 0.14 seconds
19:41:33.488215 [debug] [MainThread]: On master: Close
19:41:33.493751 [info ] [MainThread]: 
19:41:33.496785 [info ] [MainThread]: Finished running 2 table models, 2 view models in 16.93s.
19:41:33.501647 [debug] [MainThread]: Connection 'master' was properly closed.
19:41:33.509919 [debug] [MainThread]: Connection 'list_dev' was properly closed.
19:41:33.516653 [debug] [MainThread]: Connection 'model.analytics_dbt.tb_10_compradores' was properly closed.
19:41:33.561757 [info ] [MainThread]: 
19:41:33.566383 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
19:41:33.585606 [info ] [MainThread]: 
19:41:33.591506 [error] [MainThread]: [33mDatabase Error in model tb_10_compradores (models/tables/tb_10_compradores.sql)[0m
19:41:33.600307 [error] [MainThread]:   syntax error at or near "compradores"
19:41:33.608786 [error] [MainThread]:   LINE 16: compradores as (
19:41:33.616576 [error] [MainThread]:            ^
19:41:33.626190 [error] [MainThread]:   compiled SQL at target/run/analytics_dbt/models/tables/tb_10_compradores.sql
19:41:33.646698 [info ] [MainThread]: 
19:41:33.654009 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
19:41:33.699041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c6467b0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c65b6e790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c656d1d90>]}


============================== 2022-05-21 19:43:23.577235 | f0dc31ba-2bcd-48e1-a373-c23f95f324d4 ==============================
19:43:23.577261 [info ] [MainThread]: Running with dbt=1.1.0
19:43:23.584206 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['models/tables/tb_10_compradores.sql'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
19:43:23.588841 [debug] [MainThread]: Tracking: tracking
19:43:23.644067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4983079820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49830798e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4983079910>]}
19:43:23.775034 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
19:43:23.778286 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
19:43:23.799473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f0dc31ba-2bcd-48e1-a373-c23f95f324d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4982fa6100>]}
19:43:23.831108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f0dc31ba-2bcd-48e1-a373-c23f95f324d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f498305ef70>]}
19:43:23.836232 [info ] [MainThread]: Found 4 models, 4 tests, 0 snapshots, 0 analyses, 193 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
19:43:23.839987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f0dc31ba-2bcd-48e1-a373-c23f95f324d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4982fa4ee0>]}
19:43:23.874600 [info ] [MainThread]: 
19:43:23.882375 [debug] [MainThread]: Acquiring new redshift connection "master"
19:43:23.892878 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev"
19:43:23.973026 [debug] [ThreadPool]: Using redshift connection "list_dev"
19:43:23.977170 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
  
19:43:23.980810 [debug] [ThreadPool]: Opening a new connection, currently in state init
19:43:23.984182 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
19:43:25.331928 [debug] [ThreadPool]: SQL status: SELECT in 1.35 seconds
19:43:25.381401 [debug] [ThreadPool]: On list_dev: Close
19:43:25.387008 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev_public"
19:43:25.405458 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
19:43:25.408661 [debug] [ThreadPool]: On list_dev_public: BEGIN
19:43:25.411687 [debug] [ThreadPool]: Opening a new connection, currently in state closed
19:43:25.415000 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
19:43:26.709644 [debug] [ThreadPool]: SQL status: BEGIN in 1.3 seconds
19:43:26.712779 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
19:43:26.715652 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev_public"} */
select
      'dev' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dev' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
19:43:26.865803 [debug] [ThreadPool]: SQL status: SELECT in 0.15 seconds
19:43:26.872063 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
19:43:27.011693 [debug] [ThreadPool]: On list_dev_public: Close
19:43:27.025864 [debug] [MainThread]: Using redshift connection "master"
19:43:27.028846 [debug] [MainThread]: On master: BEGIN
19:43:27.031413 [debug] [MainThread]: Opening a new connection, currently in state init
19:43:27.034374 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
19:43:28.355058 [debug] [MainThread]: SQL status: BEGIN in 1.32 seconds
19:43:28.358668 [debug] [MainThread]: Using redshift connection "master"
19:43:28.361782 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
19:43:28.537786 [debug] [MainThread]: SQL status: SELECT in 0.17 seconds
19:43:28.543148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f0dc31ba-2bcd-48e1-a373-c23f95f324d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4983096a00>]}
19:43:28.545956 [debug] [MainThread]: On master: ROLLBACK
19:43:28.690473 [debug] [MainThread]: Using redshift connection "master"
19:43:28.694381 [debug] [MainThread]: On master: BEGIN
19:43:28.979923 [debug] [MainThread]: SQL status: BEGIN in 0.28 seconds
19:43:28.984535 [debug] [MainThread]: On master: COMMIT
19:43:28.987804 [debug] [MainThread]: Using redshift connection "master"
19:43:28.991389 [debug] [MainThread]: On master: COMMIT
19:43:29.136593 [debug] [MainThread]: SQL status: COMMIT in 0.14 seconds
19:43:29.139250 [debug] [MainThread]: On master: Close
19:43:29.143684 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
19:43:29.146822 [info ] [MainThread]: 
19:43:29.166802 [debug] [Thread-1  ]: Began running node model.analytics_dbt.tb_10_compradores
19:43:29.176858 [info ] [Thread-1  ]: 1 of 1 START table model public.tb_10_compradores .............................. [RUN]
19:43:29.183367 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.tb_10_compradores"
19:43:29.197826 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.tb_10_compradores
19:43:29.210089 [debug] [Thread-1  ]: Compiling model.analytics_dbt.tb_10_compradores
19:43:29.235035 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.tb_10_compradores"
19:43:29.263722 [debug] [Thread-1  ]: finished collecting timing info
19:43:29.272434 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.tb_10_compradores
19:43:29.365289 [debug] [Thread-1  ]: Writing runtime SQL for node "model.analytics_dbt.tb_10_compradores"
19:43:29.375968 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_10_compradores"
19:43:29.380302 [debug] [Thread-1  ]: On model.analytics_dbt.tb_10_compradores: BEGIN
19:43:29.383949 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:43:29.387654 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
19:43:30.682779 [debug] [Thread-1  ]: SQL status: BEGIN in 1.3 seconds
19:43:30.685703 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_10_compradores"
19:43:30.688906 [debug] [Thread-1  ]: On model.analytics_dbt.tb_10_compradores: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.tb_10_compradores"} */


  create  table
    "dev"."public"."tb_10_compradores__dbt_tmp"
    
    
    
  as (
    with sales as (

    select * from "dev"."public"."vw_sales"

)

compradores as (

    SELECT
        (firstname ||' '|| lastname) as Nome_Completo,
        userid
    FROM users
)

top_10_compradores as (

    SELECT
        compradores.Nome_Completo as Nome_Completo,
        sum(sales.quantidade_vendida) as Vendas_totais,
        sales.comisão as Comissão
    FROM sales INNER JOIN compradores
    ON sales.id_comprador = compradores.userid
    GROUP BY compradores.userid
    ORDER BY Vendas_totais DESC
    LIMIT 10

)

select * from top_10_compradores
  );
19:43:30.833290 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near "compradores"
LINE 16: compradores as (
         ^

19:43:30.836965 [debug] [Thread-1  ]: On model.analytics_dbt.tb_10_compradores: ROLLBACK
19:43:30.980312 [debug] [Thread-1  ]: finished collecting timing info
19:43:30.983362 [debug] [Thread-1  ]: On model.analytics_dbt.tb_10_compradores: Close
19:43:30.986896 [debug] [Thread-1  ]: Database Error in model tb_10_compradores (models/tables/tb_10_compradores.sql)
  syntax error at or near "compradores"
  LINE 16: compradores as (
           ^
  compiled SQL at target/run/analytics_dbt/models/tables/tb_10_compradores.sql
19:43:30.989956 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f0dc31ba-2bcd-48e1-a373-c23f95f324d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4982715130>]}
19:43:30.993659 [error] [Thread-1  ]: 1 of 1 ERROR creating table model public.tb_10_compradores ..................... [[31mERROR[0m in 1.81s]
19:43:30.997704 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.tb_10_compradores
19:43:31.004908 [debug] [MainThread]: Acquiring new redshift connection "master"
19:43:31.013344 [debug] [MainThread]: Using redshift connection "master"
19:43:31.022835 [debug] [MainThread]: On master: BEGIN
19:43:31.027852 [debug] [MainThread]: Opening a new connection, currently in state closed
19:43:31.032613 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
19:43:32.343169 [debug] [MainThread]: SQL status: BEGIN in 1.32 seconds
19:43:32.346072 [debug] [MainThread]: On master: COMMIT
19:43:32.348188 [debug] [MainThread]: Using redshift connection "master"
19:43:32.350336 [debug] [MainThread]: On master: COMMIT
19:43:32.494278 [debug] [MainThread]: SQL status: COMMIT in 0.14 seconds
19:43:32.497402 [debug] [MainThread]: On master: Close
19:43:32.500893 [info ] [MainThread]: 
19:43:32.504729 [info ] [MainThread]: Finished running 1 table model in 8.62s.
19:43:32.508868 [debug] [MainThread]: Connection 'master' was properly closed.
19:43:32.516054 [debug] [MainThread]: Connection 'model.analytics_dbt.tb_10_compradores' was properly closed.
19:43:32.572246 [info ] [MainThread]: 
19:43:32.579045 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
19:43:32.587551 [info ] [MainThread]: 
19:43:32.601198 [error] [MainThread]: [33mDatabase Error in model tb_10_compradores (models/tables/tb_10_compradores.sql)[0m
19:43:32.605972 [error] [MainThread]:   syntax error at or near "compradores"
19:43:32.616984 [error] [MainThread]:   LINE 16: compradores as (
19:43:32.627352 [error] [MainThread]:            ^
19:43:32.638297 [error] [MainThread]:   compiled SQL at target/run/analytics_dbt/models/tables/tb_10_compradores.sql
19:43:32.655068 [info ] [MainThread]: 
19:43:32.664601 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
19:43:32.673641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49830440a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f498271e220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f498271e670>]}


============================== 2022-05-21 19:46:31.013941 | caa711b1-e93d-4e61-a764-a6ea9a8f280d ==============================
19:46:31.013972 [info ] [MainThread]: Running with dbt=1.1.0
19:46:31.018479 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['models/tables/tb_10_compradores.sql'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
19:46:31.023909 [debug] [MainThread]: Tracking: tracking
19:46:31.070779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5c2a464c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5c2a46490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5c2a46550>]}
19:46:31.210447 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
19:46:31.213960 [debug] [MainThread]: Partial parsing: updated file: analytics_dbt://models/tables/tb_10_compradores.sql
19:46:31.244712 [debug] [MainThread]: 1699: static parser successfully parsed tables/tb_10_compradores.sql
19:46:31.303421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'caa711b1-e93d-4e61-a764-a6ea9a8f280d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5c2932190>]}
19:46:31.354331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'caa711b1-e93d-4e61-a764-a6ea9a8f280d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5c2a3cd60>]}
19:46:31.359961 [info ] [MainThread]: Found 4 models, 4 tests, 0 snapshots, 0 analyses, 193 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
19:46:31.364964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'caa711b1-e93d-4e61-a764-a6ea9a8f280d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5c2922f70>]}
19:46:31.391103 [info ] [MainThread]: 
19:46:31.399199 [debug] [MainThread]: Acquiring new redshift connection "master"
19:46:31.424157 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev"
19:46:31.489717 [debug] [ThreadPool]: Using redshift connection "list_dev"
19:46:31.492699 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
  
19:46:31.495256 [debug] [ThreadPool]: Opening a new connection, currently in state init
19:46:31.497987 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
19:46:32.804227 [debug] [ThreadPool]: SQL status: SELECT in 1.31 seconds
19:46:32.812257 [debug] [ThreadPool]: On list_dev: Close
19:46:32.821753 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev_public"
19:46:32.844066 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
19:46:32.846442 [debug] [ThreadPool]: On list_dev_public: BEGIN
19:46:32.848450 [debug] [ThreadPool]: Opening a new connection, currently in state init
19:46:32.851324 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
19:46:34.144610 [debug] [ThreadPool]: SQL status: BEGIN in 1.3 seconds
19:46:34.148218 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
19:46:34.150754 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev_public"} */
select
      'dev' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dev' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
19:46:34.302764 [debug] [ThreadPool]: SQL status: SELECT in 0.15 seconds
19:46:34.308405 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
19:46:34.450928 [debug] [ThreadPool]: On list_dev_public: Close
19:46:34.463627 [debug] [MainThread]: Using redshift connection "master"
19:46:34.465924 [debug] [MainThread]: On master: BEGIN
19:46:34.468321 [debug] [MainThread]: Opening a new connection, currently in state init
19:46:34.470571 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
19:46:35.788277 [debug] [MainThread]: SQL status: BEGIN in 1.32 seconds
19:46:35.791892 [debug] [MainThread]: Using redshift connection "master"
19:46:35.794470 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
19:46:35.973777 [debug] [MainThread]: SQL status: SELECT in 0.18 seconds
19:46:35.979464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'caa711b1-e93d-4e61-a764-a6ea9a8f280d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5c2a3c220>]}
19:46:35.981779 [debug] [MainThread]: On master: ROLLBACK
19:46:36.124978 [debug] [MainThread]: Using redshift connection "master"
19:46:36.128732 [debug] [MainThread]: On master: BEGIN
19:46:36.414799 [debug] [MainThread]: SQL status: BEGIN in 0.28 seconds
19:46:36.417264 [debug] [MainThread]: On master: COMMIT
19:46:36.419499 [debug] [MainThread]: Using redshift connection "master"
19:46:36.421297 [debug] [MainThread]: On master: COMMIT
19:46:36.565597 [debug] [MainThread]: SQL status: COMMIT in 0.14 seconds
19:46:36.567706 [debug] [MainThread]: On master: Close
19:46:36.570920 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
19:46:36.573601 [info ] [MainThread]: 
19:46:36.593255 [debug] [Thread-1  ]: Began running node model.analytics_dbt.tb_10_compradores
19:46:36.605767 [info ] [Thread-1  ]: 1 of 1 START table model public.tb_10_compradores .............................. [RUN]
19:46:36.615361 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.tb_10_compradores"
19:46:36.626412 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.tb_10_compradores
19:46:36.635476 [debug] [Thread-1  ]: Compiling model.analytics_dbt.tb_10_compradores
19:46:36.659274 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.tb_10_compradores"
19:46:36.674336 [debug] [Thread-1  ]: finished collecting timing info
19:46:36.681314 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.tb_10_compradores
19:46:36.779027 [debug] [Thread-1  ]: Writing runtime SQL for node "model.analytics_dbt.tb_10_compradores"
19:46:36.787478 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_10_compradores"
19:46:36.790705 [debug] [Thread-1  ]: On model.analytics_dbt.tb_10_compradores: BEGIN
19:46:36.793868 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:46:36.797760 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
19:46:38.092888 [debug] [Thread-1  ]: SQL status: BEGIN in 1.3 seconds
19:46:38.097486 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_10_compradores"
19:46:38.100226 [debug] [Thread-1  ]: On model.analytics_dbt.tb_10_compradores: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.tb_10_compradores"} */


  create  table
    "dev"."public"."tb_10_compradores__dbt_tmp"
    
    
    
  as (
    with sales as (

    select * from "dev"."public"."vw_sales"

),
compradores as (

    SELECT
        (firstname ||' '|| lastname) as Nome_Completo, userid
    FROM users
),

top_10_compradores as (

    SELECT
        compradores.Nome_Completo as Nome_Completo,
        sum(sales.quantidade_vendida) as Vendas_totais,
        sales.comissao as Comissao
    FROM sales INNER JOIN compradores
    ON sales.id_comprador = compradores.userid
    GROUP BY compradores.userid, compradores.Nome_Completo, sales.comissao
    ORDER BY Vendas_totais DESC
    LIMIT 10

)

select * from top_10_compradores
  );
19:46:45.453349 [debug] [Thread-1  ]: SQL status: SELECT in 7.35 seconds
19:46:45.471424 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_10_compradores"
19:46:45.473883 [debug] [Thread-1  ]: On model.analytics_dbt.tb_10_compradores: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.tb_10_compradores"} */
alter table "dev"."public"."tb_10_compradores__dbt_tmp" rename to "tb_10_compradores"
19:46:45.622920 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.15 seconds
19:46:45.652435 [debug] [Thread-1  ]: On model.analytics_dbt.tb_10_compradores: COMMIT
19:46:45.654900 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_10_compradores"
19:46:45.657913 [debug] [Thread-1  ]: On model.analytics_dbt.tb_10_compradores: COMMIT
19:46:45.837447 [debug] [Thread-1  ]: SQL status: COMMIT in 0.18 seconds
19:46:45.841875 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_10_compradores"
19:46:45.844649 [debug] [Thread-1  ]: On model.analytics_dbt.tb_10_compradores: BEGIN
19:46:46.002100 [debug] [Thread-1  ]: SQL status: BEGIN in 0.15 seconds
19:46:46.014232 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_10_compradores"
19:46:46.016836 [debug] [Thread-1  ]: On model.analytics_dbt.tb_10_compradores: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.tb_10_compradores"} */
drop table if exists "dev"."public"."tb_10_compradores__dbt_backup" cascade
19:46:46.160026 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.14 seconds
19:46:46.165442 [debug] [Thread-1  ]: On model.analytics_dbt.tb_10_compradores: COMMIT
19:46:46.168131 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_10_compradores"
19:46:46.170199 [debug] [Thread-1  ]: On model.analytics_dbt.tb_10_compradores: COMMIT
19:46:46.316272 [debug] [Thread-1  ]: SQL status: COMMIT in 0.14 seconds
19:46:46.320811 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_10_compradores"
19:46:46.323237 [debug] [Thread-1  ]: On model.analytics_dbt.tb_10_compradores: BEGIN
19:46:46.464892 [debug] [Thread-1  ]: SQL status: BEGIN in 0.14 seconds
19:46:46.468882 [debug] [Thread-1  ]: finished collecting timing info
19:46:46.471720 [debug] [Thread-1  ]: On model.analytics_dbt.tb_10_compradores: ROLLBACK
19:46:46.614523 [debug] [Thread-1  ]: On model.analytics_dbt.tb_10_compradores: Close
19:46:46.620242 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'caa711b1-e93d-4e61-a764-a6ea9a8f280d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5c2a62790>]}
19:46:46.622681 [info ] [Thread-1  ]: 1 of 1 OK created table model public.tb_10_compradores ......................... [[32mSELECT[0m in 10.01s]
19:46:46.626172 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.tb_10_compradores
19:46:46.632682 [debug] [MainThread]: Acquiring new redshift connection "master"
19:46:46.638244 [debug] [MainThread]: Using redshift connection "master"
19:46:46.642167 [debug] [MainThread]: On master: BEGIN
19:46:46.649784 [debug] [MainThread]: Opening a new connection, currently in state closed
19:46:46.656349 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
19:46:48.134571 [debug] [MainThread]: SQL status: BEGIN in 1.48 seconds
19:46:48.138835 [debug] [MainThread]: On master: COMMIT
19:46:48.143874 [debug] [MainThread]: Using redshift connection "master"
19:46:48.146967 [debug] [MainThread]: On master: COMMIT
19:46:48.288183 [debug] [MainThread]: SQL status: COMMIT in 0.14 seconds
19:46:48.290526 [debug] [MainThread]: On master: Close
19:46:48.293240 [info ] [MainThread]: 
19:46:48.295487 [info ] [MainThread]: Finished running 1 table model in 16.90s.
19:46:48.298883 [debug] [MainThread]: Connection 'master' was properly closed.
19:46:48.303434 [debug] [MainThread]: Connection 'list_dev' was properly closed.
19:46:48.307025 [debug] [MainThread]: Connection 'model.analytics_dbt.tb_10_compradores' was properly closed.
19:46:48.393172 [info ] [MainThread]: 
19:46:48.395796 [info ] [MainThread]: [32mCompleted successfully[0m
19:46:48.405436 [info ] [MainThread]: 
19:46:48.410199 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
19:46:48.416660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5c03febe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5c2a3cd00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5c29ef8b0>]}


============================== 2022-05-22 14:50:05.136620 | a1f213a7-8635-4649-a10b-d4c4726aa64c ==============================
14:50:05.136711 [info ] [MainThread]: Running with dbt=1.1.0
14:50:05.148122 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['models/tables/tb_vendas_primeiro_trimestre.sql'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
14:50:05.182932 [debug] [MainThread]: Tracking: tracking
14:50:05.241679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2f27447c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2f2744880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2f27448b0>]}
14:50:05.488107 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
14:50:05.491691 [debug] [MainThread]: Partial parsing: added file: analytics_dbt://models/tables/tb_vendas_primeiro_trimestre.sql
14:50:05.541882 [debug] [MainThread]: 1603: static parser failed on tables/tb_vendas_primeiro_trimestre.sql
14:50:05.585783 [debug] [MainThread]: 1602: parser fallback to jinja rendering on tables/tb_vendas_primeiro_trimestre.sql
14:50:05.652714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a1f213a7-8635-4649-a10b-d4c4726aa64c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2f25f1730>]}
14:50:05.711852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a1f213a7-8635-4649-a10b-d4c4726aa64c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2f268fd60>]}
14:50:05.721595 [info ] [MainThread]: Found 5 models, 4 tests, 0 snapshots, 0 analyses, 193 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
14:50:05.732981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a1f213a7-8635-4649-a10b-d4c4726aa64c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2f268ffd0>]}
14:50:05.761488 [info ] [MainThread]: 
14:50:05.774761 [debug] [MainThread]: Acquiring new redshift connection "master"
14:50:05.784402 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev"
14:50:05.846872 [debug] [ThreadPool]: Using redshift connection "list_dev"
14:50:05.849937 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
  
14:50:05.855616 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:50:05.858499 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
14:50:07.299234 [debug] [ThreadPool]: SQL status: SELECT in 1.44 seconds
14:50:07.313305 [debug] [ThreadPool]: On list_dev: Close
14:50:07.324144 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev_public"
14:50:07.346532 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
14:50:07.351920 [debug] [ThreadPool]: On list_dev_public: BEGIN
14:50:07.356772 [debug] [ThreadPool]: Opening a new connection, currently in state closed
14:50:07.360251 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
14:50:08.715064 [debug] [ThreadPool]: SQL status: BEGIN in 1.36 seconds
14:50:08.717448 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
14:50:08.719948 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev_public"} */
select
      'dev' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dev' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
14:50:08.873672 [debug] [ThreadPool]: SQL status: SELECT in 0.15 seconds
14:50:08.880736 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
14:50:09.023912 [debug] [ThreadPool]: On list_dev_public: Close
14:50:09.050581 [debug] [MainThread]: Using redshift connection "master"
14:50:09.053482 [debug] [MainThread]: On master: BEGIN
14:50:09.056661 [debug] [MainThread]: Opening a new connection, currently in state init
14:50:09.062141 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
14:50:10.398825 [debug] [MainThread]: SQL status: BEGIN in 1.34 seconds
14:50:10.403807 [debug] [MainThread]: Using redshift connection "master"
14:50:10.409345 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
14:50:10.589103 [debug] [MainThread]: SQL status: SELECT in 0.17 seconds
14:50:10.603203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a1f213a7-8635-4649-a10b-d4c4726aa64c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2f267dd00>]}
14:50:10.608798 [debug] [MainThread]: On master: ROLLBACK
14:50:10.754463 [debug] [MainThread]: Using redshift connection "master"
14:50:10.758544 [debug] [MainThread]: On master: BEGIN
14:50:11.045592 [debug] [MainThread]: SQL status: BEGIN in 0.28 seconds
14:50:11.052902 [debug] [MainThread]: On master: COMMIT
14:50:11.057564 [debug] [MainThread]: Using redshift connection "master"
14:50:11.061843 [debug] [MainThread]: On master: COMMIT
14:50:11.217125 [debug] [MainThread]: SQL status: COMMIT in 0.14 seconds
14:50:11.223408 [debug] [MainThread]: On master: Close
14:50:11.227508 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
14:50:11.231912 [info ] [MainThread]: 
14:50:11.254831 [debug] [Thread-1  ]: Began running node model.analytics_dbt.tb_vendas_primeiro_trimestre
14:50:11.276110 [info ] [Thread-1  ]: 1 of 1 START table model public.tb_vendas_primeiro_trimestre ................... [RUN]
14:50:11.295037 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.tb_vendas_primeiro_trimestre"
14:50:11.301754 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.tb_vendas_primeiro_trimestre
14:50:11.313243 [debug] [Thread-1  ]: Compiling model.analytics_dbt.tb_vendas_primeiro_trimestre
14:50:11.347500 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.tb_vendas_primeiro_trimestre"
14:50:11.379799 [debug] [Thread-1  ]: finished collecting timing info
14:50:11.393041 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.tb_vendas_primeiro_trimestre
14:50:11.499623 [debug] [Thread-1  ]: Writing runtime SQL for node "model.analytics_dbt.tb_vendas_primeiro_trimestre"
14:50:11.527152 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_vendas_primeiro_trimestre"
14:50:11.538338 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: BEGIN
14:50:11.542998 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:50:11.547711 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
14:50:12.890965 [debug] [Thread-1  ]: SQL status: BEGIN in 1.35 seconds
14:50:12.897831 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_vendas_primeiro_trimestre"
14:50:12.900444 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.tb_vendas_primeiro_trimestre"} */


  create  table
    "dev"."public"."tb_vendas_primeiro_trimestre__dbt_tmp"
    
    
    
  as (
    -- define o as variáveis meses e ano



-- cria a fonte com os dados de date e converte o  nome das colunas
with source_date as (

    select  dateid as id_date,
            month as mes,
            year as ano
    from date

),
-- cria uma fonte de dados unindo a tabela sales com date
sales_date (

    select  source_date.mes, 
            sum(quantidade_vendida)
    from  "dev"."public"."vw_sales" sales inner join source_date
    on sales.id_date = source_date.id_date
    GROUP BY source_date.mes,
             source_date.ano
    and source_date.mes in ('['JAN', 'FEB', 'MAR']')
    and source_date.ano = ('2008')

)

final (

    select * from sales_date
)
  );
14:50:13.050327 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near "select"
LINE 26:     select  source_date.mes, 
             ^

14:50:13.053469 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: ROLLBACK
14:50:13.220588 [debug] [Thread-1  ]: finished collecting timing info
14:50:13.225778 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: Close
14:50:13.233585 [debug] [Thread-1  ]: Database Error in model tb_vendas_primeiro_trimestre (models/tables/tb_vendas_primeiro_trimestre.sql)
  syntax error at or near "select"
  LINE 26:     select  source_date.mes, 
               ^
  compiled SQL at target/run/analytics_dbt/models/tables/tb_vendas_primeiro_trimestre.sql
14:50:13.240893 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a1f213a7-8635-4649-a10b-d4c4726aa64c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2f055e790>]}
14:50:13.244543 [error] [Thread-1  ]: 1 of 1 ERROR creating table model public.tb_vendas_primeiro_trimestre .......... [[31mERROR[0m in 1.95s]
14:50:13.248860 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.tb_vendas_primeiro_trimestre
14:50:13.256099 [debug] [MainThread]: Acquiring new redshift connection "master"
14:50:13.261455 [debug] [MainThread]: Using redshift connection "master"
14:50:13.268504 [debug] [MainThread]: On master: BEGIN
14:50:13.275164 [debug] [MainThread]: Opening a new connection, currently in state closed
14:50:13.279239 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
14:50:14.656924 [debug] [MainThread]: SQL status: BEGIN in 1.38 seconds
14:50:14.664803 [debug] [MainThread]: On master: COMMIT
14:50:14.669433 [debug] [MainThread]: Using redshift connection "master"
14:50:14.673143 [debug] [MainThread]: On master: COMMIT
14:50:14.822439 [debug] [MainThread]: SQL status: COMMIT in 0.14 seconds
14:50:14.825761 [debug] [MainThread]: On master: Close
14:50:14.830435 [info ] [MainThread]: 
14:50:14.833944 [info ] [MainThread]: Finished running 1 table model in 9.06s.
14:50:14.868995 [debug] [MainThread]: Connection 'master' was properly closed.
14:50:14.886284 [debug] [MainThread]: Connection 'model.analytics_dbt.tb_vendas_primeiro_trimestre' was properly closed.
14:50:14.948133 [info ] [MainThread]: 
14:50:14.952603 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
14:50:14.970238 [info ] [MainThread]: 
14:50:15.085531 [error] [MainThread]: [33mDatabase Error in model tb_vendas_primeiro_trimestre (models/tables/tb_vendas_primeiro_trimestre.sql)[0m
14:50:15.096884 [error] [MainThread]:   syntax error at or near "select"
14:50:15.108992 [error] [MainThread]:   LINE 26:     select  source_date.mes, 
14:50:15.120167 [error] [MainThread]:                ^
14:50:15.132185 [error] [MainThread]:   compiled SQL at target/run/analytics_dbt/models/tables/tb_vendas_primeiro_trimestre.sql
14:50:15.145564 [info ] [MainThread]: 
14:50:15.162690 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
14:50:15.181724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2f1d98520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2f1d9f5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2f1da0a60>]}


============================== 2022-05-22 14:51:27.085394 | 35bd8617-13e6-4a29-8220-0ea23677cdd6 ==============================
14:51:27.085445 [info ] [MainThread]: Running with dbt=1.1.0
14:51:27.096871 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['models/tables/tb_vendas_primeiro_trimestre.sql'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
14:51:27.117012 [debug] [MainThread]: Tracking: tracking
14:51:27.160638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33209556d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3320955790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33209557c0>]}
14:51:27.332827 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
14:51:27.336120 [debug] [MainThread]: Partial parsing: updated file: analytics_dbt://models/tables/tb_vendas_primeiro_trimestre.sql
14:51:27.367914 [debug] [MainThread]: 1603: static parser failed on tables/tb_vendas_primeiro_trimestre.sql
14:51:27.429484 [debug] [MainThread]: 1602: parser fallback to jinja rendering on tables/tb_vendas_primeiro_trimestre.sql
14:51:27.478270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '35bd8617-13e6-4a29-8220-0ea23677cdd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33208009a0>]}
14:51:27.526744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '35bd8617-13e6-4a29-8220-0ea23677cdd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f332089eee0>]}
14:51:27.531255 [info ] [MainThread]: Found 5 models, 4 tests, 0 snapshots, 0 analyses, 193 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
14:51:27.535318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '35bd8617-13e6-4a29-8220-0ea23677cdd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33208df9a0>]}
14:51:27.547871 [info ] [MainThread]: 
14:51:27.561057 [debug] [MainThread]: Acquiring new redshift connection "master"
14:51:27.570240 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev"
14:51:27.633522 [debug] [ThreadPool]: Using redshift connection "list_dev"
14:51:27.639970 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
  
14:51:27.645255 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:51:27.649530 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
14:51:28.959982 [debug] [ThreadPool]: SQL status: SELECT in 1.31 seconds
14:51:28.968936 [debug] [ThreadPool]: On list_dev: Close
14:51:28.978680 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev_public"
14:51:29.002161 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
14:51:29.006117 [debug] [ThreadPool]: On list_dev_public: BEGIN
14:51:29.010130 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:51:29.015906 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
14:51:30.324802 [debug] [ThreadPool]: SQL status: BEGIN in 1.31 seconds
14:51:30.328031 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
14:51:30.330907 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev_public"} */
select
      'dev' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dev' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
14:51:30.481933 [debug] [ThreadPool]: SQL status: SELECT in 0.15 seconds
14:51:30.488800 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
14:51:30.632030 [debug] [ThreadPool]: On list_dev_public: Close
14:51:30.646509 [debug] [MainThread]: Using redshift connection "master"
14:51:30.648731 [debug] [MainThread]: On master: BEGIN
14:51:30.651021 [debug] [MainThread]: Opening a new connection, currently in state init
14:51:30.653863 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
14:51:31.976823 [debug] [MainThread]: SQL status: BEGIN in 1.33 seconds
14:51:31.984030 [debug] [MainThread]: Using redshift connection "master"
14:51:31.988035 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
14:51:32.168064 [debug] [MainThread]: SQL status: SELECT in 0.18 seconds
14:51:32.174944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '35bd8617-13e6-4a29-8220-0ea23677cdd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3320969a60>]}
14:51:32.179635 [debug] [MainThread]: On master: ROLLBACK
14:51:32.346938 [debug] [MainThread]: Using redshift connection "master"
14:51:32.354128 [debug] [MainThread]: On master: BEGIN
14:51:32.652983 [debug] [MainThread]: SQL status: BEGIN in 0.29 seconds
14:51:32.661131 [debug] [MainThread]: On master: COMMIT
14:51:32.666299 [debug] [MainThread]: Using redshift connection "master"
14:51:32.668948 [debug] [MainThread]: On master: COMMIT
14:51:32.814146 [debug] [MainThread]: SQL status: COMMIT in 0.14 seconds
14:51:32.820119 [debug] [MainThread]: On master: Close
14:51:32.824027 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
14:51:32.827857 [info ] [MainThread]: 
14:51:32.855415 [debug] [Thread-1  ]: Began running node model.analytics_dbt.tb_vendas_primeiro_trimestre
14:51:32.864432 [info ] [Thread-1  ]: 1 of 1 START table model public.tb_vendas_primeiro_trimestre ................... [RUN]
14:51:32.872869 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.tb_vendas_primeiro_trimestre"
14:51:32.881462 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.tb_vendas_primeiro_trimestre
14:51:32.885117 [debug] [Thread-1  ]: Compiling model.analytics_dbt.tb_vendas_primeiro_trimestre
14:51:32.912625 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.tb_vendas_primeiro_trimestre"
14:51:32.926797 [debug] [Thread-1  ]: finished collecting timing info
14:51:32.931388 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.tb_vendas_primeiro_trimestre
14:51:33.059248 [debug] [Thread-1  ]: Writing runtime SQL for node "model.analytics_dbt.tb_vendas_primeiro_trimestre"
14:51:33.410716 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_vendas_primeiro_trimestre"
14:51:33.416661 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: BEGIN
14:51:33.420937 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:51:33.430906 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
14:51:34.769560 [debug] [Thread-1  ]: SQL status: BEGIN in 1.35 seconds
14:51:34.776715 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_vendas_primeiro_trimestre"
14:51:34.784086 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.tb_vendas_primeiro_trimestre"} */


  create  table
    "dev"."public"."tb_vendas_primeiro_trimestre__dbt_tmp"
    
    
    
  as (
    -- define o as variáveis meses e ano



-- cria a fonte com os dados de date e converte o  nome das colunas
with source_date as (
    select  dateid as id_date,
            month as mes,
            year as ano
    from date

),
-- cria uma fonte de dados unindo a tabela sales com date
sales_date (

    select  source_date.mes, 
            sum(quantidade_vendida)
    from  "dev"."public"."vw_sales" sales inner join source_date
    on sales.id_date = source_date.id_date
    GROUP BY source_date.mes,
             source_date.ano
    and source_date.mes in ('['JAN', 'FEB', 'MAR']')
    and source_date.ano = ('2008')

)

final (

    select * from sales_date
)
  );
14:51:34.939344 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near "select"
LINE 25:     select  source_date.mes, 
             ^

14:51:34.943752 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: ROLLBACK
14:51:35.095420 [debug] [Thread-1  ]: finished collecting timing info
14:51:35.099073 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: Close
14:51:35.109157 [debug] [Thread-1  ]: Database Error in model tb_vendas_primeiro_trimestre (models/tables/tb_vendas_primeiro_trimestre.sql)
  syntax error at or near "select"
  LINE 25:     select  source_date.mes, 
               ^
  compiled SQL at target/run/analytics_dbt/models/tables/tb_vendas_primeiro_trimestre.sql
14:51:35.124857 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '35bd8617-13e6-4a29-8220-0ea23677cdd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f331e76b790>]}
14:51:35.131300 [error] [Thread-1  ]: 1 of 1 ERROR creating table model public.tb_vendas_primeiro_trimestre .......... [[31mERROR[0m in 2.25s]
14:51:35.136857 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.tb_vendas_primeiro_trimestre
14:51:35.144852 [debug] [MainThread]: Acquiring new redshift connection "master"
14:51:35.150595 [debug] [MainThread]: Using redshift connection "master"
14:51:35.155049 [debug] [MainThread]: On master: BEGIN
14:51:35.158319 [debug] [MainThread]: Opening a new connection, currently in state closed
14:51:35.163153 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
14:51:36.522220 [debug] [MainThread]: SQL status: BEGIN in 1.36 seconds
14:51:36.525625 [debug] [MainThread]: On master: COMMIT
14:51:36.529451 [debug] [MainThread]: Using redshift connection "master"
14:51:36.534650 [debug] [MainThread]: On master: COMMIT
14:51:36.685894 [debug] [MainThread]: SQL status: COMMIT in 0.14 seconds
14:51:36.696704 [debug] [MainThread]: On master: Close
14:51:36.703531 [info ] [MainThread]: 
14:51:36.709269 [info ] [MainThread]: Finished running 1 table model in 9.14s.
14:51:36.714919 [debug] [MainThread]: Connection 'master' was properly closed.
14:51:36.724128 [debug] [MainThread]: Connection 'list_dev' was properly closed.
14:51:36.734307 [debug] [MainThread]: Connection 'model.analytics_dbt.tb_vendas_primeiro_trimestre' was properly closed.
14:51:36.800574 [info ] [MainThread]: 
14:51:36.807382 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
14:51:36.818112 [info ] [MainThread]: 
14:51:36.834130 [error] [MainThread]: [33mDatabase Error in model tb_vendas_primeiro_trimestre (models/tables/tb_vendas_primeiro_trimestre.sql)[0m
14:51:36.853043 [error] [MainThread]:   syntax error at or near "select"
14:51:36.862267 [error] [MainThread]:   LINE 25:     select  source_date.mes, 
14:51:36.876968 [error] [MainThread]:                ^
14:51:36.889856 [error] [MainThread]:   compiled SQL at target/run/analytics_dbt/models/tables/tb_vendas_primeiro_trimestre.sql
14:51:36.900277 [info ] [MainThread]: 
14:51:36.912162 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
14:51:36.926529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33209783d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3320978310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33207aa5e0>]}


============================== 2022-05-22 14:52:59.825618 | 0abd9e4e-3e31-4536-97ed-8e35a4735423 ==============================
14:52:59.825640 [info ] [MainThread]: Running with dbt=1.1.0
14:52:59.832838 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['models/tables/tb_vendas_primeiro_trimestre.sql'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
14:52:59.838445 [debug] [MainThread]: Tracking: tracking
14:52:59.869327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0984d0760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0984d0820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0984d0850>]}
14:52:59.979576 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
14:52:59.985055 [debug] [MainThread]: Partial parsing: updated file: analytics_dbt://models/tables/tb_vendas_primeiro_trimestre.sql
14:53:00.018388 [debug] [MainThread]: 1603: static parser failed on tables/tb_vendas_primeiro_trimestre.sql
14:53:00.053891 [debug] [MainThread]: 1602: parser fallback to jinja rendering on tables/tb_vendas_primeiro_trimestre.sql
14:53:00.086638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0abd9e4e-3e31-4536-97ed-8e35a4735423', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb09837b9d0>]}
14:53:00.118080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0abd9e4e-3e31-4536-97ed-8e35a4735423', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb098418ee0>]}
14:53:00.121735 [info ] [MainThread]: Found 5 models, 4 tests, 0 snapshots, 0 analyses, 193 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
14:53:00.125635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0abd9e4e-3e31-4536-97ed-8e35a4735423', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0984ed340>]}
14:53:00.139784 [info ] [MainThread]: 
14:53:00.145410 [debug] [MainThread]: Acquiring new redshift connection "master"
14:53:00.150382 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev"
14:53:00.179374 [debug] [ThreadPool]: Using redshift connection "list_dev"
14:53:00.182358 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
  
14:53:00.185096 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:53:00.188566 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
14:53:01.543877 [debug] [ThreadPool]: SQL status: SELECT in 1.36 seconds
14:53:01.552384 [debug] [ThreadPool]: On list_dev: Close
14:53:01.557487 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev_public"
14:53:01.574493 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
14:53:01.577078 [debug] [ThreadPool]: On list_dev_public: BEGIN
14:53:01.578945 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:53:01.581196 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
14:53:02.881900 [debug] [ThreadPool]: SQL status: BEGIN in 1.3 seconds
14:53:02.887346 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
14:53:02.890382 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev_public"} */
select
      'dev' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dev' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
14:53:03.051343 [debug] [ThreadPool]: SQL status: SELECT in 0.16 seconds
14:53:03.057167 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
14:53:03.199153 [debug] [ThreadPool]: On list_dev_public: Close
14:53:03.215953 [debug] [MainThread]: Using redshift connection "master"
14:53:03.218248 [debug] [MainThread]: On master: BEGIN
14:53:03.220527 [debug] [MainThread]: Opening a new connection, currently in state init
14:53:03.222969 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
14:53:04.534515 [debug] [MainThread]: SQL status: BEGIN in 1.31 seconds
14:53:04.539385 [debug] [MainThread]: Using redshift connection "master"
14:53:04.541657 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
14:53:04.722330 [debug] [MainThread]: SQL status: SELECT in 0.18 seconds
14:53:04.727468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0abd9e4e-3e31-4536-97ed-8e35a4735423', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0984e4f70>]}
14:53:04.729730 [debug] [MainThread]: On master: ROLLBACK
14:53:04.873579 [debug] [MainThread]: Using redshift connection "master"
14:53:04.877297 [debug] [MainThread]: On master: BEGIN
14:53:05.168808 [debug] [MainThread]: SQL status: BEGIN in 0.29 seconds
14:53:05.172479 [debug] [MainThread]: On master: COMMIT
14:53:05.174353 [debug] [MainThread]: Using redshift connection "master"
14:53:05.176840 [debug] [MainThread]: On master: COMMIT
14:53:05.322290 [debug] [MainThread]: SQL status: COMMIT in 0.14 seconds
14:53:05.326028 [debug] [MainThread]: On master: Close
14:53:05.330348 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
14:53:05.332926 [info ] [MainThread]: 
14:53:05.347668 [debug] [Thread-1  ]: Began running node model.analytics_dbt.tb_vendas_primeiro_trimestre
14:53:05.351407 [info ] [Thread-1  ]: 1 of 1 START table model public.tb_vendas_primeiro_trimestre ................... [RUN]
14:53:05.357654 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.tb_vendas_primeiro_trimestre"
14:53:05.363425 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.tb_vendas_primeiro_trimestre
14:53:05.366206 [debug] [Thread-1  ]: Compiling model.analytics_dbt.tb_vendas_primeiro_trimestre
14:53:05.380193 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.tb_vendas_primeiro_trimestre"
14:53:05.388141 [debug] [Thread-1  ]: finished collecting timing info
14:53:05.392426 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.tb_vendas_primeiro_trimestre
14:53:05.461918 [debug] [Thread-1  ]: Writing runtime SQL for node "model.analytics_dbt.tb_vendas_primeiro_trimestre"
14:53:05.469646 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_vendas_primeiro_trimestre"
14:53:05.472483 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: BEGIN
14:53:05.475043 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:53:05.477977 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
14:53:06.749566 [debug] [Thread-1  ]: SQL status: BEGIN in 1.27 seconds
14:53:06.752804 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_vendas_primeiro_trimestre"
14:53:06.759817 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.tb_vendas_primeiro_trimestre"} */


  create  table
    "dev"."public"."tb_vendas_primeiro_trimestre__dbt_tmp"
    
    
    
  as (
    -- define o as variáveis meses e ano



-- cria a fonte com os dados de date e converte o  nome das colunas
with source_date as (
    select  dateid as id_date,
            month as mes,
            year as ano
    from date

),
-- cria uma fonte de dados unindo a tabela sales com date
sales_date as (

    select  source_date.mes, 
            sum(quantidade_vendida)
    from  "dev"."public"."vw_sales" sales inner join source_date
    on sales.id_date = source_date.id_date
    GROUP BY source_date.mes,
             source_date.ano
    and source_date.mes in ('['JAN', 'FEB', 'MAR']')
    and source_date.ano = ('2008')

)

final (

    select * from sales_date
)
  );
14:53:06.904491 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near "JAN"
LINE 31:     and source_date.mes in ('['JAN', 'FEB', 'MAR']')
                                        ^

14:53:06.908660 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: ROLLBACK
14:53:07.048672 [debug] [Thread-1  ]: finished collecting timing info
14:53:07.052738 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: Close
14:53:07.056735 [debug] [Thread-1  ]: Database Error in model tb_vendas_primeiro_trimestre (models/tables/tb_vendas_primeiro_trimestre.sql)
  syntax error at or near "JAN"
  LINE 31:     and source_date.mes in ('['JAN', 'FEB', 'MAR']')
                                          ^
  compiled SQL at target/run/analytics_dbt/models/tables/tb_vendas_primeiro_trimestre.sql
14:53:07.059975 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0abd9e4e-3e31-4536-97ed-8e35a4735423', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0962e6820>]}
14:53:07.063171 [error] [Thread-1  ]: 1 of 1 ERROR creating table model public.tb_vendas_primeiro_trimestre .......... [[31mERROR[0m in 1.70s]
14:53:07.066210 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.tb_vendas_primeiro_trimestre
14:53:07.074659 [debug] [MainThread]: Acquiring new redshift connection "master"
14:53:07.079095 [debug] [MainThread]: Using redshift connection "master"
14:53:07.082396 [debug] [MainThread]: On master: BEGIN
14:53:07.084479 [debug] [MainThread]: Opening a new connection, currently in state closed
14:53:07.086442 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
14:53:08.376138 [debug] [MainThread]: SQL status: BEGIN in 1.29 seconds
14:53:08.378856 [debug] [MainThread]: On master: COMMIT
14:53:08.381381 [debug] [MainThread]: Using redshift connection "master"
14:53:08.384207 [debug] [MainThread]: On master: COMMIT
14:53:08.526402 [debug] [MainThread]: SQL status: COMMIT in 0.14 seconds
14:53:08.531388 [debug] [MainThread]: On master: Close
14:53:08.536188 [info ] [MainThread]: 
14:53:08.539162 [info ] [MainThread]: Finished running 1 table model in 8.39s.
14:53:08.545186 [debug] [MainThread]: Connection 'master' was properly closed.
14:53:08.551412 [debug] [MainThread]: Connection 'list_dev' was properly closed.
14:53:08.557203 [debug] [MainThread]: Connection 'model.analytics_dbt.tb_vendas_primeiro_trimestre' was properly closed.
14:53:08.589983 [info ] [MainThread]: 
14:53:08.595513 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
14:53:08.610552 [info ] [MainThread]: 
14:53:08.652045 [error] [MainThread]: [33mDatabase Error in model tb_vendas_primeiro_trimestre (models/tables/tb_vendas_primeiro_trimestre.sql)[0m
14:53:08.722014 [error] [MainThread]:   syntax error at or near "JAN"
14:53:08.733186 [error] [MainThread]:   LINE 31:     and source_date.mes in ('['JAN', 'FEB', 'MAR']')
14:53:08.740204 [error] [MainThread]:                                           ^
14:53:08.763824 [error] [MainThread]:   compiled SQL at target/run/analytics_dbt/models/tables/tb_vendas_primeiro_trimestre.sql
14:53:08.786034 [info ] [MainThread]: 
14:53:08.824374 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
14:53:08.840646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb098322a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0984ed2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb09830cbe0>]}


============================== 2022-05-22 14:53:49.507065 | fd51a5d6-5246-4cee-b5eb-3d2ae1c3b9cc ==============================
14:53:49.507229 [info ] [MainThread]: Running with dbt=1.1.0
14:53:49.510955 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'parse_only': False, 'which': 'compile', 'rpc_method': 'compile', 'indirect_selection': 'eager'}
14:53:49.517993 [debug] [MainThread]: Tracking: tracking
14:53:49.553565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86346d46d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86346d4760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86346d4790>]}
14:53:49.679726 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
14:53:49.683842 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
14:53:49.702273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fd51a5d6-5246-4cee-b5eb-3d2ae1c3b9cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86345fd640>]}
14:53:49.736767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fd51a5d6-5246-4cee-b5eb-3d2ae1c3b9cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8634606100>]}
14:53:49.740515 [info ] [MainThread]: Found 5 models, 4 tests, 0 snapshots, 0 analyses, 193 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
14:53:49.743944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fd51a5d6-5246-4cee-b5eb-3d2ae1c3b9cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8634606310>]}
14:53:49.762282 [info ] [MainThread]: 
14:53:49.768558 [debug] [MainThread]: Acquiring new redshift connection "master"
14:53:49.776916 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev_public"
14:53:49.819409 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
14:53:49.821762 [debug] [ThreadPool]: On list_dev_public: BEGIN
14:53:49.824706 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:53:49.826812 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
14:53:51.101487 [debug] [ThreadPool]: SQL status: BEGIN in 1.28 seconds
14:53:51.106198 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
14:53:51.109025 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev_public"} */
select
      'dev' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dev' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
14:53:51.258648 [debug] [ThreadPool]: SQL status: SELECT in 0.15 seconds
14:53:51.265680 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
14:53:51.412953 [debug] [ThreadPool]: On list_dev_public: Close
14:53:51.430734 [debug] [MainThread]: Using redshift connection "master"
14:53:51.433086 [debug] [MainThread]: On master: BEGIN
14:53:51.435702 [debug] [MainThread]: Opening a new connection, currently in state init
14:53:51.438832 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
14:53:52.716484 [debug] [MainThread]: SQL status: BEGIN in 1.28 seconds
14:53:52.720996 [debug] [MainThread]: Using redshift connection "master"
14:53:52.724542 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
14:53:52.898282 [debug] [MainThread]: SQL status: SELECT in 0.17 seconds
14:53:52.902832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fd51a5d6-5246-4cee-b5eb-3d2ae1c3b9cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86346ee970>]}
14:53:52.905201 [debug] [MainThread]: On master: ROLLBACK
14:53:53.045602 [debug] [MainThread]: On master: Close
14:53:53.051644 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
14:53:53.056434 [info ] [MainThread]: 
14:53:53.074413 [debug] [Thread-1  ]: Began running node model.analytics_dbt.my_first_dbt_model
14:53:53.078627 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.my_first_dbt_model"
14:53:53.083869 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.my_first_dbt_model
14:53:53.087933 [debug] [Thread-1  ]: Compiling model.analytics_dbt.my_first_dbt_model
14:53:53.101352 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.my_first_dbt_model"
14:53:53.116179 [debug] [Thread-1  ]: finished collecting timing info
14:53:53.119649 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.my_first_dbt_model
14:53:53.123459 [debug] [Thread-1  ]: finished collecting timing info
14:53:53.127428 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.my_first_dbt_model
14:53:53.130316 [debug] [Thread-1  ]: Began running node model.analytics_dbt.vw_sales
14:53:53.133971 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.vw_sales"
14:53:53.136816 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.vw_sales
14:53:53.140303 [debug] [Thread-1  ]: Compiling model.analytics_dbt.vw_sales
14:53:53.145143 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.vw_sales"
14:53:53.156076 [debug] [Thread-1  ]: finished collecting timing info
14:53:53.160186 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.vw_sales
14:53:53.163790 [debug] [Thread-1  ]: finished collecting timing info
14:53:53.167612 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.vw_sales
14:53:53.170824 [debug] [Thread-1  ]: Began running node model.analytics_dbt.my_second_dbt_model
14:53:53.176349 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.my_second_dbt_model"
14:53:53.178686 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.my_second_dbt_model
14:53:53.181046 [debug] [Thread-1  ]: Compiling model.analytics_dbt.my_second_dbt_model
14:53:53.189231 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.my_second_dbt_model"
14:53:53.198824 [debug] [Thread-1  ]: finished collecting timing info
14:53:53.202394 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.my_second_dbt_model
14:53:53.206157 [debug] [Thread-1  ]: finished collecting timing info
14:53:53.210058 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.my_second_dbt_model
14:53:53.212200 [debug] [Thread-1  ]: Began running node test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
14:53:53.215048 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
14:53:53.217199 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
14:53:53.219515 [debug] [Thread-1  ]: Compiling test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
14:53:53.247974 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
14:53:53.261598 [debug] [Thread-1  ]: finished collecting timing info
14:53:53.265001 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
14:53:53.267944 [debug] [Thread-1  ]: finished collecting timing info
14:53:53.271755 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
14:53:53.275442 [debug] [Thread-1  ]: Began running node test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
14:53:53.278334 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"
14:53:53.280561 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
14:53:53.283064 [debug] [Thread-1  ]: Compiling test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
14:53:53.298054 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"
14:53:53.309901 [debug] [Thread-1  ]: finished collecting timing info
14:53:53.314516 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
14:53:53.318023 [debug] [Thread-1  ]: finished collecting timing info
14:53:53.322845 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
14:53:53.326683 [debug] [Thread-1  ]: Began running node model.analytics_dbt.tb_10_compradores
14:53:53.331440 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.tb_10_compradores"
14:53:53.336811 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.tb_10_compradores
14:53:53.339450 [debug] [Thread-1  ]: Compiling model.analytics_dbt.tb_10_compradores
14:53:53.355006 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.tb_10_compradores"
14:53:53.367671 [debug] [Thread-1  ]: finished collecting timing info
14:53:53.371656 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.tb_10_compradores
14:53:53.375458 [debug] [Thread-1  ]: finished collecting timing info
14:53:53.380381 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.tb_10_compradores
14:53:53.389513 [debug] [Thread-1  ]: Began running node model.analytics_dbt.tb_vendas_primeiro_trimestre
14:53:53.394513 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.tb_vendas_primeiro_trimestre"
14:53:53.397592 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.tb_vendas_primeiro_trimestre
14:53:53.400085 [debug] [Thread-1  ]: Compiling model.analytics_dbt.tb_vendas_primeiro_trimestre
14:53:53.410719 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.tb_vendas_primeiro_trimestre"
14:53:53.421965 [debug] [Thread-1  ]: finished collecting timing info
14:53:53.425725 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.tb_vendas_primeiro_trimestre
14:53:53.429012 [debug] [Thread-1  ]: finished collecting timing info
14:53:53.432362 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.tb_vendas_primeiro_trimestre
14:53:53.435521 [debug] [Thread-1  ]: Began running node test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
14:53:53.441712 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"
14:53:53.447675 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
14:53:53.452052 [debug] [Thread-1  ]: Compiling test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
14:53:53.467056 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"
14:53:53.475817 [debug] [Thread-1  ]: finished collecting timing info
14:53:53.478384 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
14:53:53.480513 [debug] [Thread-1  ]: finished collecting timing info
14:53:53.483981 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
14:53:53.486435 [debug] [Thread-1  ]: Began running node test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
14:53:53.489595 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"
14:53:53.491577 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
14:53:53.494552 [debug] [Thread-1  ]: Compiling test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
14:53:53.506690 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"
14:53:53.516676 [debug] [Thread-1  ]: finished collecting timing info
14:53:53.519453 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
14:53:53.522232 [debug] [Thread-1  ]: finished collecting timing info
14:53:53.525620 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
14:53:53.531626 [debug] [MainThread]: Connection 'master' was properly closed.
14:53:53.535488 [debug] [MainThread]: Connection 'test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
14:53:53.564855 [info ] [MainThread]: Done.
14:53:53.569884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86346062e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86324db0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86324d4340>]}


============================== 2022-05-22 14:54:37.465541 | da359ebe-6684-4cfb-95ae-363af0024926 ==============================
14:54:37.465563 [info ] [MainThread]: Running with dbt=1.1.0
14:54:37.469354 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['models/tables/tb_vendas_primeiro_trimestre.sql'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
14:54:37.475559 [debug] [MainThread]: Tracking: tracking
14:54:37.504165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0042a98b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0042a9970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0042a99a0>]}
14:54:37.609822 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
14:54:37.612237 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
14:54:37.627298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'da359ebe-6684-4cfb-95ae-363af0024926', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0041d77f0>]}
14:54:37.660956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'da359ebe-6684-4cfb-95ae-363af0024926', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0041ea370>]}
14:54:37.664724 [info ] [MainThread]: Found 5 models, 4 tests, 0 snapshots, 0 analyses, 193 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
14:54:37.667776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'da359ebe-6684-4cfb-95ae-363af0024926', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0041ea310>]}
14:54:37.679836 [info ] [MainThread]: 
14:54:37.688913 [debug] [MainThread]: Acquiring new redshift connection "master"
14:54:37.693063 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev"
14:54:37.732841 [debug] [ThreadPool]: Using redshift connection "list_dev"
14:54:37.735430 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
  
14:54:37.737910 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:54:37.740956 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
14:54:39.059650 [debug] [ThreadPool]: SQL status: SELECT in 1.32 seconds
14:54:39.067512 [debug] [ThreadPool]: On list_dev: Close
14:54:39.073111 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev_public"
14:54:39.088898 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
14:54:39.090887 [debug] [ThreadPool]: On list_dev_public: BEGIN
14:54:39.093619 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:54:39.096146 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
14:54:40.399187 [debug] [ThreadPool]: SQL status: BEGIN in 1.31 seconds
14:54:40.402934 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
14:54:40.405328 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev_public"} */
select
      'dev' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dev' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
14:54:40.559760 [debug] [ThreadPool]: SQL status: SELECT in 0.15 seconds
14:54:40.564950 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
14:54:40.706435 [debug] [ThreadPool]: On list_dev_public: Close
14:54:40.723873 [debug] [MainThread]: Using redshift connection "master"
14:54:40.725868 [debug] [MainThread]: On master: BEGIN
14:54:40.728034 [debug] [MainThread]: Opening a new connection, currently in state init
14:54:40.730129 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
14:54:42.036745 [debug] [MainThread]: SQL status: BEGIN in 1.31 seconds
14:54:42.039835 [debug] [MainThread]: Using redshift connection "master"
14:54:42.042194 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
14:54:42.220984 [debug] [MainThread]: SQL status: SELECT in 0.18 seconds
14:54:42.233124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'da359ebe-6684-4cfb-95ae-363af0024926', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0042c4340>]}
14:54:42.237207 [debug] [MainThread]: On master: ROLLBACK
14:54:42.379423 [debug] [MainThread]: Using redshift connection "master"
14:54:42.385856 [debug] [MainThread]: On master: BEGIN
14:54:42.679850 [debug] [MainThread]: SQL status: BEGIN in 0.29 seconds
14:54:42.684321 [debug] [MainThread]: On master: COMMIT
14:54:42.687891 [debug] [MainThread]: Using redshift connection "master"
14:54:42.690045 [debug] [MainThread]: On master: COMMIT
14:54:42.831622 [debug] [MainThread]: SQL status: COMMIT in 0.14 seconds
14:54:42.836611 [debug] [MainThread]: On master: Close
14:54:42.839750 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
14:54:42.843015 [info ] [MainThread]: 
14:54:42.863104 [debug] [Thread-1  ]: Began running node model.analytics_dbt.tb_vendas_primeiro_trimestre
14:54:42.866274 [info ] [Thread-1  ]: 1 of 1 START table model public.tb_vendas_primeiro_trimestre ................... [RUN]
14:54:42.872525 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.tb_vendas_primeiro_trimestre"
14:54:42.879849 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.tb_vendas_primeiro_trimestre
14:54:42.884683 [debug] [Thread-1  ]: Compiling model.analytics_dbt.tb_vendas_primeiro_trimestre
14:54:42.900631 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.tb_vendas_primeiro_trimestre"
14:54:42.910582 [debug] [Thread-1  ]: finished collecting timing info
14:54:42.914184 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.tb_vendas_primeiro_trimestre
14:54:42.989989 [debug] [Thread-1  ]: Writing runtime SQL for node "model.analytics_dbt.tb_vendas_primeiro_trimestre"
14:54:43.003076 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_vendas_primeiro_trimestre"
14:54:43.006434 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: BEGIN
14:54:43.010089 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:54:43.012893 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
14:54:44.286401 [debug] [Thread-1  ]: SQL status: BEGIN in 1.28 seconds
14:54:44.293247 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_vendas_primeiro_trimestre"
14:54:44.297529 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.tb_vendas_primeiro_trimestre"} */


  create  table
    "dev"."public"."tb_vendas_primeiro_trimestre__dbt_tmp"
    
    
    
  as (
    -- define o as variáveis meses e ano



-- cria a fonte com os dados de date e converte o  nome das colunas
with source_date as (
    select  dateid as id_date,
            month as mes,
            year as ano
    from date

),
-- cria uma fonte de dados unindo a tabela sales com date
sales_date as (

    select  source_date.mes, 
            sum(quantidade_vendida)
    from  "dev"."public"."vw_sales" sales inner join source_date
    on sales.id_date = source_date.id_date
    GROUP BY source_date.mes,
             source_date.ano
    and source_date.mes in ('['JAN', 'FEB', 'MAR']')
    and source_date.ano = ('2008')

)

final (

    select * from sales_date
)
  );
14:54:44.441205 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near "JAN"
LINE 31:     and source_date.mes in ('['JAN', 'FEB', 'MAR']')
                                        ^

14:54:44.444608 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: ROLLBACK
14:54:44.587871 [debug] [Thread-1  ]: finished collecting timing info
14:54:44.591958 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: Close
14:54:44.597260 [debug] [Thread-1  ]: Database Error in model tb_vendas_primeiro_trimestre (models/tables/tb_vendas_primeiro_trimestre.sql)
  syntax error at or near "JAN"
  LINE 31:     and source_date.mes in ('['JAN', 'FEB', 'MAR']')
                                          ^
  compiled SQL at target/run/analytics_dbt/models/tables/tb_vendas_primeiro_trimestre.sql
14:54:44.601758 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da359ebe-6684-4cfb-95ae-363af0024926', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0030f1250>]}
14:54:44.605025 [error] [Thread-1  ]: 1 of 1 ERROR creating table model public.tb_vendas_primeiro_trimestre .......... [[31mERROR[0m in 1.73s]
14:54:44.608010 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.tb_vendas_primeiro_trimestre
14:54:44.615354 [debug] [MainThread]: Acquiring new redshift connection "master"
14:54:44.619049 [debug] [MainThread]: Using redshift connection "master"
14:54:44.622717 [debug] [MainThread]: On master: BEGIN
14:54:44.625723 [debug] [MainThread]: Opening a new connection, currently in state closed
14:54:44.628844 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
14:54:45.910895 [debug] [MainThread]: SQL status: BEGIN in 1.29 seconds
14:54:45.916326 [debug] [MainThread]: On master: COMMIT
14:54:45.920228 [debug] [MainThread]: Using redshift connection "master"
14:54:45.923372 [debug] [MainThread]: On master: COMMIT
14:54:46.067351 [debug] [MainThread]: SQL status: COMMIT in 0.14 seconds
14:54:46.071181 [debug] [MainThread]: On master: Close
14:54:46.074996 [info ] [MainThread]: 
14:54:46.078020 [info ] [MainThread]: Finished running 1 table model in 8.39s.
14:54:46.081784 [debug] [MainThread]: Connection 'master' was properly closed.
14:54:46.089627 [debug] [MainThread]: Connection 'list_dev' was properly closed.
14:54:46.092731 [debug] [MainThread]: Connection 'model.analytics_dbt.tb_vendas_primeiro_trimestre' was properly closed.
14:54:46.119913 [info ] [MainThread]: 
14:54:46.123642 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
14:54:46.129201 [info ] [MainThread]: 
14:54:46.135418 [error] [MainThread]: [33mDatabase Error in model tb_vendas_primeiro_trimestre (models/tables/tb_vendas_primeiro_trimestre.sql)[0m
14:54:46.141871 [error] [MainThread]:   syntax error at or near "JAN"
14:54:46.148431 [error] [MainThread]:   LINE 31:     and source_date.mes in ('['JAN', 'FEB', 'MAR']')
14:54:46.155772 [error] [MainThread]:                                           ^
14:54:46.161250 [error] [MainThread]:   compiled SQL at target/run/analytics_dbt/models/tables/tb_vendas_primeiro_trimestre.sql
14:54:46.170589 [info ] [MainThread]: 
14:54:46.180823 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
14:54:46.192433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0030e4160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0030e4220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0030e41c0>]}


============================== 2022-05-22 14:55:30.585751 | ad765529-012a-40da-9b04-804085baad37 ==============================
14:55:30.585772 [info ] [MainThread]: Running with dbt=1.1.0
14:55:30.589457 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['models/tables/tb_vendas_primeiro_trimestre.sql'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
14:55:30.596221 [debug] [MainThread]: Tracking: tracking
14:55:30.621488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3f0c76670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3f0c76730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3f0c76760>]}
14:55:30.796072 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
14:55:30.800232 [debug] [MainThread]: Partial parsing: updated file: analytics_dbt://models/tables/tb_vendas_primeiro_trimestre.sql
14:55:30.837998 [debug] [MainThread]: 1603: static parser failed on tables/tb_vendas_primeiro_trimestre.sql
14:55:30.876748 [debug] [MainThread]: 1602: parser fallback to jinja rendering on tables/tb_vendas_primeiro_trimestre.sql
14:55:30.909633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ad765529-012a-40da-9b04-804085baad37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3f0b1d940>]}
14:55:30.940285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ad765529-012a-40da-9b04-804085baad37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3f0bc0eb0>]}
14:55:30.944416 [info ] [MainThread]: Found 5 models, 4 tests, 0 snapshots, 0 analyses, 193 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
14:55:30.947429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ad765529-012a-40da-9b04-804085baad37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3f0c03d60>]}
14:55:30.959384 [info ] [MainThread]: 
14:55:30.967217 [debug] [MainThread]: Acquiring new redshift connection "master"
14:55:30.972059 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev"
14:55:31.026199 [debug] [ThreadPool]: Using redshift connection "list_dev"
14:55:31.029250 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
  
14:55:31.032773 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:55:31.036000 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
14:55:32.326874 [debug] [ThreadPool]: SQL status: SELECT in 1.29 seconds
14:55:32.334824 [debug] [ThreadPool]: On list_dev: Close
14:55:32.341231 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev_public"
14:55:32.356507 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
14:55:32.359029 [debug] [ThreadPool]: On list_dev_public: BEGIN
14:55:32.361764 [debug] [ThreadPool]: Opening a new connection, currently in state closed
14:55:32.364578 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
14:55:33.692636 [debug] [ThreadPool]: SQL status: BEGIN in 1.33 seconds
14:55:33.695600 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
14:55:33.698249 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev_public"} */
select
      'dev' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dev' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
14:55:33.847167 [debug] [ThreadPool]: SQL status: SELECT in 0.15 seconds
14:55:33.859040 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
14:55:34.010311 [debug] [ThreadPool]: On list_dev_public: Close
14:55:34.024044 [debug] [MainThread]: Using redshift connection "master"
14:55:34.026555 [debug] [MainThread]: On master: BEGIN
14:55:34.028889 [debug] [MainThread]: Opening a new connection, currently in state init
14:55:34.031142 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
14:55:35.639353 [debug] [MainThread]: SQL status: BEGIN in 1.61 seconds
14:55:35.643869 [debug] [MainThread]: Using redshift connection "master"
14:55:35.647210 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
14:55:35.820807 [debug] [MainThread]: SQL status: SELECT in 0.17 seconds
14:55:35.828703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ad765529-012a-40da-9b04-804085baad37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3f0bc0940>]}
14:55:35.832230 [debug] [MainThread]: On master: ROLLBACK
14:55:35.975399 [debug] [MainThread]: Using redshift connection "master"
14:55:35.978224 [debug] [MainThread]: On master: BEGIN
14:55:36.260017 [debug] [MainThread]: SQL status: BEGIN in 0.28 seconds
14:55:36.263272 [debug] [MainThread]: On master: COMMIT
14:55:36.266347 [debug] [MainThread]: Using redshift connection "master"
14:55:36.269729 [debug] [MainThread]: On master: COMMIT
14:55:36.411852 [debug] [MainThread]: SQL status: COMMIT in 0.14 seconds
14:55:36.415830 [debug] [MainThread]: On master: Close
14:55:36.419262 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
14:55:36.421622 [info ] [MainThread]: 
14:55:36.433433 [debug] [Thread-1  ]: Began running node model.analytics_dbt.tb_vendas_primeiro_trimestre
14:55:36.437883 [info ] [Thread-1  ]: 1 of 1 START table model public.tb_vendas_primeiro_trimestre ................... [RUN]
14:55:36.443626 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.tb_vendas_primeiro_trimestre"
14:55:36.448835 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.tb_vendas_primeiro_trimestre
14:55:36.476731 [debug] [Thread-1  ]: Compiling model.analytics_dbt.tb_vendas_primeiro_trimestre
14:55:36.486366 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.tb_vendas_primeiro_trimestre"
14:55:36.496176 [debug] [Thread-1  ]: finished collecting timing info
14:55:36.499645 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.tb_vendas_primeiro_trimestre
14:55:36.586849 [debug] [Thread-1  ]: Writing runtime SQL for node "model.analytics_dbt.tb_vendas_primeiro_trimestre"
14:55:36.598807 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_vendas_primeiro_trimestre"
14:55:36.603696 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: BEGIN
14:55:36.606203 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:55:36.608811 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
14:55:37.892765 [debug] [Thread-1  ]: SQL status: BEGIN in 1.29 seconds
14:55:37.900059 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_vendas_primeiro_trimestre"
14:55:37.903989 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.tb_vendas_primeiro_trimestre"} */


  create  table
    "dev"."public"."tb_vendas_primeiro_trimestre__dbt_tmp"
    
    
    
  as (
    -- define o as variáveis meses e ano



-- cria a fonte com os dados de date e converte o  nome das colunas
with source_date as (
    select  dateid as id_date,
            month as mes,
            year as ano
    from date

),
-- cria uma fonte de dados unindo a tabela sales com date
sales_date as (

    select  source_date.mes, 
            sum(quantidade_vendida)
    from  "dev"."public"."vw_sales" sales inner join source_date
    on sales.id_date = source_date.id_date
    GROUP BY source_date.mes,
             source_date.ano
    and source_date.mes in '['JAN', 'FEB', 'MAR']'
    and source_date.ano = ('2008')

)

final (

    select * from sales_date
)
  );
14:55:38.060197 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near "'['"
LINE 31:     and source_date.mes in '['JAN', 'FEB', 'MAR']'
                                    ^

14:55:38.066336 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: ROLLBACK
14:55:38.206938 [debug] [Thread-1  ]: finished collecting timing info
14:55:38.209988 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: Close
14:55:38.213260 [debug] [Thread-1  ]: Database Error in model tb_vendas_primeiro_trimestre (models/tables/tb_vendas_primeiro_trimestre.sql)
  syntax error at or near "'['"
  LINE 31:     and source_date.mes in '['JAN', 'FEB', 'MAR']'
                                      ^
  compiled SQL at target/run/analytics_dbt/models/tables/tb_vendas_primeiro_trimestre.sql
14:55:38.216373 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad765529-012a-40da-9b04-804085baad37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3f028fbb0>]}
14:55:38.218725 [error] [Thread-1  ]: 1 of 1 ERROR creating table model public.tb_vendas_primeiro_trimestre .......... [[31mERROR[0m in 1.77s]
14:55:38.221181 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.tb_vendas_primeiro_trimestre
14:55:38.228231 [debug] [MainThread]: Acquiring new redshift connection "master"
14:55:38.233847 [debug] [MainThread]: Using redshift connection "master"
14:55:38.237974 [debug] [MainThread]: On master: BEGIN
14:55:38.241981 [debug] [MainThread]: Opening a new connection, currently in state closed
14:55:38.246359 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
14:55:39.535907 [debug] [MainThread]: SQL status: BEGIN in 1.29 seconds
14:55:39.539148 [debug] [MainThread]: On master: COMMIT
14:55:39.542417 [debug] [MainThread]: Using redshift connection "master"
14:55:39.544819 [debug] [MainThread]: On master: COMMIT
14:55:39.689947 [debug] [MainThread]: SQL status: COMMIT in 0.14 seconds
14:55:39.693213 [debug] [MainThread]: On master: Close
14:55:39.696554 [info ] [MainThread]: 
14:55:39.698881 [info ] [MainThread]: Finished running 1 table model in 8.73s.
14:55:39.702619 [debug] [MainThread]: Connection 'master' was properly closed.
14:55:39.707936 [debug] [MainThread]: Connection 'model.analytics_dbt.tb_vendas_primeiro_trimestre' was properly closed.
14:55:39.745677 [info ] [MainThread]: 
14:55:39.749314 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
14:55:39.754817 [info ] [MainThread]: 
14:55:39.759547 [error] [MainThread]: [33mDatabase Error in model tb_vendas_primeiro_trimestre (models/tables/tb_vendas_primeiro_trimestre.sql)[0m
14:55:39.767335 [error] [MainThread]:   syntax error at or near "'['"
14:55:39.772144 [error] [MainThread]:   LINE 31:     and source_date.mes in '['JAN', 'FEB', 'MAR']'
14:55:39.780492 [error] [MainThread]:                                       ^
14:55:39.787753 [error] [MainThread]:   compiled SQL at target/run/analytics_dbt/models/tables/tb_vendas_primeiro_trimestre.sql
14:55:39.791905 [info ] [MainThread]: 
14:55:39.802865 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
14:55:39.811089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3f0ac5ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3f0c992e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3f0ad4cd0>]}


============================== 2022-05-22 15:01:59.897263 | 9ea265fc-b04a-47fd-aba5-e814397c890c ==============================
15:01:59.897300 [info ] [MainThread]: Running with dbt=1.1.0
15:01:59.901362 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['models/tables/tb_vendas_primeiro_trimestre.sql'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
15:01:59.909456 [debug] [MainThread]: Tracking: tracking
15:01:59.937693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe77903e640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe77903e700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe77903e730>]}
15:02:00.253789 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
15:02:00.266935 [debug] [MainThread]: Partial parsing: updated file: analytics_dbt://models/tables/tb_vendas_primeiro_trimestre.sql
15:02:00.442128 [debug] [MainThread]: 1603: static parser failed on tables/tb_vendas_primeiro_trimestre.sql
15:02:00.503771 [debug] [MainThread]: 1602: parser fallback to jinja rendering on tables/tb_vendas_primeiro_trimestre.sql
15:02:00.565520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9ea265fc-b04a-47fd-aba5-e814397c890c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe778ee58b0>]}
15:02:00.655269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9ea265fc-b04a-47fd-aba5-e814397c890c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe779021f40>]}
15:02:00.662139 [info ] [MainThread]: Found 5 models, 4 tests, 0 snapshots, 0 analyses, 193 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
15:02:00.670369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9ea265fc-b04a-47fd-aba5-e814397c890c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe778fc2e20>]}
15:02:00.681277 [info ] [MainThread]: 
15:02:00.687434 [debug] [MainThread]: Acquiring new redshift connection "master"
15:02:00.695726 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev"
15:02:00.786083 [debug] [ThreadPool]: Using redshift connection "list_dev"
15:02:00.789514 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
  
15:02:00.792220 [debug] [ThreadPool]: Opening a new connection, currently in state init
15:02:00.795911 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
15:02:02.165880 [debug] [ThreadPool]: SQL status: SELECT in 1.37 seconds
15:02:02.170376 [debug] [ThreadPool]: On list_dev: Close
15:02:02.175025 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev_public"
15:02:02.190620 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
15:02:02.192823 [debug] [ThreadPool]: On list_dev_public: BEGIN
15:02:02.194906 [debug] [ThreadPool]: Opening a new connection, currently in state closed
15:02:02.197059 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
15:02:03.480495 [debug] [ThreadPool]: SQL status: BEGIN in 1.29 seconds
15:02:03.483616 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
15:02:03.486341 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev_public"} */
select
      'dev' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dev' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
15:02:03.638967 [debug] [ThreadPool]: SQL status: SELECT in 0.15 seconds
15:02:03.647021 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
15:02:03.792224 [debug] [ThreadPool]: On list_dev_public: Close
15:02:03.804487 [debug] [MainThread]: Using redshift connection "master"
15:02:03.806956 [debug] [MainThread]: On master: BEGIN
15:02:03.809262 [debug] [MainThread]: Opening a new connection, currently in state init
15:02:03.811246 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
15:02:05.102391 [debug] [MainThread]: SQL status: BEGIN in 1.29 seconds
15:02:05.107351 [debug] [MainThread]: Using redshift connection "master"
15:02:05.110929 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
15:02:05.289294 [debug] [MainThread]: SQL status: SELECT in 0.17 seconds
15:02:05.296895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9ea265fc-b04a-47fd-aba5-e814397c890c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe778f50a00>]}
15:02:05.300372 [debug] [MainThread]: On master: ROLLBACK
15:02:05.463027 [debug] [MainThread]: Using redshift connection "master"
15:02:05.466965 [debug] [MainThread]: On master: BEGIN
15:02:05.757571 [debug] [MainThread]: SQL status: BEGIN in 0.29 seconds
15:02:05.760846 [debug] [MainThread]: On master: COMMIT
15:02:05.763330 [debug] [MainThread]: Using redshift connection "master"
15:02:05.766158 [debug] [MainThread]: On master: COMMIT
15:02:05.907069 [debug] [MainThread]: SQL status: COMMIT in 0.14 seconds
15:02:05.910376 [debug] [MainThread]: On master: Close
15:02:05.913422 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
15:02:05.917142 [info ] [MainThread]: 
15:02:05.935635 [debug] [Thread-1  ]: Began running node model.analytics_dbt.tb_vendas_primeiro_trimestre
15:02:05.938634 [info ] [Thread-1  ]: 1 of 1 START table model public.tb_vendas_primeiro_trimestre ................... [RUN]
15:02:05.943453 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.tb_vendas_primeiro_trimestre"
15:02:05.947596 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.tb_vendas_primeiro_trimestre
15:02:05.954425 [debug] [Thread-1  ]: Compiling model.analytics_dbt.tb_vendas_primeiro_trimestre
15:02:05.964517 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.tb_vendas_primeiro_trimestre"
15:02:05.977491 [debug] [Thread-1  ]: finished collecting timing info
15:02:05.980048 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.tb_vendas_primeiro_trimestre
15:02:06.049950 [debug] [Thread-1  ]: Writing runtime SQL for node "model.analytics_dbt.tb_vendas_primeiro_trimestre"
15:02:06.057141 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_vendas_primeiro_trimestre"
15:02:06.059458 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: BEGIN
15:02:06.062085 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:02:06.064182 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
15:02:07.405710 [debug] [Thread-1  ]: SQL status: BEGIN in 1.34 seconds
15:02:07.410995 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_vendas_primeiro_trimestre"
15:02:07.415182 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.tb_vendas_primeiro_trimestre"} */


  create  table
    "dev"."public"."tb_vendas_primeiro_trimestre__dbt_tmp"
    
    
    
  as (
    -- define o as variáveis meses e ano



-- cria a fonte com os dados de date e converte o  nome das colunas
with source_date as (
    select  dateid as id_date,
            month as mes,
            year as ano
    from date

),
-- cria uma fonte de dados unindo a tabela sales com date
sales_date as (

    select  source_date.mes, 
            sum(quantidade_vendida)
    from  "dev"."public"."vw_sales" sales inner join source_date
    on sales.id_date = source_date.id_date
    GROUP BY source_date.mes,
             source_date.ano
    and source_date.mes = '['JAN', 'FEB', 'MAR']'
    and source_date.ano = '2008'

)

final (

    select * from sales_date
)
  );
15:02:07.557671 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near "JAN"
LINE 31:     and source_date.mes = '['JAN', 'FEB', 'MAR']'
                                      ^

15:02:07.560093 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: ROLLBACK
15:02:07.702208 [debug] [Thread-1  ]: finished collecting timing info
15:02:07.706732 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: Close
15:02:07.711371 [debug] [Thread-1  ]: Database Error in model tb_vendas_primeiro_trimestre (models/tables/tb_vendas_primeiro_trimestre.sql)
  syntax error at or near "JAN"
  LINE 31:     and source_date.mes = '['JAN', 'FEB', 'MAR']'
                                        ^
  compiled SQL at target/run/analytics_dbt/models/tables/tb_vendas_primeiro_trimestre.sql
15:02:07.714919 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ea265fc-b04a-47fd-aba5-e814397c890c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe778662cd0>]}
15:02:07.718005 [error] [Thread-1  ]: 1 of 1 ERROR creating table model public.tb_vendas_primeiro_trimestre .......... [[31mERROR[0m in 1.77s]
15:02:07.721663 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.tb_vendas_primeiro_trimestre
15:02:07.728321 [debug] [MainThread]: Acquiring new redshift connection "master"
15:02:07.732428 [debug] [MainThread]: Using redshift connection "master"
15:02:07.736122 [debug] [MainThread]: On master: BEGIN
15:02:07.737962 [debug] [MainThread]: Opening a new connection, currently in state closed
15:02:07.739867 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
15:02:09.038796 [debug] [MainThread]: SQL status: BEGIN in 1.3 seconds
15:02:09.043568 [debug] [MainThread]: On master: COMMIT
15:02:09.048996 [debug] [MainThread]: Using redshift connection "master"
15:02:09.053013 [debug] [MainThread]: On master: COMMIT
15:02:09.196957 [debug] [MainThread]: SQL status: COMMIT in 0.14 seconds
15:02:09.200267 [debug] [MainThread]: On master: Close
15:02:09.204236 [info ] [MainThread]: 
15:02:09.207733 [info ] [MainThread]: Finished running 1 table model in 8.52s.
15:02:09.211321 [debug] [MainThread]: Connection 'master' was properly closed.
15:02:09.218338 [debug] [MainThread]: Connection 'model.analytics_dbt.tb_vendas_primeiro_trimestre' was properly closed.
15:02:09.249818 [info ] [MainThread]: 
15:02:09.256228 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
15:02:09.261416 [info ] [MainThread]: 
15:02:09.268211 [error] [MainThread]: [33mDatabase Error in model tb_vendas_primeiro_trimestre (models/tables/tb_vendas_primeiro_trimestre.sql)[0m
15:02:09.274449 [error] [MainThread]:   syntax error at or near "JAN"
15:02:09.280502 [error] [MainThread]:   LINE 31:     and source_date.mes = '['JAN', 'FEB', 'MAR']'
15:02:09.290758 [error] [MainThread]:                                         ^
15:02:09.295829 [error] [MainThread]:   compiled SQL at target/run/analytics_dbt/models/tables/tb_vendas_primeiro_trimestre.sql
15:02:09.305881 [info ] [MainThread]: 
15:02:09.312548 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
15:02:09.323515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe779061130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe779021970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe778ea4f70>]}


============================== 2022-05-22 15:03:47.668729 | 15293bec-063f-4b8a-9014-1a5a68dbbb90 ==============================
15:03:47.668748 [info ] [MainThread]: Running with dbt=1.1.0
15:03:47.682373 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['models/tables/tb_vendas_primeiro_trimestre.sql'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
15:03:47.688524 [debug] [MainThread]: Tracking: tracking
15:03:47.709866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff33ddd4700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff33ddd47c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff33ddd47f0>]}
15:03:47.828512 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
15:03:47.832003 [debug] [MainThread]: Partial parsing: updated file: analytics_dbt://models/tables/tb_vendas_primeiro_trimestre.sql
15:03:47.857270 [debug] [MainThread]: 1603: static parser failed on tables/tb_vendas_primeiro_trimestre.sql
15:03:47.885081 [debug] [MainThread]: 1602: parser fallback to jinja rendering on tables/tb_vendas_primeiro_trimestre.sql
15:03:47.916686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '15293bec-063f-4b8a-9014-1a5a68dbbb90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff33dc82970>]}
15:03:47.942217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '15293bec-063f-4b8a-9014-1a5a68dbbb90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff33dd1ef10>]}
15:03:47.945156 [info ] [MainThread]: Found 5 models, 4 tests, 0 snapshots, 0 analyses, 193 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
15:03:47.948076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '15293bec-063f-4b8a-9014-1a5a68dbbb90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff33dd5f910>]}
15:03:47.955576 [info ] [MainThread]: 
15:03:47.961685 [debug] [MainThread]: Acquiring new redshift connection "master"
15:03:47.966887 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev"
15:03:47.998634 [debug] [ThreadPool]: Using redshift connection "list_dev"
15:03:48.000922 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
  
15:03:48.003275 [debug] [ThreadPool]: Opening a new connection, currently in state init
15:03:48.005769 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
15:03:49.363701 [debug] [ThreadPool]: SQL status: SELECT in 1.36 seconds
15:03:49.368940 [debug] [ThreadPool]: On list_dev: Close
15:03:49.374110 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev_public"
15:03:49.392296 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
15:03:49.394934 [debug] [ThreadPool]: On list_dev_public: BEGIN
15:03:49.396875 [debug] [ThreadPool]: Opening a new connection, currently in state closed
15:03:49.399268 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
15:03:50.694288 [debug] [ThreadPool]: SQL status: BEGIN in 1.3 seconds
15:03:50.697726 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
15:03:50.700224 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev_public"} */
select
      'dev' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dev' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
15:03:50.855826 [debug] [ThreadPool]: SQL status: SELECT in 0.15 seconds
15:03:50.861718 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
15:03:51.009518 [debug] [ThreadPool]: On list_dev_public: Close
15:03:51.021921 [debug] [MainThread]: Using redshift connection "master"
15:03:51.023941 [debug] [MainThread]: On master: BEGIN
15:03:51.026138 [debug] [MainThread]: Opening a new connection, currently in state init
15:03:51.028249 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
15:03:52.365915 [debug] [MainThread]: SQL status: BEGIN in 1.34 seconds
15:03:52.369992 [debug] [MainThread]: Using redshift connection "master"
15:03:52.373211 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
15:03:52.546577 [debug] [MainThread]: SQL status: SELECT in 0.17 seconds
15:03:52.552127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '15293bec-063f-4b8a-9014-1a5a68dbbb90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff33dde8be0>]}
15:03:52.554639 [debug] [MainThread]: On master: ROLLBACK
15:03:52.694621 [debug] [MainThread]: Using redshift connection "master"
15:03:52.697394 [debug] [MainThread]: On master: BEGIN
15:03:52.977387 [debug] [MainThread]: SQL status: BEGIN in 0.28 seconds
15:03:52.982606 [debug] [MainThread]: On master: COMMIT
15:03:52.985214 [debug] [MainThread]: Using redshift connection "master"
15:03:52.987541 [debug] [MainThread]: On master: COMMIT
15:03:53.135867 [debug] [MainThread]: SQL status: COMMIT in 0.15 seconds
15:03:53.139092 [debug] [MainThread]: On master: Close
15:03:53.143805 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
15:03:53.146152 [info ] [MainThread]: 
15:03:53.156785 [debug] [Thread-1  ]: Began running node model.analytics_dbt.tb_vendas_primeiro_trimestre
15:03:53.161249 [info ] [Thread-1  ]: 1 of 1 START table model public.tb_vendas_primeiro_trimestre ................... [RUN]
15:03:53.168396 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.tb_vendas_primeiro_trimestre"
15:03:53.173446 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.tb_vendas_primeiro_trimestre
15:03:53.175997 [debug] [Thread-1  ]: Compiling model.analytics_dbt.tb_vendas_primeiro_trimestre
15:03:53.187613 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.tb_vendas_primeiro_trimestre"
15:03:53.200886 [debug] [Thread-1  ]: finished collecting timing info
15:03:53.203503 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.tb_vendas_primeiro_trimestre
15:03:53.271465 [debug] [Thread-1  ]: Writing runtime SQL for node "model.analytics_dbt.tb_vendas_primeiro_trimestre"
15:03:53.277657 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_vendas_primeiro_trimestre"
15:03:53.280558 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: BEGIN
15:03:53.282506 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:03:53.283958 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
15:03:54.549829 [debug] [Thread-1  ]: SQL status: BEGIN in 1.27 seconds
15:03:54.555888 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_vendas_primeiro_trimestre"
15:03:54.559895 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.tb_vendas_primeiro_trimestre"} */


  create  table
    "dev"."public"."tb_vendas_primeiro_trimestre__dbt_tmp"
    
    
    
  as (
    -- define o as variáveis meses e ano



-- cria a fonte com os dados de date e converte o  nome das colunas
with source_date as (
    select  dateid as id_date,
            month as mes,
            year as ano
    from date

),
-- cria uma fonte de dados unindo a tabela sales com date
sales_date as (

    select  source_date.mes, 
            sum(quantidade_vendida)
    from  "dev"."public"."vw_sales" sales inner join source_date
    on sales.id_date = source_date.id_date
    GROUP BY source_date.mes,
             source_date.ano
    and source_date.mes = '['JAN', 'FEB', 'MAR']'
    and source_date.ano = '2008'

)

final (

    select * from sales_date
)
  );
15:03:54.715657 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near "JAN"
LINE 31:     and source_date.mes = '['JAN', 'FEB', 'MAR']'
                                      ^

15:03:54.718029 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: ROLLBACK
15:03:54.864205 [debug] [Thread-1  ]: finished collecting timing info
15:03:54.868741 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: Close
15:03:54.873877 [debug] [Thread-1  ]: Database Error in model tb_vendas_primeiro_trimestre (models/tables/tb_vendas_primeiro_trimestre.sql)
  syntax error at or near "JAN"
  LINE 31:     and source_date.mes = '['JAN', 'FEB', 'MAR']'
                                        ^
  compiled SQL at target/run/analytics_dbt/models/tables/tb_vendas_primeiro_trimestre.sql
15:03:54.876249 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15293bec-063f-4b8a-9014-1a5a68dbbb90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff33c3eb130>]}
15:03:54.878778 [error] [Thread-1  ]: 1 of 1 ERROR creating table model public.tb_vendas_primeiro_trimestre .......... [[31mERROR[0m in 1.71s]
15:03:54.882895 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.tb_vendas_primeiro_trimestre
15:03:54.888724 [debug] [MainThread]: Acquiring new redshift connection "master"
15:03:54.892122 [debug] [MainThread]: Using redshift connection "master"
15:03:54.896717 [debug] [MainThread]: On master: BEGIN
15:03:54.900112 [debug] [MainThread]: Opening a new connection, currently in state closed
15:03:54.902919 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
15:03:56.172861 [debug] [MainThread]: SQL status: BEGIN in 1.27 seconds
15:03:56.176051 [debug] [MainThread]: On master: COMMIT
15:03:56.178666 [debug] [MainThread]: Using redshift connection "master"
15:03:56.180903 [debug] [MainThread]: On master: COMMIT
15:03:56.322503 [debug] [MainThread]: SQL status: COMMIT in 0.14 seconds
15:03:56.327672 [debug] [MainThread]: On master: Close
15:03:56.333617 [info ] [MainThread]: 
15:03:56.338563 [info ] [MainThread]: Finished running 1 table model in 8.37s.
15:03:56.342907 [debug] [MainThread]: Connection 'master' was properly closed.
15:03:56.349700 [debug] [MainThread]: Connection 'model.analytics_dbt.tb_vendas_primeiro_trimestre' was properly closed.
15:03:56.381571 [info ] [MainThread]: 
15:03:56.385633 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
15:03:56.393050 [info ] [MainThread]: 
15:03:56.398549 [error] [MainThread]: [33mDatabase Error in model tb_vendas_primeiro_trimestre (models/tables/tb_vendas_primeiro_trimestre.sql)[0m
15:03:56.411281 [error] [MainThread]:   syntax error at or near "JAN"
15:03:56.419528 [error] [MainThread]:   LINE 31:     and source_date.mes = '['JAN', 'FEB', 'MAR']'
15:03:56.428572 [error] [MainThread]:                                         ^
15:03:56.434947 [error] [MainThread]:   compiled SQL at target/run/analytics_dbt/models/tables/tb_vendas_primeiro_trimestre.sql
15:03:56.445008 [info ] [MainThread]: 
15:03:56.460760 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
15:03:56.474671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff33dc26f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff33ddf73a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff33dc32ca0>]}


============================== 2022-05-22 15:06:48.668267 | 6d841be7-f13c-43ac-83da-f78b551343cf ==============================
15:06:48.668335 [info ] [MainThread]: Running with dbt=1.1.0
15:06:48.671006 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['models/tables/tb_vendas_primeiro_trimestre.sql'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
15:06:48.674633 [debug] [MainThread]: Tracking: tracking
15:06:48.701619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa61efe2730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa61efe27f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa61efe2820>]}
15:06:48.799796 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
15:06:48.803288 [debug] [MainThread]: Partial parsing: updated file: analytics_dbt://models/tables/tb_vendas_primeiro_trimestre.sql
15:06:48.827387 [debug] [MainThread]: 1603: static parser failed on tables/tb_vendas_primeiro_trimestre.sql
15:06:48.857647 [debug] [MainThread]: 1602: parser fallback to jinja rendering on tables/tb_vendas_primeiro_trimestre.sql
15:06:48.885669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6d841be7-f13c-43ac-83da-f78b551343cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa61ee8a9a0>]}
15:06:48.910444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6d841be7-f13c-43ac-83da-f78b551343cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa61efc3ee0>]}
15:06:48.913261 [info ] [MainThread]: Found 5 models, 4 tests, 0 snapshots, 0 analyses, 193 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
15:06:48.915487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6d841be7-f13c-43ac-83da-f78b551343cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa61f002280>]}
15:06:48.922569 [info ] [MainThread]: 
15:06:48.930233 [debug] [MainThread]: Acquiring new redshift connection "master"
15:06:48.936781 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev"
15:06:48.969568 [debug] [ThreadPool]: Using redshift connection "list_dev"
15:06:48.972506 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
  
15:06:48.975671 [debug] [ThreadPool]: Opening a new connection, currently in state init
15:06:48.978648 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
15:06:50.343634 [debug] [ThreadPool]: SQL status: SELECT in 1.37 seconds
15:06:50.349734 [debug] [ThreadPool]: On list_dev: Close
15:06:50.355671 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev_public"
15:06:50.371863 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
15:06:50.375285 [debug] [ThreadPool]: On list_dev_public: BEGIN
15:06:50.378926 [debug] [ThreadPool]: Opening a new connection, currently in state closed
15:06:50.382462 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
15:06:51.713283 [debug] [ThreadPool]: SQL status: BEGIN in 1.33 seconds
15:06:51.716062 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
15:06:51.722877 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev_public"} */
select
      'dev' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dev' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
15:06:51.877809 [debug] [ThreadPool]: SQL status: SELECT in 0.15 seconds
15:06:51.886013 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
15:06:52.028818 [debug] [ThreadPool]: On list_dev_public: Close
15:06:52.043693 [debug] [MainThread]: Using redshift connection "master"
15:06:52.046322 [debug] [MainThread]: On master: BEGIN
15:06:52.048878 [debug] [MainThread]: Opening a new connection, currently in state init
15:06:52.051173 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
15:06:53.363512 [debug] [MainThread]: SQL status: BEGIN in 1.31 seconds
15:06:53.368063 [debug] [MainThread]: Using redshift connection "master"
15:06:53.371680 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
15:06:53.548736 [debug] [MainThread]: SQL status: SELECT in 0.17 seconds
15:06:53.554842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6d841be7-f13c-43ac-83da-f78b551343cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa61effbdc0>]}
15:06:53.557805 [debug] [MainThread]: On master: ROLLBACK
15:06:53.703788 [debug] [MainThread]: Using redshift connection "master"
15:06:53.708764 [debug] [MainThread]: On master: BEGIN
15:06:53.990997 [debug] [MainThread]: SQL status: BEGIN in 0.28 seconds
15:06:53.995904 [debug] [MainThread]: On master: COMMIT
15:06:53.999884 [debug] [MainThread]: Using redshift connection "master"
15:06:54.004122 [debug] [MainThread]: On master: COMMIT
15:06:54.152188 [debug] [MainThread]: SQL status: COMMIT in 0.14 seconds
15:06:54.155079 [debug] [MainThread]: On master: Close
15:06:54.159879 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
15:06:54.165792 [info ] [MainThread]: 
15:06:54.184723 [debug] [Thread-1  ]: Began running node model.analytics_dbt.tb_vendas_primeiro_trimestre
15:06:54.194441 [info ] [Thread-1  ]: 1 of 1 START table model public.tb_vendas_primeiro_trimestre ................... [RUN]
15:06:54.200762 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.tb_vendas_primeiro_trimestre"
15:06:54.208801 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.tb_vendas_primeiro_trimestre
15:06:54.212550 [debug] [Thread-1  ]: Compiling model.analytics_dbt.tb_vendas_primeiro_trimestre
15:06:54.227998 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.tb_vendas_primeiro_trimestre"
15:06:54.235581 [debug] [Thread-1  ]: finished collecting timing info
15:06:54.239906 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.tb_vendas_primeiro_trimestre
15:06:54.319010 [debug] [Thread-1  ]: Writing runtime SQL for node "model.analytics_dbt.tb_vendas_primeiro_trimestre"
15:06:54.327614 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_vendas_primeiro_trimestre"
15:06:54.331075 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: BEGIN
15:06:54.333796 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:06:54.337250 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
15:06:55.634093 [debug] [Thread-1  ]: SQL status: BEGIN in 1.3 seconds
15:06:55.638559 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_vendas_primeiro_trimestre"
15:06:55.645591 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.tb_vendas_primeiro_trimestre"} */


  create  table
    "dev"."public"."tb_vendas_primeiro_trimestre__dbt_tmp"
    
    
    
  as (
    -- define o as variáveis meses e ano



-- cria a fonte com os dados de date e converte o  nome das colunas
with source_date as (
    select  dateid as id_date,
            month as mes,
            year as ano
    from date

),
-- cria uma fonte de dados unindo a tabela sales com date
sales_date as (

    select  source_date.mes, 
            sum(quantidade_vendida)
    from  "dev"."public"."vw_sales" sales inner join source_date
    on sales.id_date = source_date.id_date
    GROUP BY source_date.mes,
             source_date.ano
    
    and source_date.mes = 'JAN'
    and source_date.ano = '2008'
    
    and source_date.mes = 'FEB'
    and source_date.ano = '2008'
    
    and source_date.mes = 'MAR'
    and source_date.ano = '2008'
    
    

)

final (

    select * from sales_date
)



-- 

-- select
--     order_id,
--     
--     sum(case when payment_method = 'bank_transfer' then amount end) as bank_transfer_amount,
--     
--     sum(case when payment_method = 'credit_card' then amount end) as credit_card_amount,
--     
--     sum(case when payment_method = 'gift_card' then amount end) as gift_card_amount,
--     
--     sum(amount) as total_amount
-- from app_data.payments
-- group by 1
  );
15:06:55.793466 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near "final"
LINE 45: final (
         ^

15:06:55.797580 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: ROLLBACK
15:06:55.947602 [debug] [Thread-1  ]: finished collecting timing info
15:06:55.950762 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: Close
15:06:55.957885 [debug] [Thread-1  ]: Database Error in model tb_vendas_primeiro_trimestre (models/tables/tb_vendas_primeiro_trimestre.sql)
  syntax error at or near "final"
  LINE 45: final (
           ^
  compiled SQL at target/run/analytics_dbt/models/tables/tb_vendas_primeiro_trimestre.sql
15:06:55.960571 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d841be7-f13c-43ac-83da-f78b551343cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa61cdedf40>]}
15:06:55.963556 [error] [Thread-1  ]: 1 of 1 ERROR creating table model public.tb_vendas_primeiro_trimestre .......... [[31mERROR[0m in 1.76s]
15:06:55.966646 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.tb_vendas_primeiro_trimestre
15:06:55.972901 [debug] [MainThread]: Acquiring new redshift connection "master"
15:06:55.975300 [debug] [MainThread]: Using redshift connection "master"
15:06:55.977472 [debug] [MainThread]: On master: BEGIN
15:06:55.979149 [debug] [MainThread]: Opening a new connection, currently in state closed
15:06:55.982588 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
15:06:57.278279 [debug] [MainThread]: SQL status: BEGIN in 1.3 seconds
15:06:57.283513 [debug] [MainThread]: On master: COMMIT
15:06:57.297133 [debug] [MainThread]: Using redshift connection "master"
15:06:57.299483 [debug] [MainThread]: On master: COMMIT
15:06:57.444623 [debug] [MainThread]: SQL status: COMMIT in 0.14 seconds
15:06:57.449207 [debug] [MainThread]: On master: Close
15:06:57.454224 [info ] [MainThread]: 
15:06:57.457772 [info ] [MainThread]: Finished running 1 table model in 8.53s.
15:06:57.463054 [debug] [MainThread]: Connection 'master' was properly closed.
15:06:57.469096 [debug] [MainThread]: Connection 'model.analytics_dbt.tb_vendas_primeiro_trimestre' was properly closed.
15:06:57.510263 [info ] [MainThread]: 
15:06:57.517407 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
15:06:57.521985 [info ] [MainThread]: 
15:06:57.526930 [error] [MainThread]: [33mDatabase Error in model tb_vendas_primeiro_trimestre (models/tables/tb_vendas_primeiro_trimestre.sql)[0m
15:06:57.531114 [error] [MainThread]:   syntax error at or near "final"
15:06:57.537922 [error] [MainThread]:   LINE 45: final (
15:06:57.546061 [error] [MainThread]:            ^
15:06:57.555448 [error] [MainThread]:   compiled SQL at target/run/analytics_dbt/models/tables/tb_vendas_primeiro_trimestre.sql
15:06:57.563879 [info ] [MainThread]: 
15:06:57.574690 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
15:06:57.582826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa61ee27f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa61ef66a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa61ee3fd90>]}


============================== 2022-05-22 15:08:44.490092 | f5b49f8c-da01-4089-91bd-d25efdfad858 ==============================
15:08:44.490114 [info ] [MainThread]: Running with dbt=1.1.0
15:08:44.493136 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['models/tables/tb_vendas_primeiro_trimestre.sql'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
15:08:44.497227 [debug] [MainThread]: Tracking: tracking
15:08:44.526594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38d1e39730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38d1e397f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38d1e39820>]}
15:08:44.631229 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
15:08:44.635004 [debug] [MainThread]: Partial parsing: updated file: analytics_dbt://models/tables/tb_vendas_primeiro_trimestre.sql
15:08:44.663438 [debug] [MainThread]: 1603: static parser failed on tables/tb_vendas_primeiro_trimestre.sql
15:08:44.710534 [debug] [MainThread]: 1602: parser fallback to jinja rendering on tables/tb_vendas_primeiro_trimestre.sql
15:08:44.751921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f5b49f8c-da01-4089-91bd-d25efdfad858', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38d1ce79a0>]}
15:08:44.787161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f5b49f8c-da01-4089-91bd-d25efdfad858', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38d1d82ee0>]}
15:08:44.791528 [info ] [MainThread]: Found 5 models, 4 tests, 0 snapshots, 0 analyses, 193 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
15:08:44.796039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f5b49f8c-da01-4089-91bd-d25efdfad858', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38d1dc39a0>]}
15:08:44.807140 [info ] [MainThread]: 
15:08:44.813874 [debug] [MainThread]: Acquiring new redshift connection "master"
15:08:44.824347 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev"
15:08:44.857868 [debug] [ThreadPool]: Using redshift connection "list_dev"
15:08:44.861442 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
  
15:08:44.865525 [debug] [ThreadPool]: Opening a new connection, currently in state init
15:08:44.868684 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
15:08:46.206108 [debug] [ThreadPool]: SQL status: SELECT in 1.34 seconds
15:08:46.211034 [debug] [ThreadPool]: On list_dev: Close
15:08:46.216650 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev_public"
15:08:46.232697 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
15:08:46.235512 [debug] [ThreadPool]: On list_dev_public: BEGIN
15:08:46.238160 [debug] [ThreadPool]: Opening a new connection, currently in state closed
15:08:46.241348 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
15:08:47.599223 [debug] [ThreadPool]: SQL status: BEGIN in 1.36 seconds
15:08:47.604468 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
15:08:47.608283 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev_public"} */
select
      'dev' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dev' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
15:08:47.768763 [debug] [ThreadPool]: SQL status: SELECT in 0.16 seconds
15:08:47.775570 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
15:08:47.920603 [debug] [ThreadPool]: On list_dev_public: Close
15:08:47.938049 [debug] [MainThread]: Using redshift connection "master"
15:08:47.942069 [debug] [MainThread]: On master: BEGIN
15:08:47.953356 [debug] [MainThread]: Opening a new connection, currently in state init
15:08:47.962845 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
15:08:49.298678 [debug] [MainThread]: SQL status: BEGIN in 1.35 seconds
15:08:49.301257 [debug] [MainThread]: Using redshift connection "master"
15:08:49.303840 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
15:08:49.482144 [debug] [MainThread]: SQL status: SELECT in 0.18 seconds
15:08:49.487007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f5b49f8c-da01-4089-91bd-d25efdfad858', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38d1e52af0>]}
15:08:49.489840 [debug] [MainThread]: On master: ROLLBACK
15:08:49.707984 [debug] [MainThread]: Using redshift connection "master"
15:08:49.714088 [debug] [MainThread]: On master: BEGIN
15:08:50.009534 [debug] [MainThread]: SQL status: BEGIN in 0.29 seconds
15:08:50.014969 [debug] [MainThread]: On master: COMMIT
15:08:50.016934 [debug] [MainThread]: Using redshift connection "master"
15:08:50.018918 [debug] [MainThread]: On master: COMMIT
15:08:50.163842 [debug] [MainThread]: SQL status: COMMIT in 0.14 seconds
15:08:50.167410 [debug] [MainThread]: On master: Close
15:08:50.170548 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
15:08:50.173120 [info ] [MainThread]: 
15:08:50.188339 [debug] [Thread-1  ]: Began running node model.analytics_dbt.tb_vendas_primeiro_trimestre
15:08:50.192662 [info ] [Thread-1  ]: 1 of 1 START table model public.tb_vendas_primeiro_trimestre ................... [RUN]
15:08:50.199575 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.tb_vendas_primeiro_trimestre"
15:08:50.204883 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.tb_vendas_primeiro_trimestre
15:08:50.207364 [debug] [Thread-1  ]: Compiling model.analytics_dbt.tb_vendas_primeiro_trimestre
15:08:50.228839 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.tb_vendas_primeiro_trimestre"
15:08:50.237736 [debug] [Thread-1  ]: finished collecting timing info
15:08:50.240635 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.tb_vendas_primeiro_trimestre
15:08:50.313518 [debug] [Thread-1  ]: Writing runtime SQL for node "model.analytics_dbt.tb_vendas_primeiro_trimestre"
15:08:50.322497 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_vendas_primeiro_trimestre"
15:08:50.325777 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: BEGIN
15:08:50.328983 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:08:50.331721 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
15:08:51.653049 [debug] [Thread-1  ]: SQL status: BEGIN in 1.32 seconds
15:08:51.659331 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_vendas_primeiro_trimestre"
15:08:51.662062 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.tb_vendas_primeiro_trimestre"} */


  create  table
    "dev"."public"."tb_vendas_primeiro_trimestre__dbt_tmp"
    
    
    
  as (
    -- define o as variáveis meses e ano



-- cria a fonte com os dados de date e converte o  nome das colunas
with source_date as (
    select  dateid as id_date,
            month as mes,
            year as ano
    from date

),
-- cria uma fonte de dados unindo a tabela sales com date
sales_date as (

    select  source_date.mes, 
            sum(quantidade_vendida)
    from  "dev"."public"."vw_sales" sales inner join source_date
    on sales.id_date = source_date.id_date
    GROUP BY source_date.mes,
             source_date.ano
    
    and source_date.mes = 'JAN'
    and source_date.ano = '2008'
    
    and source_date.mes = 'FEB'
    and source_date.ano = '2008'
    
    and source_date.mes = 'MAR'
    and source_date.ano = '2008'
    
    

)

select * from sales_date



-- 

-- select
--     order_id,
--     
--     sum(case when payment_method = 'bank_transfer' then amount end) as bank_transfer_amount,
--     
--     sum(case when payment_method = 'credit_card' then amount end) as credit_card_amount,
--     
--     sum(case when payment_method = 'gift_card' then amount end) as gift_card_amount,
--     
--     sum(amount) as total_amount
-- from app_data.payments
-- group by 1
  );
15:09:06.954394 [debug] [Thread-1  ]: SQL status: SELECT in 15.29 seconds
15:09:06.971270 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_vendas_primeiro_trimestre"
15:09:06.973447 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.tb_vendas_primeiro_trimestre"} */
alter table "dev"."public"."tb_vendas_primeiro_trimestre__dbt_tmp" rename to "tb_vendas_primeiro_trimestre"
15:09:07.127398 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.15 seconds
15:09:07.158363 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: COMMIT
15:09:07.161087 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_vendas_primeiro_trimestre"
15:09:07.163192 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: COMMIT
15:09:07.379012 [debug] [Thread-1  ]: SQL status: COMMIT in 0.21 seconds
15:09:07.382641 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_vendas_primeiro_trimestre"
15:09:07.387004 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: BEGIN
15:09:07.530798 [debug] [Thread-1  ]: SQL status: BEGIN in 0.14 seconds
15:09:07.548928 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_vendas_primeiro_trimestre"
15:09:07.551474 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.tb_vendas_primeiro_trimestre"} */
drop table if exists "dev"."public"."tb_vendas_primeiro_trimestre__dbt_backup" cascade
15:09:07.697105 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.14 seconds
15:09:07.704049 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: COMMIT
15:09:07.706769 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_vendas_primeiro_trimestre"
15:09:07.709072 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: COMMIT
15:09:07.857479 [debug] [Thread-1  ]: SQL status: COMMIT in 0.15 seconds
15:09:07.861848 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_vendas_primeiro_trimestre"
15:09:07.866628 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: BEGIN
15:09:08.013266 [debug] [Thread-1  ]: SQL status: BEGIN in 0.14 seconds
15:09:08.018472 [debug] [Thread-1  ]: finished collecting timing info
15:09:08.021728 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: ROLLBACK
15:09:08.168057 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: Close
15:09:08.172062 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f5b49f8c-da01-4089-91bd-d25efdfad858', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38d1c86ca0>]}
15:09:08.175731 [info ] [Thread-1  ]: 1 of 1 OK created table model public.tb_vendas_primeiro_trimestre .............. [[32mSELECT[0m in 17.98s]
15:09:08.179976 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.tb_vendas_primeiro_trimestre
15:09:08.188621 [debug] [MainThread]: Acquiring new redshift connection "master"
15:09:08.191861 [debug] [MainThread]: Using redshift connection "master"
15:09:08.195514 [debug] [MainThread]: On master: BEGIN
15:09:08.198617 [debug] [MainThread]: Opening a new connection, currently in state closed
15:09:08.201367 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
15:09:09.530963 [debug] [MainThread]: SQL status: BEGIN in 1.33 seconds
15:09:09.536314 [debug] [MainThread]: On master: COMMIT
15:09:09.539838 [debug] [MainThread]: Using redshift connection "master"
15:09:09.543136 [debug] [MainThread]: On master: COMMIT
15:09:09.692279 [debug] [MainThread]: SQL status: COMMIT in 0.15 seconds
15:09:09.695683 [debug] [MainThread]: On master: Close
15:09:09.699390 [info ] [MainThread]: 
15:09:09.703695 [info ] [MainThread]: Finished running 1 table model in 24.89s.
15:09:09.710336 [debug] [MainThread]: Connection 'master' was properly closed.
15:09:09.718033 [debug] [MainThread]: Connection 'model.analytics_dbt.tb_vendas_primeiro_trimestre' was properly closed.
15:09:09.752336 [info ] [MainThread]: 
15:09:09.758277 [info ] [MainThread]: [32mCompleted successfully[0m
15:09:09.763431 [info ] [MainThread]: 
15:09:09.769252 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
15:09:09.774718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38d1dc35b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38d1d82d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38d1e5c2b0>]}


============================== 2022-05-22 15:09:29.224992 | 39fbd03f-5fc3-4123-b847-9f2445343861 ==============================
15:09:29.225055 [info ] [MainThread]: Running with dbt=1.1.0
15:09:29.233588 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['models/tables/tb_vendas_primeiro_trimestre.sql'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
15:09:29.241598 [debug] [MainThread]: Tracking: tracking
15:09:29.271400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4cd11a46d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4cd11a4790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4cd11a47c0>]}
15:09:29.397560 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
15:09:29.401188 [debug] [MainThread]: Partial parsing: updated file: analytics_dbt://models/tables/tb_vendas_primeiro_trimestre.sql
15:09:29.427946 [debug] [MainThread]: 1603: static parser failed on tables/tb_vendas_primeiro_trimestre.sql
15:09:29.461020 [debug] [MainThread]: 1602: parser fallback to jinja rendering on tables/tb_vendas_primeiro_trimestre.sql
15:09:29.494129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '39fbd03f-5fc3-4123-b847-9f2445343861', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4cd1052940>]}
15:09:29.521144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '39fbd03f-5fc3-4123-b847-9f2445343861', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4cd10eceb0>]}
15:09:29.524803 [info ] [MainThread]: Found 5 models, 4 tests, 0 snapshots, 0 analyses, 193 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
15:09:29.527186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '39fbd03f-5fc3-4123-b847-9f2445343861', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4cd112fdf0>]}
15:09:29.535159 [info ] [MainThread]: 
15:09:29.541627 [debug] [MainThread]: Acquiring new redshift connection "master"
15:09:29.548556 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev"
15:09:29.580956 [debug] [ThreadPool]: Using redshift connection "list_dev"
15:09:29.583960 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
  
15:09:29.588342 [debug] [ThreadPool]: Opening a new connection, currently in state init
15:09:29.590935 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
15:09:30.915427 [debug] [ThreadPool]: SQL status: SELECT in 1.33 seconds
15:09:30.920254 [debug] [ThreadPool]: On list_dev: Close
15:09:30.926708 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev_public"
15:09:30.944372 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
15:09:30.947238 [debug] [ThreadPool]: On list_dev_public: BEGIN
15:09:30.950131 [debug] [ThreadPool]: Opening a new connection, currently in state init
15:09:30.954951 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
15:09:32.294176 [debug] [ThreadPool]: SQL status: BEGIN in 1.34 seconds
15:09:32.301586 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
15:09:32.303901 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev_public"} */
select
      'dev' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dev' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
15:09:32.460133 [debug] [ThreadPool]: SQL status: SELECT in 0.15 seconds
15:09:32.472536 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
15:09:32.621656 [debug] [ThreadPool]: On list_dev_public: Close
15:09:32.637826 [debug] [MainThread]: Using redshift connection "master"
15:09:32.641155 [debug] [MainThread]: On master: BEGIN
15:09:32.643855 [debug] [MainThread]: Opening a new connection, currently in state init
15:09:32.647079 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
15:09:33.970050 [debug] [MainThread]: SQL status: BEGIN in 1.33 seconds
15:09:33.973509 [debug] [MainThread]: Using redshift connection "master"
15:09:33.977880 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
15:09:34.161536 [debug] [MainThread]: SQL status: SELECT in 0.18 seconds
15:09:34.170477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '39fbd03f-5fc3-4123-b847-9f2445343861', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4cd10ec940>]}
15:09:34.173587 [debug] [MainThread]: On master: ROLLBACK
15:09:34.318324 [debug] [MainThread]: Using redshift connection "master"
15:09:34.321805 [debug] [MainThread]: On master: BEGIN
15:09:34.604354 [debug] [MainThread]: SQL status: BEGIN in 0.28 seconds
15:09:34.608124 [debug] [MainThread]: On master: COMMIT
15:09:34.611180 [debug] [MainThread]: Using redshift connection "master"
15:09:34.613300 [debug] [MainThread]: On master: COMMIT
15:09:34.755506 [debug] [MainThread]: SQL status: COMMIT in 0.14 seconds
15:09:34.758617 [debug] [MainThread]: On master: Close
15:09:34.761667 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
15:09:34.764487 [info ] [MainThread]: 
15:09:34.783554 [debug] [Thread-1  ]: Began running node model.analytics_dbt.tb_vendas_primeiro_trimestre
15:09:34.786710 [info ] [Thread-1  ]: 1 of 1 START table model public.tb_vendas_primeiro_trimestre ................... [RUN]
15:09:34.788803 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.tb_vendas_primeiro_trimestre"
15:09:34.792592 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.tb_vendas_primeiro_trimestre
15:09:34.797848 [debug] [Thread-1  ]: Compiling model.analytics_dbt.tb_vendas_primeiro_trimestre
15:09:34.807196 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.tb_vendas_primeiro_trimestre"
15:09:34.823216 [debug] [Thread-1  ]: finished collecting timing info
15:09:34.825972 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.tb_vendas_primeiro_trimestre
15:09:34.897122 [debug] [Thread-1  ]: Writing runtime SQL for node "model.analytics_dbt.tb_vendas_primeiro_trimestre"
15:09:34.904721 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_vendas_primeiro_trimestre"
15:09:34.907244 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: BEGIN
15:09:34.909652 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:09:34.911908 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
15:09:36.276320 [debug] [Thread-1  ]: SQL status: BEGIN in 1.37 seconds
15:09:36.281026 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_vendas_primeiro_trimestre"
15:09:36.284059 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.tb_vendas_primeiro_trimestre"} */


  create  table
    "dev"."public"."tb_vendas_primeiro_trimestre__dbt_tmp"
    
    
    
  as (
    -- define o as variáveis meses e ano



-- cria a fonte com os dados de date e converte o  nome das colunas
with source_date as (
    select  dateid as id_date,
            month as mes,
            year as ano
    from date

),
-- cria uma fonte de dados unindo a tabela sales com date
sales_date as (

    select  source_date.mes, 
            sum(quantidade_vendida)
    from  "dev"."public"."vw_sales" sales inner join source_date
    on sales.id_date = source_date.id_date
    GROUP BY source_date.mes,
             source_date.ano
    
    and source_date.mes = 'JAN'
    
    and source_date.mes = 'FEB'
    
    and source_date.mes = 'MAR'
    
    and source_date.ano = '2008'
    

)

select * from sales_date



-- 

-- select
--     order_id,
--     
--     sum(case when payment_method = 'bank_transfer' then amount end) as bank_transfer_amount,
--     
--     sum(case when payment_method = 'credit_card' then amount end) as credit_card_amount,
--     
--     sum(case when payment_method = 'gift_card' then amount end) as gift_card_amount,
--     
--     sum(amount) as total_amount
-- from app_data.payments
-- group by 1
  );
15:09:40.367539 [debug] [Thread-1  ]: SQL status: SELECT in 4.08 seconds
15:09:40.385303 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_vendas_primeiro_trimestre"
15:09:40.387772 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.tb_vendas_primeiro_trimestre"} */
alter table "dev"."public"."tb_vendas_primeiro_trimestre" rename to "tb_vendas_primeiro_trimestre__dbt_backup"
15:09:40.533951 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.14 seconds
15:09:40.543506 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_vendas_primeiro_trimestre"
15:09:40.545875 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.tb_vendas_primeiro_trimestre"} */
alter table "dev"."public"."tb_vendas_primeiro_trimestre__dbt_tmp" rename to "tb_vendas_primeiro_trimestre"
15:09:40.689553 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.14 seconds
15:09:40.713623 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: COMMIT
15:09:40.715835 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_vendas_primeiro_trimestre"
15:09:40.718302 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: COMMIT
15:09:40.896659 [debug] [Thread-1  ]: SQL status: COMMIT in 0.18 seconds
15:09:40.902677 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_vendas_primeiro_trimestre"
15:09:40.906209 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: BEGIN
15:09:41.058831 [debug] [Thread-1  ]: SQL status: BEGIN in 0.15 seconds
15:09:41.074653 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_vendas_primeiro_trimestre"
15:09:41.076570 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.tb_vendas_primeiro_trimestre"} */
drop table if exists "dev"."public"."tb_vendas_primeiro_trimestre__dbt_backup" cascade
15:09:41.225186 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.15 seconds
15:09:41.231271 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: COMMIT
15:09:41.236905 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_vendas_primeiro_trimestre"
15:09:41.240052 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: COMMIT
15:09:41.409435 [debug] [Thread-1  ]: SQL status: COMMIT in 0.17 seconds
15:09:41.412557 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_vendas_primeiro_trimestre"
15:09:41.414983 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: BEGIN
15:09:41.558569 [debug] [Thread-1  ]: SQL status: BEGIN in 0.14 seconds
15:09:41.563136 [debug] [Thread-1  ]: finished collecting timing info
15:09:41.565653 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: ROLLBACK
15:09:41.708071 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: Close
15:09:41.716175 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '39fbd03f-5fc3-4123-b847-9f2445343861', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4cd100f3d0>]}
15:09:41.719806 [info ] [Thread-1  ]: 1 of 1 OK created table model public.tb_vendas_primeiro_trimestre .............. [[32mSELECT[0m in 6.93s]
15:09:41.723921 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.tb_vendas_primeiro_trimestre
15:09:41.731967 [debug] [MainThread]: Acquiring new redshift connection "master"
15:09:41.737421 [debug] [MainThread]: Using redshift connection "master"
15:09:41.740662 [debug] [MainThread]: On master: BEGIN
15:09:41.743801 [debug] [MainThread]: Opening a new connection, currently in state closed
15:09:41.746141 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
15:09:43.035565 [debug] [MainThread]: SQL status: BEGIN in 1.29 seconds
15:09:43.040278 [debug] [MainThread]: On master: COMMIT
15:09:43.043445 [debug] [MainThread]: Using redshift connection "master"
15:09:43.046740 [debug] [MainThread]: On master: COMMIT
15:09:43.188561 [debug] [MainThread]: SQL status: COMMIT in 0.14 seconds
15:09:43.191638 [debug] [MainThread]: On master: Close
15:09:43.195149 [info ] [MainThread]: 
15:09:43.197599 [info ] [MainThread]: Finished running 1 table model in 13.65s.
15:09:43.201115 [debug] [MainThread]: Connection 'master' was properly closed.
15:09:43.206381 [debug] [MainThread]: Connection 'list_dev' was properly closed.
15:09:43.210963 [debug] [MainThread]: Connection 'model.analytics_dbt.tb_vendas_primeiro_trimestre' was properly closed.
15:09:43.240485 [info ] [MainThread]: 
15:09:43.244384 [info ] [MainThread]: [32mCompleted successfully[0m
15:09:43.248464 [info ] [MainThread]: 
15:09:43.254078 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
15:09:43.260213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4cd11c8370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4cd0762af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4cd0762040>]}


============================== 2022-05-22 15:14:49.724108 | dc23ed45-aec7-45f7-ba79-ac2986b2ba27 ==============================
15:14:49.724128 [info ] [MainThread]: Running with dbt=1.1.0
15:14:49.727103 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['models/tables/tb_vendas_primeiro_trimestre.sql'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
15:14:49.730803 [debug] [MainThread]: Tracking: tracking
15:14:49.756838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50f4e17730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50f4e177f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50f4e17820>]}
15:14:49.880918 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
15:14:49.884235 [debug] [MainThread]: Partial parsing: updated file: analytics_dbt://models/tables/tb_vendas_primeiro_trimestre.sql
15:14:49.922356 [debug] [MainThread]: 1603: static parser failed on tables/tb_vendas_primeiro_trimestre.sql
15:14:49.953970 [debug] [MainThread]: 1602: parser fallback to jinja rendering on tables/tb_vendas_primeiro_trimestre.sql
15:14:50.001843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dc23ed45-aec7-45f7-ba79-ac2986b2ba27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50f4cc5a00>]}
15:14:50.035905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dc23ed45-aec7-45f7-ba79-ac2986b2ba27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50f4d62e50>]}
15:14:50.041208 [info ] [MainThread]: Found 5 models, 4 tests, 0 snapshots, 0 analyses, 193 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
15:14:50.046697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dc23ed45-aec7-45f7-ba79-ac2986b2ba27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50f4e3c2e0>]}
15:14:50.061897 [info ] [MainThread]: 
15:14:50.069268 [debug] [MainThread]: Acquiring new redshift connection "master"
15:14:50.078132 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev"
15:14:50.109918 [debug] [ThreadPool]: Using redshift connection "list_dev"
15:14:50.112890 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
  
15:14:50.117563 [debug] [ThreadPool]: Opening a new connection, currently in state init
15:14:50.120700 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
15:14:51.470625 [debug] [ThreadPool]: SQL status: SELECT in 1.35 seconds
15:14:51.480035 [debug] [ThreadPool]: On list_dev: Close
15:14:51.486719 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev_public"
15:14:51.500782 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
15:14:51.503499 [debug] [ThreadPool]: On list_dev_public: BEGIN
15:14:51.505929 [debug] [ThreadPool]: Opening a new connection, currently in state closed
15:14:51.508386 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
15:14:52.842946 [debug] [ThreadPool]: SQL status: BEGIN in 1.34 seconds
15:14:52.847743 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
15:14:52.852250 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev_public"} */
select
      'dev' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dev' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
15:14:53.007284 [debug] [ThreadPool]: SQL status: SELECT in 0.15 seconds
15:14:53.015790 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
15:14:53.177631 [debug] [ThreadPool]: On list_dev_public: Close
15:14:53.191370 [debug] [MainThread]: Using redshift connection "master"
15:14:53.193688 [debug] [MainThread]: On master: BEGIN
15:14:53.196456 [debug] [MainThread]: Opening a new connection, currently in state init
15:14:53.199416 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
15:14:54.470367 [debug] [MainThread]: SQL status: BEGIN in 1.27 seconds
15:14:54.475148 [debug] [MainThread]: Using redshift connection "master"
15:14:54.481034 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
15:14:54.660198 [debug] [MainThread]: SQL status: SELECT in 0.17 seconds
15:14:54.667068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dc23ed45-aec7-45f7-ba79-ac2986b2ba27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50f4e336d0>]}
15:14:54.669451 [debug] [MainThread]: On master: ROLLBACK
15:14:54.809388 [debug] [MainThread]: Using redshift connection "master"
15:14:54.814463 [debug] [MainThread]: On master: BEGIN
15:14:55.102279 [debug] [MainThread]: SQL status: BEGIN in 0.28 seconds
15:14:55.106400 [debug] [MainThread]: On master: COMMIT
15:14:55.108459 [debug] [MainThread]: Using redshift connection "master"
15:14:55.111000 [debug] [MainThread]: On master: COMMIT
15:14:55.251807 [debug] [MainThread]: SQL status: COMMIT in 0.14 seconds
15:14:55.257326 [debug] [MainThread]: On master: Close
15:14:55.260710 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
15:14:55.263349 [info ] [MainThread]: 
15:14:55.280600 [debug] [Thread-1  ]: Began running node model.analytics_dbt.tb_vendas_primeiro_trimestre
15:14:55.287891 [info ] [Thread-1  ]: 1 of 1 START table model public.tb_vendas_primeiro_trimestre ................... [RUN]
15:14:55.295272 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.tb_vendas_primeiro_trimestre"
15:14:55.302526 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.tb_vendas_primeiro_trimestre
15:14:55.308141 [debug] [Thread-1  ]: Compiling model.analytics_dbt.tb_vendas_primeiro_trimestre
15:14:55.318167 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.tb_vendas_primeiro_trimestre"
15:14:55.334795 [debug] [Thread-1  ]: finished collecting timing info
15:14:55.341366 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.tb_vendas_primeiro_trimestre
15:14:55.422448 [debug] [Thread-1  ]: Writing runtime SQL for node "model.analytics_dbt.tb_vendas_primeiro_trimestre"
15:14:55.433988 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_vendas_primeiro_trimestre"
15:14:55.437300 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: BEGIN
15:14:55.442103 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:14:55.445372 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
15:14:56.746791 [debug] [Thread-1  ]: SQL status: BEGIN in 1.3 seconds
15:14:56.761272 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_vendas_primeiro_trimestre"
15:14:56.768793 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.tb_vendas_primeiro_trimestre"} */


  create  table
    "dev"."public"."tb_vendas_primeiro_trimestre__dbt_tmp"
    
    
    
  as (
    -- define o as variáveis meses e ano



-- cria a fonte com os dados de date e converte o  nome das colunas
with source_date as (
    select  dateid as id_date,
            month as mes,
            year as ano
    from date

),
-- cria uma fonte de dados unindo a tabela sales com date
sales_date as (

    select  source_date.mes, 
            sum(quantidade_vendida)
    from  "dev"."public"."vw_sales" sales inner join source_date
    on sales.id_date = source_date.id_date
    GROUP BY source_date.mes
    
    and source_date.mes = 'JAN'
    
    and source_date.mes = 'FEB'
    
    and source_date.mes = 'MAR'
    
    and source_date.ano = '2008'
    

)

select * from sales_date
  );
15:14:56.917836 [debug] [Thread-1  ]: Postgres adapter: Postgres error: argument of AND must be type boolean, not type character

15:14:56.921460 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: ROLLBACK
15:14:57.063425 [debug] [Thread-1  ]: finished collecting timing info
15:14:57.069623 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: Close
15:14:57.074065 [debug] [Thread-1  ]: Database Error in model tb_vendas_primeiro_trimestre (models/tables/tb_vendas_primeiro_trimestre.sql)
  argument of AND must be type boolean, not type character
  compiled SQL at target/run/analytics_dbt/models/tables/tb_vendas_primeiro_trimestre.sql
15:14:57.076408 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dc23ed45-aec7-45f7-ba79-ac2986b2ba27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50f4430bb0>]}
15:14:57.078724 [error] [Thread-1  ]: 1 of 1 ERROR creating table model public.tb_vendas_primeiro_trimestre .......... [[31mERROR[0m in 1.78s]
15:14:57.081724 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.tb_vendas_primeiro_trimestre
15:14:57.087515 [debug] [MainThread]: Acquiring new redshift connection "master"
15:14:57.092023 [debug] [MainThread]: Using redshift connection "master"
15:14:57.095497 [debug] [MainThread]: On master: BEGIN
15:14:57.099271 [debug] [MainThread]: Opening a new connection, currently in state closed
15:14:57.105180 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
15:14:58.417887 [debug] [MainThread]: SQL status: BEGIN in 1.32 seconds
15:14:58.424548 [debug] [MainThread]: On master: COMMIT
15:14:58.427139 [debug] [MainThread]: Using redshift connection "master"
15:14:58.429720 [debug] [MainThread]: On master: COMMIT
15:14:58.573791 [debug] [MainThread]: SQL status: COMMIT in 0.14 seconds
15:14:58.577290 [debug] [MainThread]: On master: Close
15:14:58.580752 [info ] [MainThread]: 
15:14:58.583630 [info ] [MainThread]: Finished running 1 table model in 8.52s.
15:14:58.588162 [debug] [MainThread]: Connection 'master' was properly closed.
15:14:58.594954 [debug] [MainThread]: Connection 'model.analytics_dbt.tb_vendas_primeiro_trimestre' was properly closed.
15:14:58.636218 [info ] [MainThread]: 
15:14:58.645275 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
15:14:58.648680 [info ] [MainThread]: 
15:14:58.652890 [error] [MainThread]: [33mDatabase Error in model tb_vendas_primeiro_trimestre (models/tables/tb_vendas_primeiro_trimestre.sql)[0m
15:14:58.661941 [error] [MainThread]:   argument of AND must be type boolean, not type character
15:14:58.666830 [error] [MainThread]:   compiled SQL at target/run/analytics_dbt/models/tables/tb_vendas_primeiro_trimestre.sql
15:14:58.680600 [info ] [MainThread]: 
15:14:58.687474 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
15:14:58.698377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50f4d4d070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50f4da5a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50f4c74e20>]}


============================== 2022-05-22 15:42:36.684453 | 592d7cd6-c6c5-4c54-8b96-6491a451d13f ==============================
15:42:36.684475 [info ] [MainThread]: Running with dbt=1.1.0
15:42:36.688074 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['models/tables/tb_vendas_primeiro_trimestre.sql'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
15:42:36.692828 [debug] [MainThread]: Tracking: tracking
15:42:36.719801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed1fc13730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed1fc137f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed1fc13820>]}
15:42:36.829274 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
15:42:36.832349 [debug] [MainThread]: Partial parsing: updated file: analytics_dbt://models/tables/tb_vendas_primeiro_trimestre.sql
15:42:36.860393 [debug] [MainThread]: 1603: static parser failed on tables/tb_vendas_primeiro_trimestre.sql
15:42:36.897160 [debug] [MainThread]: 1602: parser fallback to jinja rendering on tables/tb_vendas_primeiro_trimestre.sql
15:42:36.937860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '592d7cd6-c6c5-4c54-8b96-6491a451d13f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed1fac1a30>]}
15:42:36.970283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '592d7cd6-c6c5-4c54-8b96-6491a451d13f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed1fb5ee50>]}
15:42:36.974246 [info ] [MainThread]: Found 5 models, 4 tests, 0 snapshots, 0 analyses, 193 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
15:42:36.981419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '592d7cd6-c6c5-4c54-8b96-6491a451d13f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed1fc342e0>]}
15:42:36.996212 [info ] [MainThread]: 
15:42:37.003130 [debug] [MainThread]: Acquiring new redshift connection "master"
15:42:37.012081 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev"
15:42:37.051429 [debug] [ThreadPool]: Using redshift connection "list_dev"
15:42:37.054223 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
  
15:42:37.057156 [debug] [ThreadPool]: Opening a new connection, currently in state init
15:42:37.060225 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
15:42:38.410598 [debug] [ThreadPool]: SQL status: SELECT in 1.35 seconds
15:42:38.418614 [debug] [ThreadPool]: On list_dev: Close
15:42:38.424791 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev_public"
15:42:38.440496 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
15:42:38.443086 [debug] [ThreadPool]: On list_dev_public: BEGIN
15:42:38.445713 [debug] [ThreadPool]: Opening a new connection, currently in state closed
15:42:38.448076 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
15:42:39.776588 [debug] [ThreadPool]: SQL status: BEGIN in 1.33 seconds
15:42:39.782047 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
15:42:39.784896 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev_public"} */
select
      'dev' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dev' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
15:42:39.938134 [debug] [ThreadPool]: SQL status: SELECT in 0.15 seconds
15:42:39.943493 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
15:42:40.087338 [debug] [ThreadPool]: On list_dev_public: Close
15:42:40.101064 [debug] [MainThread]: Using redshift connection "master"
15:42:40.102789 [debug] [MainThread]: On master: BEGIN
15:42:40.105600 [debug] [MainThread]: Opening a new connection, currently in state init
15:42:40.108076 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
15:42:41.409951 [debug] [MainThread]: SQL status: BEGIN in 1.3 seconds
15:42:41.412297 [debug] [MainThread]: Using redshift connection "master"
15:42:41.414880 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
15:42:41.586687 [debug] [MainThread]: SQL status: SELECT in 0.17 seconds
15:42:41.595687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '592d7cd6-c6c5-4c54-8b96-6491a451d13f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed1fc30640>]}
15:42:41.598773 [debug] [MainThread]: On master: ROLLBACK
15:42:41.738327 [debug] [MainThread]: Using redshift connection "master"
15:42:41.742562 [debug] [MainThread]: On master: BEGIN
15:42:42.021564 [debug] [MainThread]: SQL status: BEGIN in 0.28 seconds
15:42:42.025015 [debug] [MainThread]: On master: COMMIT
15:42:42.027173 [debug] [MainThread]: Using redshift connection "master"
15:42:42.029357 [debug] [MainThread]: On master: COMMIT
15:42:42.175961 [debug] [MainThread]: SQL status: COMMIT in 0.14 seconds
15:42:42.178677 [debug] [MainThread]: On master: Close
15:42:42.182576 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
15:42:42.185464 [info ] [MainThread]: 
15:42:42.200971 [debug] [Thread-1  ]: Began running node model.analytics_dbt.tb_vendas_primeiro_trimestre
15:42:42.204304 [info ] [Thread-1  ]: 1 of 1 START table model public.tb_vendas_primeiro_trimestre ................... [RUN]
15:42:42.207724 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.tb_vendas_primeiro_trimestre"
15:42:42.215318 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.tb_vendas_primeiro_trimestre
15:42:42.221140 [debug] [Thread-1  ]: Compiling model.analytics_dbt.tb_vendas_primeiro_trimestre
15:42:42.252442 [debug] [Thread-1  ]: finished collecting timing info
15:42:42.256663 [debug] [Thread-1  ]: Compilation Error in model tb_vendas_primeiro_trimestre (models/tables/tb_vendas_primeiro_trimestre.sql)
  'filter_values' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
15:42:42.260315 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '592d7cd6-c6c5-4c54-8b96-6491a451d13f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed1da0bca0>]}
15:42:42.263003 [error] [Thread-1  ]: 1 of 1 ERROR creating table model public.tb_vendas_primeiro_trimestre .......... [[31mERROR[0m in 0.05s]
15:42:42.266863 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.tb_vendas_primeiro_trimestre
15:42:42.272730 [debug] [MainThread]: Acquiring new redshift connection "master"
15:42:42.276577 [debug] [MainThread]: Using redshift connection "master"
15:42:42.279866 [debug] [MainThread]: On master: BEGIN
15:42:42.287053 [debug] [MainThread]: Opening a new connection, currently in state closed
15:42:42.293800 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
15:42:43.601325 [debug] [MainThread]: SQL status: BEGIN in 1.31 seconds
15:42:43.606549 [debug] [MainThread]: On master: COMMIT
15:42:43.609906 [debug] [MainThread]: Using redshift connection "master"
15:42:43.613052 [debug] [MainThread]: On master: COMMIT
15:42:43.757283 [debug] [MainThread]: SQL status: COMMIT in 0.14 seconds
15:42:43.761649 [debug] [MainThread]: On master: Close
15:42:43.766965 [info ] [MainThread]: 
15:42:43.770184 [info ] [MainThread]: Finished running 1 table model in 6.76s.
15:42:43.774204 [debug] [MainThread]: Connection 'master' was properly closed.
15:42:43.782406 [debug] [MainThread]: Connection 'model.analytics_dbt.tb_vendas_primeiro_trimestre' was properly closed.
15:42:43.814859 [info ] [MainThread]: 
15:42:43.818845 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
15:42:43.823717 [info ] [MainThread]: 
15:42:43.828219 [error] [MainThread]: [33mCompilation Error in model tb_vendas_primeiro_trimestre (models/tables/tb_vendas_primeiro_trimestre.sql)[0m
15:42:43.838493 [error] [MainThread]:   'filter_values' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
15:42:43.842497 [info ] [MainThread]: 
15:42:43.851363 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
15:42:43.858135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed1fba08e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed1fba0e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed1fa72f40>]}


============================== 2022-05-22 15:48:46.188208 | 4c4b6cd1-2ced-49df-8cfd-5bcccd3639a7 ==============================
15:48:46.188232 [info ] [MainThread]: Running with dbt=1.1.0
15:48:46.192407 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['models/tables/tb_vendas_primeiro_trimestre.sql'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
15:48:46.197090 [debug] [MainThread]: Tracking: tracking
15:48:46.223997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ce7f616a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ce7f61760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ce7f61790>]}
15:48:46.329819 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
15:48:46.333737 [debug] [MainThread]: Partial parsing: updated file: analytics_dbt://models/tables/tb_vendas_primeiro_trimestre.sql
15:48:46.366998 [debug] [MainThread]: 1603: static parser failed on tables/tb_vendas_primeiro_trimestre.sql
15:48:46.404156 [debug] [MainThread]: 1602: parser fallback to jinja rendering on tables/tb_vendas_primeiro_trimestre.sql
15:48:46.434902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4c4b6cd1-2ced-49df-8cfd-5bcccd3639a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ce7e09940>]}
15:48:46.482087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4c4b6cd1-2ced-49df-8cfd-5bcccd3639a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ce7ea9f10>]}
15:48:46.486097 [info ] [MainThread]: Found 5 models, 4 tests, 0 snapshots, 0 analyses, 193 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
15:48:46.491351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4c4b6cd1-2ced-49df-8cfd-5bcccd3639a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ce7ee5f70>]}
15:48:46.499096 [info ] [MainThread]: 
15:48:46.507140 [debug] [MainThread]: Acquiring new redshift connection "master"
15:48:46.516299 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev"
15:48:46.554642 [debug] [ThreadPool]: Using redshift connection "list_dev"
15:48:46.557831 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
  
15:48:46.562667 [debug] [ThreadPool]: Opening a new connection, currently in state init
15:48:46.566227 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
15:48:47.891610 [debug] [ThreadPool]: SQL status: SELECT in 1.33 seconds
15:48:47.896530 [debug] [ThreadPool]: On list_dev: Close
15:48:47.903678 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev_public"
15:48:47.921724 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
15:48:47.925412 [debug] [ThreadPool]: On list_dev_public: BEGIN
15:48:47.928424 [debug] [ThreadPool]: Opening a new connection, currently in state init
15:48:47.931111 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
15:48:49.234862 [debug] [ThreadPool]: SQL status: BEGIN in 1.31 seconds
15:48:49.239537 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
15:48:49.243146 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev_public"} */
select
      'dev' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dev' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
15:48:49.395595 [debug] [ThreadPool]: SQL status: SELECT in 0.15 seconds
15:48:49.404908 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
15:48:49.546988 [debug] [ThreadPool]: On list_dev_public: Close
15:48:49.558751 [debug] [MainThread]: Using redshift connection "master"
15:48:49.560678 [debug] [MainThread]: On master: BEGIN
15:48:49.563107 [debug] [MainThread]: Opening a new connection, currently in state init
15:48:49.565512 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
15:48:50.891449 [debug] [MainThread]: SQL status: BEGIN in 1.33 seconds
15:48:50.893980 [debug] [MainThread]: Using redshift connection "master"
15:48:50.896313 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
15:48:51.071762 [debug] [MainThread]: SQL status: SELECT in 0.17 seconds
15:48:51.077249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4c4b6cd1-2ced-49df-8cfd-5bcccd3639a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ce7e940d0>]}
15:48:51.080413 [debug] [MainThread]: On master: ROLLBACK
15:48:51.222816 [debug] [MainThread]: Using redshift connection "master"
15:48:51.225333 [debug] [MainThread]: On master: BEGIN
15:48:51.522720 [debug] [MainThread]: SQL status: BEGIN in 0.29 seconds
15:48:51.525519 [debug] [MainThread]: On master: COMMIT
15:48:51.528044 [debug] [MainThread]: Using redshift connection "master"
15:48:51.530779 [debug] [MainThread]: On master: COMMIT
15:48:51.675520 [debug] [MainThread]: SQL status: COMMIT in 0.14 seconds
15:48:51.679959 [debug] [MainThread]: On master: Close
15:48:51.684494 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
15:48:51.687927 [info ] [MainThread]: 
15:48:51.708961 [debug] [Thread-1  ]: Began running node model.analytics_dbt.tb_vendas_primeiro_trimestre
15:48:51.713239 [info ] [Thread-1  ]: 1 of 1 START table model public.tb_vendas_primeiro_trimestre ................... [RUN]
15:48:51.715728 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.tb_vendas_primeiro_trimestre"
15:48:51.719748 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.tb_vendas_primeiro_trimestre
15:48:51.723018 [debug] [Thread-1  ]: Compiling model.analytics_dbt.tb_vendas_primeiro_trimestre
15:48:51.737914 [debug] [Thread-1  ]: finished collecting timing info
15:48:51.740956 [debug] [Thread-1  ]: Compilation Error in model tb_vendas_primeiro_trimestre (models/tables/tb_vendas_primeiro_trimestre.sql)
  'filter_values' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
15:48:51.745312 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c4b6cd1-2ced-49df-8cfd-5bcccd3639a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ce5d57f40>]}
15:48:51.748057 [error] [Thread-1  ]: 1 of 1 ERROR creating table model public.tb_vendas_primeiro_trimestre .......... [[31mERROR[0m in 0.03s]
15:48:51.751951 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.tb_vendas_primeiro_trimestre
15:48:51.760156 [debug] [MainThread]: Acquiring new redshift connection "master"
15:48:51.764414 [debug] [MainThread]: Using redshift connection "master"
15:48:51.767051 [debug] [MainThread]: On master: BEGIN
15:48:51.769627 [debug] [MainThread]: Opening a new connection, currently in state closed
15:48:51.772746 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
15:48:53.050796 [debug] [MainThread]: SQL status: BEGIN in 1.28 seconds
15:48:53.054947 [debug] [MainThread]: On master: COMMIT
15:48:53.057253 [debug] [MainThread]: Using redshift connection "master"
15:48:53.060224 [debug] [MainThread]: On master: COMMIT
15:48:53.200121 [debug] [MainThread]: SQL status: COMMIT in 0.14 seconds
15:48:53.204433 [debug] [MainThread]: On master: Close
15:48:53.209951 [info ] [MainThread]: 
15:48:53.213185 [info ] [MainThread]: Finished running 1 table model in 6.70s.
15:48:53.217385 [debug] [MainThread]: Connection 'master' was properly closed.
15:48:53.223746 [debug] [MainThread]: Connection 'list_dev' was properly closed.
15:48:53.228052 [debug] [MainThread]: Connection 'model.analytics_dbt.tb_vendas_primeiro_trimestre' was properly closed.
15:48:53.260270 [info ] [MainThread]: 
15:48:53.265607 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
15:48:53.273358 [info ] [MainThread]: 
15:48:53.284676 [error] [MainThread]: [33mCompilation Error in model tb_vendas_primeiro_trimestre (models/tables/tb_vendas_primeiro_trimestre.sql)[0m
15:48:53.288887 [error] [MainThread]:   'filter_values' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
15:48:53.298290 [info ] [MainThread]: 
15:48:53.306660 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
15:48:53.315245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ce7f84340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ce7dbed60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ce7dbee50>]}


============================== 2022-05-22 15:49:20.080391 | 3a137439-2332-44b1-a964-6baed1307d14 ==============================
15:49:20.080574 [info ] [MainThread]: Running with dbt=1.1.0
15:49:20.092612 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['models/tables/tb_vendas_primeiro_trimestre.sql'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
15:49:20.100466 [debug] [MainThread]: Tracking: tracking
15:49:20.136055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6b259c730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6b259c7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6b259c820>]}
15:49:20.291510 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
15:49:20.295041 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
15:49:20.310725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3a137439-2332-44b1-a964-6baed1307d14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6b24c96d0>]}
15:49:20.363503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3a137439-2332-44b1-a964-6baed1307d14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6b24d4250>]}
15:49:20.368137 [info ] [MainThread]: Found 5 models, 4 tests, 0 snapshots, 0 analyses, 193 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
15:49:20.371313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3a137439-2332-44b1-a964-6baed1307d14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6b24d41f0>]}
15:49:20.379193 [info ] [MainThread]: 
15:49:20.391339 [debug] [MainThread]: Acquiring new redshift connection "master"
15:49:20.396450 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev"
15:49:20.445071 [debug] [ThreadPool]: Using redshift connection "list_dev"
15:49:20.449271 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
  
15:49:20.452579 [debug] [ThreadPool]: Opening a new connection, currently in state init
15:49:20.458105 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
15:49:21.746335 [debug] [ThreadPool]: SQL status: SELECT in 1.29 seconds
15:49:21.752767 [debug] [ThreadPool]: On list_dev: Close
15:49:21.758035 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev_public"
15:49:21.772668 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
15:49:21.774998 [debug] [ThreadPool]: On list_dev_public: BEGIN
15:49:21.776950 [debug] [ThreadPool]: Opening a new connection, currently in state closed
15:49:21.779113 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
15:49:23.083012 [debug] [ThreadPool]: SQL status: BEGIN in 1.31 seconds
15:49:23.087468 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
15:49:23.091498 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev_public"} */
select
      'dev' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dev' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
15:49:23.243516 [debug] [ThreadPool]: SQL status: SELECT in 0.15 seconds
15:49:23.252349 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
15:49:23.397199 [debug] [ThreadPool]: On list_dev_public: Close
15:49:23.413720 [debug] [MainThread]: Using redshift connection "master"
15:49:23.416337 [debug] [MainThread]: On master: BEGIN
15:49:23.418479 [debug] [MainThread]: Opening a new connection, currently in state init
15:49:23.420822 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
15:49:24.762072 [debug] [MainThread]: SQL status: BEGIN in 1.34 seconds
15:49:24.767254 [debug] [MainThread]: Using redshift connection "master"
15:49:24.772355 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
15:49:24.981976 [debug] [MainThread]: SQL status: SELECT in 0.2 seconds
15:49:24.991079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3a137439-2332-44b1-a964-6baed1307d14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6b25b9e50>]}
15:49:24.994248 [debug] [MainThread]: On master: ROLLBACK
15:49:25.138500 [debug] [MainThread]: Using redshift connection "master"
15:49:25.143105 [debug] [MainThread]: On master: BEGIN
15:49:25.437651 [debug] [MainThread]: SQL status: BEGIN in 0.29 seconds
15:49:25.442635 [debug] [MainThread]: On master: COMMIT
15:49:25.446402 [debug] [MainThread]: Using redshift connection "master"
15:49:25.449609 [debug] [MainThread]: On master: COMMIT
15:49:25.600193 [debug] [MainThread]: SQL status: COMMIT in 0.15 seconds
15:49:25.605040 [debug] [MainThread]: On master: Close
15:49:25.610504 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
15:49:25.614125 [info ] [MainThread]: 
15:49:25.628552 [debug] [Thread-1  ]: Began running node model.analytics_dbt.tb_vendas_primeiro_trimestre
15:49:25.633796 [info ] [Thread-1  ]: 1 of 1 START table model public.tb_vendas_primeiro_trimestre ................... [RUN]
15:49:25.640801 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.tb_vendas_primeiro_trimestre"
15:49:25.648850 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.tb_vendas_primeiro_trimestre
15:49:25.652495 [debug] [Thread-1  ]: Compiling model.analytics_dbt.tb_vendas_primeiro_trimestre
15:49:25.664279 [debug] [Thread-1  ]: finished collecting timing info
15:49:25.668527 [debug] [Thread-1  ]: Compilation Error in model tb_vendas_primeiro_trimestre (models/tables/tb_vendas_primeiro_trimestre.sql)
  'filter_values' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
15:49:25.672195 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3a137439-2332-44b1-a964-6baed1307d14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6b1bf17c0>]}
15:49:25.676279 [error] [Thread-1  ]: 1 of 1 ERROR creating table model public.tb_vendas_primeiro_trimestre .......... [[31mERROR[0m in 0.03s]
15:49:25.681930 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.tb_vendas_primeiro_trimestre
15:49:25.690523 [debug] [MainThread]: Acquiring new redshift connection "master"
15:49:25.695555 [debug] [MainThread]: Using redshift connection "master"
15:49:25.699655 [debug] [MainThread]: On master: BEGIN
15:49:25.703275 [debug] [MainThread]: Opening a new connection, currently in state closed
15:49:25.706755 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
15:49:27.008622 [debug] [MainThread]: SQL status: BEGIN in 1.31 seconds
15:49:27.013585 [debug] [MainThread]: On master: COMMIT
15:49:27.019212 [debug] [MainThread]: Using redshift connection "master"
15:49:27.023140 [debug] [MainThread]: On master: COMMIT
15:49:27.144998 [debug] [MainThread]: SQL status: COMMIT in 0.12 seconds
15:49:27.148690 [debug] [MainThread]: On master: Close
15:49:27.154516 [info ] [MainThread]: 
15:49:27.158195 [info ] [MainThread]: Finished running 1 table model in 6.77s.
15:49:27.161638 [debug] [MainThread]: Connection 'master' was properly closed.
15:49:27.169843 [debug] [MainThread]: Connection 'model.analytics_dbt.tb_vendas_primeiro_trimestre' was properly closed.
15:49:27.210728 [info ] [MainThread]: 
15:49:27.214364 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
15:49:27.219634 [info ] [MainThread]: 
15:49:27.226387 [error] [MainThread]: [33mCompilation Error in model tb_vendas_primeiro_trimestre (models/tables/tb_vendas_primeiro_trimestre.sql)[0m
15:49:27.231943 [error] [MainThread]:   'filter_values' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
15:49:27.237921 [info ] [MainThread]: 
15:49:27.243590 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
15:49:27.251629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6b1c3d3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6b1c3d0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6b1c3d310>]}


============================== 2022-05-22 15:50:15.385292 | 437bb24c-9da9-40c2-9dbe-8b0a8f916b5c ==============================
15:50:15.385312 [info ] [MainThread]: Running with dbt=1.1.0
15:50:15.389377 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['models/tables/tb_vendas_primeiro_trimestre.sql'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
15:50:15.395481 [debug] [MainThread]: Tracking: tracking
15:50:15.421218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f767261b790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f767261b850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f767261b880>]}
15:50:15.539433 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
15:50:15.542716 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
15:50:15.561002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '437bb24c-9da9-40c2-9dbe-8b0a8f916b5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76725456d0>]}
15:50:15.599796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '437bb24c-9da9-40c2-9dbe-8b0a8f916b5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f767254e250>]}
15:50:15.603785 [info ] [MainThread]: Found 5 models, 4 tests, 0 snapshots, 0 analyses, 193 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
15:50:15.606125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '437bb24c-9da9-40c2-9dbe-8b0a8f916b5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f767254e1f0>]}
15:50:15.619893 [info ] [MainThread]: 
15:50:15.623325 [debug] [MainThread]: Acquiring new redshift connection "master"
15:50:15.632218 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev"
15:50:15.666219 [debug] [ThreadPool]: Using redshift connection "list_dev"
15:50:15.670992 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
  
15:50:15.673643 [debug] [ThreadPool]: Opening a new connection, currently in state init
15:50:15.676668 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
15:50:16.990434 [debug] [ThreadPool]: SQL status: SELECT in 1.32 seconds
15:50:16.999566 [debug] [ThreadPool]: On list_dev: Close
15:50:17.004623 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev_public"
15:50:17.020562 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
15:50:17.022806 [debug] [ThreadPool]: On list_dev_public: BEGIN
15:50:17.025571 [debug] [ThreadPool]: Opening a new connection, currently in state closed
15:50:17.027680 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
15:50:18.342321 [debug] [ThreadPool]: SQL status: BEGIN in 1.32 seconds
15:50:18.346515 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
15:50:18.350560 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev_public"} */
select
      'dev' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dev' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
15:50:18.506766 [debug] [ThreadPool]: SQL status: SELECT in 0.15 seconds
15:50:18.516246 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
15:50:18.662279 [debug] [ThreadPool]: On list_dev_public: Close
15:50:18.680049 [debug] [MainThread]: Using redshift connection "master"
15:50:18.682684 [debug] [MainThread]: On master: BEGIN
15:50:18.684801 [debug] [MainThread]: Opening a new connection, currently in state init
15:50:18.687153 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
15:50:19.973049 [debug] [MainThread]: SQL status: BEGIN in 1.29 seconds
15:50:19.977244 [debug] [MainThread]: Using redshift connection "master"
15:50:19.981736 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
15:50:20.158735 [debug] [MainThread]: SQL status: SELECT in 0.17 seconds
15:50:20.166462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '437bb24c-9da9-40c2-9dbe-8b0a8f916b5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7672634f70>]}
15:50:20.170329 [debug] [MainThread]: On master: ROLLBACK
15:50:20.313223 [debug] [MainThread]: Using redshift connection "master"
15:50:20.317567 [debug] [MainThread]: On master: BEGIN
15:50:20.618909 [debug] [MainThread]: SQL status: BEGIN in 0.3 seconds
15:50:20.624804 [debug] [MainThread]: On master: COMMIT
15:50:20.628509 [debug] [MainThread]: Using redshift connection "master"
15:50:20.631368 [debug] [MainThread]: On master: COMMIT
15:50:20.773725 [debug] [MainThread]: SQL status: COMMIT in 0.14 seconds
15:50:20.777569 [debug] [MainThread]: On master: Close
15:50:20.781788 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
15:50:20.788480 [info ] [MainThread]: 
15:50:20.810446 [debug] [Thread-1  ]: Began running node model.analytics_dbt.tb_vendas_primeiro_trimestre
15:50:20.821726 [info ] [Thread-1  ]: 1 of 1 START table model public.tb_vendas_primeiro_trimestre ................... [RUN]
15:50:20.830427 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.tb_vendas_primeiro_trimestre"
15:50:20.836827 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.tb_vendas_primeiro_trimestre
15:50:20.841231 [debug] [Thread-1  ]: Compiling model.analytics_dbt.tb_vendas_primeiro_trimestre
15:50:20.862936 [debug] [Thread-1  ]: finished collecting timing info
15:50:20.866255 [debug] [Thread-1  ]: Compilation Error in model tb_vendas_primeiro_trimestre (models/tables/tb_vendas_primeiro_trimestre.sql)
  'filter_values' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
15:50:20.870286 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '437bb24c-9da9-40c2-9dbe-8b0a8f916b5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7671c6c7c0>]}
15:50:20.873429 [error] [Thread-1  ]: 1 of 1 ERROR creating table model public.tb_vendas_primeiro_trimestre .......... [[31mERROR[0m in 0.04s]
15:50:20.878204 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.tb_vendas_primeiro_trimestre
15:50:20.887282 [debug] [MainThread]: Acquiring new redshift connection "master"
15:50:20.891979 [debug] [MainThread]: Using redshift connection "master"
15:50:20.895834 [debug] [MainThread]: On master: BEGIN
15:50:20.898629 [debug] [MainThread]: Opening a new connection, currently in state closed
15:50:20.903043 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
15:50:22.190465 [debug] [MainThread]: SQL status: BEGIN in 1.29 seconds
15:50:22.194651 [debug] [MainThread]: On master: COMMIT
15:50:22.199014 [debug] [MainThread]: Using redshift connection "master"
15:50:22.202408 [debug] [MainThread]: On master: COMMIT
15:50:22.345413 [debug] [MainThread]: SQL status: COMMIT in 0.14 seconds
15:50:22.350073 [debug] [MainThread]: On master: Close
15:50:22.357244 [info ] [MainThread]: 
15:50:22.360755 [info ] [MainThread]: Finished running 1 table model in 6.73s.
15:50:22.364747 [debug] [MainThread]: Connection 'master' was properly closed.
15:50:22.370912 [debug] [MainThread]: Connection 'model.analytics_dbt.tb_vendas_primeiro_trimestre' was properly closed.
15:50:22.405081 [info ] [MainThread]: 
15:50:22.409319 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
15:50:22.415373 [info ] [MainThread]: 
15:50:22.426040 [error] [MainThread]: [33mCompilation Error in model tb_vendas_primeiro_trimestre (models/tables/tb_vendas_primeiro_trimestre.sql)[0m
15:50:22.430108 [error] [MainThread]:   'filter_values' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
15:50:22.440720 [info ] [MainThread]: 
15:50:22.447004 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
15:50:22.457689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7671cb8100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7671cb83d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7671cb80a0>]}


============================== 2022-05-22 15:51:35.521187 | 9354a699-69d6-449b-b50e-ff828dccd452 ==============================
15:51:35.521218 [info ] [MainThread]: Running with dbt=1.1.0
15:51:35.524482 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['models/tables/tb_vendas_primeiro_trimestre.sql'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
15:51:35.528350 [debug] [MainThread]: Tracking: tracking
15:51:35.553708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf2970d7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf2970d880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf2970d8b0>]}
15:51:35.653369 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
15:51:35.656081 [debug] [MainThread]: Partial parsing: updated file: analytics_dbt://models/tables/tb_vendas_primeiro_trimestre.sql
15:51:35.679842 [debug] [MainThread]: 1603: static parser failed on tables/tb_vendas_primeiro_trimestre.sql
15:51:35.711916 [debug] [MainThread]: 1602: parser fallback to jinja rendering on tables/tb_vendas_primeiro_trimestre.sql
15:51:35.738171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9354a699-69d6-449b-b50e-ff828dccd452', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf295bdac0>]}
15:51:35.764831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9354a699-69d6-449b-b50e-ff828dccd452', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf296fe820>]}
15:51:35.768582 [info ] [MainThread]: Found 5 models, 4 tests, 0 snapshots, 0 analyses, 193 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
15:51:35.772969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9354a699-69d6-449b-b50e-ff828dccd452', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf2972d4c0>]}
15:51:35.785357 [info ] [MainThread]: 
15:51:35.790240 [debug] [MainThread]: Acquiring new redshift connection "master"
15:51:35.799900 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev"
15:51:35.836923 [debug] [ThreadPool]: Using redshift connection "list_dev"
15:51:35.839326 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
  
15:51:35.842247 [debug] [ThreadPool]: Opening a new connection, currently in state init
15:51:35.845012 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
15:51:37.176017 [debug] [ThreadPool]: SQL status: SELECT in 1.33 seconds
15:51:37.185272 [debug] [ThreadPool]: On list_dev: Close
15:51:37.192633 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev_public"
15:51:37.208621 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
15:51:37.211230 [debug] [ThreadPool]: On list_dev_public: BEGIN
15:51:37.213369 [debug] [ThreadPool]: Opening a new connection, currently in state init
15:51:37.215894 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
15:51:38.522622 [debug] [ThreadPool]: SQL status: BEGIN in 1.31 seconds
15:51:38.528395 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
15:51:38.532735 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev_public"} */
select
      'dev' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dev' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
15:51:38.691676 [debug] [ThreadPool]: SQL status: SELECT in 0.16 seconds
15:51:38.698955 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
15:51:38.844078 [debug] [ThreadPool]: On list_dev_public: Close
15:51:38.862412 [debug] [MainThread]: Using redshift connection "master"
15:51:38.864507 [debug] [MainThread]: On master: BEGIN
15:51:38.866632 [debug] [MainThread]: Opening a new connection, currently in state init
15:51:38.868944 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
15:51:40.144075 [debug] [MainThread]: SQL status: BEGIN in 1.28 seconds
15:51:40.148257 [debug] [MainThread]: Using redshift connection "master"
15:51:40.152273 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
15:51:40.326154 [debug] [MainThread]: SQL status: SELECT in 0.17 seconds
15:51:40.334956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9354a699-69d6-449b-b50e-ff828dccd452', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf296fe6a0>]}
15:51:40.338010 [debug] [MainThread]: On master: ROLLBACK
15:51:40.477653 [debug] [MainThread]: Using redshift connection "master"
15:51:40.483384 [debug] [MainThread]: On master: BEGIN
15:51:40.766964 [debug] [MainThread]: SQL status: BEGIN in 0.28 seconds
15:51:40.771524 [debug] [MainThread]: On master: COMMIT
15:51:40.775528 [debug] [MainThread]: Using redshift connection "master"
15:51:40.778636 [debug] [MainThread]: On master: COMMIT
15:51:40.918757 [debug] [MainThread]: SQL status: COMMIT in 0.14 seconds
15:51:40.923514 [debug] [MainThread]: On master: Close
15:51:40.929485 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
15:51:40.933433 [info ] [MainThread]: 
15:51:40.950314 [debug] [Thread-1  ]: Began running node model.analytics_dbt.tb_vendas_primeiro_trimestre
15:51:40.957079 [info ] [Thread-1  ]: 1 of 1 START table model public.tb_vendas_primeiro_trimestre ................... [RUN]
15:51:40.963854 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.tb_vendas_primeiro_trimestre"
15:51:40.967640 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.tb_vendas_primeiro_trimestre
15:51:40.973777 [debug] [Thread-1  ]: Compiling model.analytics_dbt.tb_vendas_primeiro_trimestre
15:51:40.990804 [debug] [Thread-1  ]: finished collecting timing info
15:51:40.994228 [debug] [Thread-1  ]: Compilation Error in model tb_vendas_primeiro_trimestre (models/tables/tb_vendas_primeiro_trimestre.sql)
  'filter_values' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
15:51:40.998476 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9354a699-69d6-449b-b50e-ff828dccd452', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf285100d0>]}
15:51:41.002306 [error] [Thread-1  ]: 1 of 1 ERROR creating table model public.tb_vendas_primeiro_trimestre .......... [[31mERROR[0m in 0.04s]
15:51:41.007461 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.tb_vendas_primeiro_trimestre
15:51:41.014065 [debug] [MainThread]: Acquiring new redshift connection "master"
15:51:41.018880 [debug] [MainThread]: Using redshift connection "master"
15:51:41.022057 [debug] [MainThread]: On master: BEGIN
15:51:41.024003 [debug] [MainThread]: Opening a new connection, currently in state closed
15:51:41.026184 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
15:51:42.332963 [debug] [MainThread]: SQL status: BEGIN in 1.31 seconds
15:51:42.337965 [debug] [MainThread]: On master: COMMIT
15:51:42.341570 [debug] [MainThread]: Using redshift connection "master"
15:51:42.346222 [debug] [MainThread]: On master: COMMIT
15:51:42.489103 [debug] [MainThread]: SQL status: COMMIT in 0.14 seconds
15:51:42.494200 [debug] [MainThread]: On master: Close
15:51:42.500022 [info ] [MainThread]: 
15:51:42.504762 [info ] [MainThread]: Finished running 1 table model in 6.71s.
15:51:42.510609 [debug] [MainThread]: Connection 'master' was properly closed.
15:51:42.516157 [debug] [MainThread]: Connection 'list_dev' was properly closed.
15:51:42.522046 [debug] [MainThread]: Connection 'model.analytics_dbt.tb_vendas_primeiro_trimestre' was properly closed.
15:51:42.549347 [info ] [MainThread]: 
15:51:42.553609 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
15:51:42.558571 [info ] [MainThread]: 
15:51:42.566296 [error] [MainThread]: [33mCompilation Error in model tb_vendas_primeiro_trimestre (models/tables/tb_vendas_primeiro_trimestre.sql)[0m
15:51:42.575723 [error] [MainThread]:   'filter_values' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
15:51:42.581414 [info ] [MainThread]: 
15:51:42.585569 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
15:51:42.595257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf2956d9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf2956dd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf2956dd30>]}


============================== 2022-05-22 15:53:28.934276 | 53b65667-8b4e-4b1a-b14c-9caa539e7dbc ==============================
15:53:28.934303 [info ] [MainThread]: Running with dbt=1.1.0
15:53:28.936901 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['models/tables/tb_vendas_primeiro_trimestre.sql'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
15:53:28.940880 [debug] [MainThread]: Tracking: tracking
15:53:28.968140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3172107f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3172108b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3172108e0>]}
15:53:29.087681 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
15:53:29.091685 [debug] [MainThread]: Partial parsing: updated file: analytics_dbt://models/tables/tb_vendas_primeiro_trimestre.sql
15:53:29.117609 [debug] [MainThread]: 1603: static parser failed on tables/tb_vendas_primeiro_trimestre.sql
15:53:29.150968 [debug] [MainThread]: 1602: parser fallback to jinja rendering on tables/tb_vendas_primeiro_trimestre.sql
15:53:29.189372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '53b65667-8b4e-4b1a-b14c-9caa539e7dbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3170baac0>]}
15:53:29.218838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '53b65667-8b4e-4b1a-b14c-9caa539e7dbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3171f9850>]}
15:53:29.224081 [info ] [MainThread]: Found 5 models, 4 tests, 0 snapshots, 0 analyses, 193 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
15:53:29.228670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '53b65667-8b4e-4b1a-b14c-9caa539e7dbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3172304f0>]}
15:53:29.248375 [info ] [MainThread]: 
15:53:29.255648 [debug] [MainThread]: Acquiring new redshift connection "master"
15:53:29.262563 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev"
15:53:29.303647 [debug] [ThreadPool]: Using redshift connection "list_dev"
15:53:29.306596 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
  
15:53:29.309606 [debug] [ThreadPool]: Opening a new connection, currently in state init
15:53:29.313358 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
15:53:30.649000 [debug] [ThreadPool]: SQL status: SELECT in 1.34 seconds
15:53:30.657313 [debug] [ThreadPool]: On list_dev: Close
15:53:30.662880 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev_public"
15:53:30.680372 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
15:53:30.682847 [debug] [ThreadPool]: On list_dev_public: BEGIN
15:53:30.684987 [debug] [ThreadPool]: Opening a new connection, currently in state init
15:53:30.687537 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
15:53:31.984965 [debug] [ThreadPool]: SQL status: BEGIN in 1.3 seconds
15:53:31.990113 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
15:53:31.993952 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev_public"} */
select
      'dev' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dev' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
15:53:32.149202 [debug] [ThreadPool]: SQL status: SELECT in 0.15 seconds
15:53:32.158979 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
15:53:32.302444 [debug] [ThreadPool]: On list_dev_public: Close
15:53:32.317090 [debug] [MainThread]: Using redshift connection "master"
15:53:32.319348 [debug] [MainThread]: On master: BEGIN
15:53:32.321608 [debug] [MainThread]: Opening a new connection, currently in state init
15:53:32.324143 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
15:53:33.671514 [debug] [MainThread]: SQL status: BEGIN in 1.35 seconds
15:53:33.676097 [debug] [MainThread]: Using redshift connection "master"
15:53:33.680169 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
15:53:33.860332 [debug] [MainThread]: SQL status: SELECT in 0.18 seconds
15:53:33.868456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '53b65667-8b4e-4b1a-b14c-9caa539e7dbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3171f9af0>]}
15:53:33.872318 [debug] [MainThread]: On master: ROLLBACK
15:53:34.012047 [debug] [MainThread]: Using redshift connection "master"
15:53:34.017389 [debug] [MainThread]: On master: BEGIN
15:53:34.296131 [debug] [MainThread]: SQL status: BEGIN in 0.27 seconds
15:53:34.300944 [debug] [MainThread]: On master: COMMIT
15:53:34.306832 [debug] [MainThread]: Using redshift connection "master"
15:53:34.310102 [debug] [MainThread]: On master: COMMIT
15:53:34.449027 [debug] [MainThread]: SQL status: COMMIT in 0.14 seconds
15:53:34.453937 [debug] [MainThread]: On master: Close
15:53:34.458116 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
15:53:34.460597 [info ] [MainThread]: 
15:53:34.475473 [debug] [Thread-1  ]: Began running node model.analytics_dbt.tb_vendas_primeiro_trimestre
15:53:34.478259 [info ] [Thread-1  ]: 1 of 1 START table model public.tb_vendas_primeiro_trimestre ................... [RUN]
15:53:34.481121 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.tb_vendas_primeiro_trimestre"
15:53:34.487293 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.tb_vendas_primeiro_trimestre
15:53:34.493114 [debug] [Thread-1  ]: Compiling model.analytics_dbt.tb_vendas_primeiro_trimestre
15:53:34.505309 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.tb_vendas_primeiro_trimestre"
15:53:34.523059 [debug] [Thread-1  ]: finished collecting timing info
15:53:34.525872 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.tb_vendas_primeiro_trimestre
15:53:34.592495 [debug] [Thread-1  ]: Writing runtime SQL for node "model.analytics_dbt.tb_vendas_primeiro_trimestre"
15:53:34.605589 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_vendas_primeiro_trimestre"
15:53:34.607706 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: BEGIN
15:53:34.610008 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:53:34.613301 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
15:53:35.914610 [debug] [Thread-1  ]: SQL status: BEGIN in 1.3 seconds
15:53:35.918441 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_vendas_primeiro_trimestre"
15:53:35.923091 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.tb_vendas_primeiro_trimestre"} */


  create  table
    "dev"."public"."tb_vendas_primeiro_trimestre__dbt_tmp"
    
    
    
  as (
    -- define o as variáveis meses e ano



-- cria a fonte com os dados de date e converte o  nome das colunas
with source_date as (
    select  dateid as id_date,
            month as mes,
            year as ano
    from date

),
-- cria uma fonte de dados unindo a tabela sales com date
sales_date as (

    select  source_date.mes, 
            sum(quantidade_vendida)
    from  "dev"."public"."vw_sales" sales inner join source_date
    on sales.id_date = source_date.id_date
    where source_date in (meses)
    group by source_date.mes
    and source_date.ano = '2008'
)
select * from sales_date
  );
15:53:36.071400 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "source_date" does not exist in sales, source_date, unnamed_join

15:53:36.076688 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: ROLLBACK
15:53:36.222671 [debug] [Thread-1  ]: finished collecting timing info
15:53:36.227909 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: Close
15:53:36.232111 [debug] [Thread-1  ]: Database Error in model tb_vendas_primeiro_trimestre (models/tables/tb_vendas_primeiro_trimestre.sql)
  column "source_date" does not exist in sales, source_date, unnamed_join
  compiled SQL at target/run/analytics_dbt/models/tables/tb_vendas_primeiro_trimestre.sql
15:53:36.236251 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '53b65667-8b4e-4b1a-b14c-9caa539e7dbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3150299a0>]}
15:53:36.238806 [error] [Thread-1  ]: 1 of 1 ERROR creating table model public.tb_vendas_primeiro_trimestre .......... [[31mERROR[0m in 1.76s]
15:53:36.241996 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.tb_vendas_primeiro_trimestre
15:53:36.248631 [debug] [MainThread]: Acquiring new redshift connection "master"
15:53:36.252473 [debug] [MainThread]: Using redshift connection "master"
15:53:36.257085 [debug] [MainThread]: On master: BEGIN
15:53:36.260118 [debug] [MainThread]: Opening a new connection, currently in state closed
15:53:36.262136 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
15:53:37.568896 [debug] [MainThread]: SQL status: BEGIN in 1.31 seconds
15:53:37.573802 [debug] [MainThread]: On master: COMMIT
15:53:37.576062 [debug] [MainThread]: Using redshift connection "master"
15:53:37.578696 [debug] [MainThread]: On master: COMMIT
15:53:37.727013 [debug] [MainThread]: SQL status: COMMIT in 0.15 seconds
15:53:37.732902 [debug] [MainThread]: On master: Close
15:53:37.744827 [info ] [MainThread]: 
15:53:37.758029 [info ] [MainThread]: Finished running 1 table model in 8.49s.
15:53:37.765792 [debug] [MainThread]: Connection 'master' was properly closed.
15:53:37.814270 [debug] [MainThread]: Connection 'list_dev' was properly closed.
15:53:37.847246 [debug] [MainThread]: Connection 'model.analytics_dbt.tb_vendas_primeiro_trimestre' was properly closed.
15:53:37.930078 [info ] [MainThread]: 
15:53:37.937145 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
15:53:37.943152 [info ] [MainThread]: 
15:53:37.948417 [error] [MainThread]: [33mDatabase Error in model tb_vendas_primeiro_trimestre (models/tables/tb_vendas_primeiro_trimestre.sql)[0m
15:53:37.955471 [error] [MainThread]:   column "source_date" does not exist in sales, source_date, unnamed_join
15:53:37.966207 [error] [MainThread]:   compiled SQL at target/run/analytics_dbt/models/tables/tb_vendas_primeiro_trimestre.sql
15:53:37.980660 [info ] [MainThread]: 
15:53:37.997330 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
15:53:38.007649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe317139af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3171f9c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe31706dd00>]}


============================== 2022-05-22 15:54:09.822140 | da194b7d-77ed-4653-8c3f-216e0a66757c ==============================
15:54:09.822159 [info ] [MainThread]: Running with dbt=1.1.0
15:54:09.825755 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['models/tables/tb_vendas_primeiro_trimestre.sql'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
15:54:09.832801 [debug] [MainThread]: Tracking: tracking
15:54:09.855899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef49b90820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef49b908e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef49b90910>]}
15:54:09.961584 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
15:54:09.964785 [debug] [MainThread]: Partial parsing: updated file: analytics_dbt://models/tables/tb_vendas_primeiro_trimestre.sql
15:54:09.988615 [debug] [MainThread]: 1603: static parser failed on tables/tb_vendas_primeiro_trimestre.sql
15:54:10.016749 [debug] [MainThread]: 1602: parser fallback to jinja rendering on tables/tb_vendas_primeiro_trimestre.sql
15:54:10.046643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'da194b7d-77ed-4653-8c3f-216e0a66757c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef49a40a90>]}
15:54:10.077397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'da194b7d-77ed-4653-8c3f-216e0a66757c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef49b82820>]}
15:54:10.080474 [info ] [MainThread]: Found 5 models, 4 tests, 0 snapshots, 0 analyses, 193 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
15:54:10.083819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'da194b7d-77ed-4653-8c3f-216e0a66757c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef49bb25e0>]}
15:54:10.090288 [info ] [MainThread]: 
15:54:10.096007 [debug] [MainThread]: Acquiring new redshift connection "master"
15:54:10.104118 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev"
15:54:10.134267 [debug] [ThreadPool]: Using redshift connection "list_dev"
15:54:10.136743 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
  
15:54:10.139205 [debug] [ThreadPool]: Opening a new connection, currently in state init
15:54:10.141582 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
15:54:11.457640 [debug] [ThreadPool]: SQL status: SELECT in 1.32 seconds
15:54:11.466638 [debug] [ThreadPool]: On list_dev: Close
15:54:11.472729 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev_public"
15:54:11.487558 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
15:54:11.489428 [debug] [ThreadPool]: On list_dev_public: BEGIN
15:54:11.491525 [debug] [ThreadPool]: Opening a new connection, currently in state closed
15:54:11.493658 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
15:54:12.852324 [debug] [ThreadPool]: SQL status: BEGIN in 1.36 seconds
15:54:12.856881 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
15:54:12.861213 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev_public"} */
select
      'dev' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dev' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
15:54:13.015468 [debug] [ThreadPool]: SQL status: SELECT in 0.15 seconds
15:54:13.028383 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
15:54:13.172310 [debug] [ThreadPool]: On list_dev_public: Close
15:54:13.189186 [debug] [MainThread]: Using redshift connection "master"
15:54:13.191919 [debug] [MainThread]: On master: BEGIN
15:54:13.194441 [debug] [MainThread]: Opening a new connection, currently in state init
15:54:13.196841 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
15:54:14.537509 [debug] [MainThread]: SQL status: BEGIN in 1.34 seconds
15:54:14.541558 [debug] [MainThread]: Using redshift connection "master"
15:54:14.546889 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
15:54:14.729628 [debug] [MainThread]: SQL status: SELECT in 0.18 seconds
15:54:14.733861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'da194b7d-77ed-4653-8c3f-216e0a66757c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef49b826a0>]}
15:54:14.736540 [debug] [MainThread]: On master: ROLLBACK
15:54:14.881181 [debug] [MainThread]: Using redshift connection "master"
15:54:14.886578 [debug] [MainThread]: On master: BEGIN
15:54:15.181315 [debug] [MainThread]: SQL status: BEGIN in 0.29 seconds
15:54:15.186136 [debug] [MainThread]: On master: COMMIT
15:54:15.190026 [debug] [MainThread]: Using redshift connection "master"
15:54:15.193182 [debug] [MainThread]: On master: COMMIT
15:54:15.339314 [debug] [MainThread]: SQL status: COMMIT in 0.14 seconds
15:54:15.344922 [debug] [MainThread]: On master: Close
15:54:15.351751 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
15:54:15.354772 [info ] [MainThread]: 
15:54:15.374523 [debug] [Thread-1  ]: Began running node model.analytics_dbt.tb_vendas_primeiro_trimestre
15:54:15.377906 [info ] [Thread-1  ]: 1 of 1 START table model public.tb_vendas_primeiro_trimestre ................... [RUN]
15:54:15.383287 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.tb_vendas_primeiro_trimestre"
15:54:15.392935 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.tb_vendas_primeiro_trimestre
15:54:15.396551 [debug] [Thread-1  ]: Compiling model.analytics_dbt.tb_vendas_primeiro_trimestre
15:54:15.413309 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.tb_vendas_primeiro_trimestre"
15:54:15.425299 [debug] [Thread-1  ]: finished collecting timing info
15:54:15.429074 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.tb_vendas_primeiro_trimestre
15:54:15.502334 [debug] [Thread-1  ]: Writing runtime SQL for node "model.analytics_dbt.tb_vendas_primeiro_trimestre"
15:54:15.508477 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_vendas_primeiro_trimestre"
15:54:15.511058 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: BEGIN
15:54:15.513207 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:54:15.515166 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
15:54:16.835399 [debug] [Thread-1  ]: SQL status: BEGIN in 1.32 seconds
15:54:16.839613 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_vendas_primeiro_trimestre"
15:54:16.843585 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.tb_vendas_primeiro_trimestre"} */


  create  table
    "dev"."public"."tb_vendas_primeiro_trimestre__dbt_tmp"
    
    
    
  as (
    -- define o as variáveis meses e ano



-- cria a fonte com os dados de date e converte o  nome das colunas
with source_date as (
    select  dateid as id_date,
            month as mes,
            year as ano
    from date

),
-- cria uma fonte de dados unindo a tabela sales com date
sales_date as (

    select  source_date.mes, 
            sum(quantidade_vendida)
    from  "dev"."public"."vw_sales" sales inner join source_date
    on sales.id_date = source_date.id_date
    where source_date.mes in (meses)
    group by source_date.mes
    and source_date.ano = '2008'
)
select * from sales_date
  );
15:54:16.989238 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "meses" does not exist in sales, source_date, unnamed_join

15:54:16.993201 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: ROLLBACK
15:54:17.137597 [debug] [Thread-1  ]: finished collecting timing info
15:54:17.141396 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: Close
15:54:17.147372 [debug] [Thread-1  ]: Database Error in model tb_vendas_primeiro_trimestre (models/tables/tb_vendas_primeiro_trimestre.sql)
  column "meses" does not exist in sales, source_date, unnamed_join
  compiled SQL at target/run/analytics_dbt/models/tables/tb_vendas_primeiro_trimestre.sql
15:54:17.151393 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da194b7d-77ed-4653-8c3f-216e0a66757c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef481abaf0>]}
15:54:17.154358 [error] [Thread-1  ]: 1 of 1 ERROR creating table model public.tb_vendas_primeiro_trimestre .......... [[31mERROR[0m in 1.77s]
15:54:17.157696 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.tb_vendas_primeiro_trimestre
15:54:17.165078 [debug] [MainThread]: Acquiring new redshift connection "master"
15:54:17.168782 [debug] [MainThread]: Using redshift connection "master"
15:54:17.171693 [debug] [MainThread]: On master: BEGIN
15:54:17.174661 [debug] [MainThread]: Opening a new connection, currently in state closed
15:54:17.177191 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
15:54:18.502603 [debug] [MainThread]: SQL status: BEGIN in 1.33 seconds
15:54:18.507213 [debug] [MainThread]: On master: COMMIT
15:54:18.511306 [debug] [MainThread]: Using redshift connection "master"
15:54:18.514417 [debug] [MainThread]: On master: COMMIT
15:54:18.659179 [debug] [MainThread]: SQL status: COMMIT in 0.14 seconds
15:54:18.663212 [debug] [MainThread]: On master: Close
15:54:18.668921 [info ] [MainThread]: 
15:54:18.673631 [info ] [MainThread]: Finished running 1 table model in 8.57s.
15:54:18.679151 [debug] [MainThread]: Connection 'master' was properly closed.
15:54:18.685782 [debug] [MainThread]: Connection 'model.analytics_dbt.tb_vendas_primeiro_trimestre' was properly closed.
15:54:18.710505 [info ] [MainThread]: 
15:54:18.715719 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
15:54:18.722512 [info ] [MainThread]: 
15:54:18.729393 [error] [MainThread]: [33mDatabase Error in model tb_vendas_primeiro_trimestre (models/tables/tb_vendas_primeiro_trimestre.sql)[0m
15:54:18.737625 [error] [MainThread]:   column "meses" does not exist in sales, source_date, unnamed_join
15:54:18.743709 [error] [MainThread]:   compiled SQL at target/run/analytics_dbt/models/tables/tb_vendas_primeiro_trimestre.sql
15:54:18.754011 [info ] [MainThread]: 
15:54:18.765800 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
15:54:18.773851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef49aba0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef49b82b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef499eee50>]}


============================== 2022-05-22 16:01:32.817572 | 37614fb6-919d-4375-8fc7-1647d880e30e ==============================
16:01:32.817592 [info ] [MainThread]: Running with dbt=1.1.0
16:01:32.820993 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['models/tables/tb_vendas_primeiro_trimestre.sql'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
16:01:32.824756 [debug] [MainThread]: Tracking: tracking
16:01:32.849227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd242a59760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd242a59820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd242a59850>]}
16:01:32.948608 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
16:01:32.952343 [debug] [MainThread]: Partial parsing: updated file: analytics_dbt://models/tables/tb_vendas_primeiro_trimestre.sql
16:01:32.983805 [debug] [MainThread]: 1603: static parser failed on tables/tb_vendas_primeiro_trimestre.sql
16:01:33.017596 [debug] [MainThread]: 1602: parser fallback to jinja rendering on tables/tb_vendas_primeiro_trimestre.sql
16:01:33.053748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '37614fb6-919d-4375-8fc7-1647d880e30e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2429029d0>]}
16:01:33.083776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '37614fb6-919d-4375-8fc7-1647d880e30e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd24299dee0>]}
16:01:33.088621 [info ] [MainThread]: Found 5 models, 4 tests, 0 snapshots, 0 analyses, 193 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
16:01:33.092801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '37614fb6-919d-4375-8fc7-1647d880e30e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd242a76340>]}
16:01:33.108459 [info ] [MainThread]: 
16:01:33.111466 [debug] [MainThread]: Acquiring new redshift connection "master"
16:01:33.122042 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev"
16:01:33.156439 [debug] [ThreadPool]: Using redshift connection "list_dev"
16:01:33.159889 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
  
16:01:33.162781 [debug] [ThreadPool]: Opening a new connection, currently in state init
16:01:33.168745 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
16:01:34.523159 [debug] [ThreadPool]: SQL status: SELECT in 1.36 seconds
16:01:34.531744 [debug] [ThreadPool]: On list_dev: Close
16:01:34.539514 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev_public"
16:01:34.558265 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
16:01:34.561221 [debug] [ThreadPool]: On list_dev_public: BEGIN
16:01:34.563237 [debug] [ThreadPool]: Opening a new connection, currently in state closed
16:01:34.565314 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
16:01:35.884898 [debug] [ThreadPool]: SQL status: BEGIN in 1.32 seconds
16:01:35.888948 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
16:01:35.893073 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev_public"} */
select
      'dev' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dev' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
16:01:36.053119 [debug] [ThreadPool]: SQL status: SELECT in 0.16 seconds
16:01:36.062758 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
16:01:36.205384 [debug] [ThreadPool]: On list_dev_public: Close
16:01:36.225796 [debug] [MainThread]: Using redshift connection "master"
16:01:36.229269 [debug] [MainThread]: On master: BEGIN
16:01:36.233089 [debug] [MainThread]: Opening a new connection, currently in state init
16:01:36.236080 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
16:01:37.561760 [debug] [MainThread]: SQL status: BEGIN in 1.33 seconds
16:01:37.571034 [debug] [MainThread]: Using redshift connection "master"
16:01:37.575225 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
16:01:37.760453 [debug] [MainThread]: SQL status: SELECT in 0.18 seconds
16:01:37.769018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '37614fb6-919d-4375-8fc7-1647d880e30e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd242a6df70>]}
16:01:37.772866 [debug] [MainThread]: On master: ROLLBACK
16:01:37.917632 [debug] [MainThread]: Using redshift connection "master"
16:01:37.922742 [debug] [MainThread]: On master: BEGIN
16:01:38.223933 [debug] [MainThread]: SQL status: BEGIN in 0.3 seconds
16:01:38.229049 [debug] [MainThread]: On master: COMMIT
16:01:38.233752 [debug] [MainThread]: Using redshift connection "master"
16:01:38.238450 [debug] [MainThread]: On master: COMMIT
16:01:38.383677 [debug] [MainThread]: SQL status: COMMIT in 0.14 seconds
16:01:38.387824 [debug] [MainThread]: On master: Close
16:01:38.394943 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
16:01:38.398100 [info ] [MainThread]: 
16:01:38.416540 [debug] [Thread-1  ]: Began running node model.analytics_dbt.tb_vendas_primeiro_trimestre
16:01:38.420853 [info ] [Thread-1  ]: 1 of 1 START table model public.tb_vendas_primeiro_trimestre ................... [RUN]
16:01:38.427002 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.tb_vendas_primeiro_trimestre"
16:01:38.432671 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.tb_vendas_primeiro_trimestre
16:01:38.435844 [debug] [Thread-1  ]: Compiling model.analytics_dbt.tb_vendas_primeiro_trimestre
16:01:38.451439 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.tb_vendas_primeiro_trimestre"
16:01:38.460341 [debug] [Thread-1  ]: finished collecting timing info
16:01:38.464357 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.tb_vendas_primeiro_trimestre
16:01:38.536608 [debug] [Thread-1  ]: Writing runtime SQL for node "model.analytics_dbt.tb_vendas_primeiro_trimestre"
16:01:38.545763 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_vendas_primeiro_trimestre"
16:01:38.549255 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: BEGIN
16:01:38.553665 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
16:01:38.557033 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
16:01:39.866550 [debug] [Thread-1  ]: SQL status: BEGIN in 1.31 seconds
16:01:39.871882 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_vendas_primeiro_trimestre"
16:01:39.876062 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.tb_vendas_primeiro_trimestre"} */


  create  table
    "dev"."public"."tb_vendas_primeiro_trimestre__dbt_tmp"
    
    
    
  as (
    -- define o as variáveis meses e ano



-- cria a fonte com os dados de date e converte o  nome das colunas
with source_date as (
    select  dateid as id_date,
            month as mes,
            year as ano
    from date

),
-- cria uma fonte de dados unindo a tabela sales com date
sales_date as (

    select  source_date.mes, 
            sum(quantidade_vendida)
    from  "dev"."public"."vw_sales" sales inner join source_date
    on sales.id_date = source_date.id_date
    where source_date.mes in ('['JAN', 'FEB', 'MAR']')
    group by source_date.mes
    and source_date.ano = '2008'
)
select * from sales_date
  );
16:01:40.027581 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near "JAN"
LINE 29:     where source_date.mes in ('['JAN', 'FEB', 'MAR']')
                                          ^

16:01:40.033037 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: ROLLBACK
16:01:40.177707 [debug] [Thread-1  ]: finished collecting timing info
16:01:40.181518 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: Close
16:01:40.187115 [debug] [Thread-1  ]: Database Error in model tb_vendas_primeiro_trimestre (models/tables/tb_vendas_primeiro_trimestre.sql)
  syntax error at or near "JAN"
  LINE 29:     where source_date.mes in ('['JAN', 'FEB', 'MAR']')
                                            ^
  compiled SQL at target/run/analytics_dbt/models/tables/tb_vendas_primeiro_trimestre.sql
16:01:40.191684 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37614fb6-919d-4375-8fc7-1647d880e30e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd24086cf10>]}
16:01:40.195285 [error] [Thread-1  ]: 1 of 1 ERROR creating table model public.tb_vendas_primeiro_trimestre .......... [[31mERROR[0m in 1.77s]
16:01:40.201629 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.tb_vendas_primeiro_trimestre
16:01:40.209463 [debug] [MainThread]: Acquiring new redshift connection "master"
16:01:40.214257 [debug] [MainThread]: Using redshift connection "master"
16:01:40.217711 [debug] [MainThread]: On master: BEGIN
16:01:40.220038 [debug] [MainThread]: Opening a new connection, currently in state closed
16:01:40.223941 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
16:01:41.539867 [debug] [MainThread]: SQL status: BEGIN in 1.32 seconds
16:01:41.544956 [debug] [MainThread]: On master: COMMIT
16:01:41.549137 [debug] [MainThread]: Using redshift connection "master"
16:01:41.552260 [debug] [MainThread]: On master: COMMIT
16:01:41.700801 [debug] [MainThread]: SQL status: COMMIT in 0.15 seconds
16:01:41.705076 [debug] [MainThread]: On master: Close
16:01:41.710337 [info ] [MainThread]: 
16:01:41.713962 [info ] [MainThread]: Finished running 1 table model in 8.60s.
16:01:41.717966 [debug] [MainThread]: Connection 'master' was properly closed.
16:01:41.724913 [debug] [MainThread]: Connection 'model.analytics_dbt.tb_vendas_primeiro_trimestre' was properly closed.
16:01:41.752918 [info ] [MainThread]: 
16:01:41.756403 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
16:01:41.761249 [info ] [MainThread]: 
16:01:41.765597 [error] [MainThread]: [33mDatabase Error in model tb_vendas_primeiro_trimestre (models/tables/tb_vendas_primeiro_trimestre.sql)[0m
16:01:41.773745 [error] [MainThread]:   syntax error at or near "JAN"
16:01:41.777975 [error] [MainThread]:   LINE 29:     where source_date.mes in ('['JAN', 'FEB', 'MAR']')
16:01:41.781547 [error] [MainThread]:                                             ^
16:01:41.790182 [error] [MainThread]:   compiled SQL at target/run/analytics_dbt/models/tables/tb_vendas_primeiro_trimestre.sql
16:01:41.796965 [info ] [MainThread]: 
16:01:41.802147 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
16:01:41.811413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd242973100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd242a762e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2428b2df0>]}


============================== 2022-05-22 16:02:16.069307 | 7ef9445d-fb32-48fc-9ce2-67614783fa64 ==============================
16:02:16.069327 [info ] [MainThread]: Running with dbt=1.1.0
16:02:16.071429 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['models/tables/tb_vendas_primeiro_trimestre.sql'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
16:02:16.075567 [debug] [MainThread]: Tracking: tracking
16:02:16.100510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99a78366d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99a7836790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99a78367c0>]}
16:02:16.203722 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
16:02:16.207787 [debug] [MainThread]: Partial parsing: updated file: analytics_dbt://models/tables/tb_vendas_primeiro_trimestre.sql
16:02:16.233873 [debug] [MainThread]: 1603: static parser failed on tables/tb_vendas_primeiro_trimestre.sql
16:02:16.262393 [debug] [MainThread]: 1602: parser fallback to jinja rendering on tables/tb_vendas_primeiro_trimestre.sql
16:02:16.286632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7ef9445d-fb32-48fc-9ce2-67614783fa64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99a76de9a0>]}
16:02:16.309583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7ef9445d-fb32-48fc-9ce2-67614783fa64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99a781aee0>]}
16:02:16.311910 [info ] [MainThread]: Found 5 models, 4 tests, 0 snapshots, 0 analyses, 193 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
16:02:16.314785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7ef9445d-fb32-48fc-9ce2-67614783fa64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99a785a280>]}
16:02:16.329909 [info ] [MainThread]: 
16:02:16.333402 [debug] [MainThread]: Acquiring new redshift connection "master"
16:02:16.338803 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev"
16:02:16.366021 [debug] [ThreadPool]: Using redshift connection "list_dev"
16:02:16.368184 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
  
16:02:16.371340 [debug] [ThreadPool]: Opening a new connection, currently in state init
16:02:16.373916 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
16:02:17.721782 [debug] [ThreadPool]: SQL status: SELECT in 1.35 seconds
16:02:17.730640 [debug] [ThreadPool]: On list_dev: Close
16:02:17.737142 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev_public"
16:02:17.751823 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
16:02:17.754156 [debug] [ThreadPool]: On list_dev_public: BEGIN
16:02:17.756222 [debug] [ThreadPool]: Opening a new connection, currently in state init
16:02:17.759715 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
16:02:19.183173 [debug] [ThreadPool]: SQL status: BEGIN in 1.43 seconds
16:02:19.187622 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
16:02:19.191397 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev_public"} */
select
      'dev' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dev' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
16:02:19.346434 [debug] [ThreadPool]: SQL status: SELECT in 0.15 seconds
16:02:19.354801 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
16:02:19.505523 [debug] [ThreadPool]: On list_dev_public: Close
16:02:19.522208 [debug] [MainThread]: Using redshift connection "master"
16:02:19.524375 [debug] [MainThread]: On master: BEGIN
16:02:19.526272 [debug] [MainThread]: Opening a new connection, currently in state init
16:02:19.528473 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
16:02:20.945558 [debug] [MainThread]: SQL status: BEGIN in 1.42 seconds
16:02:20.950489 [debug] [MainThread]: Using redshift connection "master"
16:02:20.954905 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
16:02:21.168537 [debug] [MainThread]: SQL status: SELECT in 0.21 seconds
16:02:21.176172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7ef9445d-fb32-48fc-9ce2-67614783fa64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99a7850dc0>]}
16:02:21.179333 [debug] [MainThread]: On master: ROLLBACK
16:02:21.333808 [debug] [MainThread]: Using redshift connection "master"
16:02:21.338762 [debug] [MainThread]: On master: BEGIN
16:02:21.703261 [debug] [MainThread]: SQL status: BEGIN in 0.36 seconds
16:02:21.707347 [debug] [MainThread]: On master: COMMIT
16:02:21.712783 [debug] [MainThread]: Using redshift connection "master"
16:02:21.715890 [debug] [MainThread]: On master: COMMIT
16:02:21.860568 [debug] [MainThread]: SQL status: COMMIT in 0.14 seconds
16:02:21.864923 [debug] [MainThread]: On master: Close
16:02:21.870932 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
16:02:21.874189 [info ] [MainThread]: 
16:02:21.896169 [debug] [Thread-1  ]: Began running node model.analytics_dbt.tb_vendas_primeiro_trimestre
16:02:21.905314 [info ] [Thread-1  ]: 1 of 1 START table model public.tb_vendas_primeiro_trimestre ................... [RUN]
16:02:21.910060 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.tb_vendas_primeiro_trimestre"
16:02:21.919341 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.tb_vendas_primeiro_trimestre
16:02:21.921850 [debug] [Thread-1  ]: Compiling model.analytics_dbt.tb_vendas_primeiro_trimestre
16:02:21.931885 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.tb_vendas_primeiro_trimestre"
16:02:21.943366 [debug] [Thread-1  ]: finished collecting timing info
16:02:21.949151 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.tb_vendas_primeiro_trimestre
16:02:22.023897 [debug] [Thread-1  ]: Writing runtime SQL for node "model.analytics_dbt.tb_vendas_primeiro_trimestre"
16:02:22.031538 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_vendas_primeiro_trimestre"
16:02:22.033982 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: BEGIN
16:02:22.035951 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
16:02:22.038181 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
16:02:23.455480 [debug] [Thread-1  ]: SQL status: BEGIN in 1.42 seconds
16:02:23.460617 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_vendas_primeiro_trimestre"
16:02:23.467207 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.tb_vendas_primeiro_trimestre"} */


  create  table
    "dev"."public"."tb_vendas_primeiro_trimestre__dbt_tmp"
    
    
    
  as (
    -- define o as variáveis meses e ano



-- cria a fonte com os dados de date e converte o  nome das colunas
with source_date as (
    select  dateid as id_date,
            month as mes,
            year as ano
    from date

),
-- cria uma fonte de dados unindo a tabela sales com date
sales_date as (

    select  source_date.mes, 
            sum(quantidade_vendida)
    from  "dev"."public"."vw_sales" sales inner join source_date
    on sales.id_date = source_date.id_date
    where source_date.mes in ('('JAN', 'FEB', 'MAR')')
    group by source_date.mes
    and source_date.ano = '2008'
)
select * from sales_date
  );
16:02:23.617799 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near "JAN"
LINE 29:     where source_date.mes in ('('JAN', 'FEB', 'MAR')')
                                          ^

16:02:23.622728 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: ROLLBACK
16:02:23.765944 [debug] [Thread-1  ]: finished collecting timing info
16:02:23.770206 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: Close
16:02:23.776451 [debug] [Thread-1  ]: Database Error in model tb_vendas_primeiro_trimestre (models/tables/tb_vendas_primeiro_trimestre.sql)
  syntax error at or near "JAN"
  LINE 29:     where source_date.mes in ('('JAN', 'FEB', 'MAR')')
                                            ^
  compiled SQL at target/run/analytics_dbt/models/tables/tb_vendas_primeiro_trimestre.sql
16:02:23.779489 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ef9445d-fb32-48fc-9ce2-67614783fa64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99a5647280>]}
16:02:23.782587 [error] [Thread-1  ]: 1 of 1 ERROR creating table model public.tb_vendas_primeiro_trimestre .......... [[31mERROR[0m in 1.87s]
16:02:23.786590 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.tb_vendas_primeiro_trimestre
16:02:23.792943 [debug] [MainThread]: Acquiring new redshift connection "master"
16:02:23.798041 [debug] [MainThread]: Using redshift connection "master"
16:02:23.801799 [debug] [MainThread]: On master: BEGIN
16:02:23.804615 [debug] [MainThread]: Opening a new connection, currently in state closed
16:02:23.806483 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
16:02:25.279035 [debug] [MainThread]: SQL status: BEGIN in 1.47 seconds
16:02:25.285244 [debug] [MainThread]: On master: COMMIT
16:02:25.290012 [debug] [MainThread]: Using redshift connection "master"
16:02:25.292577 [debug] [MainThread]: On master: COMMIT
16:02:25.441576 [debug] [MainThread]: SQL status: COMMIT in 0.15 seconds
16:02:25.446415 [debug] [MainThread]: On master: Close
16:02:25.452460 [info ] [MainThread]: 
16:02:25.455907 [info ] [MainThread]: Finished running 1 table model in 9.12s.
16:02:25.459819 [debug] [MainThread]: Connection 'master' was properly closed.
16:02:25.463780 [debug] [MainThread]: Connection 'list_dev' was properly closed.
16:02:25.471077 [debug] [MainThread]: Connection 'model.analytics_dbt.tb_vendas_primeiro_trimestre' was properly closed.
16:02:25.497799 [info ] [MainThread]: 
16:02:25.504890 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
16:02:25.510689 [info ] [MainThread]: 
16:02:25.517621 [error] [MainThread]: [33mDatabase Error in model tb_vendas_primeiro_trimestre (models/tables/tb_vendas_primeiro_trimestre.sql)[0m
16:02:25.526801 [error] [MainThread]:   syntax error at or near "JAN"
16:02:25.532973 [error] [MainThread]:   LINE 29:     where source_date.mes in ('('JAN', 'FEB', 'MAR')')
16:02:25.542643 [error] [MainThread]:                                             ^
16:02:25.547637 [error] [MainThread]:   compiled SQL at target/run/analytics_dbt/models/tables/tb_vendas_primeiro_trimestre.sql
16:02:25.554742 [info ] [MainThread]: 
16:02:25.561521 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
16:02:25.570744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99a77fd3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99a77bca90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99a7696ca0>]}


============================== 2022-05-22 16:02:44.951167 | 1ec5d687-3c6d-45fd-93e4-fe06dc804a96 ==============================
16:02:44.951187 [info ] [MainThread]: Running with dbt=1.1.0
16:02:44.953231 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['models/tables/tb_vendas_primeiro_trimestre.sql'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
16:02:44.957181 [debug] [MainThread]: Tracking: tracking
16:02:44.985774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88334213a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8833421370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8833421460>]}
16:02:45.091839 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
16:02:45.095141 [debug] [MainThread]: Partial parsing: updated file: analytics_dbt://models/tables/tb_vendas_primeiro_trimestre.sql
16:02:45.123149 [debug] [MainThread]: 1603: static parser failed on tables/tb_vendas_primeiro_trimestre.sql
16:02:45.152423 [debug] [MainThread]: 1602: parser fallback to jinja rendering on tables/tb_vendas_primeiro_trimestre.sql
16:02:45.184033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1ec5d687-3c6d-45fd-93e4-fe06dc804a96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88332ce970>]}
16:02:45.210928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1ec5d687-3c6d-45fd-93e4-fe06dc804a96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f883336af10>]}
16:02:45.213737 [info ] [MainThread]: Found 5 models, 4 tests, 0 snapshots, 0 analyses, 193 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
16:02:45.217634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1ec5d687-3c6d-45fd-93e4-fe06dc804a96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f883337f430>]}
16:02:45.224893 [info ] [MainThread]: 
16:02:45.231564 [debug] [MainThread]: Acquiring new redshift connection "master"
16:02:45.236930 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev"
16:02:45.265108 [debug] [ThreadPool]: Using redshift connection "list_dev"
16:02:45.267987 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
  
16:02:45.270512 [debug] [ThreadPool]: Opening a new connection, currently in state init
16:02:45.272841 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
16:02:46.719873 [debug] [ThreadPool]: SQL status: SELECT in 1.45 seconds
16:02:46.728601 [debug] [ThreadPool]: On list_dev: Close
16:02:46.735982 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev_public"
16:02:46.750438 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
16:02:46.752668 [debug] [ThreadPool]: On list_dev_public: BEGIN
16:02:46.754751 [debug] [ThreadPool]: Opening a new connection, currently in state closed
16:02:46.756811 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
16:02:48.045038 [debug] [ThreadPool]: SQL status: BEGIN in 1.29 seconds
16:02:48.049912 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
16:02:48.054593 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev_public"} */
select
      'dev' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dev' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
16:02:48.209730 [debug] [ThreadPool]: SQL status: SELECT in 0.15 seconds
16:02:48.218997 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
16:02:48.360884 [debug] [ThreadPool]: On list_dev_public: Close
16:02:48.375503 [debug] [MainThread]: Using redshift connection "master"
16:02:48.377904 [debug] [MainThread]: On master: BEGIN
16:02:48.380641 [debug] [MainThread]: Opening a new connection, currently in state init
16:02:48.383002 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
16:02:49.692530 [debug] [MainThread]: SQL status: BEGIN in 1.31 seconds
16:02:49.696625 [debug] [MainThread]: Using redshift connection "master"
16:02:49.701141 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
16:02:49.881805 [debug] [MainThread]: SQL status: SELECT in 0.18 seconds
16:02:49.890016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1ec5d687-3c6d-45fd-93e4-fe06dc804a96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f883336a130>]}
16:02:49.893633 [debug] [MainThread]: On master: ROLLBACK
16:02:50.036567 [debug] [MainThread]: Using redshift connection "master"
16:02:50.041231 [debug] [MainThread]: On master: BEGIN
16:02:50.327673 [debug] [MainThread]: SQL status: BEGIN in 0.28 seconds
16:02:50.332152 [debug] [MainThread]: On master: COMMIT
16:02:50.336466 [debug] [MainThread]: Using redshift connection "master"
16:02:50.339699 [debug] [MainThread]: On master: COMMIT
16:02:50.487601 [debug] [MainThread]: SQL status: COMMIT in 0.15 seconds
16:02:50.492997 [debug] [MainThread]: On master: Close
16:02:50.497867 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
16:02:50.501499 [info ] [MainThread]: 
16:02:50.519780 [debug] [Thread-1  ]: Began running node model.analytics_dbt.tb_vendas_primeiro_trimestre
16:02:50.540471 [info ] [Thread-1  ]: 1 of 1 START table model public.tb_vendas_primeiro_trimestre ................... [RUN]
16:02:50.554772 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.tb_vendas_primeiro_trimestre"
16:02:50.562122 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.tb_vendas_primeiro_trimestre
16:02:50.575355 [debug] [Thread-1  ]: Compiling model.analytics_dbt.tb_vendas_primeiro_trimestre
16:02:50.588100 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.tb_vendas_primeiro_trimestre"
16:02:50.595251 [debug] [Thread-1  ]: finished collecting timing info
16:02:50.598101 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.tb_vendas_primeiro_trimestre
16:02:50.682092 [debug] [Thread-1  ]: Writing runtime SQL for node "model.analytics_dbt.tb_vendas_primeiro_trimestre"
16:02:50.689245 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_vendas_primeiro_trimestre"
16:02:50.691595 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: BEGIN
16:02:50.693741 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
16:02:50.696939 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
16:02:52.030854 [debug] [Thread-1  ]: SQL status: BEGIN in 1.34 seconds
16:02:52.035631 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_vendas_primeiro_trimestre"
16:02:52.038837 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.tb_vendas_primeiro_trimestre"} */


  create  table
    "dev"."public"."tb_vendas_primeiro_trimestre__dbt_tmp"
    
    
    
  as (
    -- define o as variáveis meses e ano



-- cria a fonte com os dados de date e converte o  nome das colunas
with source_date as (
    select  dateid as id_date,
            month as mes,
            year as ano
    from date

),
-- cria uma fonte de dados unindo a tabela sales com date
sales_date as (

    select  source_date.mes, 
            sum(quantidade_vendida)
    from  "dev"."public"."vw_sales" sales inner join source_date
    on sales.id_date = source_date.id_date
    where source_date.mes in '('JAN', 'FEB', 'MAR')'
    group by source_date.mes
    and source_date.ano = '2008'
)
select * from sales_date
  );
16:02:52.187448 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near "'('"
LINE 29:     where source_date.mes in '('JAN', 'FEB', 'MAR')'
                                      ^

16:02:52.191887 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: ROLLBACK
16:02:52.334521 [debug] [Thread-1  ]: finished collecting timing info
16:02:52.338560 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: Close
16:02:52.343739 [debug] [Thread-1  ]: Database Error in model tb_vendas_primeiro_trimestre (models/tables/tb_vendas_primeiro_trimestre.sql)
  syntax error at or near "'('"
  LINE 29:     where source_date.mes in '('JAN', 'FEB', 'MAR')'
                                        ^
  compiled SQL at target/run/analytics_dbt/models/tables/tb_vendas_primeiro_trimestre.sql
16:02:52.346978 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ec5d687-3c6d-45fd-93e4-fe06dc804a96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8831234700>]}
16:02:52.350009 [error] [Thread-1  ]: 1 of 1 ERROR creating table model public.tb_vendas_primeiro_trimestre .......... [[31mERROR[0m in 1.79s]
16:02:52.353116 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.tb_vendas_primeiro_trimestre
16:02:52.360628 [debug] [MainThread]: Acquiring new redshift connection "master"
16:02:52.365617 [debug] [MainThread]: Using redshift connection "master"
16:02:52.369102 [debug] [MainThread]: On master: BEGIN
16:02:52.371616 [debug] [MainThread]: Opening a new connection, currently in state closed
16:02:52.374497 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
16:02:53.696124 [debug] [MainThread]: SQL status: BEGIN in 1.32 seconds
16:02:53.700254 [debug] [MainThread]: On master: COMMIT
16:02:53.704201 [debug] [MainThread]: Using redshift connection "master"
16:02:53.707801 [debug] [MainThread]: On master: COMMIT
16:02:53.851929 [debug] [MainThread]: SQL status: COMMIT in 0.14 seconds
16:02:53.856348 [debug] [MainThread]: On master: Close
16:02:53.862826 [info ] [MainThread]: 
16:02:53.866150 [info ] [MainThread]: Finished running 1 table model in 8.63s.
16:02:53.870138 [debug] [MainThread]: Connection 'master' was properly closed.
16:02:53.875696 [debug] [MainThread]: Connection 'model.analytics_dbt.tb_vendas_primeiro_trimestre' was properly closed.
16:02:53.910423 [info ] [MainThread]: 
16:02:53.914032 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
16:02:53.923407 [info ] [MainThread]: 
16:02:53.929146 [error] [MainThread]: [33mDatabase Error in model tb_vendas_primeiro_trimestre (models/tables/tb_vendas_primeiro_trimestre.sql)[0m
16:02:53.942755 [error] [MainThread]:   syntax error at or near "'('"
16:02:53.950839 [error] [MainThread]:   LINE 29:     where source_date.mes in '('JAN', 'FEB', 'MAR')'
16:02:53.961098 [error] [MainThread]:                                         ^
16:02:53.971333 [error] [MainThread]:   compiled SQL at target/run/analytics_dbt/models/tables/tb_vendas_primeiro_trimestre.sql
16:02:53.978546 [info ] [MainThread]: 
16:02:53.990941 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
16:02:53.999052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8833361ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f883336a340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f883327bcd0>]}


============================== 2022-05-22 16:03:20.885571 | 6d95d8a3-0cca-440d-a918-b6b36ada1d3c ==============================
16:03:20.885597 [info ] [MainThread]: Running with dbt=1.1.0
16:03:20.892490 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['models/tables/tb_vendas_primeiro_trimestre.sql'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
16:03:20.899476 [debug] [MainThread]: Tracking: tracking
16:03:20.929533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f043b3c9790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f043b3c9850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f043b3c9880>]}
16:03:21.042861 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
16:03:21.045961 [debug] [MainThread]: Partial parsing: updated file: analytics_dbt://models/tables/tb_vendas_primeiro_trimestre.sql
16:03:21.073651 [debug] [MainThread]: 1603: static parser failed on tables/tb_vendas_primeiro_trimestre.sql
16:03:21.110024 [debug] [MainThread]: 1602: parser fallback to jinja rendering on tables/tb_vendas_primeiro_trimestre.sql
16:03:21.147735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6d95d8a3-0cca-440d-a918-b6b36ada1d3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f043b274a60>]}
16:03:21.172783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6d95d8a3-0cca-440d-a918-b6b36ada1d3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f043b313ee0>]}
16:03:21.175615 [info ] [MainThread]: Found 5 models, 4 tests, 0 snapshots, 0 analyses, 193 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
16:03:21.178492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6d95d8a3-0cca-440d-a918-b6b36ada1d3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f043b3e9850>]}
16:03:21.188481 [info ] [MainThread]: 
16:03:21.197519 [debug] [MainThread]: Acquiring new redshift connection "master"
16:03:21.205300 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev"
16:03:21.244708 [debug] [ThreadPool]: Using redshift connection "list_dev"
16:03:21.247705 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
  
16:03:21.251669 [debug] [ThreadPool]: Opening a new connection, currently in state init
16:03:21.254820 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
16:03:22.580016 [debug] [ThreadPool]: SQL status: SELECT in 1.33 seconds
16:03:22.586441 [debug] [ThreadPool]: On list_dev: Close
16:03:22.591879 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev_public"
16:03:22.607916 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
16:03:22.610028 [debug] [ThreadPool]: On list_dev_public: BEGIN
16:03:22.612162 [debug] [ThreadPool]: Opening a new connection, currently in state init
16:03:22.614677 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
16:03:23.900043 [debug] [ThreadPool]: SQL status: BEGIN in 1.29 seconds
16:03:23.904700 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
16:03:23.909677 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev_public"} */
select
      'dev' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dev' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
16:03:24.071028 [debug] [ThreadPool]: SQL status: SELECT in 0.16 seconds
16:03:24.079447 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
16:03:24.226676 [debug] [ThreadPool]: On list_dev_public: Close
16:03:24.243689 [debug] [MainThread]: Using redshift connection "master"
16:03:24.246730 [debug] [MainThread]: On master: BEGIN
16:03:24.249949 [debug] [MainThread]: Opening a new connection, currently in state init
16:03:24.252813 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
16:03:25.535681 [debug] [MainThread]: SQL status: BEGIN in 1.29 seconds
16:03:25.539883 [debug] [MainThread]: Using redshift connection "master"
16:03:25.544546 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
16:03:25.726283 [debug] [MainThread]: SQL status: SELECT in 0.17 seconds
16:03:25.734596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6d95d8a3-0cca-440d-a918-b6b36ada1d3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f043b313d60>]}
16:03:25.738239 [debug] [MainThread]: On master: ROLLBACK
16:03:25.879386 [debug] [MainThread]: Using redshift connection "master"
16:03:25.884419 [debug] [MainThread]: On master: BEGIN
16:03:26.165558 [debug] [MainThread]: SQL status: BEGIN in 0.28 seconds
16:03:26.170398 [debug] [MainThread]: On master: COMMIT
16:03:26.174706 [debug] [MainThread]: Using redshift connection "master"
16:03:26.177933 [debug] [MainThread]: On master: COMMIT
16:03:26.319333 [debug] [MainThread]: SQL status: COMMIT in 0.14 seconds
16:03:26.324281 [debug] [MainThread]: On master: Close
16:03:26.331783 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
16:03:26.335505 [info ] [MainThread]: 
16:03:26.356445 [debug] [Thread-1  ]: Began running node model.analytics_dbt.tb_vendas_primeiro_trimestre
16:03:26.361040 [info ] [Thread-1  ]: 1 of 1 START table model public.tb_vendas_primeiro_trimestre ................... [RUN]
16:03:26.363705 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.tb_vendas_primeiro_trimestre"
16:03:26.368780 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.tb_vendas_primeiro_trimestre
16:03:26.374644 [debug] [Thread-1  ]: Compiling model.analytics_dbt.tb_vendas_primeiro_trimestre
16:03:26.383317 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.tb_vendas_primeiro_trimestre"
16:03:26.395620 [debug] [Thread-1  ]: finished collecting timing info
16:03:26.399337 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.tb_vendas_primeiro_trimestre
16:03:26.478324 [debug] [Thread-1  ]: Writing runtime SQL for node "model.analytics_dbt.tb_vendas_primeiro_trimestre"
16:03:26.491731 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_vendas_primeiro_trimestre"
16:03:26.496335 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: BEGIN
16:03:26.501345 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
16:03:26.503633 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
16:03:27.823460 [debug] [Thread-1  ]: SQL status: BEGIN in 1.32 seconds
16:03:27.828283 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_vendas_primeiro_trimestre"
16:03:27.831973 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.tb_vendas_primeiro_trimestre"} */


  create  table
    "dev"."public"."tb_vendas_primeiro_trimestre__dbt_tmp"
    
    
    
  as (
    -- define o as variáveis meses e ano



-- cria a fonte com os dados de date e converte o  nome das colunas
with source_date as (
    select  dateid as id_date,
            month as mes,
            year as ano
    from date

),
-- cria uma fonte de dados unindo a tabela sales com date
sales_date as (

    select  source_date.mes, 
            sum(quantidade_vendida)
    from  "dev"."public"."vw_sales" sales inner join source_date
    on sales.id_date = source_date.id_date
    where source_date.mes in ('JAN', 'FEB', 'MAR')
    group by source_date.mes
    and source_date.ano = '2008'
)
select * from sales_date
  );
16:03:27.975489 [debug] [Thread-1  ]: Postgres adapter: Postgres error: argument of AND must be type boolean, not type character

16:03:27.980163 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: ROLLBACK
16:03:28.121008 [debug] [Thread-1  ]: finished collecting timing info
16:03:28.125364 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: Close
16:03:28.131773 [debug] [Thread-1  ]: Database Error in model tb_vendas_primeiro_trimestre (models/tables/tb_vendas_primeiro_trimestre.sql)
  argument of AND must be type boolean, not type character
  compiled SQL at target/run/analytics_dbt/models/tables/tb_vendas_primeiro_trimestre.sql
16:03:28.135783 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d95d8a3-0cca-440d-a918-b6b36ada1d3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04391df970>]}
16:03:28.138416 [error] [Thread-1  ]: 1 of 1 ERROR creating table model public.tb_vendas_primeiro_trimestre .......... [[31mERROR[0m in 1.77s]
16:03:28.142536 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.tb_vendas_primeiro_trimestre
16:03:28.150018 [debug] [MainThread]: Acquiring new redshift connection "master"
16:03:28.154874 [debug] [MainThread]: Using redshift connection "master"
16:03:28.157934 [debug] [MainThread]: On master: BEGIN
16:03:28.160402 [debug] [MainThread]: Opening a new connection, currently in state closed
16:03:28.163267 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
16:03:29.504162 [debug] [MainThread]: SQL status: BEGIN in 1.34 seconds
16:03:29.509024 [debug] [MainThread]: On master: COMMIT
16:03:29.513436 [debug] [MainThread]: Using redshift connection "master"
16:03:29.516934 [debug] [MainThread]: On master: COMMIT
16:03:29.659466 [debug] [MainThread]: SQL status: COMMIT in 0.14 seconds
16:03:29.664289 [debug] [MainThread]: On master: Close
16:03:29.669291 [info ] [MainThread]: 
16:03:29.672539 [info ] [MainThread]: Finished running 1 table model in 8.47s.
16:03:29.676956 [debug] [MainThread]: Connection 'master' was properly closed.
16:03:29.684664 [debug] [MainThread]: Connection 'list_dev' was properly closed.
16:03:29.688389 [debug] [MainThread]: Connection 'model.analytics_dbt.tb_vendas_primeiro_trimestre' was properly closed.
16:03:29.719802 [info ] [MainThread]: 
16:03:29.727111 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
16:03:29.731733 [info ] [MainThread]: 
16:03:29.735872 [error] [MainThread]: [33mDatabase Error in model tb_vendas_primeiro_trimestre (models/tables/tb_vendas_primeiro_trimestre.sql)[0m
16:03:29.743986 [error] [MainThread]:   argument of AND must be type boolean, not type character
16:03:29.748150 [error] [MainThread]:   compiled SQL at target/run/analytics_dbt/models/tables/tb_vendas_primeiro_trimestre.sql
16:03:29.754513 [info ] [MainThread]: 
16:03:29.761133 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
16:03:29.765240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f043b351ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f043b2eda30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f043b222d00>]}


============================== 2022-05-23 16:16:01.687101 | 5cec4e0d-88cc-4db8-9a75-db943830fe0b ==============================
16:16:01.687127 [info ] [MainThread]: Running with dbt=1.1.0
16:16:01.690326 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['models/tables/tb_vendas_primeiro_trimestre.sql'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
16:16:01.703537 [debug] [MainThread]: Tracking: tracking
16:16:01.745619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcce453760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcce453820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcce453850>]}
16:16:01.955274 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
16:16:01.959013 [debug] [MainThread]: Partial parsing: updated file: analytics_dbt://models/tables/tb_vendas_primeiro_trimestre.sql
16:16:01.992339 [debug] [MainThread]: 1603: static parser failed on tables/tb_vendas_primeiro_trimestre.sql
16:16:02.041800 [debug] [MainThread]: 1602: parser fallback to jinja rendering on tables/tb_vendas_primeiro_trimestre.sql
16:16:02.087919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5cec4e0d-88cc-4db8-9a75-db943830fe0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcce2fa9d0>]}
16:16:02.129070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5cec4e0d-88cc-4db8-9a75-db943830fe0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcce39cee0>]}
16:16:02.133712 [info ] [MainThread]: Found 5 models, 4 tests, 0 snapshots, 0 analyses, 193 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
16:16:02.138117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5cec4e0d-88cc-4db8-9a75-db943830fe0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcce470340>]}
16:16:02.150990 [info ] [MainThread]: 
16:16:02.158606 [debug] [MainThread]: Acquiring new redshift connection "master"
16:16:02.168149 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev"
16:16:02.214625 [debug] [ThreadPool]: Using redshift connection "list_dev"
16:16:02.220132 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
  
16:16:02.222435 [debug] [ThreadPool]: Opening a new connection, currently in state init
16:16:02.225102 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
16:16:12.311873 [debug] [ThreadPool]: Postgres adapter: Got an error when attempting to open a postgres connection: 'connection to server at "redshift-edz-cluster1.czbvqs57zygi.us-east-1.redshift.amazonaws.com" (3.211.194.173), port 5439 failed: timeout expired
'
16:16:12.314543 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
  
16:16:12.316925 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
16:16:12.320826 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
16:16:12.324200 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
16:16:12.326809 [debug] [ThreadPool]: On list_dev: No close available on handle
16:16:12.330239 [debug] [MainThread]: Connection 'master' was properly closed.
16:16:12.332534 [debug] [MainThread]: Connection 'list_dev' was properly closed.
16:16:12.336252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcce39cdc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcce388100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcce388e80>]}


============================== 2022-05-23 16:21:24.321695 | 861d3bbf-cf9a-4797-86fc-eb6b10545338 ==============================
16:21:24.321715 [info ] [MainThread]: Running with dbt=1.1.0
16:21:24.326812 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['models/tables/tb_vendas_primeiro_trimestre.sql'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
16:21:24.343840 [debug] [MainThread]: Tracking: tracking
16:21:24.372684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad71e4b730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad71e4b7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad71e4b820>]}
16:21:24.543718 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
16:21:24.547049 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
16:21:24.568156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '861d3bbf-cf9a-4797-86fc-eb6b10545338', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad71d76670>]}
16:21:24.613753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '861d3bbf-cf9a-4797-86fc-eb6b10545338', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad71d8a130>]}
16:21:24.618807 [info ] [MainThread]: Found 5 models, 4 tests, 0 snapshots, 0 analyses, 193 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
16:21:24.624016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '861d3bbf-cf9a-4797-86fc-eb6b10545338', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad71d8a340>]}
16:21:24.643212 [info ] [MainThread]: 
16:21:24.651622 [debug] [MainThread]: Acquiring new redshift connection "master"
16:21:24.665555 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev"
16:21:24.719627 [debug] [ThreadPool]: Using redshift connection "list_dev"
16:21:24.722868 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
  
16:21:24.728017 [debug] [ThreadPool]: Opening a new connection, currently in state init
16:21:24.731496 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
16:21:26.119547 [debug] [ThreadPool]: SQL status: SELECT in 1.39 seconds
16:21:26.127187 [debug] [ThreadPool]: On list_dev: Close
16:21:26.134625 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev_public"
16:21:26.154500 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
16:21:26.157485 [debug] [ThreadPool]: On list_dev_public: BEGIN
16:21:26.160685 [debug] [ThreadPool]: Opening a new connection, currently in state init
16:21:26.167728 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
16:21:27.627468 [debug] [ThreadPool]: SQL status: BEGIN in 1.47 seconds
16:21:27.630984 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
16:21:27.633780 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev_public"} */
select
      'dev' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dev' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
16:21:27.789042 [debug] [ThreadPool]: SQL status: SELECT in 0.15 seconds
16:21:27.794277 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
16:21:27.941544 [debug] [ThreadPool]: On list_dev_public: Close
16:21:27.957792 [debug] [MainThread]: Using redshift connection "master"
16:21:27.960973 [debug] [MainThread]: On master: BEGIN
16:21:27.964403 [debug] [MainThread]: Opening a new connection, currently in state init
16:21:27.967629 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
16:21:29.274182 [debug] [MainThread]: SQL status: BEGIN in 1.31 seconds
16:21:29.279479 [debug] [MainThread]: Using redshift connection "master"
16:21:29.282554 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
16:21:29.453651 [debug] [MainThread]: SQL status: SELECT in 0.17 seconds
16:21:29.459577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '861d3bbf-cf9a-4797-86fc-eb6b10545338', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad714d98e0>]}
16:21:29.462609 [debug] [MainThread]: On master: ROLLBACK
16:21:29.603353 [debug] [MainThread]: Using redshift connection "master"
16:21:29.610397 [debug] [MainThread]: On master: BEGIN
16:21:29.888112 [debug] [MainThread]: SQL status: BEGIN in 0.27 seconds
16:21:29.892490 [debug] [MainThread]: On master: COMMIT
16:21:29.895812 [debug] [MainThread]: Using redshift connection "master"
16:21:29.899261 [debug] [MainThread]: On master: COMMIT
16:21:30.038143 [debug] [MainThread]: SQL status: COMMIT in 0.14 seconds
16:21:30.041429 [debug] [MainThread]: On master: Close
16:21:30.046050 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
16:21:30.050113 [info ] [MainThread]: 
16:21:30.073558 [debug] [Thread-1  ]: Began running node model.analytics_dbt.tb_vendas_primeiro_trimestre
16:21:30.080799 [info ] [Thread-1  ]: 1 of 1 START table model public.tb_vendas_primeiro_trimestre ................... [RUN]
16:21:30.092933 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.tb_vendas_primeiro_trimestre"
16:21:30.099725 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.tb_vendas_primeiro_trimestre
16:21:30.103487 [debug] [Thread-1  ]: Compiling model.analytics_dbt.tb_vendas_primeiro_trimestre
16:21:30.118169 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.tb_vendas_primeiro_trimestre"
16:21:30.145144 [debug] [Thread-1  ]: finished collecting timing info
16:21:30.149099 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.tb_vendas_primeiro_trimestre
16:21:30.254681 [debug] [Thread-1  ]: Writing runtime SQL for node "model.analytics_dbt.tb_vendas_primeiro_trimestre"
16:21:30.271667 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_vendas_primeiro_trimestre"
16:21:30.280306 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: BEGIN
16:21:30.283284 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
16:21:30.286381 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
16:21:31.586115 [debug] [Thread-1  ]: SQL status: BEGIN in 1.3 seconds
16:21:31.589548 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_vendas_primeiro_trimestre"
16:21:31.591849 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.tb_vendas_primeiro_trimestre"} */


  create  table
    "dev"."public"."tb_vendas_primeiro_trimestre__dbt_tmp"
    
    
    
  as (
    -- define o as variáveis meses e ano



-- cria a fonte com os dados de date e converte o  nome das colunas
with source_date as (
    select  dateid as id_date,
            month as mes,
            year as ano
    from date

),
-- cria uma fonte de dados unindo a tabela sales com date
sales_date as (

    select  source_date.mes, 
            sum(quantidade_vendida)
    from  "dev"."public"."vw_sales" sales inner join source_date
    on sales.id_date = source_date.id_date
    where source_date.mes in ('JAN', 'FEB', 'MAR')
    and source_date.ano = '2008'
    group by source_date.mes
)
select * from sales_date
  );
16:21:37.293416 [debug] [Thread-1  ]: SQL status: SELECT in 5.7 seconds
16:21:37.311313 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_vendas_primeiro_trimestre"
16:21:37.313758 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.tb_vendas_primeiro_trimestre"} */
alter table "dev"."public"."tb_vendas_primeiro_trimestre" rename to "tb_vendas_primeiro_trimestre__dbt_backup"
16:21:37.481741 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.17 seconds
16:21:37.490053 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_vendas_primeiro_trimestre"
16:21:37.492008 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.tb_vendas_primeiro_trimestre"} */
alter table "dev"."public"."tb_vendas_primeiro_trimestre__dbt_tmp" rename to "tb_vendas_primeiro_trimestre"
16:21:37.634283 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.14 seconds
16:21:37.664855 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: COMMIT
16:21:37.668008 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_vendas_primeiro_trimestre"
16:21:37.671662 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: COMMIT
16:21:37.853737 [debug] [Thread-1  ]: SQL status: COMMIT in 0.18 seconds
16:21:37.859538 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_vendas_primeiro_trimestre"
16:21:37.862830 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: BEGIN
16:21:38.005852 [debug] [Thread-1  ]: SQL status: BEGIN in 0.14 seconds
16:21:38.021576 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_vendas_primeiro_trimestre"
16:21:38.025338 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.tb_vendas_primeiro_trimestre"} */
drop table if exists "dev"."public"."tb_vendas_primeiro_trimestre__dbt_backup" cascade
16:21:38.175133 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.14 seconds
16:21:38.179127 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: COMMIT
16:21:38.181319 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_vendas_primeiro_trimestre"
16:21:38.183839 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: COMMIT
16:21:38.350728 [debug] [Thread-1  ]: SQL status: COMMIT in 0.16 seconds
16:21:38.355290 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_vendas_primeiro_trimestre"
16:21:38.358440 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: BEGIN
16:21:38.500672 [debug] [Thread-1  ]: SQL status: BEGIN in 0.14 seconds
16:21:38.505549 [debug] [Thread-1  ]: finished collecting timing info
16:21:38.509681 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: ROLLBACK
16:21:38.655113 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: Close
16:21:38.661676 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '861d3bbf-cf9a-4797-86fc-eb6b10545338', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad70c858b0>]}
16:21:38.665600 [info ] [Thread-1  ]: 1 of 1 OK created table model public.tb_vendas_primeiro_trimestre .............. [[32mSELECT[0m in 8.57s]
16:21:38.669892 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.tb_vendas_primeiro_trimestre
16:21:38.678838 [debug] [MainThread]: Acquiring new redshift connection "master"
16:21:38.683371 [debug] [MainThread]: Using redshift connection "master"
16:21:38.690812 [debug] [MainThread]: On master: BEGIN
16:21:38.694389 [debug] [MainThread]: Opening a new connection, currently in state closed
16:21:38.697975 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
16:21:39.960233 [debug] [MainThread]: SQL status: BEGIN in 1.27 seconds
16:21:39.963031 [debug] [MainThread]: On master: COMMIT
16:21:39.966371 [debug] [MainThread]: Using redshift connection "master"
16:21:39.969346 [debug] [MainThread]: On master: COMMIT
16:21:40.110390 [debug] [MainThread]: SQL status: COMMIT in 0.14 seconds
16:21:40.113906 [debug] [MainThread]: On master: Close
16:21:40.118421 [info ] [MainThread]: 
16:21:40.122834 [info ] [MainThread]: Finished running 1 table model in 15.47s.
16:21:40.128795 [debug] [MainThread]: Connection 'master' was properly closed.
16:21:40.135390 [debug] [MainThread]: Connection 'list_dev' was properly closed.
16:21:40.145201 [debug] [MainThread]: Connection 'model.analytics_dbt.tb_vendas_primeiro_trimestre' was properly closed.
16:21:40.290756 [info ] [MainThread]: 
16:21:40.294591 [info ] [MainThread]: [32mCompleted successfully[0m
16:21:40.306544 [info ] [MainThread]: 
16:21:40.398347 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
16:21:40.422625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad71d962e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad714eff40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad714eff10>]}


============================== 2022-05-23 17:41:31.773557 | 47de88e9-1d9a-448c-b11f-ff6a15d063ef ==============================
17:41:31.773588 [info ] [MainThread]: Running with dbt=1.1.0
17:41:31.778583 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['models/tables/tb_vendas_primeiro_trimestre.sql'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
17:41:31.792977 [debug] [MainThread]: Tracking: tracking
17:41:31.839682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a8fa7f760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a8fa7f820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a8fa7f850>]}
17:41:32.041154 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
17:41:32.047392 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
17:41:32.075256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '47de88e9-1d9a-448c-b11f-ff6a15d063ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a8f9a96a0>]}
17:41:32.132532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '47de88e9-1d9a-448c-b11f-ff6a15d063ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a8fa39160>]}
17:41:32.142119 [info ] [MainThread]: Found 5 models, 4 tests, 0 snapshots, 0 analyses, 193 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
17:41:32.149014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '47de88e9-1d9a-448c-b11f-ff6a15d063ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a8fa39370>]}
17:41:32.177443 [info ] [MainThread]: 
17:41:32.193842 [debug] [MainThread]: Acquiring new redshift connection "master"
17:41:32.227366 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev"
17:41:32.279509 [debug] [ThreadPool]: Using redshift connection "list_dev"
17:41:32.283176 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
  
17:41:32.288314 [debug] [ThreadPool]: Opening a new connection, currently in state init
17:41:32.292071 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
17:41:33.589608 [debug] [ThreadPool]: SQL status: SELECT in 1.3 seconds
17:41:33.596286 [debug] [ThreadPool]: On list_dev: Close
17:41:33.606017 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev_public"
17:41:33.626583 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
17:41:33.629350 [debug] [ThreadPool]: On list_dev_public: BEGIN
17:41:33.633059 [debug] [ThreadPool]: Opening a new connection, currently in state init
17:41:33.636889 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
17:41:34.941505 [debug] [ThreadPool]: SQL status: BEGIN in 1.31 seconds
17:41:34.944221 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
17:41:34.946519 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev_public"} */
select
      'dev' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dev' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
17:41:35.099335 [debug] [ThreadPool]: SQL status: SELECT in 0.15 seconds
17:41:35.105339 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
17:41:35.249958 [debug] [ThreadPool]: On list_dev_public: Close
17:41:35.267011 [debug] [MainThread]: Using redshift connection "master"
17:41:35.271029 [debug] [MainThread]: On master: BEGIN
17:41:35.275035 [debug] [MainThread]: Opening a new connection, currently in state init
17:41:35.277676 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
17:41:36.524755 [debug] [MainThread]: SQL status: BEGIN in 1.25 seconds
17:41:36.528897 [debug] [MainThread]: Using redshift connection "master"
17:41:36.532297 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
17:41:36.731475 [debug] [MainThread]: SQL status: SELECT in 0.19 seconds
17:41:36.736360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '47de88e9-1d9a-448c-b11f-ff6a15d063ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a8fa989a0>]}
17:41:36.740575 [debug] [MainThread]: On master: ROLLBACK
17:41:36.905239 [debug] [MainThread]: Using redshift connection "master"
17:41:36.908906 [debug] [MainThread]: On master: BEGIN
17:41:37.172391 [debug] [MainThread]: SQL status: BEGIN in 0.26 seconds
17:41:37.175863 [debug] [MainThread]: On master: COMMIT
17:41:37.178493 [debug] [MainThread]: Using redshift connection "master"
17:41:37.180805 [debug] [MainThread]: On master: COMMIT
17:41:37.316437 [debug] [MainThread]: SQL status: COMMIT in 0.13 seconds
17:41:37.319924 [debug] [MainThread]: On master: Close
17:41:37.324192 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
17:41:37.329882 [info ] [MainThread]: 
17:41:37.365863 [debug] [Thread-1  ]: Began running node model.analytics_dbt.tb_vendas_primeiro_trimestre
17:41:37.371403 [info ] [Thread-1  ]: 1 of 1 START table model public.tb_vendas_primeiro_trimestre ................... [RUN]
17:41:37.382094 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.tb_vendas_primeiro_trimestre"
17:41:37.389776 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.tb_vendas_primeiro_trimestre
17:41:37.393954 [debug] [Thread-1  ]: Compiling model.analytics_dbt.tb_vendas_primeiro_trimestre
17:41:37.421176 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.tb_vendas_primeiro_trimestre"
17:41:37.449378 [debug] [Thread-1  ]: finished collecting timing info
17:41:37.454196 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.tb_vendas_primeiro_trimestre
17:41:37.564155 [debug] [Thread-1  ]: Writing runtime SQL for node "model.analytics_dbt.tb_vendas_primeiro_trimestre"
17:41:37.583829 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_vendas_primeiro_trimestre"
17:41:37.588867 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: BEGIN
17:41:37.592623 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
17:41:37.595404 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
17:41:38.809394 [debug] [Thread-1  ]: SQL status: BEGIN in 1.22 seconds
17:41:38.812359 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_vendas_primeiro_trimestre"
17:41:38.815107 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.tb_vendas_primeiro_trimestre"} */


  create  table
    "dev"."public"."tb_vendas_primeiro_trimestre__dbt_tmp"
    
    
    
  as (
    -- define o as variáveis meses e ano



-- cria a fonte com os dados de date e converte o  nome das colunas
with source_date as (
    select  dateid as id_date,
            month as mes,
            year as ano
    from date

),
-- cria uma fonte de dados unindo a tabela sales com date
sales_date as (

    select  source_date.mes, 
            sum(quantidade_vendida)
    from  "dev"."public"."vw_sales" sales inner join source_date
    on sales.id_date = source_date.id_date
    where source_date.mes in ('JAN', 'FEB', 'MAR')
    and source_date.ano = '2008'
    group by source_date.mes
)
select * from sales_date
  );
17:41:39.310802 [debug] [Thread-1  ]: SQL status: SELECT in 0.49 seconds
17:41:39.332357 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_vendas_primeiro_trimestre"
17:41:39.335206 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.tb_vendas_primeiro_trimestre"} */
alter table "dev"."public"."tb_vendas_primeiro_trimestre" rename to "tb_vendas_primeiro_trimestre__dbt_backup"
17:41:39.468690 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.13 seconds
17:41:39.478275 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_vendas_primeiro_trimestre"
17:41:39.481293 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.tb_vendas_primeiro_trimestre"} */
alter table "dev"."public"."tb_vendas_primeiro_trimestre__dbt_tmp" rename to "tb_vendas_primeiro_trimestre"
17:41:39.616881 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.13 seconds
17:41:39.651632 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: COMMIT
17:41:39.655835 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_vendas_primeiro_trimestre"
17:41:39.659057 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: COMMIT
17:41:39.838496 [debug] [Thread-1  ]: SQL status: COMMIT in 0.18 seconds
17:41:39.844466 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_vendas_primeiro_trimestre"
17:41:39.847197 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: BEGIN
17:41:39.979476 [debug] [Thread-1  ]: SQL status: BEGIN in 0.13 seconds
17:41:39.993753 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_vendas_primeiro_trimestre"
17:41:39.996756 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.tb_vendas_primeiro_trimestre"} */
drop table if exists "dev"."public"."tb_vendas_primeiro_trimestre__dbt_backup" cascade
17:41:40.135549 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.13 seconds
17:41:40.139550 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: COMMIT
17:41:40.143005 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_vendas_primeiro_trimestre"
17:41:40.145944 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: COMMIT
17:41:40.305454 [debug] [Thread-1  ]: SQL status: COMMIT in 0.16 seconds
17:41:40.309258 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_vendas_primeiro_trimestre"
17:41:40.312305 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: BEGIN
17:41:40.444556 [debug] [Thread-1  ]: SQL status: BEGIN in 0.13 seconds
17:41:40.448273 [debug] [Thread-1  ]: finished collecting timing info
17:41:40.451380 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: ROLLBACK
17:41:40.590060 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: Close
17:41:40.596464 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '47de88e9-1d9a-448c-b11f-ff6a15d063ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a8e8b68e0>]}
17:41:40.601905 [info ] [Thread-1  ]: 1 of 1 OK created table model public.tb_vendas_primeiro_trimestre .............. [[32mSELECT[0m in 3.21s]
17:41:40.606666 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.tb_vendas_primeiro_trimestre
17:41:40.615514 [debug] [MainThread]: Acquiring new redshift connection "master"
17:41:40.618898 [debug] [MainThread]: Using redshift connection "master"
17:41:40.624288 [debug] [MainThread]: On master: BEGIN
17:41:40.630473 [debug] [MainThread]: Opening a new connection, currently in state closed
17:41:40.638676 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
17:41:41.855333 [debug] [MainThread]: SQL status: BEGIN in 1.22 seconds
17:41:41.858889 [debug] [MainThread]: On master: COMMIT
17:41:41.862511 [debug] [MainThread]: Using redshift connection "master"
17:41:41.865869 [debug] [MainThread]: On master: COMMIT
17:41:42.011619 [debug] [MainThread]: SQL status: COMMIT in 0.14 seconds
17:41:42.014945 [debug] [MainThread]: On master: Close
17:41:42.019439 [info ] [MainThread]: 
17:41:42.025601 [info ] [MainThread]: Finished running 1 table model in 9.83s.
17:41:42.032659 [debug] [MainThread]: Connection 'master' was properly closed.
17:41:42.042102 [debug] [MainThread]: Connection 'list_dev' was properly closed.
17:41:42.051977 [debug] [MainThread]: Connection 'model.analytics_dbt.tb_vendas_primeiro_trimestre' was properly closed.
17:41:42.119999 [info ] [MainThread]: 
17:41:42.128603 [info ] [MainThread]: [32mCompleted successfully[0m
17:41:42.137243 [info ] [MainThread]: 
17:41:42.146686 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
17:41:42.162697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a8f120fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a8f120fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a8f120ca0>]}


============================== 2022-05-23 17:58:34.169372 | 0f1eb94d-c998-4ce3-8518-c11c9af8a1a0 ==============================
17:58:34.169394 [info ] [MainThread]: Running with dbt=1.1.0
17:58:34.174063 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
17:58:34.183091 [debug] [MainThread]: Tracking: tracking
17:58:34.217828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5cc90e0790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5cc90e0850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5cc90e0880>]}
17:58:34.341749 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
17:58:34.345709 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
17:58:34.363012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0f1eb94d-c998-4ce3-8518-c11c9af8a1a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5cc900a730>]}
17:58:34.403760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0f1eb94d-c998-4ce3-8518-c11c9af8a1a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5cc90272b0>]}
17:58:34.409400 [info ] [MainThread]: Found 5 models, 4 tests, 0 snapshots, 0 analyses, 193 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
17:58:34.416195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0f1eb94d-c998-4ce3-8518-c11c9af8a1a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5cc9027250>]}
17:58:34.438311 [info ] [MainThread]: 
17:58:34.443788 [debug] [MainThread]: Acquiring new redshift connection "master"
17:58:34.460572 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev_public"
17:58:34.516684 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
17:58:34.519273 [debug] [ThreadPool]: On list_dev_public: BEGIN
17:58:34.522891 [debug] [ThreadPool]: Opening a new connection, currently in state init
17:58:34.526042 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
17:58:35.765902 [debug] [ThreadPool]: SQL status: BEGIN in 1.24 seconds
17:58:35.768849 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
17:58:35.771429 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev_public"} */
select
      'dev' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dev' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
17:58:35.913264 [debug] [ThreadPool]: SQL status: SELECT in 0.14 seconds
17:58:35.920744 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
17:58:36.051428 [debug] [ThreadPool]: On list_dev_public: Close
17:58:36.069915 [debug] [MainThread]: Using redshift connection "master"
17:58:36.072578 [debug] [MainThread]: On master: BEGIN
17:58:36.075499 [debug] [MainThread]: Opening a new connection, currently in state init
17:58:36.078600 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
17:58:37.258119 [debug] [MainThread]: SQL status: BEGIN in 1.18 seconds
17:58:37.260888 [debug] [MainThread]: Using redshift connection "master"
17:58:37.263470 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
17:58:37.425894 [debug] [MainThread]: SQL status: SELECT in 0.16 seconds
17:58:37.432143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0f1eb94d-c998-4ce3-8518-c11c9af8a1a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5cc909bca0>]}
17:58:37.437477 [debug] [MainThread]: On master: ROLLBACK
17:58:37.569934 [debug] [MainThread]: Using redshift connection "master"
17:58:37.573221 [debug] [MainThread]: On master: BEGIN
17:58:37.831239 [debug] [MainThread]: SQL status: BEGIN in 0.26 seconds
17:58:37.835409 [debug] [MainThread]: On master: COMMIT
17:58:37.838522 [debug] [MainThread]: Using redshift connection "master"
17:58:37.840860 [debug] [MainThread]: On master: COMMIT
17:58:37.971853 [debug] [MainThread]: SQL status: COMMIT in 0.13 seconds
17:58:37.974241 [debug] [MainThread]: On master: Close
17:58:37.991867 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
17:58:37.996823 [info ] [MainThread]: 
17:58:38.066095 [debug] [Thread-1  ]: Began running node test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
17:58:38.104211 [info ] [Thread-1  ]: 1 of 4 START test not_null_my_first_dbt_model_id ............................... [RUN]
17:58:38.160496 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
17:58:38.198481 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
17:58:38.206703 [debug] [Thread-1  ]: Compiling test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
17:58:38.534667 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
17:58:38.559510 [debug] [Thread-1  ]: finished collecting timing info
17:58:38.565216 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
17:58:38.687428 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
17:58:38.752899 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
17:58:38.759284 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710: BEGIN
17:58:38.764520 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
17:58:38.770095 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
17:58:39.989444 [debug] [Thread-1  ]: SQL status: BEGIN in 1.22 seconds
17:58:39.998318 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
17:58:40.005133 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dev"."public"."my_first_dbt_model"
where id is null



      
    ) dbt_internal_test
17:58:40.345237 [debug] [Thread-1  ]: SQL status: SELECT in 0.33 seconds
17:58:40.355918 [debug] [Thread-1  ]: finished collecting timing info
17:58:40.359935 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
17:58:40.494818 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710: Close
17:58:40.499668 [error] [Thread-1  ]: 1 of 4 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 2.34s]
17:58:40.505011 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
17:58:40.511708 [debug] [Thread-1  ]: Began running node test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
17:58:40.515551 [info ] [Thread-1  ]: 2 of 4 START test not_null_my_second_dbt_model_id .............................. [RUN]
17:58:40.521094 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"
17:58:40.525348 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
17:58:40.529169 [debug] [Thread-1  ]: Compiling test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
17:58:40.546267 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"
17:58:40.560206 [debug] [Thread-1  ]: finished collecting timing info
17:58:40.564339 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
17:58:40.581464 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"
17:58:40.690211 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"
17:58:40.694905 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778: BEGIN
17:58:40.698834 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
17:58:40.702505 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
17:58:41.950620 [debug] [Thread-1  ]: SQL status: BEGIN in 1.25 seconds
17:58:41.953938 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"
17:58:41.957787 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dev"."public"."my_second_dbt_model"
where id is null



      
    ) dbt_internal_test
17:58:42.101924 [debug] [Thread-1  ]: SQL status: SELECT in 0.14 seconds
17:58:42.107949 [debug] [Thread-1  ]: finished collecting timing info
17:58:42.111557 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778: ROLLBACK
17:58:42.243094 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778: Close
17:58:42.248583 [info ] [Thread-1  ]: 2 of 4 PASS not_null_my_second_dbt_model_id .................................... [[32mPASS[0m in 1.73s]
17:58:42.253515 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
17:58:42.259063 [debug] [Thread-1  ]: Began running node test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
17:58:42.264455 [info ] [Thread-1  ]: 3 of 4 START test unique_my_first_dbt_model_id ................................. [RUN]
17:58:42.271212 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"
17:58:42.288027 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
17:58:42.293271 [debug] [Thread-1  ]: Compiling test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
17:58:42.335281 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"
17:58:42.352331 [debug] [Thread-1  ]: finished collecting timing info
17:58:42.358031 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
17:58:42.376483 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"
17:58:42.411751 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"
17:58:42.417247 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321: BEGIN
17:58:42.426640 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
17:58:42.432155 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
17:58:43.628538 [debug] [Thread-1  ]: SQL status: BEGIN in 1.2 seconds
17:58:43.643833 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"
17:58:43.664700 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dev"."public"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
17:58:43.973665 [debug] [Thread-1  ]: SQL status: SELECT in 0.3 seconds
17:58:43.979948 [debug] [Thread-1  ]: finished collecting timing info
17:58:43.983886 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
17:58:44.115872 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321: Close
17:58:44.120960 [info ] [Thread-1  ]: 3 of 4 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 1.85s]
17:58:44.126413 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
17:58:44.130982 [debug] [Thread-1  ]: Began running node test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
17:58:44.134322 [info ] [Thread-1  ]: 4 of 4 START test unique_my_second_dbt_model_id ................................ [RUN]
17:58:44.141125 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"
17:58:44.145592 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
17:58:44.149142 [debug] [Thread-1  ]: Compiling test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
17:58:44.167431 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"
17:58:44.181408 [debug] [Thread-1  ]: finished collecting timing info
17:58:44.186111 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
17:58:44.198172 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"
17:58:44.215866 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"
17:58:44.221482 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493: BEGIN
17:58:44.224987 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
17:58:44.228033 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
17:58:45.467945 [debug] [Thread-1  ]: SQL status: BEGIN in 1.24 seconds
17:58:45.472431 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"
17:58:45.475392 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dev"."public"."my_second_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
17:58:45.725400 [debug] [Thread-1  ]: SQL status: SELECT in 0.25 seconds
17:58:45.732063 [debug] [Thread-1  ]: finished collecting timing info
17:58:45.735986 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493: ROLLBACK
17:58:45.870889 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493: Close
17:58:45.876640 [info ] [Thread-1  ]: 4 of 4 PASS unique_my_second_dbt_model_id ...................................... [[32mPASS[0m in 1.74s]
17:58:45.880747 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
17:58:45.890768 [debug] [MainThread]: Acquiring new redshift connection "master"
17:58:45.896013 [debug] [MainThread]: Using redshift connection "master"
17:58:45.907638 [debug] [MainThread]: On master: BEGIN
17:58:45.916491 [debug] [MainThread]: Opening a new connection, currently in state closed
17:58:45.925427 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
17:58:47.109445 [debug] [MainThread]: SQL status: BEGIN in 1.19 seconds
17:58:47.112195 [debug] [MainThread]: On master: COMMIT
17:58:47.114477 [debug] [MainThread]: Using redshift connection "master"
17:58:47.117067 [debug] [MainThread]: On master: COMMIT
17:58:47.250302 [debug] [MainThread]: SQL status: COMMIT in 0.13 seconds
17:58:47.253425 [debug] [MainThread]: On master: Close
17:58:47.257426 [info ] [MainThread]: 
17:58:47.261256 [info ] [MainThread]: Finished running 4 tests in 12.81s.
17:58:47.267472 [debug] [MainThread]: Connection 'master' was properly closed.
17:58:47.277721 [debug] [MainThread]: Connection 'test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
17:58:47.330407 [info ] [MainThread]: 
17:58:47.339205 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
17:58:47.350938 [info ] [MainThread]: 
17:58:47.356132 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models/example/schema.yml)[0m
17:58:47.362874 [error] [MainThread]:   Got 1 result, configured to fail if != 0
17:58:47.371000 [info ] [MainThread]: 
17:58:47.391132 [info ] [MainThread]:   compiled SQL at target/compiled/analytics_dbt/models/example/schema.yml/not_null_my_first_dbt_model_id.sql
17:58:47.408208 [info ] [MainThread]: 
17:58:47.424053 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
17:58:47.437879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5cc8fcfeb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5cc876ef70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5cc90273d0>]}


============================== 2022-05-23 18:02:07.154776 | 09d0a6ba-89c9-457b-b4f9-a3ee04a29af8 ==============================
18:02:07.154893 [info ] [MainThread]: Running with dbt=1.1.0
18:02:07.158378 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
18:02:07.162503 [debug] [MainThread]: Tracking: tracking
18:02:07.193164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f229d4d1760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f229d4d1820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f229d4d1850>]}
18:02:07.326057 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
18:02:07.349348 [debug] [MainThread]: Partial parsing: update schema file: analytics_dbt://models/example/schema.yml
18:02:07.460089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '09d0a6ba-89c9-457b-b4f9-a3ee04a29af8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f229d37bf10>]}
18:02:07.493996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '09d0a6ba-89c9-457b-b4f9-a3ee04a29af8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f229d3ebdc0>]}
18:02:07.498059 [info ] [MainThread]: Found 5 models, 5 tests, 0 snapshots, 0 analyses, 193 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
18:02:07.501289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '09d0a6ba-89c9-457b-b4f9-a3ee04a29af8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f229d3ebfa0>]}
18:02:07.511180 [info ] [MainThread]: 
18:02:07.519925 [debug] [MainThread]: Acquiring new redshift connection "master"
18:02:07.532447 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev_public"
18:02:07.569912 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
18:02:07.575619 [debug] [ThreadPool]: On list_dev_public: BEGIN
18:02:07.579573 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:02:07.582942 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
18:02:08.811695 [debug] [ThreadPool]: SQL status: BEGIN in 1.23 seconds
18:02:08.814255 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
18:02:08.817609 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev_public"} */
select
      'dev' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dev' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
18:02:08.959743 [debug] [ThreadPool]: SQL status: SELECT in 0.14 seconds
18:02:08.965689 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
18:02:09.101277 [debug] [ThreadPool]: On list_dev_public: Close
18:02:09.115514 [debug] [MainThread]: Using redshift connection "master"
18:02:09.118991 [debug] [MainThread]: On master: BEGIN
18:02:09.122176 [debug] [MainThread]: Opening a new connection, currently in state init
18:02:09.125339 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
18:02:10.316118 [debug] [MainThread]: SQL status: BEGIN in 1.19 seconds
18:02:10.319095 [debug] [MainThread]: Using redshift connection "master"
18:02:10.322501 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
18:02:10.483965 [debug] [MainThread]: SQL status: SELECT in 0.16 seconds
18:02:10.489340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '09d0a6ba-89c9-457b-b4f9-a3ee04a29af8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f229d3ebc10>]}
18:02:10.492158 [debug] [MainThread]: On master: ROLLBACK
18:02:10.622158 [debug] [MainThread]: Using redshift connection "master"
18:02:10.625736 [debug] [MainThread]: On master: BEGIN
18:02:10.888868 [debug] [MainThread]: SQL status: BEGIN in 0.26 seconds
18:02:10.891456 [debug] [MainThread]: On master: COMMIT
18:02:10.894039 [debug] [MainThread]: Using redshift connection "master"
18:02:10.896928 [debug] [MainThread]: On master: COMMIT
18:02:11.026333 [debug] [MainThread]: SQL status: COMMIT in 0.13 seconds
18:02:11.029836 [debug] [MainThread]: On master: Close
18:02:11.035326 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
18:02:11.040740 [info ] [MainThread]: 
18:02:11.060393 [debug] [Thread-1  ]: Began running node test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
18:02:11.065528 [info ] [Thread-1  ]: 1 of 5 START test not_null_my_first_dbt_model_id ............................... [RUN]
18:02:11.078289 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
18:02:11.088649 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
18:02:11.092333 [debug] [Thread-1  ]: Compiling test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
18:02:11.134590 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
18:02:11.145812 [debug] [Thread-1  ]: finished collecting timing info
18:02:11.149727 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
18:02:11.193627 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
18:02:11.206348 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
18:02:11.210016 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710: BEGIN
18:02:11.214311 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:02:11.218874 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
18:02:12.423892 [debug] [Thread-1  ]: SQL status: BEGIN in 1.21 seconds
18:02:12.426374 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
18:02:12.428416 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dev"."public"."my_first_dbt_model"
where id is null



      
    ) dbt_internal_test
18:02:12.562073 [debug] [Thread-1  ]: SQL status: SELECT in 0.13 seconds
18:02:12.569856 [debug] [Thread-1  ]: finished collecting timing info
18:02:12.572015 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
18:02:12.706278 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710: Close
18:02:12.710047 [error] [Thread-1  ]: 1 of 5 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 1.63s]
18:02:12.714676 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
18:02:12.720815 [debug] [Thread-1  ]: Began running node test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
18:02:12.726272 [info ] [Thread-1  ]: 2 of 5 START test not_null_my_second_dbt_model_id .............................. [RUN]
18:02:12.734977 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"
18:02:12.741915 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
18:02:12.744477 [debug] [Thread-1  ]: Compiling test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
18:02:12.770657 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"
18:02:12.780877 [debug] [Thread-1  ]: finished collecting timing info
18:02:12.785709 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
18:02:12.793489 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"
18:02:12.805971 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"
18:02:12.810133 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778: BEGIN
18:02:12.812724 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:02:12.816917 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
18:02:14.006612 [debug] [Thread-1  ]: SQL status: BEGIN in 1.19 seconds
18:02:14.009163 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"
18:02:14.012307 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dev"."public"."my_second_dbt_model"
where id is null



      
    ) dbt_internal_test
18:02:14.160579 [debug] [Thread-1  ]: SQL status: SELECT in 0.14 seconds
18:02:14.165554 [debug] [Thread-1  ]: finished collecting timing info
18:02:14.167965 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778: ROLLBACK
18:02:14.300351 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778: Close
18:02:14.305613 [info ] [Thread-1  ]: 2 of 5 PASS not_null_my_second_dbt_model_id .................................... [[32mPASS[0m in 1.57s]
18:02:14.309755 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
18:02:14.315063 [debug] [Thread-1  ]: Began running node test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752
18:02:14.322311 [info ] [Thread-1  ]: 3 of 5 START test not_null_tb_10_compradores_vendas_totais ..................... [RUN]
18:02:14.331071 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752"
18:02:14.336247 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752
18:02:14.343683 [debug] [Thread-1  ]: Compiling test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752
18:02:14.360849 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752"
18:02:14.377309 [debug] [Thread-1  ]: finished collecting timing info
18:02:14.382264 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752
18:02:14.389728 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752"
18:02:14.400949 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752"
18:02:14.404806 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752: BEGIN
18:02:14.407719 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:02:14.410950 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
18:02:15.591309 [debug] [Thread-1  ]: SQL status: BEGIN in 1.18 seconds
18:02:15.593883 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752"
18:02:15.596731 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select vendas_totais
from "dev"."public"."tb_10_compradores"
where vendas_totais is null



      
    ) dbt_internal_test
18:02:15.841856 [debug] [Thread-1  ]: SQL status: SELECT in 0.24 seconds
18:02:15.846836 [debug] [Thread-1  ]: finished collecting timing info
18:02:15.849286 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752: ROLLBACK
18:02:15.979410 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752: Close
18:02:15.984353 [info ] [Thread-1  ]: 3 of 5 PASS not_null_tb_10_compradores_vendas_totais ........................... [[32mPASS[0m in 1.65s]
18:02:15.989099 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752
18:02:15.994638 [debug] [Thread-1  ]: Began running node test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
18:02:16.001491 [info ] [Thread-1  ]: 4 of 5 START test unique_my_first_dbt_model_id ................................. [RUN]
18:02:16.013538 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"
18:02:16.023553 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
18:02:16.028072 [debug] [Thread-1  ]: Compiling test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
18:02:16.057428 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"
18:02:16.068417 [debug] [Thread-1  ]: finished collecting timing info
18:02:16.073151 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
18:02:16.092052 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"
18:02:16.104639 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"
18:02:16.110528 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321: BEGIN
18:02:16.114103 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:02:16.117691 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
18:02:17.287982 [debug] [Thread-1  ]: SQL status: BEGIN in 1.17 seconds
18:02:17.290938 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"
18:02:17.293045 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dev"."public"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
18:02:17.424898 [debug] [Thread-1  ]: SQL status: SELECT in 0.13 seconds
18:02:17.429471 [debug] [Thread-1  ]: finished collecting timing info
18:02:17.431689 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
18:02:17.563852 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321: Close
18:02:17.567734 [info ] [Thread-1  ]: 4 of 5 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 1.56s]
18:02:17.572991 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
18:02:17.576944 [debug] [Thread-1  ]: Began running node test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
18:02:17.584018 [info ] [Thread-1  ]: 5 of 5 START test unique_my_second_dbt_model_id ................................ [RUN]
18:02:17.591149 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"
18:02:17.597289 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
18:02:17.604130 [debug] [Thread-1  ]: Compiling test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
18:02:17.623003 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"
18:02:17.635988 [debug] [Thread-1  ]: finished collecting timing info
18:02:17.641700 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
18:02:17.651590 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"
18:02:17.659963 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"
18:02:17.663349 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493: BEGIN
18:02:17.665739 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:02:17.669002 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
18:02:18.854664 [debug] [Thread-1  ]: SQL status: BEGIN in 1.19 seconds
18:02:18.857481 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"
18:02:18.860617 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dev"."public"."my_second_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
18:02:18.993049 [debug] [Thread-1  ]: SQL status: SELECT in 0.13 seconds
18:02:18.998044 [debug] [Thread-1  ]: finished collecting timing info
18:02:19.000863 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493: ROLLBACK
18:02:19.132819 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493: Close
18:02:19.137145 [info ] [Thread-1  ]: 5 of 5 PASS unique_my_second_dbt_model_id ...................................... [[32mPASS[0m in 1.55s]
18:02:19.142543 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
18:02:19.151840 [debug] [MainThread]: Acquiring new redshift connection "master"
18:02:19.158907 [debug] [MainThread]: Using redshift connection "master"
18:02:19.165616 [debug] [MainThread]: On master: BEGIN
18:02:19.170840 [debug] [MainThread]: Opening a new connection, currently in state closed
18:02:19.174616 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
18:02:20.352648 [debug] [MainThread]: SQL status: BEGIN in 1.18 seconds
18:02:20.356018 [debug] [MainThread]: On master: COMMIT
18:02:20.359396 [debug] [MainThread]: Using redshift connection "master"
18:02:20.362320 [debug] [MainThread]: On master: COMMIT
18:02:20.473892 [debug] [MainThread]: SQL status: COMMIT in 0.11 seconds
18:02:20.477069 [debug] [MainThread]: On master: Close
18:02:20.481938 [info ] [MainThread]: 
18:02:20.486601 [info ] [MainThread]: Finished running 5 tests in 12.96s.
18:02:20.493664 [debug] [MainThread]: Connection 'master' was properly closed.
18:02:20.504848 [debug] [MainThread]: Connection 'test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
18:02:20.551375 [info ] [MainThread]: 
18:02:20.555144 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
18:02:20.560067 [info ] [MainThread]: 
18:02:20.568637 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models/example/schema.yml)[0m
18:02:20.576865 [error] [MainThread]:   Got 1 result, configured to fail if != 0
18:02:20.587270 [info ] [MainThread]: 
18:02:20.595660 [info ] [MainThread]:   compiled SQL at target/compiled/analytics_dbt/models/example/schema.yml/not_null_my_first_dbt_model_id.sql
18:02:20.607188 [info ] [MainThread]: 
18:02:20.620268 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
18:02:20.636911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f229d319b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f229d319610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f229d318f10>]}


============================== 2022-05-23 18:04:44.505892 | d40a100a-ed42-4793-8bb4-1e031207bcbb ==============================
18:04:44.505921 [info ] [MainThread]: Running with dbt=1.1.0
18:04:44.511367 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
18:04:44.522029 [debug] [MainThread]: Tracking: tracking
18:04:44.552302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc8711b730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc8711b7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc8711b7f0>]}
18:04:44.732712 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
18:04:44.736037 [debug] [MainThread]: Partial parsing: added file: analytics_dbt://tests/test_maior_que_zero.sql
18:04:44.740499 [debug] [MainThread]: Partial parsing: update schema file: analytics_dbt://models/example/schema.yml
18:04:44.790262 [debug] [MainThread]: 1699: static parser successfully parsed tables/tb_10_compradores.sql
18:04:44.971927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd40a100a-ed42-4793-8bb4-1e031207bcbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc86fd8130>]}
18:04:45.013192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd40a100a-ed42-4793-8bb4-1e031207bcbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc870a1ac0>]}
18:04:45.018451 [info ] [MainThread]: Found 5 models, 7 tests, 0 snapshots, 0 analyses, 193 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
18:04:45.024961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd40a100a-ed42-4793-8bb4-1e031207bcbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc87139190>]}
18:04:45.045196 [info ] [MainThread]: 
18:04:45.049420 [debug] [MainThread]: Acquiring new redshift connection "master"
18:04:45.070209 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev_public"
18:04:45.108059 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
18:04:45.117277 [debug] [ThreadPool]: On list_dev_public: BEGIN
18:04:45.120563 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:04:45.124178 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
18:04:46.337724 [debug] [ThreadPool]: SQL status: BEGIN in 1.22 seconds
18:04:46.340900 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
18:04:46.346224 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev_public"} */
select
      'dev' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dev' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
18:04:46.491314 [debug] [ThreadPool]: SQL status: SELECT in 0.14 seconds
18:04:46.498482 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
18:04:46.631775 [debug] [ThreadPool]: On list_dev_public: Close
18:04:46.649510 [debug] [MainThread]: Using redshift connection "master"
18:04:46.653140 [debug] [MainThread]: On master: BEGIN
18:04:46.656958 [debug] [MainThread]: Opening a new connection, currently in state init
18:04:46.660577 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
18:04:47.859985 [debug] [MainThread]: SQL status: BEGIN in 1.2 seconds
18:04:47.863228 [debug] [MainThread]: Using redshift connection "master"
18:04:47.865705 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
18:04:48.037456 [debug] [MainThread]: SQL status: SELECT in 0.16 seconds
18:04:48.042798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd40a100a-ed42-4793-8bb4-1e031207bcbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc87035b50>]}
18:04:48.045986 [debug] [MainThread]: On master: ROLLBACK
18:04:48.179115 [debug] [MainThread]: Using redshift connection "master"
18:04:48.182299 [debug] [MainThread]: On master: BEGIN
18:04:48.445758 [debug] [MainThread]: SQL status: BEGIN in 0.26 seconds
18:04:48.449753 [debug] [MainThread]: On master: COMMIT
18:04:48.452985 [debug] [MainThread]: Using redshift connection "master"
18:04:48.455695 [debug] [MainThread]: On master: COMMIT
18:04:48.589221 [debug] [MainThread]: SQL status: COMMIT in 0.13 seconds
18:04:48.592460 [debug] [MainThread]: On master: Close
18:04:48.596488 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
18:04:48.600414 [info ] [MainThread]: 
18:04:48.621841 [debug] [Thread-1  ]: Began running node test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
18:04:48.627282 [info ] [Thread-1  ]: 1 of 7 START test not_null_my_first_dbt_model_id ............................... [RUN]
18:04:48.638288 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
18:04:48.645456 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
18:04:48.650769 [debug] [Thread-1  ]: Compiling test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
18:04:48.686513 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
18:04:48.695444 [debug] [Thread-1  ]: finished collecting timing info
18:04:48.698483 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
18:04:48.737288 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
18:04:48.746140 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
18:04:48.749049 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710: BEGIN
18:04:48.751491 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:04:48.754337 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
18:04:49.964621 [debug] [Thread-1  ]: SQL status: BEGIN in 1.21 seconds
18:04:49.967256 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
18:04:49.969443 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dev"."public"."my_first_dbt_model"
where id is null



      
    ) dbt_internal_test
18:04:50.102569 [debug] [Thread-1  ]: SQL status: SELECT in 0.13 seconds
18:04:50.110157 [debug] [Thread-1  ]: finished collecting timing info
18:04:50.112480 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
18:04:50.244421 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710: Close
18:04:50.248406 [error] [Thread-1  ]: 1 of 7 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 1.61s]
18:04:50.252335 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
18:04:50.259059 [debug] [Thread-1  ]: Began running node test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
18:04:50.264727 [info ] [Thread-1  ]: 2 of 7 START test not_null_my_second_dbt_model_id .............................. [RUN]
18:04:50.273461 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"
18:04:50.281241 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
18:04:50.286822 [debug] [Thread-1  ]: Compiling test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
18:04:50.305565 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"
18:04:50.319441 [debug] [Thread-1  ]: finished collecting timing info
18:04:50.324978 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
18:04:50.334406 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"
18:04:50.344125 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"
18:04:50.347745 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778: BEGIN
18:04:50.351795 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:04:50.356716 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
18:04:51.519555 [debug] [Thread-1  ]: SQL status: BEGIN in 1.17 seconds
18:04:51.523064 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"
18:04:51.526536 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dev"."public"."my_second_dbt_model"
where id is null



      
    ) dbt_internal_test
18:04:51.667470 [debug] [Thread-1  ]: SQL status: SELECT in 0.14 seconds
18:04:51.677045 [debug] [Thread-1  ]: finished collecting timing info
18:04:51.680152 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778: ROLLBACK
18:04:51.810437 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778: Close
18:04:51.814901 [info ] [Thread-1  ]: 2 of 7 PASS not_null_my_second_dbt_model_id .................................... [[32mPASS[0m in 1.54s]
18:04:51.819141 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
18:04:51.825734 [debug] [Thread-1  ]: Began running node test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752
18:04:51.831804 [info ] [Thread-1  ]: 3 of 7 START test not_null_tb_10_compradores_vendas_totais ..................... [RUN]
18:04:51.839617 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752"
18:04:51.845042 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752
18:04:51.848423 [debug] [Thread-1  ]: Compiling test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752
18:04:51.871615 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752"
18:04:51.882116 [debug] [Thread-1  ]: finished collecting timing info
18:04:51.885981 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752
18:04:51.894736 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752"
18:04:51.902307 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752"
18:04:51.905453 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752: BEGIN
18:04:51.908742 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:04:51.912968 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
18:04:53.169985 [debug] [Thread-1  ]: SQL status: BEGIN in 1.26 seconds
18:04:53.175548 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752"
18:04:53.179011 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select vendas_totais
from "dev"."public"."tb_10_compradores"
where vendas_totais is null



      
    ) dbt_internal_test
18:04:53.317049 [debug] [Thread-1  ]: SQL status: SELECT in 0.13 seconds
18:04:53.323345 [debug] [Thread-1  ]: finished collecting timing info
18:04:53.326025 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752: ROLLBACK
18:04:53.456033 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752: Close
18:04:53.460397 [info ] [Thread-1  ]: 3 of 7 PASS not_null_tb_10_compradores_vendas_totais ........................... [[32mPASS[0m in 1.62s]
18:04:53.464878 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752
18:04:53.468534 [debug] [Thread-1  ]: Began running node test.analytics_dbt.test_maior_que_zero
18:04:53.475643 [info ] [Thread-1  ]: 4 of 7 START test test_maior_que_zero .......................................... [RUN]
18:04:53.484649 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.test_maior_que_zero"
18:04:53.490629 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.test_maior_que_zero
18:04:53.498323 [debug] [Thread-1  ]: Compiling test.analytics_dbt.test_maior_que_zero
18:04:53.515337 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.test_maior_que_zero"
18:04:53.519152 [debug] [Thread-1  ]: finished collecting timing info
18:04:53.523707 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.test_maior_que_zero
18:04:53.532464 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.test_maior_que_zero"
18:04:53.552479 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.test_maior_que_zero"
18:04:53.555253 [debug] [Thread-1  ]: On test.analytics_dbt.test_maior_que_zero: BEGIN
18:04:53.558587 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:04:53.561323 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
18:04:54.753246 [debug] [Thread-1  ]: SQL status: BEGIN in 1.19 seconds
18:04:54.756293 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.test_maior_que_zero"
18:04:54.760015 [debug] [Thread-1  ]: On test.analytics_dbt.test_maior_que_zero: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.test_maior_que_zero"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
      
    ) dbt_internal_test
18:04:54.892218 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near ")"
LINE 9:     ) dbt_internal_test
            ^

18:04:54.895010 [debug] [Thread-1  ]: On test.analytics_dbt.test_maior_que_zero: ROLLBACK
18:04:55.024668 [debug] [Thread-1  ]: finished collecting timing info
18:04:55.029003 [debug] [Thread-1  ]: On test.analytics_dbt.test_maior_que_zero: Close
18:04:55.033641 [debug] [Thread-1  ]: Database Error in test test_maior_que_zero (tests/test_maior_que_zero.sql)
  syntax error at or near ")"
  LINE 9:     ) dbt_internal_test
              ^
  compiled SQL at target/run/analytics_dbt/tests/test_maior_que_zero.sql
18:04:55.036766 [error] [Thread-1  ]: 4 of 7 ERROR test_maior_que_zero ............................................... [[31mERROR[0m in 1.55s]
18:04:55.042366 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.test_maior_que_zero
18:04:55.046442 [debug] [Thread-1  ]: Began running node test.analytics_dbt.test_maior_que_zero_tb_10_compradores_vendas_totais.4a8ff6ac49
18:04:55.057881 [info ] [Thread-1  ]: 5 of 7 START test test_maior_que_zero_tb_10_compradores_vendas_totais .......... [RUN]
18:04:55.065681 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.test_maior_que_zero_tb_10_compradores_vendas_totais.4a8ff6ac49"
18:04:55.069929 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.test_maior_que_zero_tb_10_compradores_vendas_totais.4a8ff6ac49
18:04:55.080714 [debug] [Thread-1  ]: Compiling test.analytics_dbt.test_maior_que_zero_tb_10_compradores_vendas_totais.4a8ff6ac49
18:04:55.096964 [debug] [Thread-1  ]: finished collecting timing info
18:04:55.102267 [debug] [Thread-1  ]: Compilation Error in test test_maior_que_zero_tb_10_compradores_vendas_totais (models/example/schema.yml)
  'test_test_maior_que_zero' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
18:04:55.107029 [error] [Thread-1  ]: 5 of 7 ERROR test_maior_que_zero_tb_10_compradores_vendas_totais ............... [[31mERROR[0m in 0.04s]
18:04:55.117712 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.test_maior_que_zero_tb_10_compradores_vendas_totais.4a8ff6ac49
18:04:55.124056 [debug] [Thread-1  ]: Began running node test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
18:04:55.129521 [info ] [Thread-1  ]: 6 of 7 START test unique_my_first_dbt_model_id ................................. [RUN]
18:04:55.134360 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"
18:04:55.141731 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
18:04:55.149702 [debug] [Thread-1  ]: Compiling test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
18:04:55.182696 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"
18:04:55.194174 [debug] [Thread-1  ]: finished collecting timing info
18:04:55.197568 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
18:04:55.204614 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"
18:04:55.219657 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"
18:04:55.222590 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321: BEGIN
18:04:55.226360 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:04:55.229269 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
18:04:56.411808 [debug] [Thread-1  ]: SQL status: BEGIN in 1.19 seconds
18:04:56.416172 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"
18:04:56.419144 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dev"."public"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
18:04:56.552951 [debug] [Thread-1  ]: SQL status: SELECT in 0.13 seconds
18:04:56.560511 [debug] [Thread-1  ]: finished collecting timing info
18:04:56.563403 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
18:04:56.692267 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321: Close
18:04:56.698326 [info ] [Thread-1  ]: 6 of 7 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 1.56s]
18:04:56.703179 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
18:04:56.708915 [debug] [Thread-1  ]: Began running node test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
18:04:56.718282 [info ] [Thread-1  ]: 7 of 7 START test unique_my_second_dbt_model_id ................................ [RUN]
18:04:56.724442 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"
18:04:56.734770 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
18:04:56.739214 [debug] [Thread-1  ]: Compiling test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
18:04:56.771341 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"
18:04:56.790022 [debug] [Thread-1  ]: finished collecting timing info
18:04:56.792997 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
18:04:56.804403 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"
18:04:56.815956 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"
18:04:56.821766 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493: BEGIN
18:04:56.825692 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:04:56.831249 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
18:04:58.002506 [debug] [Thread-1  ]: SQL status: BEGIN in 1.18 seconds
18:04:58.005217 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"
18:04:58.008182 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dev"."public"."my_second_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
18:04:58.141160 [debug] [Thread-1  ]: SQL status: SELECT in 0.13 seconds
18:04:58.146870 [debug] [Thread-1  ]: finished collecting timing info
18:04:58.150075 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493: ROLLBACK
18:04:58.280842 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493: Close
18:04:58.285811 [info ] [Thread-1  ]: 7 of 7 PASS unique_my_second_dbt_model_id ...................................... [[32mPASS[0m in 1.56s]
18:04:58.289307 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
18:04:58.297256 [debug] [MainThread]: Acquiring new redshift connection "master"
18:04:58.303550 [debug] [MainThread]: Using redshift connection "master"
18:04:58.306623 [debug] [MainThread]: On master: BEGIN
18:04:58.311140 [debug] [MainThread]: Opening a new connection, currently in state closed
18:04:58.317543 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
18:04:59.501321 [debug] [MainThread]: SQL status: BEGIN in 1.19 seconds
18:04:59.503904 [debug] [MainThread]: On master: COMMIT
18:04:59.506560 [debug] [MainThread]: Using redshift connection "master"
18:04:59.508664 [debug] [MainThread]: On master: COMMIT
18:04:59.640530 [debug] [MainThread]: SQL status: COMMIT in 0.13 seconds
18:04:59.643750 [debug] [MainThread]: On master: Close
18:04:59.648631 [info ] [MainThread]: 
18:04:59.653335 [info ] [MainThread]: Finished running 7 tests in 14.60s.
18:04:59.659467 [debug] [MainThread]: Connection 'master' was properly closed.
18:04:59.670640 [debug] [MainThread]: Connection 'test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
18:04:59.710518 [info ] [MainThread]: 
18:04:59.717629 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
18:04:59.724363 [info ] [MainThread]: 
18:04:59.730436 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models/example/schema.yml)[0m
18:04:59.738610 [error] [MainThread]:   Got 1 result, configured to fail if != 0
18:04:59.748042 [info ] [MainThread]: 
18:04:59.755919 [info ] [MainThread]:   compiled SQL at target/compiled/analytics_dbt/models/example/schema.yml/not_null_my_first_dbt_model_id.sql
18:04:59.769413 [info ] [MainThread]: 
18:04:59.788068 [error] [MainThread]: [33mDatabase Error in test test_maior_que_zero (tests/test_maior_que_zero.sql)[0m
18:04:59.809525 [error] [MainThread]:   syntax error at or near ")"
18:04:59.824985 [error] [MainThread]:   LINE 9:     ) dbt_internal_test
18:04:59.840484 [error] [MainThread]:               ^
18:04:59.853118 [error] [MainThread]:   compiled SQL at target/run/analytics_dbt/tests/test_maior_que_zero.sql
18:04:59.859109 [info ] [MainThread]: 
18:04:59.869401 [error] [MainThread]: [33mCompilation Error in test test_maior_que_zero_tb_10_compradores_vendas_totais (models/example/schema.yml)[0m
18:04:59.882043 [error] [MainThread]:   'test_test_maior_que_zero' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
18:04:59.889835 [info ] [MainThread]: 
18:04:59.903287 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=3 SKIP=0 TOTAL=7
18:04:59.916255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc8633f040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc863323d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc86332d00>]}


============================== 2022-05-23 18:07:04.507897 | da560a0e-f02d-4f4b-ac6c-38617808c105 ==============================
18:07:04.507938 [info ] [MainThread]: Running with dbt=1.1.0
18:07:04.514718 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
18:07:04.521348 [debug] [MainThread]: Tracking: tracking
18:07:04.561206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60bb08b760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60bb08b820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60bb08b850>]}
18:07:04.724434 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
18:07:04.728634 [debug] [MainThread]: Partial parsing: update schema file: analytics_dbt://models/example/schema.yml
18:07:04.731388 [debug] [MainThread]: Partial parsing: updated file: analytics_dbt://tests/test_maior_que_zero.sql
18:07:04.763104 [debug] [MainThread]: 1699: static parser successfully parsed tables/tb_10_compradores.sql
18:07:04.800177 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
18:07:04.815367 [debug] [MainThread]: 1699: static parser successfully parsed example/my_second_dbt_model.sql
18:07:04.999302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'da560a0e-f02d-4f4b-ac6c-38617808c105', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60baaccc70>]}
18:07:05.027519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'da560a0e-f02d-4f4b-ac6c-38617808c105', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60bb08baf0>]}
18:07:05.031308 [info ] [MainThread]: Found 5 models, 3 tests, 0 snapshots, 0 analyses, 193 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
18:07:05.040010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'da560a0e-f02d-4f4b-ac6c-38617808c105', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60bb08b7f0>]}
18:07:05.056082 [info ] [MainThread]: 
18:07:05.069130 [debug] [MainThread]: Acquiring new redshift connection "master"
18:07:05.085698 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev_public"
18:07:05.131076 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
18:07:05.134295 [debug] [ThreadPool]: On list_dev_public: BEGIN
18:07:05.138304 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:07:05.143125 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
18:07:06.375667 [debug] [ThreadPool]: SQL status: BEGIN in 1.24 seconds
18:07:06.379488 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
18:07:06.382875 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev_public"} */
select
      'dev' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dev' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
18:07:06.538242 [debug] [ThreadPool]: SQL status: SELECT in 0.15 seconds
18:07:06.545843 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
18:07:06.678745 [debug] [ThreadPool]: On list_dev_public: Close
18:07:06.692392 [debug] [MainThread]: Using redshift connection "master"
18:07:06.695563 [debug] [MainThread]: On master: BEGIN
18:07:06.698739 [debug] [MainThread]: Opening a new connection, currently in state init
18:07:06.701995 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
18:07:07.891689 [debug] [MainThread]: SQL status: BEGIN in 1.19 seconds
18:07:07.895184 [debug] [MainThread]: Using redshift connection "master"
18:07:07.897427 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
18:07:08.064660 [debug] [MainThread]: SQL status: SELECT in 0.16 seconds
18:07:08.070176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'da560a0e-f02d-4f4b-ac6c-38617808c105', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60bb0a99a0>]}
18:07:08.074341 [debug] [MainThread]: On master: ROLLBACK
18:07:08.209300 [debug] [MainThread]: Using redshift connection "master"
18:07:08.212647 [debug] [MainThread]: On master: BEGIN
18:07:08.472643 [debug] [MainThread]: SQL status: BEGIN in 0.26 seconds
18:07:08.476737 [debug] [MainThread]: On master: COMMIT
18:07:08.479869 [debug] [MainThread]: Using redshift connection "master"
18:07:08.482556 [debug] [MainThread]: On master: COMMIT
18:07:08.614736 [debug] [MainThread]: SQL status: COMMIT in 0.13 seconds
18:07:08.619277 [debug] [MainThread]: On master: Close
18:07:08.622989 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
18:07:08.627110 [info ] [MainThread]: 
18:07:08.645172 [debug] [Thread-1  ]: Began running node test.analytics_dbt.maior_que_zero_tb_10_compradores_vendas_totais.d3966f9348
18:07:08.651444 [info ] [Thread-1  ]: 1 of 3 START test maior_que_zero_tb_10_compradores_vendas_totais ............... [RUN]
18:07:08.661625 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.maior_que_zero_tb_10_compradores_vendas_totais.d3966f9348"
18:07:08.667696 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.maior_que_zero_tb_10_compradores_vendas_totais.d3966f9348
18:07:08.677404 [debug] [Thread-1  ]: Compiling test.analytics_dbt.maior_que_zero_tb_10_compradores_vendas_totais.d3966f9348
18:07:08.691326 [debug] [Thread-1  ]: finished collecting timing info
18:07:08.697811 [debug] [Thread-1  ]: Compilation Error in test maior_que_zero_tb_10_compradores_vendas_totais (models/example/schema.yml)
  'test_maior_que_zero' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
18:07:08.705039 [error] [Thread-1  ]: 1 of 3 ERROR maior_que_zero_tb_10_compradores_vendas_totais .................... [[31mERROR[0m in 0.04s]
18:07:08.709271 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.maior_que_zero_tb_10_compradores_vendas_totais.d3966f9348
18:07:08.716156 [debug] [Thread-1  ]: Began running node test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752
18:07:08.723027 [info ] [Thread-1  ]: 2 of 3 START test not_null_tb_10_compradores_vendas_totais ..................... [RUN]
18:07:08.729051 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752"
18:07:08.736835 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752
18:07:08.742665 [debug] [Thread-1  ]: Compiling test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752
18:07:08.782681 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752"
18:07:08.795974 [debug] [Thread-1  ]: finished collecting timing info
18:07:08.799050 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752
18:07:08.838859 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752"
18:07:08.847714 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752"
18:07:08.850730 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752: BEGIN
18:07:08.853671 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:07:08.856880 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
18:07:10.045259 [debug] [Thread-1  ]: SQL status: BEGIN in 1.19 seconds
18:07:10.047574 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752"
18:07:10.050614 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select vendas_totais
from "dev"."public"."tb_10_compradores"
where vendas_totais is null



      
    ) dbt_internal_test
18:07:10.280725 [debug] [Thread-1  ]: SQL status: SELECT in 0.23 seconds
18:07:10.294381 [debug] [Thread-1  ]: finished collecting timing info
18:07:10.300378 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752: ROLLBACK
18:07:10.641152 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752: Close
18:07:10.645023 [info ] [Thread-1  ]: 2 of 3 PASS not_null_tb_10_compradores_vendas_totais ........................... [[32mPASS[0m in 1.92s]
18:07:10.651614 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752
18:07:10.657689 [debug] [Thread-1  ]: Began running node test.analytics_dbt.test_maior_que_zero
18:07:10.664293 [info ] [Thread-1  ]: 3 of 3 START test test_maior_que_zero .......................................... [RUN]
18:07:10.673673 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.test_maior_que_zero"
18:07:10.683931 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.test_maior_que_zero
18:07:10.694510 [debug] [Thread-1  ]: Compiling test.analytics_dbt.test_maior_que_zero
18:07:10.712353 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.test_maior_que_zero"
18:07:10.715390 [debug] [Thread-1  ]: finished collecting timing info
18:07:10.719601 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.test_maior_que_zero
18:07:10.728603 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.test_maior_que_zero"
18:07:10.739128 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.test_maior_que_zero"
18:07:10.743786 [debug] [Thread-1  ]: On test.analytics_dbt.test_maior_que_zero: BEGIN
18:07:10.747166 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:07:10.750158 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
18:07:12.231311 [debug] [Thread-1  ]: SQL status: BEGIN in 1.48 seconds
18:07:12.236566 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.test_maior_que_zero"
18:07:12.241886 [debug] [Thread-1  ]: On test.analytics_dbt.test_maior_que_zero: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.test_maior_que_zero"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
      
    ) dbt_internal_test
18:07:12.397438 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near ")"
LINE 9:     ) dbt_internal_test
            ^

18:07:12.400361 [debug] [Thread-1  ]: On test.analytics_dbt.test_maior_que_zero: ROLLBACK
18:07:12.564862 [debug] [Thread-1  ]: finished collecting timing info
18:07:12.567831 [debug] [Thread-1  ]: On test.analytics_dbt.test_maior_que_zero: Close
18:07:12.571848 [debug] [Thread-1  ]: Database Error in test test_maior_que_zero (tests/test_maior_que_zero.sql)
  syntax error at or near ")"
  LINE 9:     ) dbt_internal_test
              ^
  compiled SQL at target/run/analytics_dbt/tests/test_maior_que_zero.sql
18:07:12.574747 [error] [Thread-1  ]: 3 of 3 ERROR test_maior_que_zero ............................................... [[31mERROR[0m in 1.90s]
18:07:12.579221 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.test_maior_que_zero
18:07:12.586021 [debug] [MainThread]: Acquiring new redshift connection "master"
18:07:12.595244 [debug] [MainThread]: Using redshift connection "master"
18:07:12.601763 [debug] [MainThread]: On master: BEGIN
18:07:12.605716 [debug] [MainThread]: Opening a new connection, currently in state closed
18:07:12.612398 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
18:07:14.088169 [debug] [MainThread]: SQL status: BEGIN in 1.48 seconds
18:07:14.090405 [debug] [MainThread]: On master: COMMIT
18:07:14.092898 [debug] [MainThread]: Using redshift connection "master"
18:07:14.095335 [debug] [MainThread]: On master: COMMIT
18:07:14.229726 [debug] [MainThread]: SQL status: COMMIT in 0.13 seconds
18:07:14.233111 [debug] [MainThread]: On master: Close
18:07:14.237347 [info ] [MainThread]: 
18:07:14.241604 [info ] [MainThread]: Finished running 3 tests in 9.17s.
18:07:14.246895 [debug] [MainThread]: Connection 'master' was properly closed.
18:07:14.255818 [debug] [MainThread]: Connection 'test.analytics_dbt.test_maior_que_zero' was properly closed.
18:07:14.305525 [info ] [MainThread]: 
18:07:14.308943 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
18:07:14.315140 [info ] [MainThread]: 
18:07:14.322592 [error] [MainThread]: [33mCompilation Error in test maior_que_zero_tb_10_compradores_vendas_totais (models/example/schema.yml)[0m
18:07:14.330079 [error] [MainThread]:   'test_maior_que_zero' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
18:07:14.337310 [info ] [MainThread]: 
18:07:14.348122 [error] [MainThread]: [33mDatabase Error in test test_maior_que_zero (tests/test_maior_que_zero.sql)[0m
18:07:14.358891 [error] [MainThread]:   syntax error at or near ")"
18:07:14.373947 [error] [MainThread]:   LINE 9:     ) dbt_internal_test
18:07:14.388354 [error] [MainThread]:               ^
18:07:14.402984 [error] [MainThread]:   compiled SQL at target/run/analytics_dbt/tests/test_maior_que_zero.sql
18:07:14.417378 [info ] [MainThread]: 
18:07:14.427365 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=2 SKIP=0 TOTAL=3
18:07:14.439198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60ba29a970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60bb08b790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60ba2a22e0>]}


============================== 2022-05-23 18:08:49.741737 | ba1d33a6-e136-40af-8b6b-d2bb63ac5a55 ==============================
18:08:49.741770 [info ] [MainThread]: Running with dbt=1.1.0
18:08:49.745628 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
18:08:49.752021 [debug] [MainThread]: Tracking: tracking
18:08:49.780148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc08d19f820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc08d19f8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc08d19f910>]}
18:08:49.929109 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 1 files changed.
18:08:49.932178 [debug] [MainThread]: Partial parsing: added file: analytics_dbt://tests/maior_que_zero.sql
18:08:49.935106 [debug] [MainThread]: Partial parsing: update schema file: analytics_dbt://models/example/schema.yml
18:08:49.937743 [debug] [MainThread]: Partial parsing: deleted file: analytics_dbt://tests/test_maior_que_zero.sql
18:08:50.035273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ba1d33a6-e136-40af-8b6b-d2bb63ac5a55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc08d050fd0>]}
18:08:50.075030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ba1d33a6-e136-40af-8b6b-d2bb63ac5a55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc08d037070>]}
18:08:50.078728 [info ] [MainThread]: Found 5 models, 3 tests, 0 snapshots, 0 analyses, 193 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
18:08:50.081361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ba1d33a6-e136-40af-8b6b-d2bb63ac5a55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc08d19fc70>]}
18:08:50.091178 [info ] [MainThread]: 
18:08:50.100757 [debug] [MainThread]: Acquiring new redshift connection "master"
18:08:50.110874 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev_public"
18:08:50.155768 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
18:08:50.160196 [debug] [ThreadPool]: On list_dev_public: BEGIN
18:08:50.164182 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:08:50.167968 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
18:08:51.353170 [debug] [ThreadPool]: SQL status: BEGIN in 1.19 seconds
18:08:51.360561 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
18:08:51.366754 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev_public"} */
select
      'dev' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dev' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
18:08:51.506378 [debug] [ThreadPool]: SQL status: SELECT in 0.14 seconds
18:08:51.512450 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
18:08:51.641315 [debug] [ThreadPool]: On list_dev_public: Close
18:08:51.657350 [debug] [MainThread]: Using redshift connection "master"
18:08:51.660589 [debug] [MainThread]: On master: BEGIN
18:08:51.663868 [debug] [MainThread]: Opening a new connection, currently in state init
18:08:51.666893 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
18:08:52.898316 [debug] [MainThread]: SQL status: BEGIN in 1.23 seconds
18:08:52.901482 [debug] [MainThread]: Using redshift connection "master"
18:08:52.904150 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
18:08:53.067255 [debug] [MainThread]: SQL status: SELECT in 0.16 seconds
18:08:53.072898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ba1d33a6-e136-40af-8b6b-d2bb63ac5a55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc08d0377f0>]}
18:08:53.076607 [debug] [MainThread]: On master: ROLLBACK
18:08:53.208391 [debug] [MainThread]: Using redshift connection "master"
18:08:53.212010 [debug] [MainThread]: On master: BEGIN
18:08:53.474698 [debug] [MainThread]: SQL status: BEGIN in 0.26 seconds
18:08:53.477255 [debug] [MainThread]: On master: COMMIT
18:08:53.481533 [debug] [MainThread]: Using redshift connection "master"
18:08:53.483978 [debug] [MainThread]: On master: COMMIT
18:08:53.619009 [debug] [MainThread]: SQL status: COMMIT in 0.13 seconds
18:08:53.621693 [debug] [MainThread]: On master: Close
18:08:53.624957 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
18:08:53.627768 [info ] [MainThread]: 
18:08:53.653111 [debug] [Thread-1  ]: Began running node test.analytics_dbt.maior_que_zero
18:08:53.657825 [info ] [Thread-1  ]: 1 of 3 START test maior_que_zero ............................................... [RUN]
18:08:53.664369 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.maior_que_zero"
18:08:53.674046 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.maior_que_zero
18:08:53.682252 [debug] [Thread-1  ]: Compiling test.analytics_dbt.maior_que_zero
18:08:53.694298 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.maior_que_zero"
18:08:53.697928 [debug] [Thread-1  ]: finished collecting timing info
18:08:53.702769 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.maior_que_zero
18:08:53.743725 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.maior_que_zero"
18:08:53.755809 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.maior_que_zero"
18:08:53.758813 [debug] [Thread-1  ]: On test.analytics_dbt.maior_que_zero: BEGIN
18:08:53.760925 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:08:53.763648 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
18:08:54.946763 [debug] [Thread-1  ]: SQL status: BEGIN in 1.19 seconds
18:08:54.949907 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.maior_que_zero"
18:08:54.952753 [debug] [Thread-1  ]: On test.analytics_dbt.maior_que_zero: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.maior_que_zero"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
      
    ) dbt_internal_test
18:08:55.089627 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near ")"
LINE 9:     ) dbt_internal_test
            ^

18:08:55.092386 [debug] [Thread-1  ]: On test.analytics_dbt.maior_que_zero: ROLLBACK
18:08:55.224697 [debug] [Thread-1  ]: finished collecting timing info
18:08:55.228370 [debug] [Thread-1  ]: On test.analytics_dbt.maior_que_zero: Close
18:08:55.232493 [debug] [Thread-1  ]: Database Error in test maior_que_zero (tests/maior_que_zero.sql)
  syntax error at or near ")"
  LINE 9:     ) dbt_internal_test
              ^
  compiled SQL at target/run/analytics_dbt/tests/maior_que_zero.sql
18:08:55.236295 [error] [Thread-1  ]: 1 of 3 ERROR maior_que_zero .................................................... [[31mERROR[0m in 1.57s]
18:08:55.240238 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.maior_que_zero
18:08:55.245476 [debug] [Thread-1  ]: Began running node test.analytics_dbt.maior_que_zero_tb_10_compradores_vendas_totais.d3966f9348
18:08:55.252602 [info ] [Thread-1  ]: 2 of 3 START test maior_que_zero_tb_10_compradores_vendas_totais ............... [RUN]
18:08:55.260530 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.maior_que_zero_tb_10_compradores_vendas_totais.d3966f9348"
18:08:55.273437 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.maior_que_zero_tb_10_compradores_vendas_totais.d3966f9348
18:08:55.283819 [debug] [Thread-1  ]: Compiling test.analytics_dbt.maior_que_zero_tb_10_compradores_vendas_totais.d3966f9348
18:08:55.315343 [debug] [Thread-1  ]: finished collecting timing info
18:08:55.319787 [debug] [Thread-1  ]: Compilation Error in test maior_que_zero_tb_10_compradores_vendas_totais (models/example/schema.yml)
  'test_maior_que_zero' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
18:08:55.323709 [error] [Thread-1  ]: 2 of 3 ERROR maior_que_zero_tb_10_compradores_vendas_totais .................... [[31mERROR[0m in 0.06s]
18:08:55.329209 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.maior_que_zero_tb_10_compradores_vendas_totais.d3966f9348
18:08:55.336451 [debug] [Thread-1  ]: Began running node test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752
18:08:55.344007 [info ] [Thread-1  ]: 3 of 3 START test not_null_tb_10_compradores_vendas_totais ..................... [RUN]
18:08:55.352993 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752"
18:08:55.357173 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752
18:08:55.360601 [debug] [Thread-1  ]: Compiling test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752
18:08:55.392118 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752"
18:08:55.402844 [debug] [Thread-1  ]: finished collecting timing info
18:08:55.406009 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752
18:08:55.414256 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752"
18:08:55.422297 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752"
18:08:55.430452 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752: BEGIN
18:08:55.434007 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:08:55.436438 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
18:08:56.611074 [debug] [Thread-1  ]: SQL status: BEGIN in 1.18 seconds
18:08:56.614273 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752"
18:08:56.618309 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select vendas_totais
from "dev"."public"."tb_10_compradores"
where vendas_totais is null



      
    ) dbt_internal_test
18:08:56.754840 [debug] [Thread-1  ]: SQL status: SELECT in 0.13 seconds
18:08:56.761261 [debug] [Thread-1  ]: finished collecting timing info
18:08:56.763774 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752: ROLLBACK
18:08:56.894490 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752: Close
18:08:56.899067 [info ] [Thread-1  ]: 3 of 3 PASS not_null_tb_10_compradores_vendas_totais ........................... [[32mPASS[0m in 1.55s]
18:08:56.903078 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752
18:08:56.911643 [debug] [MainThread]: Acquiring new redshift connection "master"
18:08:56.919008 [debug] [MainThread]: Using redshift connection "master"
18:08:56.923249 [debug] [MainThread]: On master: BEGIN
18:08:56.925359 [debug] [MainThread]: Opening a new connection, currently in state closed
18:08:56.928571 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
18:08:58.128169 [debug] [MainThread]: SQL status: BEGIN in 1.2 seconds
18:08:58.130883 [debug] [MainThread]: On master: COMMIT
18:08:58.133185 [debug] [MainThread]: Using redshift connection "master"
18:08:58.136779 [debug] [MainThread]: On master: COMMIT
18:08:58.267294 [debug] [MainThread]: SQL status: COMMIT in 0.13 seconds
18:08:58.270841 [debug] [MainThread]: On master: Close
18:08:58.276344 [info ] [MainThread]: 
18:08:58.280614 [info ] [MainThread]: Finished running 3 tests in 8.18s.
18:08:58.287976 [debug] [MainThread]: Connection 'master' was properly closed.
18:08:58.297245 [debug] [MainThread]: Connection 'test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752' was properly closed.
18:08:58.346340 [info ] [MainThread]: 
18:08:58.350039 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
18:08:58.355559 [info ] [MainThread]: 
18:08:58.362198 [error] [MainThread]: [33mDatabase Error in test maior_que_zero (tests/maior_que_zero.sql)[0m
18:08:58.367486 [error] [MainThread]:   syntax error at or near ")"
18:08:58.376423 [error] [MainThread]:   LINE 9:     ) dbt_internal_test
18:08:58.396523 [error] [MainThread]:               ^
18:08:58.409474 [error] [MainThread]:   compiled SQL at target/run/analytics_dbt/tests/maior_que_zero.sql
18:08:58.419214 [info ] [MainThread]: 
18:08:58.430062 [error] [MainThread]: [33mCompilation Error in test maior_que_zero_tb_10_compradores_vendas_totais (models/example/schema.yml)[0m
18:08:58.447366 [error] [MainThread]:   'test_maior_que_zero' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
18:08:58.460577 [info ] [MainThread]: 
18:08:58.469486 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=2 SKIP=0 TOTAL=3
18:08:58.479530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc08c786280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc08c7864c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc08c786490>]}


============================== 2022-05-23 18:10:20.805558 | 8279a11a-192d-4d39-a315-9e0e16d127af ==============================
18:10:20.805581 [info ] [MainThread]: Running with dbt=1.1.0
18:10:20.810296 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
18:10:20.819556 [debug] [MainThread]: Tracking: tracking
18:10:20.854014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab8cfc9700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab8cfc97c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab8cfc97f0>]}
18:10:21.033525 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
18:10:21.036722 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
18:10:21.055367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8279a11a-192d-4d39-a315-9e0e16d127af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab8cef26a0>]}
18:10:21.098358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8279a11a-192d-4d39-a315-9e0e16d127af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab8cedf1f0>]}
18:10:21.102892 [info ] [MainThread]: Found 5 models, 3 tests, 0 snapshots, 0 analyses, 193 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
18:10:21.108284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8279a11a-192d-4d39-a315-9e0e16d127af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab8cedf400>]}
18:10:21.126525 [info ] [MainThread]: 
18:10:21.137256 [debug] [MainThread]: Acquiring new redshift connection "master"
18:10:21.145826 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev_public"
18:10:21.196127 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
18:10:21.198996 [debug] [ThreadPool]: On list_dev_public: BEGIN
18:10:21.202379 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:10:21.205493 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
18:10:22.435851 [debug] [ThreadPool]: SQL status: BEGIN in 1.23 seconds
18:10:22.439208 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
18:10:22.442083 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev_public"} */
select
      'dev' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dev' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
18:10:22.584727 [debug] [ThreadPool]: SQL status: SELECT in 0.14 seconds
18:10:22.591468 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
18:10:22.723522 [debug] [ThreadPool]: On list_dev_public: Close
18:10:22.738553 [debug] [MainThread]: Using redshift connection "master"
18:10:22.741498 [debug] [MainThread]: On master: BEGIN
18:10:22.744662 [debug] [MainThread]: Opening a new connection, currently in state init
18:10:22.747853 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
18:10:23.947006 [debug] [MainThread]: SQL status: BEGIN in 1.2 seconds
18:10:23.950755 [debug] [MainThread]: Using redshift connection "master"
18:10:23.953867 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
18:10:24.124445 [debug] [MainThread]: SQL status: SELECT in 0.17 seconds
18:10:24.129903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8279a11a-192d-4d39-a315-9e0e16d127af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab8cf97c10>]}
18:10:24.133126 [debug] [MainThread]: On master: ROLLBACK
18:10:24.264349 [debug] [MainThread]: Using redshift connection "master"
18:10:24.267840 [debug] [MainThread]: On master: BEGIN
18:10:24.527969 [debug] [MainThread]: SQL status: BEGIN in 0.26 seconds
18:10:24.531327 [debug] [MainThread]: On master: COMMIT
18:10:24.533874 [debug] [MainThread]: Using redshift connection "master"
18:10:24.536578 [debug] [MainThread]: On master: COMMIT
18:10:24.668345 [debug] [MainThread]: SQL status: COMMIT in 0.13 seconds
18:10:24.671017 [debug] [MainThread]: On master: Close
18:10:24.675705 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
18:10:24.678344 [info ] [MainThread]: 
18:10:24.700831 [debug] [Thread-1  ]: Began running node test.analytics_dbt.maior_que_zero
18:10:24.705106 [info ] [Thread-1  ]: 1 of 3 START test maior_que_zero ............................................... [RUN]
18:10:24.715061 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.maior_que_zero"
18:10:24.719946 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.maior_que_zero
18:10:24.723797 [debug] [Thread-1  ]: Compiling test.analytics_dbt.maior_que_zero
18:10:24.739142 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.maior_que_zero"
18:10:24.743828 [debug] [Thread-1  ]: finished collecting timing info
18:10:24.748915 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.maior_que_zero
18:10:24.795297 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.maior_que_zero"
18:10:24.808804 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.maior_que_zero"
18:10:24.811299 [debug] [Thread-1  ]: On test.analytics_dbt.maior_que_zero: BEGIN
18:10:24.813541 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:10:24.816221 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
18:10:26.013489 [debug] [Thread-1  ]: SQL status: BEGIN in 1.2 seconds
18:10:26.017914 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.maior_que_zero"
18:10:26.020501 [debug] [Thread-1  ]: On test.analytics_dbt.maior_que_zero: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.maior_que_zero"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
      
    ) dbt_internal_test
18:10:26.152023 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near ")"
LINE 9:     ) dbt_internal_test
            ^

18:10:26.155509 [debug] [Thread-1  ]: On test.analytics_dbt.maior_que_zero: ROLLBACK
18:10:26.289251 [debug] [Thread-1  ]: finished collecting timing info
18:10:26.292616 [debug] [Thread-1  ]: On test.analytics_dbt.maior_que_zero: Close
18:10:26.296645 [debug] [Thread-1  ]: Database Error in test maior_que_zero (tests/maior_que_zero.sql)
  syntax error at or near ")"
  LINE 9:     ) dbt_internal_test
              ^
  compiled SQL at target/run/analytics_dbt/tests/maior_que_zero.sql
18:10:26.300139 [error] [Thread-1  ]: 1 of 3 ERROR maior_que_zero .................................................... [[31mERROR[0m in 1.59s]
18:10:26.307524 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.maior_que_zero
18:10:26.313646 [debug] [Thread-1  ]: Began running node test.analytics_dbt.maior_que_zero_tb_10_compradores_vendas_totais.d3966f9348
18:10:26.319384 [info ] [Thread-1  ]: 2 of 3 START test maior_que_zero_tb_10_compradores_vendas_totais ............... [RUN]
18:10:26.328430 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.maior_que_zero_tb_10_compradores_vendas_totais.d3966f9348"
18:10:26.332699 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.maior_que_zero_tb_10_compradores_vendas_totais.d3966f9348
18:10:26.337777 [debug] [Thread-1  ]: Compiling test.analytics_dbt.maior_que_zero_tb_10_compradores_vendas_totais.d3966f9348
18:10:26.374184 [debug] [Thread-1  ]: finished collecting timing info
18:10:26.379450 [debug] [Thread-1  ]: Compilation Error in test maior_que_zero_tb_10_compradores_vendas_totais (models/example/schema.yml)
  'test_maior_que_zero' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
18:10:26.383826 [error] [Thread-1  ]: 2 of 3 ERROR maior_que_zero_tb_10_compradores_vendas_totais .................... [[31mERROR[0m in 0.06s]
18:10:26.388546 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.maior_que_zero_tb_10_compradores_vendas_totais.d3966f9348
18:10:26.408535 [debug] [Thread-1  ]: Began running node test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752
18:10:26.411985 [info ] [Thread-1  ]: 3 of 3 START test not_null_tb_10_compradores_vendas_totais ..................... [RUN]
18:10:26.415719 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752"
18:10:26.430158 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752
18:10:26.435339 [debug] [Thread-1  ]: Compiling test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752
18:10:26.463487 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752"
18:10:26.470955 [debug] [Thread-1  ]: finished collecting timing info
18:10:26.474235 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752
18:10:26.482904 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752"
18:10:26.491437 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752"
18:10:26.494659 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752: BEGIN
18:10:26.498087 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:10:26.500793 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
18:10:27.690928 [debug] [Thread-1  ]: SQL status: BEGIN in 1.19 seconds
18:10:27.695871 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752"
18:10:27.698638 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select vendas_totais
from "dev"."public"."tb_10_compradores"
where vendas_totais is null



      
    ) dbt_internal_test
18:10:27.830026 [debug] [Thread-1  ]: SQL status: SELECT in 0.13 seconds
18:10:27.837950 [debug] [Thread-1  ]: finished collecting timing info
18:10:27.841665 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752: ROLLBACK
18:10:27.977720 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752: Close
18:10:27.981622 [info ] [Thread-1  ]: 3 of 3 PASS not_null_tb_10_compradores_vendas_totais ........................... [[32mPASS[0m in 1.57s]
18:10:27.986351 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752
18:10:27.995943 [debug] [MainThread]: Acquiring new redshift connection "master"
18:10:28.002557 [debug] [MainThread]: Using redshift connection "master"
18:10:28.005527 [debug] [MainThread]: On master: BEGIN
18:10:28.009556 [debug] [MainThread]: Opening a new connection, currently in state closed
18:10:28.015722 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
18:10:29.215167 [debug] [MainThread]: SQL status: BEGIN in 1.21 seconds
18:10:29.219038 [debug] [MainThread]: On master: COMMIT
18:10:29.222613 [debug] [MainThread]: Using redshift connection "master"
18:10:29.225429 [debug] [MainThread]: On master: COMMIT
18:10:29.358508 [debug] [MainThread]: SQL status: COMMIT in 0.13 seconds
18:10:29.362862 [debug] [MainThread]: On master: Close
18:10:29.366960 [info ] [MainThread]: 
18:10:29.373906 [info ] [MainThread]: Finished running 3 tests in 8.23s.
18:10:29.382659 [debug] [MainThread]: Connection 'master' was properly closed.
18:10:29.389810 [debug] [MainThread]: Connection 'test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752' was properly closed.
18:10:29.433910 [info ] [MainThread]: 
18:10:29.439470 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
18:10:29.446350 [info ] [MainThread]: 
18:10:29.455904 [error] [MainThread]: [33mDatabase Error in test maior_que_zero (tests/maior_que_zero.sql)[0m
18:10:29.464557 [error] [MainThread]:   syntax error at or near ")"
18:10:29.476058 [error] [MainThread]:   LINE 9:     ) dbt_internal_test
18:10:29.488348 [error] [MainThread]:               ^
18:10:29.502539 [error] [MainThread]:   compiled SQL at target/run/analytics_dbt/tests/maior_que_zero.sql
18:10:29.533561 [info ] [MainThread]: 
18:10:29.542385 [error] [MainThread]: [33mCompilation Error in test maior_que_zero_tb_10_compradores_vendas_totais (models/example/schema.yml)[0m
18:10:29.563601 [error] [MainThread]:   'test_maior_que_zero' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
18:10:29.582142 [info ] [MainThread]: 
18:10:29.591385 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=2 SKIP=0 TOTAL=3
18:10:29.601436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab8cedf340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab8c641eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab8c641e50>]}


============================== 2022-05-23 18:24:38.206640 | c7256fe2-2102-4943-8019-1ef4f46692e9 ==============================
18:24:38.206710 [info ] [MainThread]: Running with dbt=1.1.0
18:24:38.210610 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
18:24:38.220055 [debug] [MainThread]: Tracking: tracking
18:24:38.257708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd107803a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd10780460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd10780490>]}
18:24:38.400382 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
18:24:38.406314 [debug] [MainThread]: Partial parsing: updated file: analytics_dbt://tests/maior_que_zero.sql
18:24:38.514699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c7256fe2-2102-4943-8019-1ef4f46692e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd10628940>]}
18:24:38.548864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c7256fe2-2102-4943-8019-1ef4f46692e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd106d8130>]}
18:24:38.553302 [info ] [MainThread]: Found 5 models, 3 tests, 0 snapshots, 0 analyses, 193 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
18:24:38.558455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c7256fe2-2102-4943-8019-1ef4f46692e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd106d80d0>]}
18:24:38.569712 [info ] [MainThread]: 
18:24:38.578602 [debug] [MainThread]: Acquiring new redshift connection "master"
18:24:38.588591 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev_public"
18:24:38.633188 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
18:24:38.635777 [debug] [ThreadPool]: On list_dev_public: BEGIN
18:24:38.638099 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:24:38.640599 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
18:24:39.861997 [debug] [ThreadPool]: SQL status: BEGIN in 1.22 seconds
18:24:39.866848 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
18:24:39.869663 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev_public"} */
select
      'dev' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dev' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
18:24:40.008440 [debug] [ThreadPool]: SQL status: SELECT in 0.14 seconds
18:24:40.015104 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
18:24:40.143737 [debug] [ThreadPool]: On list_dev_public: Close
18:24:40.159576 [debug] [MainThread]: Using redshift connection "master"
18:24:40.162625 [debug] [MainThread]: On master: BEGIN
18:24:40.166197 [debug] [MainThread]: Opening a new connection, currently in state init
18:24:40.168697 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
18:24:41.386535 [debug] [MainThread]: SQL status: BEGIN in 1.22 seconds
18:24:41.390063 [debug] [MainThread]: Using redshift connection "master"
18:24:41.392766 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
18:24:41.558968 [debug] [MainThread]: SQL status: SELECT in 0.16 seconds
18:24:41.567314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c7256fe2-2102-4943-8019-1ef4f46692e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd1075af10>]}
18:24:41.570593 [debug] [MainThread]: On master: ROLLBACK
18:24:41.702366 [debug] [MainThread]: Using redshift connection "master"
18:24:41.705097 [debug] [MainThread]: On master: BEGIN
18:24:41.965828 [debug] [MainThread]: SQL status: BEGIN in 0.26 seconds
18:24:41.969914 [debug] [MainThread]: On master: COMMIT
18:24:41.972589 [debug] [MainThread]: Using redshift connection "master"
18:24:41.974689 [debug] [MainThread]: On master: COMMIT
18:24:42.106372 [debug] [MainThread]: SQL status: COMMIT in 0.13 seconds
18:24:42.109942 [debug] [MainThread]: On master: Close
18:24:42.113882 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
18:24:42.117905 [info ] [MainThread]: 
18:24:42.140594 [debug] [Thread-1  ]: Began running node test.analytics_dbt.maior_que_zero
18:24:42.144854 [info ] [Thread-1  ]: 1 of 3 START test maior_que_zero ............................................... [RUN]
18:24:42.158379 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.maior_que_zero"
18:24:42.163329 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.maior_que_zero
18:24:42.170010 [debug] [Thread-1  ]: Compiling test.analytics_dbt.maior_que_zero
18:24:42.186480 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.maior_que_zero"
18:24:42.192492 [debug] [Thread-1  ]: finished collecting timing info
18:24:42.195808 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.maior_que_zero
18:24:42.238754 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.maior_que_zero"
18:24:42.251507 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.maior_que_zero"
18:24:42.254193 [debug] [Thread-1  ]: On test.analytics_dbt.maior_que_zero: BEGIN
18:24:42.257133 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:24:42.260014 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
18:24:43.485986 [debug] [Thread-1  ]: SQL status: BEGIN in 1.23 seconds
18:24:43.490431 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.maior_que_zero"
18:24:43.494443 [debug] [Thread-1  ]: On test.analytics_dbt.maior_que_zero: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.maior_que_zero"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
      
    ) dbt_internal_test
18:24:43.629588 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near ")"
LINE 9:     ) dbt_internal_test
            ^

18:24:43.633205 [debug] [Thread-1  ]: On test.analytics_dbt.maior_que_zero: ROLLBACK
18:24:43.766137 [debug] [Thread-1  ]: finished collecting timing info
18:24:43.769946 [debug] [Thread-1  ]: On test.analytics_dbt.maior_que_zero: Close
18:24:43.773405 [debug] [Thread-1  ]: Database Error in test maior_que_zero (tests/maior_que_zero.sql)
  syntax error at or near ")"
  LINE 9:     ) dbt_internal_test
              ^
  compiled SQL at target/run/analytics_dbt/tests/maior_que_zero.sql
18:24:43.776994 [error] [Thread-1  ]: 1 of 3 ERROR maior_que_zero .................................................... [[31mERROR[0m in 1.62s]
18:24:43.782910 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.maior_que_zero
18:24:43.788275 [debug] [Thread-1  ]: Began running node test.analytics_dbt.maior_que_zero_tb_10_compradores_vendas_totais.d3966f9348
18:24:43.792287 [info ] [Thread-1  ]: 2 of 3 START test maior_que_zero_tb_10_compradores_vendas_totais ............... [RUN]
18:24:43.798505 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.maior_que_zero_tb_10_compradores_vendas_totais.d3966f9348"
18:24:43.805161 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.maior_que_zero_tb_10_compradores_vendas_totais.d3966f9348
18:24:43.809466 [debug] [Thread-1  ]: Compiling test.analytics_dbt.maior_que_zero_tb_10_compradores_vendas_totais.d3966f9348
18:24:43.843055 [debug] [Thread-1  ]: finished collecting timing info
18:24:43.846499 [debug] [Thread-1  ]: Compilation Error in test maior_que_zero_tb_10_compradores_vendas_totais (models/example/schema.yml)
  'test_maior_que_zero' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
18:24:43.850337 [error] [Thread-1  ]: 2 of 3 ERROR maior_que_zero_tb_10_compradores_vendas_totais .................... [[31mERROR[0m in 0.05s]
18:24:43.853514 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.maior_que_zero_tb_10_compradores_vendas_totais.d3966f9348
18:24:43.858300 [debug] [Thread-1  ]: Began running node test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752
18:24:43.863184 [info ] [Thread-1  ]: 3 of 3 START test not_null_tb_10_compradores_vendas_totais ..................... [RUN]
18:24:43.872428 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752"
18:24:43.876494 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752
18:24:43.881529 [debug] [Thread-1  ]: Compiling test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752
18:24:43.910701 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752"
18:24:43.922678 [debug] [Thread-1  ]: finished collecting timing info
18:24:43.931189 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752
18:24:43.952608 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752"
18:24:43.960417 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752"
18:24:43.962739 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752: BEGIN
18:24:43.965481 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:24:43.968779 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
18:24:45.156410 [debug] [Thread-1  ]: SQL status: BEGIN in 1.19 seconds
18:24:45.159666 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752"
18:24:45.162503 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select vendas_totais
from "dev"."public"."tb_10_compradores"
where vendas_totais is null



      
    ) dbt_internal_test
18:24:45.300691 [debug] [Thread-1  ]: SQL status: SELECT in 0.13 seconds
18:24:45.310721 [debug] [Thread-1  ]: finished collecting timing info
18:24:45.313522 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752: ROLLBACK
18:24:45.443400 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752: Close
18:24:45.448229 [info ] [Thread-1  ]: 3 of 3 PASS not_null_tb_10_compradores_vendas_totais ........................... [[32mPASS[0m in 1.58s]
18:24:45.454555 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752
18:24:45.467226 [debug] [MainThread]: Acquiring new redshift connection "master"
18:24:45.475251 [debug] [MainThread]: Using redshift connection "master"
18:24:45.481122 [debug] [MainThread]: On master: BEGIN
18:24:45.491332 [debug] [MainThread]: Opening a new connection, currently in state closed
18:24:45.494884 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
18:24:46.701035 [debug] [MainThread]: SQL status: BEGIN in 1.21 seconds
18:24:46.705016 [debug] [MainThread]: On master: COMMIT
18:24:46.708579 [debug] [MainThread]: Using redshift connection "master"
18:24:46.713459 [debug] [MainThread]: On master: COMMIT
18:24:46.849467 [debug] [MainThread]: SQL status: COMMIT in 0.13 seconds
18:24:46.856630 [debug] [MainThread]: On master: Close
18:24:46.860998 [info ] [MainThread]: 
18:24:46.864017 [info ] [MainThread]: Finished running 3 tests in 8.28s.
18:24:46.870316 [debug] [MainThread]: Connection 'master' was properly closed.
18:24:46.891108 [debug] [MainThread]: Connection 'test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752' was properly closed.
18:24:46.936362 [info ] [MainThread]: 
18:24:46.942201 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
18:24:46.950502 [info ] [MainThread]: 
18:24:46.960377 [error] [MainThread]: [33mDatabase Error in test maior_que_zero (tests/maior_que_zero.sql)[0m
18:24:46.977480 [error] [MainThread]:   syntax error at or near ")"
18:24:46.983815 [error] [MainThread]:   LINE 9:     ) dbt_internal_test
18:24:46.998913 [error] [MainThread]:               ^
18:24:47.015736 [error] [MainThread]:   compiled SQL at target/run/analytics_dbt/tests/maior_que_zero.sql
18:24:47.027681 [info ] [MainThread]: 
18:24:47.033572 [error] [MainThread]: [33mCompilation Error in test maior_que_zero_tb_10_compradores_vendas_totais (models/example/schema.yml)[0m
18:24:47.047008 [error] [MainThread]:   'test_maior_que_zero' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
18:24:47.064129 [info ] [MainThread]: 
18:24:47.075121 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=2 SKIP=0 TOTAL=3
18:24:47.084329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd106d8100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd105d23a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd105d2610>]}


============================== 2022-05-23 18:25:56.586078 | a3af34eb-ddcd-4ee2-ad7b-85eb393ce2d2 ==============================
18:25:56.586102 [info ] [MainThread]: Running with dbt=1.1.0
18:25:56.590603 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
18:25:56.598257 [debug] [MainThread]: Tracking: tracking
18:25:56.625785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8aaca5e730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8aaca5e7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8aaca5e820>]}
18:25:56.814944 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
18:25:56.818836 [debug] [MainThread]: Partial parsing: added file: analytics_dbt://macros/maior_que_zero.sql
18:25:56.823079 [debug] [MainThread]: Partial parsing: deleted file: analytics_dbt://tests/maior_que_zero.sql
18:25:56.826414 [debug] [MainThread]: Parsing macros/maior_que_zero.sql
18:25:56.872783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a3af34eb-ddcd-4ee2-ad7b-85eb393ce2d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8aac926e80>]}
18:25:56.913005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a3af34eb-ddcd-4ee2-ad7b-85eb393ce2d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8aaca2f790>]}
18:25:56.918089 [info ] [MainThread]: Found 5 models, 2 tests, 0 snapshots, 0 analyses, 194 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
18:25:56.923081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a3af34eb-ddcd-4ee2-ad7b-85eb393ce2d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8aaca2f9a0>]}
18:25:56.936646 [info ] [MainThread]: 
18:25:56.941871 [debug] [MainThread]: Acquiring new redshift connection "master"
18:25:56.950484 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev_public"
18:25:56.993342 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
18:25:56.996665 [debug] [ThreadPool]: On list_dev_public: BEGIN
18:25:56.999920 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:25:57.003098 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
18:25:58.233268 [debug] [ThreadPool]: SQL status: BEGIN in 1.23 seconds
18:25:58.236564 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
18:25:58.239843 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev_public"} */
select
      'dev' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dev' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
18:25:58.384534 [debug] [ThreadPool]: SQL status: SELECT in 0.14 seconds
18:25:58.390753 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
18:25:58.523689 [debug] [ThreadPool]: On list_dev_public: Close
18:25:58.538824 [debug] [MainThread]: Using redshift connection "master"
18:25:58.541898 [debug] [MainThread]: On master: BEGIN
18:25:58.544608 [debug] [MainThread]: Opening a new connection, currently in state init
18:25:58.547029 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
18:25:59.743657 [debug] [MainThread]: SQL status: BEGIN in 1.2 seconds
18:25:59.746955 [debug] [MainThread]: Using redshift connection "master"
18:25:59.749922 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
18:25:59.917045 [debug] [MainThread]: SQL status: SELECT in 0.16 seconds
18:25:59.930792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a3af34eb-ddcd-4ee2-ad7b-85eb393ce2d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8aaca2f6d0>]}
18:25:59.939332 [debug] [MainThread]: On master: ROLLBACK
18:26:00.078687 [debug] [MainThread]: Using redshift connection "master"
18:26:00.082107 [debug] [MainThread]: On master: BEGIN
18:26:00.342632 [debug] [MainThread]: SQL status: BEGIN in 0.26 seconds
18:26:00.352355 [debug] [MainThread]: On master: COMMIT
18:26:00.359134 [debug] [MainThread]: Using redshift connection "master"
18:26:00.369159 [debug] [MainThread]: On master: COMMIT
18:26:00.507813 [debug] [MainThread]: SQL status: COMMIT in 0.13 seconds
18:26:00.511896 [debug] [MainThread]: On master: Close
18:26:00.522000 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
18:26:00.532849 [info ] [MainThread]: 
18:26:00.574191 [debug] [Thread-1  ]: Began running node test.analytics_dbt.maior_que_zero_tb_10_compradores_vendas_totais.d3966f9348
18:26:00.596104 [info ] [Thread-1  ]: 1 of 2 START test maior_que_zero_tb_10_compradores_vendas_totais ............... [RUN]
18:26:00.610676 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.maior_que_zero_tb_10_compradores_vendas_totais.d3966f9348"
18:26:00.623217 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.maior_que_zero_tb_10_compradores_vendas_totais.d3966f9348
18:26:00.635082 [debug] [Thread-1  ]: Compiling test.analytics_dbt.maior_que_zero_tb_10_compradores_vendas_totais.d3966f9348
18:26:00.676880 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.maior_que_zero_tb_10_compradores_vendas_totais.d3966f9348"
18:26:00.693186 [debug] [Thread-1  ]: finished collecting timing info
18:26:00.697803 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.maior_que_zero_tb_10_compradores_vendas_totais.d3966f9348
18:26:00.748150 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.maior_que_zero_tb_10_compradores_vendas_totais.d3966f9348"
18:26:00.762231 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.maior_que_zero_tb_10_compradores_vendas_totais.d3966f9348"
18:26:00.768616 [debug] [Thread-1  ]: On test.analytics_dbt.maior_que_zero_tb_10_compradores_vendas_totais.d3966f9348: BEGIN
18:26:00.772511 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:26:00.775803 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
18:26:01.970514 [debug] [Thread-1  ]: SQL status: BEGIN in 1.2 seconds
18:26:01.973905 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.maior_que_zero_tb_10_compradores_vendas_totais.d3966f9348"
18:26:01.976831 [debug] [Thread-1  ]: On test.analytics_dbt.maior_que_zero_tb_10_compradores_vendas_totais.d3966f9348: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.maior_que_zero_tb_10_compradores_vendas_totais.d3966f9348"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

    select count(*)
    from "dev"."public"."tb_10_compradores"
    where vendas_totais = 0


      
    ) dbt_internal_test
18:26:02.125553 [debug] [Thread-1  ]: SQL status: SELECT in 0.15 seconds
18:26:02.132724 [debug] [Thread-1  ]: finished collecting timing info
18:26:02.135785 [debug] [Thread-1  ]: On test.analytics_dbt.maior_que_zero_tb_10_compradores_vendas_totais.d3966f9348: ROLLBACK
18:26:02.269308 [debug] [Thread-1  ]: On test.analytics_dbt.maior_que_zero_tb_10_compradores_vendas_totais.d3966f9348: Close
18:26:02.278546 [error] [Thread-1  ]: 1 of 2 FAIL 1 maior_que_zero_tb_10_compradores_vendas_totais ................... [[31mFAIL 1[0m in 1.67s]
18:26:02.285276 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.maior_que_zero_tb_10_compradores_vendas_totais.d3966f9348
18:26:02.294716 [debug] [Thread-1  ]: Began running node test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752
18:26:02.298383 [info ] [Thread-1  ]: 2 of 2 START test not_null_tb_10_compradores_vendas_totais ..................... [RUN]
18:26:02.305240 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752"
18:26:02.314640 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752
18:26:02.318036 [debug] [Thread-1  ]: Compiling test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752
18:26:02.356037 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752"
18:26:02.383729 [debug] [Thread-1  ]: finished collecting timing info
18:26:02.391692 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752
18:26:02.413721 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752"
18:26:02.430299 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752"
18:26:02.434501 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752: BEGIN
18:26:02.438302 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:26:02.442253 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
18:26:04.033662 [debug] [Thread-1  ]: SQL status: BEGIN in 1.6 seconds
18:26:04.039717 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752"
18:26:04.043742 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select vendas_totais
from "dev"."public"."tb_10_compradores"
where vendas_totais is null



      
    ) dbt_internal_test
18:26:04.189923 [debug] [Thread-1  ]: SQL status: SELECT in 0.14 seconds
18:26:04.231468 [debug] [Thread-1  ]: finished collecting timing info
18:26:04.343968 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752: ROLLBACK
18:26:04.512685 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752: Close
18:26:04.517008 [info ] [Thread-1  ]: 2 of 2 PASS not_null_tb_10_compradores_vendas_totais ........................... [[32mPASS[0m in 2.21s]
18:26:04.522177 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752
18:26:04.532966 [debug] [MainThread]: Acquiring new redshift connection "master"
18:26:04.536889 [debug] [MainThread]: Using redshift connection "master"
18:26:04.540020 [debug] [MainThread]: On master: BEGIN
18:26:04.543555 [debug] [MainThread]: Opening a new connection, currently in state closed
18:26:04.547749 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
18:26:05.852664 [debug] [MainThread]: SQL status: BEGIN in 1.31 seconds
18:26:05.866962 [debug] [MainThread]: On master: COMMIT
18:26:05.876176 [debug] [MainThread]: Using redshift connection "master"
18:26:05.912640 [debug] [MainThread]: On master: COMMIT
18:26:06.075255 [debug] [MainThread]: SQL status: COMMIT in 0.14 seconds
18:26:06.099165 [debug] [MainThread]: On master: Close
18:26:06.118056 [info ] [MainThread]: 
18:26:06.131997 [info ] [MainThread]: Finished running 2 tests in 9.18s.
18:26:06.148219 [debug] [MainThread]: Connection 'master' was properly closed.
18:26:06.164749 [debug] [MainThread]: Connection 'test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752' was properly closed.
18:26:06.642089 [info ] [MainThread]: 
18:26:06.646354 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
18:26:06.660070 [info ] [MainThread]: 
18:26:06.675732 [error] [MainThread]: [31mFailure in test maior_que_zero_tb_10_compradores_vendas_totais (models/example/schema.yml)[0m
18:26:06.686643 [error] [MainThread]:   Got 1 result, configured to fail if != 0
18:26:06.697666 [info ] [MainThread]: 
18:26:06.711145 [info ] [MainThread]:   compiled SQL at target/compiled/analytics_dbt/models/example/schema.yml/maior_que_zero_tb_10_compradores_vendas_totais.sql
18:26:06.720758 [info ] [MainThread]: 
18:26:06.731663 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
18:26:06.739630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8aaca2f7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8aac0dffa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8aac0f36d0>]}


============================== 2022-05-23 18:28:42.598390 | 964b2e1f-9973-4f73-bd70-edff5bb72150 ==============================
18:28:42.598415 [info ] [MainThread]: Running with dbt=1.1.0
18:28:42.601647 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
18:28:42.608732 [debug] [MainThread]: Tracking: tracking
18:28:42.640289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15a7a6f6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15a7a6f760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15a7a6f790>]}
18:28:42.806769 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
18:28:42.810238 [debug] [MainThread]: Partial parsing: updated file: analytics_dbt://macros/maior_que_zero.sql
18:28:42.813221 [debug] [MainThread]: Parsing macros/maior_que_zero.sql
18:28:42.855824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '964b2e1f-9973-4f73-bd70-edff5bb72150', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15a7932d30>]}
18:28:42.884438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '964b2e1f-9973-4f73-bd70-edff5bb72150', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15a7985370>]}
18:28:42.887918 [info ] [MainThread]: Found 5 models, 2 tests, 0 snapshots, 0 analyses, 194 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
18:28:42.891888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '964b2e1f-9973-4f73-bd70-edff5bb72150', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15a7985670>]}
18:28:42.911410 [info ] [MainThread]: 
18:28:42.919614 [debug] [MainThread]: Acquiring new redshift connection "master"
18:28:42.926713 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev_public"
18:28:42.972113 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
18:28:42.994828 [debug] [ThreadPool]: On list_dev_public: BEGIN
18:28:43.003765 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:28:43.011745 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
18:28:44.286618 [debug] [ThreadPool]: SQL status: BEGIN in 1.28 seconds
18:28:44.291766 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
18:28:44.294442 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev_public"} */
select
      'dev' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dev' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
18:28:44.460357 [debug] [ThreadPool]: SQL status: SELECT in 0.16 seconds
18:28:44.467640 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
18:28:44.602655 [debug] [ThreadPool]: On list_dev_public: Close
18:28:44.627075 [debug] [MainThread]: Using redshift connection "master"
18:28:44.630501 [debug] [MainThread]: On master: BEGIN
18:28:44.633814 [debug] [MainThread]: Opening a new connection, currently in state init
18:28:44.637433 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
18:28:45.816438 [debug] [MainThread]: SQL status: BEGIN in 1.18 seconds
18:28:45.819875 [debug] [MainThread]: Using redshift connection "master"
18:28:45.823526 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
18:28:45.987884 [debug] [MainThread]: SQL status: SELECT in 0.16 seconds
18:28:45.993837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '964b2e1f-9973-4f73-bd70-edff5bb72150', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15a797dfd0>]}
18:28:45.997890 [debug] [MainThread]: On master: ROLLBACK
18:28:46.127909 [debug] [MainThread]: Using redshift connection "master"
18:28:46.130971 [debug] [MainThread]: On master: BEGIN
18:28:46.390270 [debug] [MainThread]: SQL status: BEGIN in 0.26 seconds
18:28:46.394349 [debug] [MainThread]: On master: COMMIT
18:28:46.397046 [debug] [MainThread]: Using redshift connection "master"
18:28:46.400934 [debug] [MainThread]: On master: COMMIT
18:28:46.532877 [debug] [MainThread]: SQL status: COMMIT in 0.13 seconds
18:28:46.536887 [debug] [MainThread]: On master: Close
18:28:46.540660 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
18:28:46.544753 [info ] [MainThread]: 
18:28:46.567746 [debug] [Thread-1  ]: Began running node test.analytics_dbt.maior_que_zero_tb_10_compradores_vendas_totais.d3966f9348
18:28:46.572796 [info ] [Thread-1  ]: 1 of 2 START test maior_que_zero_tb_10_compradores_vendas_totais ............... [RUN]
18:28:46.588517 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.maior_que_zero_tb_10_compradores_vendas_totais.d3966f9348"
18:28:46.602855 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.maior_que_zero_tb_10_compradores_vendas_totais.d3966f9348
18:28:46.605823 [debug] [Thread-1  ]: Compiling test.analytics_dbt.maior_que_zero_tb_10_compradores_vendas_totais.d3966f9348
18:28:46.654861 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.maior_que_zero_tb_10_compradores_vendas_totais.d3966f9348"
18:28:46.671341 [debug] [Thread-1  ]: finished collecting timing info
18:28:46.674868 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.maior_que_zero_tb_10_compradores_vendas_totais.d3966f9348
18:28:46.720575 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.maior_que_zero_tb_10_compradores_vendas_totais.d3966f9348"
18:28:46.728789 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.maior_que_zero_tb_10_compradores_vendas_totais.d3966f9348"
18:28:46.731885 [debug] [Thread-1  ]: On test.analytics_dbt.maior_que_zero_tb_10_compradores_vendas_totais.d3966f9348: BEGIN
18:28:46.734350 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:28:46.738388 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
18:28:47.917188 [debug] [Thread-1  ]: SQL status: BEGIN in 1.18 seconds
18:28:47.923422 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.maior_que_zero_tb_10_compradores_vendas_totais.d3966f9348"
18:28:47.934107 [debug] [Thread-1  ]: On test.analytics_dbt.maior_que_zero_tb_10_compradores_vendas_totais.d3966f9348: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.maior_que_zero_tb_10_compradores_vendas_totais.d3966f9348"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

    select count(*)
    from "dev"."public"."tb_10_compradores"
    where vendas_totais < 0


      
    ) dbt_internal_test
18:28:48.086924 [debug] [Thread-1  ]: SQL status: SELECT in 0.15 seconds
18:28:48.095419 [debug] [Thread-1  ]: finished collecting timing info
18:28:48.098874 [debug] [Thread-1  ]: On test.analytics_dbt.maior_que_zero_tb_10_compradores_vendas_totais.d3966f9348: ROLLBACK
18:28:48.229603 [debug] [Thread-1  ]: On test.analytics_dbt.maior_que_zero_tb_10_compradores_vendas_totais.d3966f9348: Close
18:28:48.235614 [error] [Thread-1  ]: 1 of 2 FAIL 1 maior_que_zero_tb_10_compradores_vendas_totais ................... [[31mFAIL 1[0m in 1.65s]
18:28:48.242899 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.maior_que_zero_tb_10_compradores_vendas_totais.d3966f9348
18:28:48.250613 [debug] [Thread-1  ]: Began running node test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752
18:28:48.261160 [info ] [Thread-1  ]: 2 of 2 START test not_null_tb_10_compradores_vendas_totais ..................... [RUN]
18:28:48.274193 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752"
18:28:48.296407 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752
18:28:48.303667 [debug] [Thread-1  ]: Compiling test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752
18:28:48.368908 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752"
18:28:48.393816 [debug] [Thread-1  ]: finished collecting timing info
18:28:48.402363 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752
18:28:48.414104 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752"
18:28:48.427297 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752"
18:28:48.432169 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752: BEGIN
18:28:48.435505 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:28:48.438363 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
18:28:49.656010 [debug] [Thread-1  ]: SQL status: BEGIN in 1.22 seconds
18:28:49.665016 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752"
18:28:49.669809 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select vendas_totais
from "dev"."public"."tb_10_compradores"
where vendas_totais is null



      
    ) dbt_internal_test
18:28:49.805255 [debug] [Thread-1  ]: SQL status: SELECT in 0.13 seconds
18:28:49.815954 [debug] [Thread-1  ]: finished collecting timing info
18:28:49.821064 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752: ROLLBACK
18:28:49.955192 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752: Close
18:28:49.959750 [info ] [Thread-1  ]: 2 of 2 PASS not_null_tb_10_compradores_vendas_totais ........................... [[32mPASS[0m in 1.69s]
18:28:49.968089 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752
18:28:49.989759 [debug] [MainThread]: Acquiring new redshift connection "master"
18:28:49.992487 [debug] [MainThread]: Using redshift connection "master"
18:28:50.008920 [debug] [MainThread]: On master: BEGIN
18:28:50.016652 [debug] [MainThread]: Opening a new connection, currently in state closed
18:28:50.021378 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
18:28:51.200918 [debug] [MainThread]: SQL status: BEGIN in 1.18 seconds
18:28:51.204849 [debug] [MainThread]: On master: COMMIT
18:28:51.208049 [debug] [MainThread]: Using redshift connection "master"
18:28:51.211266 [debug] [MainThread]: On master: COMMIT
18:28:51.342064 [debug] [MainThread]: SQL status: COMMIT in 0.13 seconds
18:28:51.346509 [debug] [MainThread]: On master: Close
18:28:51.350731 [info ] [MainThread]: 
18:28:51.354455 [info ] [MainThread]: Finished running 2 tests in 8.44s.
18:28:51.360470 [debug] [MainThread]: Connection 'master' was properly closed.
18:28:51.370224 [debug] [MainThread]: Connection 'test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752' was properly closed.
18:28:51.437539 [info ] [MainThread]: 
18:28:51.440989 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
18:28:51.447429 [info ] [MainThread]: 
18:28:51.452698 [error] [MainThread]: [31mFailure in test maior_que_zero_tb_10_compradores_vendas_totais (models/example/schema.yml)[0m
18:28:51.457436 [error] [MainThread]:   Got 1 result, configured to fail if != 0
18:28:51.463917 [info ] [MainThread]: 
18:28:51.474157 [info ] [MainThread]:   compiled SQL at target/compiled/analytics_dbt/models/example/schema.yml/maior_que_zero_tb_10_compradores_vendas_totais.sql
18:28:51.489840 [info ] [MainThread]: 
18:28:51.511210 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
18:28:51.528441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15a70fa6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15a71057c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15a7985460>]}


============================== 2022-05-23 18:38:52.511172 | 5aeb7d1d-2655-4291-9879-5f29b53c2247 ==============================
18:38:52.511195 [info ] [MainThread]: Running with dbt=1.1.0
18:38:52.514614 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'select': ['models/example/schema.yml'], 'which': 'test', 'rpc_method': 'test'}
18:38:52.518692 [debug] [MainThread]: Tracking: tracking
18:38:52.559551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31bd12d700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31bd12d7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31bd12d7f0>]}
18:38:52.694113 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
18:38:52.696726 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
18:38:52.718447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5aeb7d1d-2655-4291-9879-5f29b53c2247', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31bd055610>]}
18:38:52.778182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5aeb7d1d-2655-4291-9879-5f29b53c2247', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31bd045070>]}
18:38:52.782156 [info ] [MainThread]: Found 5 models, 2 tests, 0 snapshots, 0 analyses, 194 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
18:38:52.785659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5aeb7d1d-2655-4291-9879-5f29b53c2247', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31bd045310>]}
18:38:52.796456 [info ] [MainThread]: 
18:38:52.803414 [debug] [MainThread]: Acquiring new redshift connection "master"
18:38:52.821627 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev_public"
18:38:52.883620 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
18:38:52.887480 [debug] [ThreadPool]: On list_dev_public: BEGIN
18:38:52.890121 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:38:52.893190 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
18:38:54.107535 [debug] [ThreadPool]: SQL status: BEGIN in 1.22 seconds
18:38:54.110452 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
18:38:54.113602 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev_public"} */
select
      'dev' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dev' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
18:38:54.258136 [debug] [ThreadPool]: SQL status: SELECT in 0.14 seconds
18:38:54.265592 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
18:38:54.400777 [debug] [ThreadPool]: On list_dev_public: Close
18:38:54.417238 [debug] [MainThread]: Using redshift connection "master"
18:38:54.420443 [debug] [MainThread]: On master: BEGIN
18:38:54.423028 [debug] [MainThread]: Opening a new connection, currently in state init
18:38:54.425482 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
18:38:55.620099 [debug] [MainThread]: SQL status: BEGIN in 1.2 seconds
18:38:55.624346 [debug] [MainThread]: Using redshift connection "master"
18:38:55.626787 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
18:38:55.792156 [debug] [MainThread]: SQL status: SELECT in 0.16 seconds
18:38:55.799465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5aeb7d1d-2655-4291-9879-5f29b53c2247', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31bd0fdf70>]}
18:38:55.804041 [debug] [MainThread]: On master: ROLLBACK
18:38:55.939614 [debug] [MainThread]: Using redshift connection "master"
18:38:55.942717 [debug] [MainThread]: On master: BEGIN
18:38:56.202223 [debug] [MainThread]: SQL status: BEGIN in 0.26 seconds
18:38:56.206027 [debug] [MainThread]: On master: COMMIT
18:38:56.208666 [debug] [MainThread]: Using redshift connection "master"
18:38:56.211290 [debug] [MainThread]: On master: COMMIT
18:38:56.341647 [debug] [MainThread]: SQL status: COMMIT in 0.13 seconds
18:38:56.344435 [debug] [MainThread]: On master: Close
18:38:56.349101 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
18:38:56.352169 [info ] [MainThread]: 
18:38:56.384168 [debug] [Thread-1  ]: Began running node test.analytics_dbt.maior_que_zero_tb_10_compradores_vendas_totais.d3966f9348
18:38:56.390716 [info ] [Thread-1  ]: 1 of 2 START test maior_que_zero_tb_10_compradores_vendas_totais ............... [RUN]
18:38:56.413151 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.maior_que_zero_tb_10_compradores_vendas_totais.d3966f9348"
18:38:56.420121 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.maior_que_zero_tb_10_compradores_vendas_totais.d3966f9348
18:38:56.428037 [debug] [Thread-1  ]: Compiling test.analytics_dbt.maior_que_zero_tb_10_compradores_vendas_totais.d3966f9348
18:38:56.472074 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.maior_que_zero_tb_10_compradores_vendas_totais.d3966f9348"
18:38:56.486475 [debug] [Thread-1  ]: finished collecting timing info
18:38:56.490401 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.maior_que_zero_tb_10_compradores_vendas_totais.d3966f9348
18:38:56.532495 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.maior_que_zero_tb_10_compradores_vendas_totais.d3966f9348"
18:38:56.541924 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.maior_que_zero_tb_10_compradores_vendas_totais.d3966f9348"
18:38:56.546867 [debug] [Thread-1  ]: On test.analytics_dbt.maior_que_zero_tb_10_compradores_vendas_totais.d3966f9348: BEGIN
18:38:56.549768 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:38:56.552358 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
18:38:57.766526 [debug] [Thread-1  ]: SQL status: BEGIN in 1.22 seconds
18:38:57.768789 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.maior_que_zero_tb_10_compradores_vendas_totais.d3966f9348"
18:38:57.771601 [debug] [Thread-1  ]: On test.analytics_dbt.maior_que_zero_tb_10_compradores_vendas_totais.d3966f9348: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.maior_que_zero_tb_10_compradores_vendas_totais.d3966f9348"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

    select count(*)
    from "dev"."public"."tb_10_compradores"
    where vendas_totais < 0


      
    ) dbt_internal_test
18:38:57.912233 [debug] [Thread-1  ]: SQL status: SELECT in 0.14 seconds
18:38:57.920747 [debug] [Thread-1  ]: finished collecting timing info
18:38:57.924466 [debug] [Thread-1  ]: On test.analytics_dbt.maior_que_zero_tb_10_compradores_vendas_totais.d3966f9348: ROLLBACK
18:38:58.057994 [debug] [Thread-1  ]: On test.analytics_dbt.maior_que_zero_tb_10_compradores_vendas_totais.d3966f9348: Close
18:38:58.061721 [error] [Thread-1  ]: 1 of 2 FAIL 1 maior_que_zero_tb_10_compradores_vendas_totais ................... [[31mFAIL 1[0m in 1.65s]
18:38:58.065160 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.maior_que_zero_tb_10_compradores_vendas_totais.d3966f9348
18:38:58.070828 [debug] [Thread-1  ]: Began running node test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752
18:38:58.075456 [info ] [Thread-1  ]: 2 of 2 START test not_null_tb_10_compradores_vendas_totais ..................... [RUN]
18:38:58.081502 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752"
18:38:58.091572 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752
18:38:58.099505 [debug] [Thread-1  ]: Compiling test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752
18:38:58.157829 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752"
18:38:58.169714 [debug] [Thread-1  ]: finished collecting timing info
18:38:58.175331 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752
18:38:58.187012 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752"
18:38:58.195493 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752"
18:38:58.199072 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752: BEGIN
18:38:58.201298 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:38:58.203659 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
18:38:59.415899 [debug] [Thread-1  ]: SQL status: BEGIN in 1.21 seconds
18:38:59.421669 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752"
18:38:59.425597 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select vendas_totais
from "dev"."public"."tb_10_compradores"
where vendas_totais is null



      
    ) dbt_internal_test
18:38:59.562093 [debug] [Thread-1  ]: SQL status: SELECT in 0.13 seconds
18:38:59.567706 [debug] [Thread-1  ]: finished collecting timing info
18:38:59.570441 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752: ROLLBACK
18:38:59.704293 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752: Close
18:38:59.710092 [info ] [Thread-1  ]: 2 of 2 PASS not_null_tb_10_compradores_vendas_totais ........................... [[32mPASS[0m in 1.63s]
18:38:59.715421 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752
18:38:59.726348 [debug] [MainThread]: Acquiring new redshift connection "master"
18:38:59.735014 [debug] [MainThread]: Using redshift connection "master"
18:38:59.745437 [debug] [MainThread]: On master: BEGIN
18:38:59.754466 [debug] [MainThread]: Opening a new connection, currently in state closed
18:38:59.759507 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
18:39:01.090217 [debug] [MainThread]: SQL status: BEGIN in 1.34 seconds
18:39:01.096618 [debug] [MainThread]: On master: COMMIT
18:39:01.100616 [debug] [MainThread]: Using redshift connection "master"
18:39:01.103250 [debug] [MainThread]: On master: COMMIT
18:39:01.235709 [debug] [MainThread]: SQL status: COMMIT in 0.13 seconds
18:39:01.240529 [debug] [MainThread]: On master: Close
18:39:01.244540 [info ] [MainThread]: 
18:39:01.247901 [info ] [MainThread]: Finished running 2 tests in 8.44s.
18:39:01.252749 [debug] [MainThread]: Connection 'master' was properly closed.
18:39:01.257062 [debug] [MainThread]: Connection 'test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752' was properly closed.
18:39:01.304829 [info ] [MainThread]: 
18:39:01.310983 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
18:39:01.323223 [info ] [MainThread]: 
18:39:01.332372 [error] [MainThread]: [31mFailure in test maior_que_zero_tb_10_compradores_vendas_totais (models/example/schema.yml)[0m
18:39:01.346693 [error] [MainThread]:   Got 1 result, configured to fail if != 0
18:39:01.365002 [info ] [MainThread]: 
18:39:01.386028 [info ] [MainThread]:   compiled SQL at target/compiled/analytics_dbt/models/example/schema.yml/maior_que_zero_tb_10_compradores_vendas_totais.sql
18:39:01.398073 [info ] [MainThread]: 
18:39:01.418413 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
18:39:01.436045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31bd045250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31bd018d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31bc7adf40>]}


============================== 2022-05-23 18:39:47.645346 | 95335fce-135e-46f2-9a5a-dbc17969f1d8 ==============================
18:39:47.645376 [info ] [MainThread]: Running with dbt=1.1.0
18:39:47.649225 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'select': ['models/example/schema.yml'], 'which': 'test', 'rpc_method': 'test'}
18:39:47.668055 [debug] [MainThread]: Tracking: tracking
18:39:47.711753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d4bf02760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d4bf02820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d4bf02850>]}
18:39:47.867940 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
18:39:47.872651 [debug] [MainThread]: Partial parsing: updated file: analytics_dbt://macros/maior_que_zero.sql
18:39:47.876199 [debug] [MainThread]: Parsing macros/maior_que_zero.sql
18:39:47.923358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '95335fce-135e-46f2-9a5a-dbc17969f1d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d4bdcadf0>]}
18:39:47.959960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '95335fce-135e-46f2-9a5a-dbc17969f1d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d4be1d4f0>]}
18:39:47.966287 [info ] [MainThread]: Found 5 models, 2 tests, 0 snapshots, 0 analyses, 194 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
18:39:47.970393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '95335fce-135e-46f2-9a5a-dbc17969f1d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d4be099a0>]}
18:39:47.999086 [info ] [MainThread]: 
18:39:48.005428 [debug] [MainThread]: Acquiring new redshift connection "master"
18:39:48.023118 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev_public"
18:39:48.079048 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
18:39:48.082933 [debug] [ThreadPool]: On list_dev_public: BEGIN
18:39:48.086210 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:39:48.089794 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
18:39:49.269203 [debug] [ThreadPool]: SQL status: BEGIN in 1.18 seconds
18:39:49.271760 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
18:39:49.275357 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev_public"} */
select
      'dev' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dev' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
18:39:49.415397 [debug] [ThreadPool]: SQL status: SELECT in 0.14 seconds
18:39:49.422907 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
18:39:49.553329 [debug] [ThreadPool]: On list_dev_public: Close
18:39:49.569984 [debug] [MainThread]: Using redshift connection "master"
18:39:49.572661 [debug] [MainThread]: On master: BEGIN
18:39:49.579445 [debug] [MainThread]: Opening a new connection, currently in state init
18:39:49.583116 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
18:39:50.773870 [debug] [MainThread]: SQL status: BEGIN in 1.19 seconds
18:39:50.776755 [debug] [MainThread]: Using redshift connection "master"
18:39:50.779775 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
18:39:50.947860 [debug] [MainThread]: SQL status: SELECT in 0.16 seconds
18:39:50.954210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '95335fce-135e-46f2-9a5a-dbc17969f1d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d4bf1aa90>]}
18:39:50.958183 [debug] [MainThread]: On master: ROLLBACK
18:39:51.090858 [debug] [MainThread]: Using redshift connection "master"
18:39:51.093848 [debug] [MainThread]: On master: BEGIN
18:39:51.355187 [debug] [MainThread]: SQL status: BEGIN in 0.26 seconds
18:39:51.359433 [debug] [MainThread]: On master: COMMIT
18:39:51.362113 [debug] [MainThread]: Using redshift connection "master"
18:39:51.364922 [debug] [MainThread]: On master: COMMIT
18:39:51.496901 [debug] [MainThread]: SQL status: COMMIT in 0.13 seconds
18:39:51.500801 [debug] [MainThread]: On master: Close
18:39:51.504741 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
18:39:51.507744 [info ] [MainThread]: 
18:39:51.531801 [debug] [Thread-1  ]: Began running node test.analytics_dbt.maior_que_zero_tb_10_compradores_vendas_totais.d3966f9348
18:39:51.536002 [info ] [Thread-1  ]: 1 of 2 START test maior_que_zero_tb_10_compradores_vendas_totais ............... [RUN]
18:39:51.552383 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.maior_que_zero_tb_10_compradores_vendas_totais.d3966f9348"
18:39:51.561686 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.maior_que_zero_tb_10_compradores_vendas_totais.d3966f9348
18:39:51.566435 [debug] [Thread-1  ]: Compiling test.analytics_dbt.maior_que_zero_tb_10_compradores_vendas_totais.d3966f9348
18:39:51.624185 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.maior_que_zero_tb_10_compradores_vendas_totais.d3966f9348"
18:39:51.636236 [debug] [Thread-1  ]: finished collecting timing info
18:39:51.643839 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.maior_que_zero_tb_10_compradores_vendas_totais.d3966f9348
18:39:51.689476 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.maior_que_zero_tb_10_compradores_vendas_totais.d3966f9348"
18:39:51.699839 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.maior_que_zero_tb_10_compradores_vendas_totais.d3966f9348"
18:39:51.702990 [debug] [Thread-1  ]: On test.analytics_dbt.maior_que_zero_tb_10_compradores_vendas_totais.d3966f9348: BEGIN
18:39:51.706616 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:39:51.715651 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
18:39:52.938305 [debug] [Thread-1  ]: SQL status: BEGIN in 1.23 seconds
18:39:52.941788 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.maior_que_zero_tb_10_compradores_vendas_totais.d3966f9348"
18:39:52.945243 [debug] [Thread-1  ]: On test.analytics_dbt.maior_que_zero_tb_10_compradores_vendas_totais.d3966f9348: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.maior_que_zero_tb_10_compradores_vendas_totais.d3966f9348"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

    select *
    from "dev"."public"."tb_10_compradores"
    where vendas_totais < 0


      
    ) dbt_internal_test
18:39:56.696194 [debug] [Thread-1  ]: SQL status: SELECT in 3.75 seconds
18:39:56.704955 [debug] [Thread-1  ]: finished collecting timing info
18:39:56.708311 [debug] [Thread-1  ]: On test.analytics_dbt.maior_que_zero_tb_10_compradores_vendas_totais.d3966f9348: ROLLBACK
18:39:56.845948 [debug] [Thread-1  ]: On test.analytics_dbt.maior_que_zero_tb_10_compradores_vendas_totais.d3966f9348: Close
18:39:56.850431 [info ] [Thread-1  ]: 1 of 2 PASS maior_que_zero_tb_10_compradores_vendas_totais ..................... [[32mPASS[0m in 5.30s]
18:39:56.855039 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.maior_que_zero_tb_10_compradores_vendas_totais.d3966f9348
18:39:56.858487 [debug] [Thread-1  ]: Began running node test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752
18:39:56.863775 [info ] [Thread-1  ]: 2 of 2 START test not_null_tb_10_compradores_vendas_totais ..................... [RUN]
18:39:56.872529 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752"
18:39:56.883460 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752
18:39:56.889355 [debug] [Thread-1  ]: Compiling test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752
18:39:56.929186 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752"
18:39:56.946322 [debug] [Thread-1  ]: finished collecting timing info
18:39:56.950246 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752
18:39:56.958291 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752"
18:39:56.966088 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752"
18:39:56.969034 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752: BEGIN
18:39:56.972002 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:39:56.974718 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
18:39:58.423049 [debug] [Thread-1  ]: SQL status: BEGIN in 1.45 seconds
18:39:58.427414 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752"
18:39:58.430306 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select vendas_totais
from "dev"."public"."tb_10_compradores"
where vendas_totais is null



      
    ) dbt_internal_test
18:39:58.565877 [debug] [Thread-1  ]: SQL status: SELECT in 0.13 seconds
18:39:58.572317 [debug] [Thread-1  ]: finished collecting timing info
18:39:58.575010 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752: ROLLBACK
18:39:58.708998 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752: Close
18:39:58.713231 [info ] [Thread-1  ]: 2 of 2 PASS not_null_tb_10_compradores_vendas_totais ........................... [[32mPASS[0m in 1.84s]
18:39:58.717114 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752
18:39:58.724582 [debug] [MainThread]: Acquiring new redshift connection "master"
18:39:58.729715 [debug] [MainThread]: Using redshift connection "master"
18:39:58.738097 [debug] [MainThread]: On master: BEGIN
18:39:58.746226 [debug] [MainThread]: Opening a new connection, currently in state closed
18:39:58.751461 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
18:39:59.954739 [debug] [MainThread]: SQL status: BEGIN in 1.21 seconds
18:39:59.957618 [debug] [MainThread]: On master: COMMIT
18:39:59.960434 [debug] [MainThread]: Using redshift connection "master"
18:39:59.963602 [debug] [MainThread]: On master: COMMIT
18:40:00.098131 [debug] [MainThread]: SQL status: COMMIT in 0.13 seconds
18:40:00.101037 [debug] [MainThread]: On master: Close
18:40:00.105913 [info ] [MainThread]: 
18:40:00.110142 [info ] [MainThread]: Finished running 2 tests in 12.10s.
18:40:00.115930 [debug] [MainThread]: Connection 'master' was properly closed.
18:40:00.123194 [debug] [MainThread]: Connection 'test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752' was properly closed.
18:40:00.181165 [info ] [MainThread]: 
18:40:00.186294 [info ] [MainThread]: [32mCompleted successfully[0m
18:40:00.192627 [info ] [MainThread]: 
18:40:00.199549 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
18:40:00.210174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d4be09940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d4b581e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d4b597790>]}


============================== 2022-05-23 18:45:45.390454 | 0a820854-c500-4f12-acd4-bf308ebed6c0 ==============================
18:45:45.390481 [info ] [MainThread]: Running with dbt=1.1.0
18:45:45.394270 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'select': ['models/example/schema.yml'], 'which': 'test', 'rpc_method': 'test'}
18:45:45.400990 [debug] [MainThread]: Tracking: tracking
18:45:45.437678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02915c5610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02915c56d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02915c5700>]}
18:45:45.620153 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 1 files changed.
18:45:45.624788 [debug] [MainThread]: Partial parsing: added file: analytics_dbt://macros/nao_negativo.sql
18:45:45.629723 [debug] [MainThread]: Partial parsing: update schema file: analytics_dbt://models/example/schema.yml
18:45:45.633572 [debug] [MainThread]: Partial parsing: deleted file: analytics_dbt://macros/maior_que_zero.sql
18:45:45.638436 [debug] [MainThread]: Parsing macros/nao_negativo.sql
18:45:45.676502 [debug] [MainThread]: 1699: static parser successfully parsed tables/tb_10_compradores.sql
18:45:45.961145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0a820854-c500-4f12-acd4-bf308ebed6c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f029147f250>]}
18:45:46.004524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0a820854-c500-4f12-acd4-bf308ebed6c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02915c5820>]}
18:45:46.009047 [info ] [MainThread]: Found 5 models, 10 tests, 0 snapshots, 0 analyses, 194 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
18:45:46.012768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0a820854-c500-4f12-acd4-bf308ebed6c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02914c5790>]}
18:45:46.042586 [info ] [MainThread]: 
18:45:46.047048 [debug] [MainThread]: Acquiring new redshift connection "master"
18:45:46.067352 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev_public"
18:45:46.104136 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
18:45:46.108087 [debug] [ThreadPool]: On list_dev_public: BEGIN
18:45:46.110724 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:45:46.114055 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
18:45:47.366483 [debug] [ThreadPool]: SQL status: BEGIN in 1.26 seconds
18:45:47.369132 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
18:45:47.371584 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev_public"} */
select
      'dev' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dev' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
18:45:47.514948 [debug] [ThreadPool]: SQL status: SELECT in 0.14 seconds
18:45:47.522549 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
18:45:47.655037 [debug] [ThreadPool]: On list_dev_public: Close
18:45:47.671453 [debug] [MainThread]: Using redshift connection "master"
18:45:47.674371 [debug] [MainThread]: On master: BEGIN
18:45:47.677730 [debug] [MainThread]: Opening a new connection, currently in state init
18:45:47.680779 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
18:45:48.901526 [debug] [MainThread]: SQL status: BEGIN in 1.22 seconds
18:45:48.904675 [debug] [MainThread]: Using redshift connection "master"
18:45:48.907424 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
18:45:49.075983 [debug] [MainThread]: SQL status: SELECT in 0.17 seconds
18:45:49.084038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0a820854-c500-4f12-acd4-bf308ebed6c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02914d26a0>]}
18:45:49.101961 [debug] [MainThread]: On master: ROLLBACK
18:45:49.236361 [debug] [MainThread]: Using redshift connection "master"
18:45:49.240871 [debug] [MainThread]: On master: BEGIN
18:45:49.507718 [debug] [MainThread]: SQL status: BEGIN in 0.26 seconds
18:45:49.511025 [debug] [MainThread]: On master: COMMIT
18:45:49.513881 [debug] [MainThread]: Using redshift connection "master"
18:45:49.516455 [debug] [MainThread]: On master: COMMIT
18:45:49.631055 [debug] [MainThread]: SQL status: COMMIT in 0.11 seconds
18:45:49.634254 [debug] [MainThread]: On master: Close
18:45:49.638991 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
18:45:49.643408 [info ] [MainThread]: 
18:45:49.662724 [debug] [Thread-1  ]: Began running node test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea
18:45:49.670895 [info ] [Thread-1  ]: 1 of 10 START test nao_negativo_tb_10_compradores_vendas_totais ................ [RUN]
18:45:49.677628 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea"
18:45:49.686795 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea
18:45:49.691203 [debug] [Thread-1  ]: Compiling test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea
18:45:49.706364 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea"
18:45:49.725844 [debug] [Thread-1  ]: finished collecting timing info
18:45:49.728841 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea
18:45:49.771823 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea"
18:45:49.788878 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea"
18:45:49.793218 [debug] [Thread-1  ]: On test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea: BEGIN
18:45:49.796795 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:45:49.800626 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
18:45:50.998832 [debug] [Thread-1  ]: SQL status: BEGIN in 1.2 seconds
18:45:51.005212 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea"
18:45:51.008029 [debug] [Thread-1  ]: On test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

    select *
    from "dev"."public"."tb_10_compradores"
    where vendas_totais < 0


      
    ) dbt_internal_test
18:45:51.143259 [debug] [Thread-1  ]: SQL status: SELECT in 0.13 seconds
18:45:51.149966 [debug] [Thread-1  ]: finished collecting timing info
18:45:51.152875 [debug] [Thread-1  ]: On test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea: ROLLBACK
18:45:51.286373 [debug] [Thread-1  ]: On test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea: Close
18:45:51.295118 [info ] [Thread-1  ]: 1 of 10 PASS nao_negativo_tb_10_compradores_vendas_totais ...................... [[32mPASS[0m in 1.62s]
18:45:51.299872 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea
18:45:51.306263 [debug] [Thread-1  ]: Began running node test.analytics_dbt.nao_negativo_vw_sales_comissao.c9561fd7db
18:45:51.310606 [info ] [Thread-1  ]: 2 of 10 START test nao_negativo_vw_sales_comissao .............................. [RUN]
18:45:51.317323 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.nao_negativo_vw_sales_comissao.c9561fd7db"
18:45:51.328374 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.nao_negativo_vw_sales_comissao.c9561fd7db
18:45:51.332000 [debug] [Thread-1  ]: Compiling test.analytics_dbt.nao_negativo_vw_sales_comissao.c9561fd7db
18:45:51.358564 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.nao_negativo_vw_sales_comissao.c9561fd7db"
18:45:51.370942 [debug] [Thread-1  ]: finished collecting timing info
18:45:51.374966 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.nao_negativo_vw_sales_comissao.c9561fd7db
18:45:51.386203 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.nao_negativo_vw_sales_comissao.c9561fd7db"
18:45:51.396433 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.nao_negativo_vw_sales_comissao.c9561fd7db"
18:45:51.400673 [debug] [Thread-1  ]: On test.analytics_dbt.nao_negativo_vw_sales_comissao.c9561fd7db: BEGIN
18:45:51.404654 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:45:51.407938 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
18:45:52.608557 [debug] [Thread-1  ]: SQL status: BEGIN in 1.2 seconds
18:45:52.611488 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.nao_negativo_vw_sales_comissao.c9561fd7db"
18:45:52.613506 [debug] [Thread-1  ]: On test.analytics_dbt.nao_negativo_vw_sales_comissao.c9561fd7db: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.nao_negativo_vw_sales_comissao.c9561fd7db"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

    select *
    from "dev"."public"."vw_sales"
    where comissao < 0


      
    ) dbt_internal_test
18:45:56.602318 [debug] [Thread-1  ]: SQL status: SELECT in 3.99 seconds
18:45:56.608306 [debug] [Thread-1  ]: finished collecting timing info
18:45:56.610824 [debug] [Thread-1  ]: On test.analytics_dbt.nao_negativo_vw_sales_comissao.c9561fd7db: ROLLBACK
18:45:56.749595 [debug] [Thread-1  ]: On test.analytics_dbt.nao_negativo_vw_sales_comissao.c9561fd7db: Close
18:45:56.754796 [info ] [Thread-1  ]: 2 of 10 PASS nao_negativo_vw_sales_comissao .................................... [[32mPASS[0m in 5.44s]
18:45:56.758425 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.nao_negativo_vw_sales_comissao.c9561fd7db
18:45:56.770013 [debug] [Thread-1  ]: Began running node test.analytics_dbt.nao_negativo_vw_sales_valor_pago.7a9d055b10
18:45:56.776732 [info ] [Thread-1  ]: 3 of 10 START test nao_negativo_vw_sales_valor_pago ............................ [RUN]
18:45:56.785905 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.nao_negativo_vw_sales_valor_pago.7a9d055b10"
18:45:56.792576 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.nao_negativo_vw_sales_valor_pago.7a9d055b10
18:45:56.798385 [debug] [Thread-1  ]: Compiling test.analytics_dbt.nao_negativo_vw_sales_valor_pago.7a9d055b10
18:45:56.817114 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.nao_negativo_vw_sales_valor_pago.7a9d055b10"
18:45:56.833237 [debug] [Thread-1  ]: finished collecting timing info
18:45:56.837573 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.nao_negativo_vw_sales_valor_pago.7a9d055b10
18:45:56.845958 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.nao_negativo_vw_sales_valor_pago.7a9d055b10"
18:45:56.856010 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.nao_negativo_vw_sales_valor_pago.7a9d055b10"
18:45:56.858961 [debug] [Thread-1  ]: On test.analytics_dbt.nao_negativo_vw_sales_valor_pago.7a9d055b10: BEGIN
18:45:56.862089 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:45:56.865352 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
18:45:58.047974 [debug] [Thread-1  ]: SQL status: BEGIN in 1.19 seconds
18:45:58.052957 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.nao_negativo_vw_sales_valor_pago.7a9d055b10"
18:45:58.056413 [debug] [Thread-1  ]: On test.analytics_dbt.nao_negativo_vw_sales_valor_pago.7a9d055b10: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.nao_negativo_vw_sales_valor_pago.7a9d055b10"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

    select *
    from "dev"."public"."vw_sales"
    where valor_pago < 0


      
    ) dbt_internal_test
18:46:01.805852 [debug] [Thread-1  ]: SQL status: SELECT in 3.75 seconds
18:46:01.814163 [debug] [Thread-1  ]: finished collecting timing info
18:46:01.817479 [debug] [Thread-1  ]: On test.analytics_dbt.nao_negativo_vw_sales_valor_pago.7a9d055b10: ROLLBACK
18:46:01.949470 [debug] [Thread-1  ]: On test.analytics_dbt.nao_negativo_vw_sales_valor_pago.7a9d055b10: Close
18:46:01.953867 [info ] [Thread-1  ]: 3 of 10 PASS nao_negativo_vw_sales_valor_pago .................................. [[32mPASS[0m in 5.17s]
18:46:01.958664 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.nao_negativo_vw_sales_valor_pago.7a9d055b10
18:46:01.962273 [debug] [Thread-1  ]: Began running node test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
18:46:01.973022 [info ] [Thread-1  ]: 4 of 10 START test not_null_my_first_dbt_model_id .............................. [RUN]
18:46:01.979028 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
18:46:01.995266 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
18:46:02.000590 [debug] [Thread-1  ]: Compiling test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
18:46:02.026992 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
18:46:02.038353 [debug] [Thread-1  ]: finished collecting timing info
18:46:02.041112 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
18:46:02.049908 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
18:46:02.058740 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
18:46:02.061820 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710: BEGIN
18:46:02.064492 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:46:02.067890 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
18:46:03.268068 [debug] [Thread-1  ]: SQL status: BEGIN in 1.2 seconds
18:46:03.272757 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
18:46:03.276134 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dev"."public"."my_first_dbt_model"
where id is null



      
    ) dbt_internal_test
18:46:03.411907 [debug] [Thread-1  ]: SQL status: SELECT in 0.13 seconds
18:46:03.418646 [debug] [Thread-1  ]: finished collecting timing info
18:46:03.421474 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
18:46:03.552736 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710: Close
18:46:03.557311 [error] [Thread-1  ]: 4 of 10 FAIL 1 not_null_my_first_dbt_model_id .................................. [[31mFAIL 1[0m in 1.58s]
18:46:03.560891 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
18:46:03.568830 [debug] [Thread-1  ]: Began running node test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
18:46:03.573842 [info ] [Thread-1  ]: 5 of 10 START test not_null_my_second_dbt_model_id ............................. [RUN]
18:46:03.580503 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"
18:46:03.585218 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
18:46:03.589383 [debug] [Thread-1  ]: Compiling test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
18:46:03.611673 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"
18:46:03.619987 [debug] [Thread-1  ]: finished collecting timing info
18:46:03.623955 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
18:46:03.633932 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"
18:46:03.642369 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"
18:46:03.645754 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778: BEGIN
18:46:03.648843 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:46:03.651957 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
18:46:04.843409 [debug] [Thread-1  ]: SQL status: BEGIN in 1.19 seconds
18:46:04.846923 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"
18:46:04.850899 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dev"."public"."my_second_dbt_model"
where id is null



      
    ) dbt_internal_test
18:46:04.989368 [debug] [Thread-1  ]: SQL status: SELECT in 0.14 seconds
18:46:04.995351 [debug] [Thread-1  ]: finished collecting timing info
18:46:04.998641 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778: ROLLBACK
18:46:05.130305 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778: Close
18:46:05.135026 [info ] [Thread-1  ]: 5 of 10 PASS not_null_my_second_dbt_model_id ................................... [[32mPASS[0m in 1.55s]
18:46:05.139947 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
18:46:05.146538 [debug] [Thread-1  ]: Began running node test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752
18:46:05.152734 [info ] [Thread-1  ]: 6 of 10 START test not_null_tb_10_compradores_vendas_totais .................... [RUN]
18:46:05.158988 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752"
18:46:05.164871 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752
18:46:05.170206 [debug] [Thread-1  ]: Compiling test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752
18:46:05.188126 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752"
18:46:05.198887 [debug] [Thread-1  ]: finished collecting timing info
18:46:05.204127 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752
18:46:05.212224 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752"
18:46:05.221605 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752"
18:46:05.225347 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752: BEGIN
18:46:05.228186 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:46:05.230980 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
18:46:06.431323 [debug] [Thread-1  ]: SQL status: BEGIN in 1.2 seconds
18:46:06.435480 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752"
18:46:06.439973 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select vendas_totais
from "dev"."public"."tb_10_compradores"
where vendas_totais is null



      
    ) dbt_internal_test
18:46:06.574388 [debug] [Thread-1  ]: SQL status: SELECT in 0.13 seconds
18:46:06.582553 [debug] [Thread-1  ]: finished collecting timing info
18:46:06.585919 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752: ROLLBACK
18:46:06.719900 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752: Close
18:46:06.723852 [info ] [Thread-1  ]: 6 of 10 PASS not_null_tb_10_compradores_vendas_totais .......................... [[32mPASS[0m in 1.57s]
18:46:06.727636 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752
18:46:06.733048 [debug] [Thread-1  ]: Began running node test.analytics_dbt.not_null_vw_sales_comissao.d9b6c254ab
18:46:06.738779 [info ] [Thread-1  ]: 7 of 10 START test not_null_vw_sales_comissao .................................. [RUN]
18:46:06.745176 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.not_null_vw_sales_comissao.d9b6c254ab"
18:46:06.753706 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.not_null_vw_sales_comissao.d9b6c254ab
18:46:06.757709 [debug] [Thread-1  ]: Compiling test.analytics_dbt.not_null_vw_sales_comissao.d9b6c254ab
18:46:06.783428 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.not_null_vw_sales_comissao.d9b6c254ab"
18:46:06.793553 [debug] [Thread-1  ]: finished collecting timing info
18:46:06.796786 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.not_null_vw_sales_comissao.d9b6c254ab
18:46:06.804525 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.not_null_vw_sales_comissao.d9b6c254ab"
18:46:06.814664 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_vw_sales_comissao.d9b6c254ab"
18:46:06.818115 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_vw_sales_comissao.d9b6c254ab: BEGIN
18:46:06.820706 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:46:06.823243 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
18:46:08.034819 [debug] [Thread-1  ]: SQL status: BEGIN in 1.21 seconds
18:46:08.037551 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_vw_sales_comissao.d9b6c254ab"
18:46:08.040214 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_vw_sales_comissao.d9b6c254ab: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.not_null_vw_sales_comissao.d9b6c254ab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select comissao
from "dev"."public"."vw_sales"
where comissao is null



      
    ) dbt_internal_test
18:46:11.641478 [debug] [Thread-1  ]: SQL status: SELECT in 3.6 seconds
18:46:11.648253 [debug] [Thread-1  ]: finished collecting timing info
18:46:11.652010 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_vw_sales_comissao.d9b6c254ab: ROLLBACK
18:46:11.785228 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_vw_sales_comissao.d9b6c254ab: Close
18:46:11.789620 [info ] [Thread-1  ]: 7 of 10 PASS not_null_vw_sales_comissao ........................................ [[32mPASS[0m in 5.04s]
18:46:11.793773 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.not_null_vw_sales_comissao.d9b6c254ab
18:46:11.798943 [debug] [Thread-1  ]: Began running node test.analytics_dbt.not_null_vw_sales_valor_pago.5cd141ad26
18:46:11.804881 [info ] [Thread-1  ]: 8 of 10 START test not_null_vw_sales_valor_pago ................................ [RUN]
18:46:11.813643 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.not_null_vw_sales_valor_pago.5cd141ad26"
18:46:11.818603 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.not_null_vw_sales_valor_pago.5cd141ad26
18:46:11.829451 [debug] [Thread-1  ]: Compiling test.analytics_dbt.not_null_vw_sales_valor_pago.5cd141ad26
18:46:11.844960 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.not_null_vw_sales_valor_pago.5cd141ad26"
18:46:11.858005 [debug] [Thread-1  ]: finished collecting timing info
18:46:11.860686 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.not_null_vw_sales_valor_pago.5cd141ad26
18:46:11.868653 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.not_null_vw_sales_valor_pago.5cd141ad26"
18:46:11.880809 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_vw_sales_valor_pago.5cd141ad26"
18:46:11.884029 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_vw_sales_valor_pago.5cd141ad26: BEGIN
18:46:11.887784 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:46:11.890962 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
18:46:13.085427 [debug] [Thread-1  ]: SQL status: BEGIN in 1.2 seconds
18:46:13.090513 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_vw_sales_valor_pago.5cd141ad26"
18:46:13.093007 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_vw_sales_valor_pago.5cd141ad26: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.not_null_vw_sales_valor_pago.5cd141ad26"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select valor_pago
from "dev"."public"."vw_sales"
where valor_pago is null



      
    ) dbt_internal_test
18:46:13.342667 [debug] [Thread-1  ]: SQL status: SELECT in 0.25 seconds
18:46:13.347934 [debug] [Thread-1  ]: finished collecting timing info
18:46:13.350762 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_vw_sales_valor_pago.5cd141ad26: ROLLBACK
18:46:13.484393 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_vw_sales_valor_pago.5cd141ad26: Close
18:46:13.490437 [info ] [Thread-1  ]: 8 of 10 PASS not_null_vw_sales_valor_pago ...................................... [[32mPASS[0m in 1.68s]
18:46:13.497531 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.not_null_vw_sales_valor_pago.5cd141ad26
18:46:13.502442 [debug] [Thread-1  ]: Began running node test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
18:46:13.509511 [info ] [Thread-1  ]: 9 of 10 START test unique_my_first_dbt_model_id ................................ [RUN]
18:46:13.518197 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"
18:46:13.525987 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
18:46:13.530128 [debug] [Thread-1  ]: Compiling test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
18:46:13.561532 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"
18:46:13.571855 [debug] [Thread-1  ]: finished collecting timing info
18:46:13.576379 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
18:46:13.581824 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"
18:46:13.589389 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"
18:46:13.592147 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321: BEGIN
18:46:13.594922 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:46:13.597348 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
18:46:14.830927 [debug] [Thread-1  ]: SQL status: BEGIN in 1.24 seconds
18:46:14.834028 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"
18:46:14.837428 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dev"."public"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
18:46:14.974283 [debug] [Thread-1  ]: SQL status: SELECT in 0.13 seconds
18:46:14.980832 [debug] [Thread-1  ]: finished collecting timing info
18:46:14.983368 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
18:46:15.117382 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321: Close
18:46:15.123030 [info ] [Thread-1  ]: 9 of 10 PASS unique_my_first_dbt_model_id ...................................... [[32mPASS[0m in 1.61s]
18:46:15.126807 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
18:46:15.132389 [debug] [Thread-1  ]: Began running node test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
18:46:15.138766 [info ] [Thread-1  ]: 10 of 10 START test unique_my_second_dbt_model_id .............................. [RUN]
18:46:15.146585 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"
18:46:15.153473 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
18:46:15.160522 [debug] [Thread-1  ]: Compiling test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
18:46:15.186646 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"
18:46:15.205183 [debug] [Thread-1  ]: finished collecting timing info
18:46:15.211110 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
18:46:15.223087 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"
18:46:15.235175 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"
18:46:15.240684 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493: BEGIN
18:46:15.247466 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:46:15.250017 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
18:46:16.475248 [debug] [Thread-1  ]: SQL status: BEGIN in 1.23 seconds
18:46:16.478898 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"
18:46:16.481704 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dev"."public"."my_second_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
18:46:16.622256 [debug] [Thread-1  ]: SQL status: SELECT in 0.14 seconds
18:46:16.629123 [debug] [Thread-1  ]: finished collecting timing info
18:46:16.631662 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493: ROLLBACK
18:46:16.767298 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493: Close
18:46:16.776738 [info ] [Thread-1  ]: 10 of 10 PASS unique_my_second_dbt_model_id .................................... [[32mPASS[0m in 1.63s]
18:46:16.781897 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
18:46:16.788665 [debug] [MainThread]: Acquiring new redshift connection "master"
18:46:16.792759 [debug] [MainThread]: Using redshift connection "master"
18:46:16.802213 [debug] [MainThread]: On master: BEGIN
18:46:16.806059 [debug] [MainThread]: Opening a new connection, currently in state closed
18:46:16.811801 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
18:46:18.025732 [debug] [MainThread]: SQL status: BEGIN in 1.22 seconds
18:46:18.028674 [debug] [MainThread]: On master: COMMIT
18:46:18.031471 [debug] [MainThread]: Using redshift connection "master"
18:46:18.033995 [debug] [MainThread]: On master: COMMIT
18:46:18.165716 [debug] [MainThread]: SQL status: COMMIT in 0.13 seconds
18:46:18.168610 [debug] [MainThread]: On master: Close
18:46:18.172509 [info ] [MainThread]: 
18:46:18.177470 [info ] [MainThread]: Finished running 10 tests in 32.13s.
18:46:18.182874 [debug] [MainThread]: Connection 'master' was properly closed.
18:46:18.194919 [debug] [MainThread]: Connection 'test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
18:46:18.272004 [info ] [MainThread]: 
18:46:18.275769 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
18:46:18.281382 [info ] [MainThread]: 
18:46:18.292707 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models/example/schema.yml)[0m
18:46:18.303209 [error] [MainThread]:   Got 1 result, configured to fail if != 0
18:46:18.314560 [info ] [MainThread]: 
18:46:18.328906 [info ] [MainThread]:   compiled SQL at target/compiled/analytics_dbt/models/example/schema.yml/not_null_my_first_dbt_model_id.sql
18:46:18.346858 [info ] [MainThread]: 
18:46:18.357727 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=1 SKIP=0 TOTAL=10
18:46:18.376896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02907d5c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02907d5d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02907d5d60>]}


============================== 2022-05-23 18:55:39.214515 | 21286bd0-4c03-4392-a27d-1680bfe2c9cc ==============================
18:55:39.214547 [info ] [MainThread]: Running with dbt=1.1.0
18:55:39.219044 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'select': ['models/example/schema.yml'], 'which': 'test', 'rpc_method': 'test'}
18:55:39.230882 [debug] [MainThread]: Tracking: tracking
18:55:39.263557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0c2608670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0c2608730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0c2608760>]}
18:55:39.444440 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
18:55:39.447890 [debug] [MainThread]: Partial parsing: added file: analytics_dbt://tests/test_singular_testa_nao_negativo.sql
18:55:39.557761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '21286bd0-4c03-4392-a27d-1680bfe2c9cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0c24b4970>]}
18:55:39.603239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '21286bd0-4c03-4392-a27d-1680bfe2c9cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0c24e8640>]}
18:55:39.607223 [info ] [MainThread]: Found 5 models, 11 tests, 0 snapshots, 0 analyses, 194 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
18:55:39.612411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '21286bd0-4c03-4392-a27d-1680bfe2c9cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0c24e8fa0>]}
18:55:39.633131 [info ] [MainThread]: 
18:55:39.641656 [debug] [MainThread]: Acquiring new redshift connection "master"
18:55:39.653050 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev_public"
18:55:39.694730 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
18:55:39.698649 [debug] [ThreadPool]: On list_dev_public: BEGIN
18:55:39.701388 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:55:39.705122 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
18:55:40.931395 [debug] [ThreadPool]: SQL status: BEGIN in 1.23 seconds
18:55:40.934025 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
18:55:40.937073 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev_public"} */
select
      'dev' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dev' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
18:55:41.081282 [debug] [ThreadPool]: SQL status: SELECT in 0.14 seconds
18:55:41.089617 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
18:55:41.224078 [debug] [ThreadPool]: On list_dev_public: Close
18:55:41.240771 [debug] [MainThread]: Using redshift connection "master"
18:55:41.243187 [debug] [MainThread]: On master: BEGIN
18:55:41.245582 [debug] [MainThread]: Opening a new connection, currently in state init
18:55:41.248312 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
18:55:42.474550 [debug] [MainThread]: SQL status: BEGIN in 1.23 seconds
18:55:42.477398 [debug] [MainThread]: Using redshift connection "master"
18:55:42.480467 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
18:55:42.649964 [debug] [MainThread]: SQL status: SELECT in 0.17 seconds
18:55:42.656604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '21286bd0-4c03-4392-a27d-1680bfe2c9cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0c24de310>]}
18:55:42.659587 [debug] [MainThread]: On master: ROLLBACK
18:55:42.794145 [debug] [MainThread]: Using redshift connection "master"
18:55:42.797020 [debug] [MainThread]: On master: BEGIN
18:55:43.061945 [debug] [MainThread]: SQL status: BEGIN in 0.26 seconds
18:55:43.065444 [debug] [MainThread]: On master: COMMIT
18:55:43.068503 [debug] [MainThread]: Using redshift connection "master"
18:55:43.071106 [debug] [MainThread]: On master: COMMIT
18:55:43.205871 [debug] [MainThread]: SQL status: COMMIT in 0.13 seconds
18:55:43.209161 [debug] [MainThread]: On master: Close
18:55:43.213375 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
18:55:43.216201 [info ] [MainThread]: 
18:55:43.237400 [debug] [Thread-1  ]: Began running node test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea
18:55:43.240017 [info ] [Thread-1  ]: 1 of 10 START test nao_negativo_tb_10_compradores_vendas_totais ................ [RUN]
18:55:43.243458 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea"
18:55:43.251850 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea
18:55:43.259099 [debug] [Thread-1  ]: Compiling test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea
18:55:43.292676 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea"
18:55:43.305337 [debug] [Thread-1  ]: finished collecting timing info
18:55:43.308524 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea
18:55:43.353057 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea"
18:55:43.362365 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea"
18:55:43.368109 [debug] [Thread-1  ]: On test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea: BEGIN
18:55:43.371634 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:55:43.377892 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
18:55:44.576398 [debug] [Thread-1  ]: SQL status: BEGIN in 1.2 seconds
18:55:44.581827 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea"
18:55:44.584813 [debug] [Thread-1  ]: On test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

    select *
    from "dev"."public"."tb_10_compradores"
    where vendas_totais < 0


      
    ) dbt_internal_test
18:55:44.718849 [debug] [Thread-1  ]: SQL status: SELECT in 0.13 seconds
18:55:44.727048 [debug] [Thread-1  ]: finished collecting timing info
18:55:44.729856 [debug] [Thread-1  ]: On test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea: ROLLBACK
18:55:44.862139 [debug] [Thread-1  ]: On test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea: Close
18:55:44.867694 [info ] [Thread-1  ]: 1 of 10 PASS nao_negativo_tb_10_compradores_vendas_totais ...................... [[32mPASS[0m in 1.62s]
18:55:44.873593 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea
18:55:44.880329 [debug] [Thread-1  ]: Began running node test.analytics_dbt.nao_negativo_vw_sales_comissao.c9561fd7db
18:55:44.889212 [info ] [Thread-1  ]: 2 of 10 START test nao_negativo_vw_sales_comissao .............................. [RUN]
18:55:44.896096 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.nao_negativo_vw_sales_comissao.c9561fd7db"
18:55:44.905925 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.nao_negativo_vw_sales_comissao.c9561fd7db
18:55:44.911145 [debug] [Thread-1  ]: Compiling test.analytics_dbt.nao_negativo_vw_sales_comissao.c9561fd7db
18:55:44.934988 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.nao_negativo_vw_sales_comissao.c9561fd7db"
18:55:44.953986 [debug] [Thread-1  ]: finished collecting timing info
18:55:44.957758 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.nao_negativo_vw_sales_comissao.c9561fd7db
18:55:44.965299 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.nao_negativo_vw_sales_comissao.c9561fd7db"
18:55:44.975122 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.nao_negativo_vw_sales_comissao.c9561fd7db"
18:55:44.979211 [debug] [Thread-1  ]: On test.analytics_dbt.nao_negativo_vw_sales_comissao.c9561fd7db: BEGIN
18:55:44.983532 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:55:44.987167 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
18:55:46.197817 [debug] [Thread-1  ]: SQL status: BEGIN in 1.21 seconds
18:55:46.203176 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.nao_negativo_vw_sales_comissao.c9561fd7db"
18:55:46.205897 [debug] [Thread-1  ]: On test.analytics_dbt.nao_negativo_vw_sales_comissao.c9561fd7db: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.nao_negativo_vw_sales_comissao.c9561fd7db"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

    select *
    from "dev"."public"."vw_sales"
    where comissao < 0


      
    ) dbt_internal_test
18:55:46.340164 [debug] [Thread-1  ]: SQL status: SELECT in 0.13 seconds
18:55:46.347349 [debug] [Thread-1  ]: finished collecting timing info
18:55:46.350650 [debug] [Thread-1  ]: On test.analytics_dbt.nao_negativo_vw_sales_comissao.c9561fd7db: ROLLBACK
18:55:46.484104 [debug] [Thread-1  ]: On test.analytics_dbt.nao_negativo_vw_sales_comissao.c9561fd7db: Close
18:55:46.489834 [info ] [Thread-1  ]: 2 of 10 PASS nao_negativo_vw_sales_comissao .................................... [[32mPASS[0m in 1.60s]
18:55:46.493229 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.nao_negativo_vw_sales_comissao.c9561fd7db
18:55:46.499388 [debug] [Thread-1  ]: Began running node test.analytics_dbt.nao_negativo_vw_sales_valor_pago.7a9d055b10
18:55:46.510180 [info ] [Thread-1  ]: 3 of 10 START test nao_negativo_vw_sales_valor_pago ............................ [RUN]
18:55:46.517111 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.nao_negativo_vw_sales_valor_pago.7a9d055b10"
18:55:46.522303 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.nao_negativo_vw_sales_valor_pago.7a9d055b10
18:55:46.525496 [debug] [Thread-1  ]: Compiling test.analytics_dbt.nao_negativo_vw_sales_valor_pago.7a9d055b10
18:55:46.539335 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.nao_negativo_vw_sales_valor_pago.7a9d055b10"
18:55:46.551158 [debug] [Thread-1  ]: finished collecting timing info
18:55:46.558932 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.nao_negativo_vw_sales_valor_pago.7a9d055b10
18:55:46.572764 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.nao_negativo_vw_sales_valor_pago.7a9d055b10"
18:55:46.582620 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.nao_negativo_vw_sales_valor_pago.7a9d055b10"
18:55:46.587477 [debug] [Thread-1  ]: On test.analytics_dbt.nao_negativo_vw_sales_valor_pago.7a9d055b10: BEGIN
18:55:46.590371 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:55:46.595187 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
18:55:47.768290 [debug] [Thread-1  ]: SQL status: BEGIN in 1.18 seconds
18:55:47.771969 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.nao_negativo_vw_sales_valor_pago.7a9d055b10"
18:55:47.774751 [debug] [Thread-1  ]: On test.analytics_dbt.nao_negativo_vw_sales_valor_pago.7a9d055b10: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.nao_negativo_vw_sales_valor_pago.7a9d055b10"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

    select *
    from "dev"."public"."vw_sales"
    where valor_pago < 0


      
    ) dbt_internal_test
18:55:47.908655 [debug] [Thread-1  ]: SQL status: SELECT in 0.13 seconds
18:55:47.915219 [debug] [Thread-1  ]: finished collecting timing info
18:55:47.918209 [debug] [Thread-1  ]: On test.analytics_dbt.nao_negativo_vw_sales_valor_pago.7a9d055b10: ROLLBACK
18:55:48.048448 [debug] [Thread-1  ]: On test.analytics_dbt.nao_negativo_vw_sales_valor_pago.7a9d055b10: Close
18:55:48.052750 [info ] [Thread-1  ]: 3 of 10 PASS nao_negativo_vw_sales_valor_pago .................................. [[32mPASS[0m in 1.54s]
18:55:48.056255 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.nao_negativo_vw_sales_valor_pago.7a9d055b10
18:55:48.061269 [debug] [Thread-1  ]: Began running node test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
18:55:48.066787 [info ] [Thread-1  ]: 4 of 10 START test not_null_my_first_dbt_model_id .............................. [RUN]
18:55:48.073747 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
18:55:48.078847 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
18:55:48.081873 [debug] [Thread-1  ]: Compiling test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
18:55:48.110562 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
18:55:48.122948 [debug] [Thread-1  ]: finished collecting timing info
18:55:48.126939 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
18:55:48.135282 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
18:55:48.146357 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
18:55:48.151880 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710: BEGIN
18:55:48.154462 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:55:48.157139 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
18:55:49.309227 [debug] [Thread-1  ]: SQL status: BEGIN in 1.15 seconds
18:55:49.311928 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
18:55:49.315500 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dev"."public"."my_first_dbt_model"
where id is null



      
    ) dbt_internal_test
18:55:49.447516 [debug] [Thread-1  ]: SQL status: SELECT in 0.13 seconds
18:55:49.453714 [debug] [Thread-1  ]: finished collecting timing info
18:55:49.456549 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
18:55:49.588077 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710: Close
18:55:49.594479 [error] [Thread-1  ]: 4 of 10 FAIL 1 not_null_my_first_dbt_model_id .................................. [[31mFAIL 1[0m in 1.52s]
18:55:49.598713 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
18:55:49.602886 [debug] [Thread-1  ]: Began running node test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
18:55:49.608706 [info ] [Thread-1  ]: 5 of 10 START test not_null_my_second_dbt_model_id ............................. [RUN]
18:55:49.614633 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"
18:55:49.621532 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
18:55:49.625798 [debug] [Thread-1  ]: Compiling test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
18:55:49.641910 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"
18:55:49.654034 [debug] [Thread-1  ]: finished collecting timing info
18:55:49.658989 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
18:55:49.674767 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"
18:55:49.687597 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"
18:55:49.700408 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778: BEGIN
18:55:49.704951 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:55:49.708947 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
18:55:50.881365 [debug] [Thread-1  ]: SQL status: BEGIN in 1.18 seconds
18:55:50.884874 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"
18:55:50.888428 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dev"."public"."my_second_dbt_model"
where id is null



      
    ) dbt_internal_test
18:55:51.029214 [debug] [Thread-1  ]: SQL status: SELECT in 0.14 seconds
18:55:51.038774 [debug] [Thread-1  ]: finished collecting timing info
18:55:51.041980 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778: ROLLBACK
18:55:51.176995 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778: Close
18:55:51.184848 [info ] [Thread-1  ]: 5 of 10 PASS not_null_my_second_dbt_model_id ................................... [[32mPASS[0m in 1.57s]
18:55:51.196565 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
18:55:51.199611 [debug] [Thread-1  ]: Began running node test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752
18:55:51.202622 [info ] [Thread-1  ]: 6 of 10 START test not_null_tb_10_compradores_vendas_totais .................... [RUN]
18:55:51.211363 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752"
18:55:51.215695 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752
18:55:51.219368 [debug] [Thread-1  ]: Compiling test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752
18:55:51.235760 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752"
18:55:51.256031 [debug] [Thread-1  ]: finished collecting timing info
18:55:51.266059 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752
18:55:51.281522 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752"
18:55:51.293176 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752"
18:55:51.296321 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752: BEGIN
18:55:51.300034 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:55:51.303319 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
18:55:52.475050 [debug] [Thread-1  ]: SQL status: BEGIN in 1.18 seconds
18:55:52.478331 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752"
18:55:52.481251 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select vendas_totais
from "dev"."public"."tb_10_compradores"
where vendas_totais is null



      
    ) dbt_internal_test
18:55:52.613134 [debug] [Thread-1  ]: SQL status: SELECT in 0.13 seconds
18:55:52.619379 [debug] [Thread-1  ]: finished collecting timing info
18:55:52.622481 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752: ROLLBACK
18:55:52.752447 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752: Close
18:55:52.756772 [info ] [Thread-1  ]: 6 of 10 PASS not_null_tb_10_compradores_vendas_totais .......................... [[32mPASS[0m in 1.55s]
18:55:52.760955 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752
18:55:52.773617 [debug] [Thread-1  ]: Began running node test.analytics_dbt.not_null_vw_sales_comissao.d9b6c254ab
18:55:52.780205 [info ] [Thread-1  ]: 7 of 10 START test not_null_vw_sales_comissao .................................. [RUN]
18:55:52.787208 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.not_null_vw_sales_comissao.d9b6c254ab"
18:55:52.795807 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.not_null_vw_sales_comissao.d9b6c254ab
18:55:52.801955 [debug] [Thread-1  ]: Compiling test.analytics_dbt.not_null_vw_sales_comissao.d9b6c254ab
18:55:52.816153 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.not_null_vw_sales_comissao.d9b6c254ab"
18:55:52.832184 [debug] [Thread-1  ]: finished collecting timing info
18:55:52.837940 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.not_null_vw_sales_comissao.d9b6c254ab
18:55:52.846703 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.not_null_vw_sales_comissao.d9b6c254ab"
18:55:52.853932 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_vw_sales_comissao.d9b6c254ab"
18:55:52.856620 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_vw_sales_comissao.d9b6c254ab: BEGIN
18:55:52.859699 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:55:52.862869 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
18:55:54.030612 [debug] [Thread-1  ]: SQL status: BEGIN in 1.17 seconds
18:55:54.034217 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_vw_sales_comissao.d9b6c254ab"
18:55:54.036874 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_vw_sales_comissao.d9b6c254ab: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.not_null_vw_sales_comissao.d9b6c254ab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select comissao
from "dev"."public"."vw_sales"
where comissao is null



      
    ) dbt_internal_test
18:55:54.170238 [debug] [Thread-1  ]: SQL status: SELECT in 0.13 seconds
18:55:54.176207 [debug] [Thread-1  ]: finished collecting timing info
18:55:54.179054 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_vw_sales_comissao.d9b6c254ab: ROLLBACK
18:55:54.313221 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_vw_sales_comissao.d9b6c254ab: Close
18:55:54.317898 [info ] [Thread-1  ]: 7 of 10 PASS not_null_vw_sales_comissao ........................................ [[32mPASS[0m in 1.53s]
18:55:54.325383 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.not_null_vw_sales_comissao.d9b6c254ab
18:55:54.332061 [debug] [Thread-1  ]: Began running node test.analytics_dbt.not_null_vw_sales_valor_pago.5cd141ad26
18:55:54.340916 [info ] [Thread-1  ]: 8 of 10 START test not_null_vw_sales_valor_pago ................................ [RUN]
18:55:54.346032 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.not_null_vw_sales_valor_pago.5cd141ad26"
18:55:54.354927 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.not_null_vw_sales_valor_pago.5cd141ad26
18:55:54.358857 [debug] [Thread-1  ]: Compiling test.analytics_dbt.not_null_vw_sales_valor_pago.5cd141ad26
18:55:54.374849 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.not_null_vw_sales_valor_pago.5cd141ad26"
18:55:54.388135 [debug] [Thread-1  ]: finished collecting timing info
18:55:54.391645 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.not_null_vw_sales_valor_pago.5cd141ad26
18:55:54.399632 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.not_null_vw_sales_valor_pago.5cd141ad26"
18:55:54.409633 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_vw_sales_valor_pago.5cd141ad26"
18:55:54.412855 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_vw_sales_valor_pago.5cd141ad26: BEGIN
18:55:54.416115 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:55:54.419323 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
18:55:55.604047 [debug] [Thread-1  ]: SQL status: BEGIN in 1.19 seconds
18:55:55.607210 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_vw_sales_valor_pago.5cd141ad26"
18:55:55.610729 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_vw_sales_valor_pago.5cd141ad26: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.not_null_vw_sales_valor_pago.5cd141ad26"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select valor_pago
from "dev"."public"."vw_sales"
where valor_pago is null



      
    ) dbt_internal_test
18:55:55.744773 [debug] [Thread-1  ]: SQL status: SELECT in 0.13 seconds
18:55:55.752861 [debug] [Thread-1  ]: finished collecting timing info
18:55:55.755939 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_vw_sales_valor_pago.5cd141ad26: ROLLBACK
18:55:55.885729 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_vw_sales_valor_pago.5cd141ad26: Close
18:55:55.891693 [info ] [Thread-1  ]: 8 of 10 PASS not_null_vw_sales_valor_pago ...................................... [[32mPASS[0m in 1.55s]
18:55:55.896436 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.not_null_vw_sales_valor_pago.5cd141ad26
18:55:55.900602 [debug] [Thread-1  ]: Began running node test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
18:55:55.905383 [info ] [Thread-1  ]: 9 of 10 START test unique_my_first_dbt_model_id ................................ [RUN]
18:55:55.914282 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"
18:55:55.922521 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
18:55:55.925181 [debug] [Thread-1  ]: Compiling test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
18:55:55.952827 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"
18:55:55.965768 [debug] [Thread-1  ]: finished collecting timing info
18:55:55.969043 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
18:55:55.984380 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"
18:55:55.999590 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"
18:55:56.003902 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321: BEGIN
18:55:56.008665 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:55:56.012562 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
18:55:57.228921 [debug] [Thread-1  ]: SQL status: BEGIN in 1.22 seconds
18:55:57.233697 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"
18:55:57.236246 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dev"."public"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
18:55:57.371366 [debug] [Thread-1  ]: SQL status: SELECT in 0.13 seconds
18:55:57.377779 [debug] [Thread-1  ]: finished collecting timing info
18:55:57.380839 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
18:55:57.512764 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321: Close
18:55:57.518063 [info ] [Thread-1  ]: 9 of 10 PASS unique_my_first_dbt_model_id ...................................... [[32mPASS[0m in 1.61s]
18:55:57.523233 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
18:55:57.529401 [debug] [Thread-1  ]: Began running node test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
18:55:57.541373 [info ] [Thread-1  ]: 10 of 10 START test unique_my_second_dbt_model_id .............................. [RUN]
18:55:57.545275 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"
18:55:57.552536 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
18:55:57.557986 [debug] [Thread-1  ]: Compiling test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
18:55:57.589438 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"
18:55:57.599617 [debug] [Thread-1  ]: finished collecting timing info
18:55:57.606520 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
18:55:57.620379 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"
18:55:57.635470 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"
18:55:57.638493 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493: BEGIN
18:55:57.640970 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:55:57.643909 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
18:55:58.822939 [debug] [Thread-1  ]: SQL status: BEGIN in 1.18 seconds
18:55:58.828457 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"
18:55:58.831466 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dev"."public"."my_second_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
18:55:58.965288 [debug] [Thread-1  ]: SQL status: SELECT in 0.13 seconds
18:55:58.973514 [debug] [Thread-1  ]: finished collecting timing info
18:55:58.976467 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493: ROLLBACK
18:55:59.107563 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493: Close
18:55:59.113481 [info ] [Thread-1  ]: 10 of 10 PASS unique_my_second_dbt_model_id .................................... [[32mPASS[0m in 1.57s]
18:55:59.117396 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
18:55:59.127222 [debug] [MainThread]: Acquiring new redshift connection "master"
18:55:59.133484 [debug] [MainThread]: Using redshift connection "master"
18:55:59.140655 [debug] [MainThread]: On master: BEGIN
18:55:59.147494 [debug] [MainThread]: Opening a new connection, currently in state closed
18:55:59.150556 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
18:56:00.344407 [debug] [MainThread]: SQL status: BEGIN in 1.2 seconds
18:56:00.348641 [debug] [MainThread]: On master: COMMIT
18:56:00.351469 [debug] [MainThread]: Using redshift connection "master"
18:56:00.354173 [debug] [MainThread]: On master: COMMIT
18:56:00.487000 [debug] [MainThread]: SQL status: COMMIT in 0.13 seconds
18:56:00.491038 [debug] [MainThread]: On master: Close
18:56:00.495080 [info ] [MainThread]: 
18:56:00.498122 [info ] [MainThread]: Finished running 10 tests in 20.86s.
18:56:00.503160 [debug] [MainThread]: Connection 'master' was properly closed.
18:56:00.511391 [debug] [MainThread]: Connection 'test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
18:56:00.576721 [info ] [MainThread]: 
18:56:00.581593 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
18:56:00.586308 [info ] [MainThread]: 
18:56:00.615503 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models/example/schema.yml)[0m
18:56:00.628723 [error] [MainThread]:   Got 1 result, configured to fail if != 0
18:56:00.647450 [info ] [MainThread]: 
18:56:00.669502 [info ] [MainThread]:   compiled SQL at target/compiled/analytics_dbt/models/example/schema.yml/not_null_my_first_dbt_model_id.sql
18:56:00.684333 [info ] [MainThread]: 
18:56:00.693435 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=1 SKIP=0 TOTAL=10
18:56:00.700842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0c033bf70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0c033bfa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0c2460f40>]}


============================== 2022-05-23 18:56:37.778344 | 0724067d-6c9b-4b18-97e1-7394f175f3ca ==============================
18:56:37.778377 [info ] [MainThread]: Running with dbt=1.1.0
18:56:37.781708 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'select': ['models/example/schema.yml'], 'which': 'test', 'rpc_method': 'test'}
18:56:37.786142 [debug] [MainThread]: Tracking: tracking
18:56:37.814875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b258973a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b25897400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b25897460>]}
18:56:37.956151 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
18:56:37.959262 [debug] [MainThread]: Partial parsing: update schema file: analytics_dbt://models/example/schema.yml
18:56:37.990569 [debug] [MainThread]: 1699: static parser successfully parsed views/vw_sales.sql
18:56:38.197575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0724067d-6c9b-4b18-97e1-7394f175f3ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b2575f280>]}
18:56:38.230715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0724067d-6c9b-4b18-97e1-7394f175f3ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b258019a0>]}
18:56:38.234431 [info ] [MainThread]: Found 5 models, 12 tests, 0 snapshots, 0 analyses, 194 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
18:56:38.237389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0724067d-6c9b-4b18-97e1-7394f175f3ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b25801c70>]}
18:56:38.248582 [info ] [MainThread]: 
18:56:38.258765 [debug] [MainThread]: Acquiring new redshift connection "master"
18:56:38.278994 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev_public"
18:56:38.323427 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
18:56:38.326463 [debug] [ThreadPool]: On list_dev_public: BEGIN
18:56:38.329886 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:56:38.334216 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
18:56:39.533511 [debug] [ThreadPool]: SQL status: BEGIN in 1.2 seconds
18:56:39.536509 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
18:56:39.539340 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev_public"} */
select
      'dev' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dev' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
18:56:39.683370 [debug] [ThreadPool]: SQL status: SELECT in 0.14 seconds
18:56:39.690175 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
18:56:39.822702 [debug] [ThreadPool]: On list_dev_public: Close
18:56:39.837242 [debug] [MainThread]: Using redshift connection "master"
18:56:39.839865 [debug] [MainThread]: On master: BEGIN
18:56:39.842438 [debug] [MainThread]: Opening a new connection, currently in state init
18:56:39.844945 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
18:56:41.039064 [debug] [MainThread]: SQL status: BEGIN in 1.2 seconds
18:56:41.043610 [debug] [MainThread]: Using redshift connection "master"
18:56:41.046105 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
18:56:41.207050 [debug] [MainThread]: SQL status: SELECT in 0.16 seconds
18:56:41.212936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0724067d-6c9b-4b18-97e1-7394f175f3ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b25759820>]}
18:56:41.216029 [debug] [MainThread]: On master: ROLLBACK
18:56:41.348402 [debug] [MainThread]: Using redshift connection "master"
18:56:41.353034 [debug] [MainThread]: On master: BEGIN
18:56:41.611330 [debug] [MainThread]: SQL status: BEGIN in 0.25 seconds
18:56:41.615335 [debug] [MainThread]: On master: COMMIT
18:56:41.618329 [debug] [MainThread]: Using redshift connection "master"
18:56:41.621503 [debug] [MainThread]: On master: COMMIT
18:56:41.775480 [debug] [MainThread]: SQL status: COMMIT in 0.13 seconds
18:56:41.778270 [debug] [MainThread]: On master: Close
18:56:41.782403 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
18:56:41.787179 [info ] [MainThread]: 
18:56:41.811168 [debug] [Thread-1  ]: Began running node test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea
18:56:41.817649 [info ] [Thread-1  ]: 1 of 11 START test nao_negativo_tb_10_compradores_vendas_totais ................ [RUN]
18:56:41.827203 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea"
18:56:41.832227 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea
18:56:41.840978 [debug] [Thread-1  ]: Compiling test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea
18:56:41.861367 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea"
18:56:41.875589 [debug] [Thread-1  ]: finished collecting timing info
18:56:41.879714 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea
18:56:41.930358 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea"
18:56:41.941618 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea"
18:56:41.948331 [debug] [Thread-1  ]: On test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea: BEGIN
18:56:41.952951 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:56:41.957174 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
18:56:43.124487 [debug] [Thread-1  ]: SQL status: BEGIN in 1.17 seconds
18:56:43.127349 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea"
18:56:43.130219 [debug] [Thread-1  ]: On test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

    select *
    from "dev"."public"."tb_10_compradores"
    where vendas_totais < 0


      
    ) dbt_internal_test
18:56:43.264530 [debug] [Thread-1  ]: SQL status: SELECT in 0.13 seconds
18:56:43.272472 [debug] [Thread-1  ]: finished collecting timing info
18:56:43.275741 [debug] [Thread-1  ]: On test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea: ROLLBACK
18:56:43.408093 [debug] [Thread-1  ]: On test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea: Close
18:56:43.413131 [info ] [Thread-1  ]: 1 of 11 PASS nao_negativo_tb_10_compradores_vendas_totais ...................... [[32mPASS[0m in 1.59s]
18:56:43.420369 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea
18:56:43.425687 [debug] [Thread-1  ]: Began running node test.analytics_dbt.nao_negativo_vw_sales_comissao.c9561fd7db
18:56:43.430971 [info ] [Thread-1  ]: 2 of 11 START test nao_negativo_vw_sales_comissao .............................. [RUN]
18:56:43.439744 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.nao_negativo_vw_sales_comissao.c9561fd7db"
18:56:43.445760 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.nao_negativo_vw_sales_comissao.c9561fd7db
18:56:43.449429 [debug] [Thread-1  ]: Compiling test.analytics_dbt.nao_negativo_vw_sales_comissao.c9561fd7db
18:56:43.471262 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.nao_negativo_vw_sales_comissao.c9561fd7db"
18:56:43.483443 [debug] [Thread-1  ]: finished collecting timing info
18:56:43.491062 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.nao_negativo_vw_sales_comissao.c9561fd7db
18:56:43.505524 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.nao_negativo_vw_sales_comissao.c9561fd7db"
18:56:43.518188 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.nao_negativo_vw_sales_comissao.c9561fd7db"
18:56:43.522127 [debug] [Thread-1  ]: On test.analytics_dbt.nao_negativo_vw_sales_comissao.c9561fd7db: BEGIN
18:56:43.525598 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:56:43.528531 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
18:56:44.750558 [debug] [Thread-1  ]: SQL status: BEGIN in 1.22 seconds
18:56:44.753487 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.nao_negativo_vw_sales_comissao.c9561fd7db"
18:56:44.756178 [debug] [Thread-1  ]: On test.analytics_dbt.nao_negativo_vw_sales_comissao.c9561fd7db: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.nao_negativo_vw_sales_comissao.c9561fd7db"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

    select *
    from "dev"."public"."vw_sales"
    where comissao < 0


      
    ) dbt_internal_test
18:56:44.890082 [debug] [Thread-1  ]: SQL status: SELECT in 0.13 seconds
18:56:44.897225 [debug] [Thread-1  ]: finished collecting timing info
18:56:44.900303 [debug] [Thread-1  ]: On test.analytics_dbt.nao_negativo_vw_sales_comissao.c9561fd7db: ROLLBACK
18:56:45.031669 [debug] [Thread-1  ]: On test.analytics_dbt.nao_negativo_vw_sales_comissao.c9561fd7db: Close
18:56:45.036382 [info ] [Thread-1  ]: 2 of 11 PASS nao_negativo_vw_sales_comissao .................................... [[32mPASS[0m in 1.60s]
18:56:45.040364 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.nao_negativo_vw_sales_comissao.c9561fd7db
18:56:45.045497 [debug] [Thread-1  ]: Began running node test.analytics_dbt.nao_negativo_vw_sales_valor_pago.7a9d055b10
18:56:45.048955 [info ] [Thread-1  ]: 3 of 11 START test nao_negativo_vw_sales_valor_pago ............................ [RUN]
18:56:45.053185 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.nao_negativo_vw_sales_valor_pago.7a9d055b10"
18:56:45.057386 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.nao_negativo_vw_sales_valor_pago.7a9d055b10
18:56:45.060324 [debug] [Thread-1  ]: Compiling test.analytics_dbt.nao_negativo_vw_sales_valor_pago.7a9d055b10
18:56:45.079236 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.nao_negativo_vw_sales_valor_pago.7a9d055b10"
18:56:45.088328 [debug] [Thread-1  ]: finished collecting timing info
18:56:45.094458 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.nao_negativo_vw_sales_valor_pago.7a9d055b10
18:56:45.104458 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.nao_negativo_vw_sales_valor_pago.7a9d055b10"
18:56:45.113494 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.nao_negativo_vw_sales_valor_pago.7a9d055b10"
18:56:45.116469 [debug] [Thread-1  ]: On test.analytics_dbt.nao_negativo_vw_sales_valor_pago.7a9d055b10: BEGIN
18:56:45.119960 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:56:45.124145 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
18:56:46.321066 [debug] [Thread-1  ]: SQL status: BEGIN in 1.2 seconds
18:56:46.324782 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.nao_negativo_vw_sales_valor_pago.7a9d055b10"
18:56:46.329222 [debug] [Thread-1  ]: On test.analytics_dbt.nao_negativo_vw_sales_valor_pago.7a9d055b10: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.nao_negativo_vw_sales_valor_pago.7a9d055b10"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

    select *
    from "dev"."public"."vw_sales"
    where valor_pago < 0


      
    ) dbt_internal_test
18:56:46.465605 [debug] [Thread-1  ]: SQL status: SELECT in 0.13 seconds
18:56:46.483289 [debug] [Thread-1  ]: finished collecting timing info
18:56:46.486077 [debug] [Thread-1  ]: On test.analytics_dbt.nao_negativo_vw_sales_valor_pago.7a9d055b10: ROLLBACK
18:56:46.619306 [debug] [Thread-1  ]: On test.analytics_dbt.nao_negativo_vw_sales_valor_pago.7a9d055b10: Close
18:56:46.624351 [info ] [Thread-1  ]: 3 of 11 PASS nao_negativo_vw_sales_valor_pago .................................. [[32mPASS[0m in 1.57s]
18:56:46.629222 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.nao_negativo_vw_sales_valor_pago.7a9d055b10
18:56:46.639072 [debug] [Thread-1  ]: Began running node test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
18:56:46.647504 [info ] [Thread-1  ]: 4 of 11 START test not_null_my_first_dbt_model_id .............................. [RUN]
18:56:46.672257 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
18:56:46.684536 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
18:56:46.700448 [debug] [Thread-1  ]: Compiling test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
18:56:46.739694 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
18:56:46.755518 [debug] [Thread-1  ]: finished collecting timing info
18:56:46.758712 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
18:56:46.765943 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
18:56:46.773599 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
18:56:46.776999 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710: BEGIN
18:56:46.780428 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:56:46.784288 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
18:56:47.988088 [debug] [Thread-1  ]: SQL status: BEGIN in 1.21 seconds
18:56:47.995037 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
18:56:47.997580 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dev"."public"."my_first_dbt_model"
where id is null



      
    ) dbt_internal_test
18:56:48.130750 [debug] [Thread-1  ]: SQL status: SELECT in 0.13 seconds
18:56:48.136333 [debug] [Thread-1  ]: finished collecting timing info
18:56:48.140178 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
18:56:48.277075 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710: Close
18:56:48.283281 [error] [Thread-1  ]: 4 of 11 FAIL 1 not_null_my_first_dbt_model_id .................................. [[31mFAIL 1[0m in 1.61s]
18:56:48.287607 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
18:56:48.292976 [debug] [Thread-1  ]: Began running node test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
18:56:48.299070 [info ] [Thread-1  ]: 5 of 11 START test not_null_my_second_dbt_model_id ............................. [RUN]
18:56:48.307058 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"
18:56:48.313121 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
18:56:48.318733 [debug] [Thread-1  ]: Compiling test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
18:56:48.344516 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"
18:56:48.357821 [debug] [Thread-1  ]: finished collecting timing info
18:56:48.361046 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
18:56:48.369684 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"
18:56:48.379051 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"
18:56:48.382649 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778: BEGIN
18:56:48.385478 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:56:48.388711 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
18:56:49.570630 [debug] [Thread-1  ]: SQL status: BEGIN in 1.19 seconds
18:56:49.573881 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"
18:56:49.578048 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dev"."public"."my_second_dbt_model"
where id is null



      
    ) dbt_internal_test
18:56:49.715291 [debug] [Thread-1  ]: SQL status: SELECT in 0.13 seconds
18:56:49.720892 [debug] [Thread-1  ]: finished collecting timing info
18:56:49.723452 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778: ROLLBACK
18:56:49.853450 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778: Close
18:56:49.857546 [info ] [Thread-1  ]: 5 of 11 PASS not_null_my_second_dbt_model_id ................................... [[32mPASS[0m in 1.55s]
18:56:49.861471 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
18:56:49.867216 [debug] [Thread-1  ]: Began running node test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752
18:56:49.873009 [info ] [Thread-1  ]: 6 of 11 START test not_null_tb_10_compradores_vendas_totais .................... [RUN]
18:56:49.880346 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752"
18:56:49.891016 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752
18:56:49.894595 [debug] [Thread-1  ]: Compiling test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752
18:56:49.912912 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752"
18:56:49.923979 [debug] [Thread-1  ]: finished collecting timing info
18:56:49.927514 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752
18:56:49.934757 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752"
18:56:49.949555 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752"
18:56:49.952480 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752: BEGIN
18:56:49.955469 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:56:49.957778 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
18:56:51.139614 [debug] [Thread-1  ]: SQL status: BEGIN in 1.18 seconds
18:56:51.142633 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752"
18:56:51.144994 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select vendas_totais
from "dev"."public"."tb_10_compradores"
where vendas_totais is null



      
    ) dbt_internal_test
18:56:51.279443 [debug] [Thread-1  ]: SQL status: SELECT in 0.13 seconds
18:56:51.285948 [debug] [Thread-1  ]: finished collecting timing info
18:56:51.288625 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752: ROLLBACK
18:56:51.420521 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752: Close
18:56:51.425092 [info ] [Thread-1  ]: 6 of 11 PASS not_null_tb_10_compradores_vendas_totais .......................... [[32mPASS[0m in 1.55s]
18:56:51.431943 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752
18:56:51.436293 [debug] [Thread-1  ]: Began running node test.analytics_dbt.not_null_vw_sales_comissao.d9b6c254ab
18:56:51.441552 [info ] [Thread-1  ]: 7 of 11 START test not_null_vw_sales_comissao .................................. [RUN]
18:56:51.450855 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.not_null_vw_sales_comissao.d9b6c254ab"
18:56:51.461444 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.not_null_vw_sales_comissao.d9b6c254ab
18:56:51.464751 [debug] [Thread-1  ]: Compiling test.analytics_dbt.not_null_vw_sales_comissao.d9b6c254ab
18:56:51.481582 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.not_null_vw_sales_comissao.d9b6c254ab"
18:56:51.495979 [debug] [Thread-1  ]: finished collecting timing info
18:56:51.499380 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.not_null_vw_sales_comissao.d9b6c254ab
18:56:51.511510 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.not_null_vw_sales_comissao.d9b6c254ab"
18:56:51.520831 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_vw_sales_comissao.d9b6c254ab"
18:56:51.525692 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_vw_sales_comissao.d9b6c254ab: BEGIN
18:56:51.529016 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:56:51.532427 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
18:56:52.697691 [debug] [Thread-1  ]: SQL status: BEGIN in 1.17 seconds
18:56:52.700545 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_vw_sales_comissao.d9b6c254ab"
18:56:52.702687 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_vw_sales_comissao.d9b6c254ab: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.not_null_vw_sales_comissao.d9b6c254ab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select comissao
from "dev"."public"."vw_sales"
where comissao is null



      
    ) dbt_internal_test
18:56:52.837656 [debug] [Thread-1  ]: SQL status: SELECT in 0.13 seconds
18:56:52.844693 [debug] [Thread-1  ]: finished collecting timing info
18:56:52.847412 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_vw_sales_comissao.d9b6c254ab: ROLLBACK
18:56:52.981427 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_vw_sales_comissao.d9b6c254ab: Close
18:56:52.988278 [info ] [Thread-1  ]: 7 of 11 PASS not_null_vw_sales_comissao ........................................ [[32mPASS[0m in 1.54s]
18:56:52.993313 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.not_null_vw_sales_comissao.d9b6c254ab
18:56:52.997525 [debug] [Thread-1  ]: Began running node test.analytics_dbt.not_null_vw_sales_valor_pago.5cd141ad26
18:56:53.005636 [info ] [Thread-1  ]: 8 of 11 START test not_null_vw_sales_valor_pago ................................ [RUN]
18:56:53.016764 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.not_null_vw_sales_valor_pago.5cd141ad26"
18:56:53.026124 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.not_null_vw_sales_valor_pago.5cd141ad26
18:56:53.031327 [debug] [Thread-1  ]: Compiling test.analytics_dbt.not_null_vw_sales_valor_pago.5cd141ad26
18:56:53.054002 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.not_null_vw_sales_valor_pago.5cd141ad26"
18:56:53.065799 [debug] [Thread-1  ]: finished collecting timing info
18:56:53.068490 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.not_null_vw_sales_valor_pago.5cd141ad26
18:56:53.077844 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.not_null_vw_sales_valor_pago.5cd141ad26"
18:56:53.086345 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_vw_sales_valor_pago.5cd141ad26"
18:56:53.091761 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_vw_sales_valor_pago.5cd141ad26: BEGIN
18:56:53.096381 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:56:53.104863 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
18:56:54.285339 [debug] [Thread-1  ]: SQL status: BEGIN in 1.19 seconds
18:56:54.291558 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_vw_sales_valor_pago.5cd141ad26"
18:56:54.294401 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_vw_sales_valor_pago.5cd141ad26: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.not_null_vw_sales_valor_pago.5cd141ad26"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select valor_pago
from "dev"."public"."vw_sales"
where valor_pago is null



      
    ) dbt_internal_test
18:56:54.425372 [debug] [Thread-1  ]: SQL status: SELECT in 0.13 seconds
18:56:54.430696 [debug] [Thread-1  ]: finished collecting timing info
18:56:54.433484 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_vw_sales_valor_pago.5cd141ad26: ROLLBACK
18:56:54.561760 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_vw_sales_valor_pago.5cd141ad26: Close
18:56:54.566847 [info ] [Thread-1  ]: 8 of 11 PASS not_null_vw_sales_valor_pago ...................................... [[32mPASS[0m in 1.55s]
18:56:54.573894 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.not_null_vw_sales_valor_pago.5cd141ad26
18:56:54.579915 [debug] [Thread-1  ]: Began running node test.analytics_dbt.test_singular_testa_nao_negativo_vw_sales_valor_pago.960c3093cc
18:56:54.586032 [info ] [Thread-1  ]: 9 of 11 START test test_singular_testa_nao_negativo_vw_sales_valor_pago ........ [RUN]
18:56:54.597045 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.test_singular_testa_nao_negativo_vw_sales_valor_pago.960c3093cc"
18:56:54.604091 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.test_singular_testa_nao_negativo_vw_sales_valor_pago.960c3093cc
18:56:54.616839 [debug] [Thread-1  ]: Compiling test.analytics_dbt.test_singular_testa_nao_negativo_vw_sales_valor_pago.960c3093cc
18:56:54.646774 [debug] [Thread-1  ]: finished collecting timing info
18:56:54.652787 [debug] [Thread-1  ]: Compilation Error in test test_singular_testa_nao_negativo_vw_sales_valor_pago (models/example/schema.yml)
  'test_test_singular_testa_nao_negativo' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
18:56:54.660269 [error] [Thread-1  ]: 9 of 11 ERROR test_singular_testa_nao_negativo_vw_sales_valor_pago ............. [[31mERROR[0m in 0.06s]
18:56:54.667038 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.test_singular_testa_nao_negativo_vw_sales_valor_pago.960c3093cc
18:56:54.687428 [debug] [Thread-1  ]: Began running node test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
18:56:54.693975 [info ] [Thread-1  ]: 10 of 11 START test unique_my_first_dbt_model_id ............................... [RUN]
18:56:54.698275 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"
18:56:54.702996 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
18:56:54.710056 [debug] [Thread-1  ]: Compiling test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
18:56:54.749467 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"
18:56:54.762530 [debug] [Thread-1  ]: finished collecting timing info
18:56:54.773990 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
18:56:54.784666 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"
18:56:54.802907 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"
18:56:54.806794 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321: BEGIN
18:56:54.809069 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:56:54.812468 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
18:56:56.000478 [debug] [Thread-1  ]: SQL status: BEGIN in 1.19 seconds
18:56:56.003826 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"
18:56:56.006581 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dev"."public"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
18:56:56.141070 [debug] [Thread-1  ]: SQL status: SELECT in 0.13 seconds
18:56:56.149912 [debug] [Thread-1  ]: finished collecting timing info
18:56:56.153909 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
18:56:56.287696 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321: Close
18:56:56.294660 [info ] [Thread-1  ]: 10 of 11 PASS unique_my_first_dbt_model_id ..................................... [[32mPASS[0m in 1.60s]
18:56:56.301124 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
18:56:56.306710 [debug] [Thread-1  ]: Began running node test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
18:56:56.312227 [info ] [Thread-1  ]: 11 of 11 START test unique_my_second_dbt_model_id .............................. [RUN]
18:56:56.326180 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"
18:56:56.335537 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
18:56:56.340869 [debug] [Thread-1  ]: Compiling test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
18:56:56.388524 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"
18:56:56.424101 [debug] [Thread-1  ]: finished collecting timing info
18:56:56.431807 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
18:56:56.443660 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"
18:56:56.455577 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"
18:56:56.459318 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493: BEGIN
18:56:56.462292 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:56:56.466744 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
18:56:57.680159 [debug] [Thread-1  ]: SQL status: BEGIN in 1.22 seconds
18:56:57.683745 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"
18:56:57.686526 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dev"."public"."my_second_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
18:56:57.824392 [debug] [Thread-1  ]: SQL status: SELECT in 0.13 seconds
18:56:57.830369 [debug] [Thread-1  ]: finished collecting timing info
18:56:57.833620 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493: ROLLBACK
18:56:57.967747 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493: Close
18:56:57.971596 [info ] [Thread-1  ]: 11 of 11 PASS unique_my_second_dbt_model_id .................................... [[32mPASS[0m in 1.65s]
18:56:57.975555 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
18:56:57.984321 [debug] [MainThread]: Acquiring new redshift connection "master"
18:56:57.988042 [debug] [MainThread]: Using redshift connection "master"
18:56:57.993723 [debug] [MainThread]: On master: BEGIN
18:56:58.004871 [debug] [MainThread]: Opening a new connection, currently in state closed
18:56:58.015567 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
18:56:59.227954 [debug] [MainThread]: SQL status: BEGIN in 1.22 seconds
18:56:59.230923 [debug] [MainThread]: On master: COMMIT
18:56:59.233748 [debug] [MainThread]: Using redshift connection "master"
18:56:59.236627 [debug] [MainThread]: On master: COMMIT
18:56:59.366862 [debug] [MainThread]: SQL status: COMMIT in 0.13 seconds
18:56:59.369717 [debug] [MainThread]: On master: Close
18:56:59.373750 [info ] [MainThread]: 
18:56:59.376807 [info ] [MainThread]: Finished running 11 tests in 21.12s.
18:56:59.381230 [debug] [MainThread]: Connection 'master' was properly closed.
18:56:59.389863 [debug] [MainThread]: Connection 'test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
18:56:59.443450 [info ] [MainThread]: 
18:56:59.450424 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
18:56:59.457009 [info ] [MainThread]: 
18:56:59.466286 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models/example/schema.yml)[0m
18:56:59.479399 [error] [MainThread]:   Got 1 result, configured to fail if != 0
18:56:59.496930 [info ] [MainThread]: 
18:56:59.518013 [info ] [MainThread]:   compiled SQL at target/compiled/analytics_dbt/models/example/schema.yml/not_null_my_first_dbt_model_id.sql
18:56:59.528927 [info ] [MainThread]: 
18:56:59.545129 [error] [MainThread]: [33mCompilation Error in test test_singular_testa_nao_negativo_vw_sales_valor_pago (models/example/schema.yml)[0m
18:56:59.559688 [error] [MainThread]:   'test_test_singular_testa_nao_negativo' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
18:56:59.569659 [info ] [MainThread]: 
18:56:59.580676 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=2 SKIP=0 TOTAL=11
18:56:59.589632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b252c9460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b25801b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b252a5a60>]}


============================== 2022-05-23 18:59:29.335060 | 871c4775-c54c-4655-85c4-d8066e107237 ==============================
18:59:29.335091 [info ] [MainThread]: Running with dbt=1.1.0
18:59:29.338453 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'select': ['models/example/schema.yml'], 'which': 'test', 'rpc_method': 'test'}
18:59:29.343355 [debug] [MainThread]: Tracking: tracking
18:59:29.366741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d4f5b77c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d4f5b7880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d4f5b78b0>]}
18:59:29.561255 [debug] [MainThread]: Partial parsing enabled: 2 files deleted, 2 files added, 1 files changed.
18:59:29.564535 [debug] [MainThread]: Partial parsing: added file: analytics_dbt://macros/test_nao_negativo.sql
18:59:29.567711 [debug] [MainThread]: Partial parsing: added file: analytics_dbt://tests/test_singular_nao_negativo.sql
18:59:29.571633 [debug] [MainThread]: Partial parsing: update schema file: analytics_dbt://models/example/schema.yml
18:59:29.574495 [debug] [MainThread]: Partial parsing: deleted file: analytics_dbt://tests/test_singular_testa_nao_negativo.sql
18:59:29.578201 [debug] [MainThread]: Partial parsing: deleted file: analytics_dbt://macros/nao_negativo.sql
18:59:29.581438 [debug] [MainThread]: Parsing macros/test_nao_negativo.sql
18:59:29.620278 [debug] [MainThread]: 1699: static parser successfully parsed views/vw_sales.sql
18:59:29.652778 [debug] [MainThread]: 1699: static parser successfully parsed tables/tb_10_compradores.sql
18:59:29.882009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '871c4775-c54c-4655-85c4-d8066e107237', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d4f00cc70>]}
18:59:29.923472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '871c4775-c54c-4655-85c4-d8066e107237', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d4f5b7ac0>]}
18:59:29.928118 [info ] [MainThread]: Found 5 models, 11 tests, 0 snapshots, 0 analyses, 194 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
18:59:29.932711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '871c4775-c54c-4655-85c4-d8066e107237', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d4f5b7a60>]}
18:59:29.948091 [info ] [MainThread]: 
18:59:29.954507 [debug] [MainThread]: Acquiring new redshift connection "master"
18:59:29.963612 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev_public"
18:59:29.996966 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
18:59:30.000161 [debug] [ThreadPool]: On list_dev_public: BEGIN
18:59:30.003650 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:59:30.006643 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
18:59:31.216518 [debug] [ThreadPool]: SQL status: BEGIN in 1.21 seconds
18:59:31.219729 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
18:59:31.222668 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev_public"} */
select
      'dev' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dev' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
18:59:31.366528 [debug] [ThreadPool]: SQL status: SELECT in 0.14 seconds
18:59:31.373595 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
18:59:31.503878 [debug] [ThreadPool]: On list_dev_public: Close
18:59:31.518418 [debug] [MainThread]: Using redshift connection "master"
18:59:31.521533 [debug] [MainThread]: On master: BEGIN
18:59:31.524568 [debug] [MainThread]: Opening a new connection, currently in state init
18:59:31.527563 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
18:59:32.722291 [debug] [MainThread]: SQL status: BEGIN in 1.2 seconds
18:59:32.725697 [debug] [MainThread]: Using redshift connection "master"
18:59:32.728645 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
18:59:32.894234 [debug] [MainThread]: SQL status: SELECT in 0.16 seconds
18:59:32.899774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '871c4775-c54c-4655-85c4-d8066e107237', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d4f52b190>]}
18:59:32.902946 [debug] [MainThread]: On master: ROLLBACK
18:59:33.040812 [debug] [MainThread]: Using redshift connection "master"
18:59:33.043847 [debug] [MainThread]: On master: BEGIN
18:59:33.302638 [debug] [MainThread]: SQL status: BEGIN in 0.26 seconds
18:59:33.305897 [debug] [MainThread]: On master: COMMIT
18:59:33.308970 [debug] [MainThread]: Using redshift connection "master"
18:59:33.311871 [debug] [MainThread]: On master: COMMIT
18:59:33.445266 [debug] [MainThread]: SQL status: COMMIT in 0.13 seconds
18:59:33.448564 [debug] [MainThread]: On master: Close
18:59:33.454785 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
18:59:33.458190 [info ] [MainThread]: 
18:59:33.476754 [debug] [Thread-1  ]: Began running node test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea
18:59:33.479511 [info ] [Thread-1  ]: 1 of 10 START test nao_negativo_tb_10_compradores_vendas_totais ................ [RUN]
18:59:33.483327 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea"
18:59:33.488861 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea
18:59:33.492696 [debug] [Thread-1  ]: Compiling test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea
18:59:33.503525 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea"
18:59:33.516543 [debug] [Thread-1  ]: finished collecting timing info
18:59:33.522264 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea
18:59:33.567863 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea"
18:59:33.584523 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea"
18:59:33.592712 [debug] [Thread-1  ]: On test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea: BEGIN
18:59:33.596930 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:59:33.600395 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
18:59:34.777373 [debug] [Thread-1  ]: SQL status: BEGIN in 1.18 seconds
18:59:34.781531 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea"
18:59:34.784792 [debug] [Thread-1  ]: On test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

    select *
    from "dev"."public"."tb_10_compradores"
    where vendas_totais < 0


      
    ) dbt_internal_test
18:59:34.917389 [debug] [Thread-1  ]: SQL status: SELECT in 0.13 seconds
18:59:34.925169 [debug] [Thread-1  ]: finished collecting timing info
18:59:34.928155 [debug] [Thread-1  ]: On test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea: ROLLBACK
18:59:35.057759 [debug] [Thread-1  ]: On test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea: Close
18:59:35.063382 [info ] [Thread-1  ]: 1 of 10 PASS nao_negativo_tb_10_compradores_vendas_totais ...................... [[32mPASS[0m in 1.58s]
18:59:35.068295 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea
18:59:35.073306 [debug] [Thread-1  ]: Began running node test.analytics_dbt.nao_negativo_vw_sales_comissao.c9561fd7db
18:59:35.076227 [info ] [Thread-1  ]: 2 of 10 START test nao_negativo_vw_sales_comissao .............................. [RUN]
18:59:35.081077 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.nao_negativo_vw_sales_comissao.c9561fd7db"
18:59:35.084990 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.nao_negativo_vw_sales_comissao.c9561fd7db
18:59:35.087540 [debug] [Thread-1  ]: Compiling test.analytics_dbt.nao_negativo_vw_sales_comissao.c9561fd7db
18:59:35.099132 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.nao_negativo_vw_sales_comissao.c9561fd7db"
18:59:35.108815 [debug] [Thread-1  ]: finished collecting timing info
18:59:35.112312 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.nao_negativo_vw_sales_comissao.c9561fd7db
18:59:35.121905 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.nao_negativo_vw_sales_comissao.c9561fd7db"
18:59:35.132151 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.nao_negativo_vw_sales_comissao.c9561fd7db"
18:59:35.135047 [debug] [Thread-1  ]: On test.analytics_dbt.nao_negativo_vw_sales_comissao.c9561fd7db: BEGIN
18:59:35.138388 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:59:35.141682 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
18:59:36.331761 [debug] [Thread-1  ]: SQL status: BEGIN in 1.19 seconds
18:59:36.336157 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.nao_negativo_vw_sales_comissao.c9561fd7db"
18:59:36.339240 [debug] [Thread-1  ]: On test.analytics_dbt.nao_negativo_vw_sales_comissao.c9561fd7db: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.nao_negativo_vw_sales_comissao.c9561fd7db"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

    select *
    from "dev"."public"."vw_sales"
    where comissao < 0


      
    ) dbt_internal_test
18:59:36.477197 [debug] [Thread-1  ]: SQL status: SELECT in 0.14 seconds
18:59:36.482876 [debug] [Thread-1  ]: finished collecting timing info
18:59:36.486121 [debug] [Thread-1  ]: On test.analytics_dbt.nao_negativo_vw_sales_comissao.c9561fd7db: ROLLBACK
18:59:36.629807 [debug] [Thread-1  ]: On test.analytics_dbt.nao_negativo_vw_sales_comissao.c9561fd7db: Close
18:59:36.637704 [info ] [Thread-1  ]: 2 of 10 PASS nao_negativo_vw_sales_comissao .................................... [[32mPASS[0m in 1.56s]
18:59:36.640688 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.nao_negativo_vw_sales_comissao.c9561fd7db
18:59:36.644484 [debug] [Thread-1  ]: Began running node test.analytics_dbt.nao_negativo_vw_sales_valor_pago.7a9d055b10
18:59:36.648586 [info ] [Thread-1  ]: 3 of 10 START test nao_negativo_vw_sales_valor_pago ............................ [RUN]
18:59:36.652277 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.nao_negativo_vw_sales_valor_pago.7a9d055b10"
18:59:36.656209 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.nao_negativo_vw_sales_valor_pago.7a9d055b10
18:59:36.659727 [debug] [Thread-1  ]: Compiling test.analytics_dbt.nao_negativo_vw_sales_valor_pago.7a9d055b10
18:59:36.670407 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.nao_negativo_vw_sales_valor_pago.7a9d055b10"
18:59:36.677742 [debug] [Thread-1  ]: finished collecting timing info
18:59:36.680608 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.nao_negativo_vw_sales_valor_pago.7a9d055b10
18:59:36.688215 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.nao_negativo_vw_sales_valor_pago.7a9d055b10"
18:59:36.696185 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.nao_negativo_vw_sales_valor_pago.7a9d055b10"
18:59:36.699219 [debug] [Thread-1  ]: On test.analytics_dbt.nao_negativo_vw_sales_valor_pago.7a9d055b10: BEGIN
18:59:36.701935 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:59:36.704615 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
18:59:37.922298 [debug] [Thread-1  ]: SQL status: BEGIN in 1.22 seconds
18:59:37.925735 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.nao_negativo_vw_sales_valor_pago.7a9d055b10"
18:59:37.929091 [debug] [Thread-1  ]: On test.analytics_dbt.nao_negativo_vw_sales_valor_pago.7a9d055b10: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.nao_negativo_vw_sales_valor_pago.7a9d055b10"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

    select *
    from "dev"."public"."vw_sales"
    where valor_pago < 0


      
    ) dbt_internal_test
18:59:38.067571 [debug] [Thread-1  ]: SQL status: SELECT in 0.13 seconds
18:59:38.073310 [debug] [Thread-1  ]: finished collecting timing info
18:59:38.076348 [debug] [Thread-1  ]: On test.analytics_dbt.nao_negativo_vw_sales_valor_pago.7a9d055b10: ROLLBACK
18:59:38.208906 [debug] [Thread-1  ]: On test.analytics_dbt.nao_negativo_vw_sales_valor_pago.7a9d055b10: Close
18:59:38.212646 [info ] [Thread-1  ]: 3 of 10 PASS nao_negativo_vw_sales_valor_pago .................................. [[32mPASS[0m in 1.56s]
18:59:38.217008 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.nao_negativo_vw_sales_valor_pago.7a9d055b10
18:59:38.221907 [debug] [Thread-1  ]: Began running node test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
18:59:38.225485 [info ] [Thread-1  ]: 4 of 10 START test not_null_my_first_dbt_model_id .............................. [RUN]
18:59:38.229404 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
18:59:38.233403 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
18:59:38.236603 [debug] [Thread-1  ]: Compiling test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
18:59:38.256817 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
18:59:38.267904 [debug] [Thread-1  ]: finished collecting timing info
18:59:38.271040 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
18:59:38.278665 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
18:59:38.289567 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
18:59:38.292820 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710: BEGIN
18:59:38.295452 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:59:38.299409 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
18:59:39.481487 [debug] [Thread-1  ]: SQL status: BEGIN in 1.19 seconds
18:59:39.496218 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
18:59:39.507230 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dev"."public"."my_first_dbt_model"
where id is null



      
    ) dbt_internal_test
18:59:39.650393 [debug] [Thread-1  ]: SQL status: SELECT in 0.14 seconds
18:59:39.659732 [debug] [Thread-1  ]: finished collecting timing info
18:59:39.663107 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
18:59:39.810200 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710: Close
18:59:39.824132 [error] [Thread-1  ]: 4 of 10 FAIL 1 not_null_my_first_dbt_model_id .................................. [[31mFAIL 1[0m in 1.60s]
18:59:39.839642 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
18:59:39.861847 [debug] [Thread-1  ]: Began running node test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
18:59:39.875032 [info ] [Thread-1  ]: 5 of 10 START test not_null_my_second_dbt_model_id ............................. [RUN]
18:59:39.890746 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"
18:59:39.905286 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
18:59:39.913970 [debug] [Thread-1  ]: Compiling test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
18:59:39.949761 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"
18:59:39.969641 [debug] [Thread-1  ]: finished collecting timing info
18:59:39.976969 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
18:59:39.985418 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"
18:59:39.996387 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"
18:59:40.001520 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778: BEGIN
18:59:40.004927 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:59:40.008373 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
18:59:41.205988 [debug] [Thread-1  ]: SQL status: BEGIN in 1.2 seconds
18:59:41.209537 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"
18:59:41.212692 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dev"."public"."my_second_dbt_model"
where id is null



      
    ) dbt_internal_test
18:59:41.352325 [debug] [Thread-1  ]: SQL status: SELECT in 0.14 seconds
18:59:41.360092 [debug] [Thread-1  ]: finished collecting timing info
18:59:41.362478 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778: ROLLBACK
18:59:41.494846 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778: Close
18:59:41.500244 [info ] [Thread-1  ]: 5 of 10 PASS not_null_my_second_dbt_model_id ................................... [[32mPASS[0m in 1.61s]
18:59:41.503841 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
18:59:41.508887 [debug] [Thread-1  ]: Began running node test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752
18:59:41.511572 [info ] [Thread-1  ]: 6 of 10 START test not_null_tb_10_compradores_vendas_totais .................... [RUN]
18:59:41.514955 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752"
18:59:41.519403 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752
18:59:41.522701 [debug] [Thread-1  ]: Compiling test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752
18:59:41.534152 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752"
18:59:41.544179 [debug] [Thread-1  ]: finished collecting timing info
18:59:41.548290 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752
18:59:41.554918 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752"
18:59:41.566236 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752"
18:59:41.569630 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752: BEGIN
18:59:41.589074 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:59:41.592528 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
18:59:42.822777 [debug] [Thread-1  ]: SQL status: BEGIN in 1.23 seconds
18:59:42.827749 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752"
18:59:42.831282 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select vendas_totais
from "dev"."public"."tb_10_compradores"
where vendas_totais is null



      
    ) dbt_internal_test
18:59:42.968031 [debug] [Thread-1  ]: SQL status: SELECT in 0.13 seconds
18:59:42.974475 [debug] [Thread-1  ]: finished collecting timing info
18:59:42.977205 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752: ROLLBACK
18:59:43.113673 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752: Close
18:59:43.118556 [info ] [Thread-1  ]: 6 of 10 PASS not_null_tb_10_compradores_vendas_totais .......................... [[32mPASS[0m in 1.60s]
18:59:43.122681 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752
18:59:43.128220 [debug] [Thread-1  ]: Began running node test.analytics_dbt.not_null_vw_sales_comissao.d9b6c254ab
18:59:43.131582 [info ] [Thread-1  ]: 7 of 10 START test not_null_vw_sales_comissao .................................. [RUN]
18:59:43.135601 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.not_null_vw_sales_comissao.d9b6c254ab"
18:59:43.141098 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.not_null_vw_sales_comissao.d9b6c254ab
18:59:43.144619 [debug] [Thread-1  ]: Compiling test.analytics_dbt.not_null_vw_sales_comissao.d9b6c254ab
18:59:43.155913 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.not_null_vw_sales_comissao.d9b6c254ab"
18:59:43.166499 [debug] [Thread-1  ]: finished collecting timing info
18:59:43.170965 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.not_null_vw_sales_comissao.d9b6c254ab
18:59:43.178526 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.not_null_vw_sales_comissao.d9b6c254ab"
18:59:43.188908 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_vw_sales_comissao.d9b6c254ab"
18:59:43.192479 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_vw_sales_comissao.d9b6c254ab: BEGIN
18:59:43.195161 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:59:43.197995 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
18:59:44.374304 [debug] [Thread-1  ]: SQL status: BEGIN in 1.18 seconds
18:59:44.377758 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_vw_sales_comissao.d9b6c254ab"
18:59:44.380243 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_vw_sales_comissao.d9b6c254ab: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.not_null_vw_sales_comissao.d9b6c254ab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select comissao
from "dev"."public"."vw_sales"
where comissao is null



      
    ) dbt_internal_test
18:59:44.514223 [debug] [Thread-1  ]: SQL status: SELECT in 0.13 seconds
18:59:44.521272 [debug] [Thread-1  ]: finished collecting timing info
18:59:44.524343 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_vw_sales_comissao.d9b6c254ab: ROLLBACK
18:59:44.656184 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_vw_sales_comissao.d9b6c254ab: Close
18:59:44.662268 [info ] [Thread-1  ]: 7 of 10 PASS not_null_vw_sales_comissao ........................................ [[32mPASS[0m in 1.53s]
18:59:44.667454 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.not_null_vw_sales_comissao.d9b6c254ab
18:59:44.790727 [debug] [Thread-1  ]: Began running node test.analytics_dbt.not_null_vw_sales_valor_pago.5cd141ad26
18:59:44.794569 [info ] [Thread-1  ]: 8 of 10 START test not_null_vw_sales_valor_pago ................................ [RUN]
18:59:44.801187 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.not_null_vw_sales_valor_pago.5cd141ad26"
18:59:44.805569 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.not_null_vw_sales_valor_pago.5cd141ad26
18:59:44.809178 [debug] [Thread-1  ]: Compiling test.analytics_dbt.not_null_vw_sales_valor_pago.5cd141ad26
18:59:44.820784 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.not_null_vw_sales_valor_pago.5cd141ad26"
18:59:44.830437 [debug] [Thread-1  ]: finished collecting timing info
18:59:44.834728 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.not_null_vw_sales_valor_pago.5cd141ad26
18:59:44.843782 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.not_null_vw_sales_valor_pago.5cd141ad26"
18:59:44.852678 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_vw_sales_valor_pago.5cd141ad26"
18:59:44.856828 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_vw_sales_valor_pago.5cd141ad26: BEGIN
18:59:44.859657 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:59:44.863309 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
18:59:46.037832 [debug] [Thread-1  ]: SQL status: BEGIN in 1.18 seconds
18:59:46.042094 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_vw_sales_valor_pago.5cd141ad26"
18:59:46.045065 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_vw_sales_valor_pago.5cd141ad26: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.not_null_vw_sales_valor_pago.5cd141ad26"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select valor_pago
from "dev"."public"."vw_sales"
where valor_pago is null



      
    ) dbt_internal_test
18:59:46.177587 [debug] [Thread-1  ]: SQL status: SELECT in 0.13 seconds
18:59:46.183665 [debug] [Thread-1  ]: finished collecting timing info
18:59:46.185987 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_vw_sales_valor_pago.5cd141ad26: ROLLBACK
18:59:46.316474 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_vw_sales_valor_pago.5cd141ad26: Close
18:59:46.321672 [info ] [Thread-1  ]: 8 of 10 PASS not_null_vw_sales_valor_pago ...................................... [[32mPASS[0m in 1.52s]
18:59:46.324925 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.not_null_vw_sales_valor_pago.5cd141ad26
18:59:46.329499 [debug] [Thread-1  ]: Began running node test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
18:59:46.332506 [info ] [Thread-1  ]: 9 of 10 START test unique_my_first_dbt_model_id ................................ [RUN]
18:59:46.335527 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"
18:59:46.340142 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
18:59:46.344282 [debug] [Thread-1  ]: Compiling test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
18:59:46.362321 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"
18:59:46.370465 [debug] [Thread-1  ]: finished collecting timing info
18:59:46.373442 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
18:59:46.379906 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"
18:59:46.393566 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"
18:59:46.398337 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321: BEGIN
18:59:46.402478 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:59:46.405537 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
18:59:47.578423 [debug] [Thread-1  ]: SQL status: BEGIN in 1.18 seconds
18:59:47.583011 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"
18:59:47.587039 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dev"."public"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
18:59:47.720576 [debug] [Thread-1  ]: SQL status: SELECT in 0.13 seconds
18:59:47.728077 [debug] [Thread-1  ]: finished collecting timing info
18:59:47.730548 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
18:59:47.860709 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321: Close
18:59:47.866706 [info ] [Thread-1  ]: 9 of 10 PASS unique_my_first_dbt_model_id ...................................... [[32mPASS[0m in 1.53s]
18:59:47.871673 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
18:59:47.875550 [debug] [Thread-1  ]: Began running node test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
18:59:47.878288 [info ] [Thread-1  ]: 10 of 10 START test unique_my_second_dbt_model_id .............................. [RUN]
18:59:47.883073 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"
18:59:47.887913 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
18:59:47.892076 [debug] [Thread-1  ]: Compiling test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
18:59:47.904762 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"
18:59:47.915331 [debug] [Thread-1  ]: finished collecting timing info
18:59:47.919556 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
18:59:47.933317 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"
18:59:47.945932 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"
18:59:47.951162 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493: BEGIN
18:59:47.954933 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:59:47.958714 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
18:59:49.126402 [debug] [Thread-1  ]: SQL status: BEGIN in 1.17 seconds
18:59:49.129921 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"
18:59:49.133176 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dev"."public"."my_second_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
18:59:49.247473 [debug] [Thread-1  ]: SQL status: SELECT in 0.11 seconds
18:59:49.254072 [debug] [Thread-1  ]: finished collecting timing info
18:59:49.257273 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493: ROLLBACK
18:59:49.399297 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493: Close
18:59:49.405612 [info ] [Thread-1  ]: 10 of 10 PASS unique_my_second_dbt_model_id .................................... [[32mPASS[0m in 1.52s]
18:59:49.409451 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
18:59:49.418107 [debug] [MainThread]: Acquiring new redshift connection "master"
18:59:49.421251 [debug] [MainThread]: Using redshift connection "master"
18:59:49.424380 [debug] [MainThread]: On master: BEGIN
18:59:49.427457 [debug] [MainThread]: Opening a new connection, currently in state closed
18:59:49.430022 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
18:59:50.631039 [debug] [MainThread]: SQL status: BEGIN in 1.2 seconds
18:59:50.634660 [debug] [MainThread]: On master: COMMIT
18:59:50.637119 [debug] [MainThread]: Using redshift connection "master"
18:59:50.640241 [debug] [MainThread]: On master: COMMIT
18:59:50.773709 [debug] [MainThread]: SQL status: COMMIT in 0.13 seconds
18:59:50.777092 [debug] [MainThread]: On master: Close
18:59:50.781613 [info ] [MainThread]: 
18:59:50.785879 [info ] [MainThread]: Finished running 10 tests in 20.83s.
18:59:50.791315 [debug] [MainThread]: Connection 'master' was properly closed.
18:59:50.796542 [debug] [MainThread]: Connection 'test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
18:59:50.839378 [info ] [MainThread]: 
18:59:50.846176 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
18:59:50.852382 [info ] [MainThread]: 
18:59:50.857688 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models/example/schema.yml)[0m
18:59:50.870399 [error] [MainThread]:   Got 1 result, configured to fail if != 0
18:59:50.898621 [info ] [MainThread]: 
18:59:50.904916 [info ] [MainThread]:   compiled SQL at target/compiled/analytics_dbt/models/example/schema.yml/not_null_my_first_dbt_model_id.sql
18:59:50.912182 [info ] [MainThread]: 
18:59:50.917293 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=1 SKIP=0 TOTAL=10
18:59:50.923103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d4efccc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d4efccf70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d4efccee0>]}


============================== 2022-05-23 19:10:15.004029 | 9e7e0c3e-49f0-4dae-b411-e148397260db ==============================
19:10:15.004063 [info ] [MainThread]: Running with dbt=1.1.0
19:10:15.007705 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
19:10:15.014495 [debug] [MainThread]: Tracking: tracking
19:10:15.050235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f383c1d06a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f383c1d0730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f383c1d0760>]}
19:10:15.240778 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
19:10:15.248077 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
19:10:15.274126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9e7e0c3e-49f0-4dae-b411-e148397260db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f383c08ca30>]}
19:10:15.323076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9e7e0c3e-49f0-4dae-b411-e148397260db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f383c190610>]}
19:10:15.334069 [info ] [MainThread]: Found 5 models, 11 tests, 0 snapshots, 0 analyses, 194 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
19:10:15.337967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9e7e0c3e-49f0-4dae-b411-e148397260db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f383c1904f0>]}
19:10:15.367415 [info ] [MainThread]: 
19:10:15.372384 [debug] [MainThread]: Acquiring new redshift connection "master"
19:10:15.401129 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev_public"
19:10:15.444562 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
19:10:15.449063 [debug] [ThreadPool]: On list_dev_public: BEGIN
19:10:15.452245 [debug] [ThreadPool]: Opening a new connection, currently in state init
19:10:15.455011 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
19:10:16.683731 [debug] [ThreadPool]: SQL status: BEGIN in 1.23 seconds
19:10:16.694268 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
19:10:16.699034 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev_public"} */
select
      'dev' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dev' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
19:10:16.839779 [debug] [ThreadPool]: SQL status: SELECT in 0.14 seconds
19:10:16.846472 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
19:10:16.978929 [debug] [ThreadPool]: On list_dev_public: Close
19:10:17.001304 [debug] [MainThread]: Using redshift connection "master"
19:10:17.014326 [debug] [MainThread]: On master: BEGIN
19:10:17.024384 [debug] [MainThread]: Opening a new connection, currently in state init
19:10:17.027980 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
19:10:18.216312 [debug] [MainThread]: SQL status: BEGIN in 1.19 seconds
19:10:18.218790 [debug] [MainThread]: Using redshift connection "master"
19:10:18.220948 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
19:10:18.382632 [debug] [MainThread]: SQL status: SELECT in 0.16 seconds
19:10:18.387844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9e7e0c3e-49f0-4dae-b411-e148397260db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f383c1e6d30>]}
19:10:18.391087 [debug] [MainThread]: On master: ROLLBACK
19:10:18.528083 [debug] [MainThread]: Using redshift connection "master"
19:10:18.530999 [debug] [MainThread]: On master: BEGIN
19:10:18.787175 [debug] [MainThread]: SQL status: BEGIN in 0.25 seconds
19:10:18.791607 [debug] [MainThread]: On master: COMMIT
19:10:18.794786 [debug] [MainThread]: Using redshift connection "master"
19:10:18.797679 [debug] [MainThread]: On master: COMMIT
19:10:18.907849 [debug] [MainThread]: SQL status: COMMIT in 0.11 seconds
19:10:18.911482 [debug] [MainThread]: On master: Close
19:10:18.915625 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
19:10:18.918212 [info ] [MainThread]: 
19:10:18.939384 [debug] [Thread-1  ]: Began running node test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea
19:10:18.946859 [info ] [Thread-1  ]: 1 of 11 START test nao_negativo_tb_10_compradores_vendas_totais ................ [RUN]
19:10:18.953618 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea"
19:10:18.965771 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea
19:10:18.972635 [debug] [Thread-1  ]: Compiling test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea
19:10:19.015422 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea"
19:10:19.027918 [debug] [Thread-1  ]: finished collecting timing info
19:10:19.034093 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea
19:10:19.098452 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea"
19:10:19.110325 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea"
19:10:19.114147 [debug] [Thread-1  ]: On test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea: BEGIN
19:10:19.118366 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:10:19.122504 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
19:10:20.321413 [debug] [Thread-1  ]: SQL status: BEGIN in 1.2 seconds
19:10:20.324573 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea"
19:10:20.328152 [debug] [Thread-1  ]: On test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

    select *
    from "dev"."public"."tb_10_compradores"
    where vendas_totais < 0


      
    ) dbt_internal_test
19:10:20.464374 [debug] [Thread-1  ]: SQL status: SELECT in 0.13 seconds
19:10:20.473282 [debug] [Thread-1  ]: finished collecting timing info
19:10:20.475948 [debug] [Thread-1  ]: On test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea: ROLLBACK
19:10:20.607071 [debug] [Thread-1  ]: On test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea: Close
19:10:20.611608 [info ] [Thread-1  ]: 1 of 11 PASS nao_negativo_tb_10_compradores_vendas_totais ...................... [[32mPASS[0m in 1.66s]
19:10:20.615355 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea
19:10:20.620191 [debug] [Thread-1  ]: Began running node test.analytics_dbt.nao_negativo_vw_sales_comissao.c9561fd7db
19:10:20.625262 [info ] [Thread-1  ]: 2 of 11 START test nao_negativo_vw_sales_comissao .............................. [RUN]
19:10:20.638548 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.nao_negativo_vw_sales_comissao.c9561fd7db"
19:10:20.643316 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.nao_negativo_vw_sales_comissao.c9561fd7db
19:10:20.656631 [debug] [Thread-1  ]: Compiling test.analytics_dbt.nao_negativo_vw_sales_comissao.c9561fd7db
19:10:20.683970 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.nao_negativo_vw_sales_comissao.c9561fd7db"
19:10:20.693991 [debug] [Thread-1  ]: finished collecting timing info
19:10:20.699953 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.nao_negativo_vw_sales_comissao.c9561fd7db
19:10:20.709204 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.nao_negativo_vw_sales_comissao.c9561fd7db"
19:10:20.719431 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.nao_negativo_vw_sales_comissao.c9561fd7db"
19:10:20.722152 [debug] [Thread-1  ]: On test.analytics_dbt.nao_negativo_vw_sales_comissao.c9561fd7db: BEGIN
19:10:20.725602 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:10:20.728727 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
19:10:21.924744 [debug] [Thread-1  ]: SQL status: BEGIN in 1.2 seconds
19:10:21.928253 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.nao_negativo_vw_sales_comissao.c9561fd7db"
19:10:21.932068 [debug] [Thread-1  ]: On test.analytics_dbt.nao_negativo_vw_sales_comissao.c9561fd7db: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.nao_negativo_vw_sales_comissao.c9561fd7db"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

    select *
    from "dev"."public"."vw_sales"
    where comissao < 0


      
    ) dbt_internal_test
19:10:22.067899 [debug] [Thread-1  ]: SQL status: SELECT in 0.13 seconds
19:10:22.077178 [debug] [Thread-1  ]: finished collecting timing info
19:10:22.082354 [debug] [Thread-1  ]: On test.analytics_dbt.nao_negativo_vw_sales_comissao.c9561fd7db: ROLLBACK
19:10:22.225711 [debug] [Thread-1  ]: On test.analytics_dbt.nao_negativo_vw_sales_comissao.c9561fd7db: Close
19:10:22.231004 [info ] [Thread-1  ]: 2 of 11 PASS nao_negativo_vw_sales_comissao .................................... [[32mPASS[0m in 1.59s]
19:10:22.234665 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.nao_negativo_vw_sales_comissao.c9561fd7db
19:10:22.239367 [debug] [Thread-1  ]: Began running node test.analytics_dbt.nao_negativo_vw_sales_valor_pago.7a9d055b10
19:10:22.247003 [info ] [Thread-1  ]: 3 of 11 START test nao_negativo_vw_sales_valor_pago ............................ [RUN]
19:10:22.263265 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.nao_negativo_vw_sales_valor_pago.7a9d055b10"
19:10:22.273928 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.nao_negativo_vw_sales_valor_pago.7a9d055b10
19:10:22.292539 [debug] [Thread-1  ]: Compiling test.analytics_dbt.nao_negativo_vw_sales_valor_pago.7a9d055b10
19:10:22.320629 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.nao_negativo_vw_sales_valor_pago.7a9d055b10"
19:10:22.347438 [debug] [Thread-1  ]: finished collecting timing info
19:10:22.352764 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.nao_negativo_vw_sales_valor_pago.7a9d055b10
19:10:22.367622 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.nao_negativo_vw_sales_valor_pago.7a9d055b10"
19:10:22.376002 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.nao_negativo_vw_sales_valor_pago.7a9d055b10"
19:10:22.379184 [debug] [Thread-1  ]: On test.analytics_dbt.nao_negativo_vw_sales_valor_pago.7a9d055b10: BEGIN
19:10:22.382023 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:10:22.384570 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
19:10:23.577915 [debug] [Thread-1  ]: SQL status: BEGIN in 1.2 seconds
19:10:23.582402 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.nao_negativo_vw_sales_valor_pago.7a9d055b10"
19:10:23.584959 [debug] [Thread-1  ]: On test.analytics_dbt.nao_negativo_vw_sales_valor_pago.7a9d055b10: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.nao_negativo_vw_sales_valor_pago.7a9d055b10"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

    select *
    from "dev"."public"."vw_sales"
    where valor_pago < 0


      
    ) dbt_internal_test
19:10:23.720153 [debug] [Thread-1  ]: SQL status: SELECT in 0.13 seconds
19:10:23.726433 [debug] [Thread-1  ]: finished collecting timing info
19:10:23.729695 [debug] [Thread-1  ]: On test.analytics_dbt.nao_negativo_vw_sales_valor_pago.7a9d055b10: ROLLBACK
19:10:23.862874 [debug] [Thread-1  ]: On test.analytics_dbt.nao_negativo_vw_sales_valor_pago.7a9d055b10: Close
19:10:23.868304 [info ] [Thread-1  ]: 3 of 11 PASS nao_negativo_vw_sales_valor_pago .................................. [[32mPASS[0m in 1.61s]
19:10:23.873620 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.nao_negativo_vw_sales_valor_pago.7a9d055b10
19:10:23.878680 [debug] [Thread-1  ]: Began running node test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
19:10:23.885117 [info ] [Thread-1  ]: 4 of 11 START test not_null_my_first_dbt_model_id .............................. [RUN]
19:10:23.893854 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
19:10:23.907232 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
19:10:23.912008 [debug] [Thread-1  ]: Compiling test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
19:10:23.952183 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
19:10:23.967983 [debug] [Thread-1  ]: finished collecting timing info
19:10:23.975405 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
19:10:23.988159 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
19:10:24.002865 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
19:10:24.006817 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710: BEGIN
19:10:24.010200 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:10:24.013822 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
19:10:25.214697 [debug] [Thread-1  ]: SQL status: BEGIN in 1.2 seconds
19:10:25.219396 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
19:10:25.222867 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dev"."public"."my_first_dbt_model"
where id is null



      
    ) dbt_internal_test
19:10:25.358600 [debug] [Thread-1  ]: SQL status: SELECT in 0.13 seconds
19:10:25.365746 [debug] [Thread-1  ]: finished collecting timing info
19:10:25.370337 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
19:10:25.501950 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710: Close
19:10:25.506112 [error] [Thread-1  ]: 4 of 11 FAIL 1 not_null_my_first_dbt_model_id .................................. [[31mFAIL 1[0m in 1.61s]
19:10:25.510649 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
19:10:25.517070 [debug] [Thread-1  ]: Began running node test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
19:10:25.525926 [info ] [Thread-1  ]: 5 of 11 START test not_null_my_second_dbt_model_id ............................. [RUN]
19:10:25.532247 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"
19:10:25.543345 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
19:10:25.546157 [debug] [Thread-1  ]: Compiling test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
19:10:25.564070 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"
19:10:25.584750 [debug] [Thread-1  ]: finished collecting timing info
19:10:25.588544 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
19:10:25.599828 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"
19:10:25.613746 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"
19:10:25.617885 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778: BEGIN
19:10:25.621823 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:10:25.625703 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
19:10:26.815464 [debug] [Thread-1  ]: SQL status: BEGIN in 1.19 seconds
19:10:26.821918 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"
19:10:26.826862 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dev"."public"."my_second_dbt_model"
where id is null



      
    ) dbt_internal_test
19:10:26.969519 [debug] [Thread-1  ]: SQL status: SELECT in 0.14 seconds
19:10:26.976161 [debug] [Thread-1  ]: finished collecting timing info
19:10:26.980962 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778: ROLLBACK
19:10:27.113476 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778: Close
19:10:27.118020 [info ] [Thread-1  ]: 5 of 11 PASS not_null_my_second_dbt_model_id ................................... [[32mPASS[0m in 1.59s]
19:10:27.122719 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
19:10:27.131394 [debug] [Thread-1  ]: Began running node test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752
19:10:27.141792 [info ] [Thread-1  ]: 6 of 11 START test not_null_tb_10_compradores_vendas_totais .................... [RUN]
19:10:27.148976 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752"
19:10:27.161742 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752
19:10:27.167139 [debug] [Thread-1  ]: Compiling test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752
19:10:27.198945 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752"
19:10:27.216886 [debug] [Thread-1  ]: finished collecting timing info
19:10:27.220709 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752
19:10:27.231287 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752"
19:10:27.248789 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752"
19:10:27.252809 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752: BEGIN
19:10:27.256109 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:10:27.258732 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
19:10:28.429102 [debug] [Thread-1  ]: SQL status: BEGIN in 1.17 seconds
19:10:28.432122 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752"
19:10:28.435331 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select vendas_totais
from "dev"."public"."tb_10_compradores"
where vendas_totais is null



      
    ) dbt_internal_test
19:10:28.567780 [debug] [Thread-1  ]: SQL status: SELECT in 0.13 seconds
19:10:28.573392 [debug] [Thread-1  ]: finished collecting timing info
19:10:28.576027 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752: ROLLBACK
19:10:28.705841 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752: Close
19:10:28.709831 [info ] [Thread-1  ]: 6 of 11 PASS not_null_tb_10_compradores_vendas_totais .......................... [[32mPASS[0m in 1.56s]
19:10:28.714235 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752
19:10:28.718946 [debug] [Thread-1  ]: Began running node test.analytics_dbt.not_null_vw_sales_comissao.d9b6c254ab
19:10:28.725044 [info ] [Thread-1  ]: 7 of 11 START test not_null_vw_sales_comissao .................................. [RUN]
19:10:28.733140 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.not_null_vw_sales_comissao.d9b6c254ab"
19:10:28.738888 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.not_null_vw_sales_comissao.d9b6c254ab
19:10:28.750965 [debug] [Thread-1  ]: Compiling test.analytics_dbt.not_null_vw_sales_comissao.d9b6c254ab
19:10:28.770184 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.not_null_vw_sales_comissao.d9b6c254ab"
19:10:28.785392 [debug] [Thread-1  ]: finished collecting timing info
19:10:28.788730 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.not_null_vw_sales_comissao.d9b6c254ab
19:10:28.809659 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.not_null_vw_sales_comissao.d9b6c254ab"
19:10:28.822647 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_vw_sales_comissao.d9b6c254ab"
19:10:28.825816 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_vw_sales_comissao.d9b6c254ab: BEGIN
19:10:28.828579 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:10:28.834933 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
19:10:30.006379 [debug] [Thread-1  ]: SQL status: BEGIN in 1.18 seconds
19:10:30.009026 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_vw_sales_comissao.d9b6c254ab"
19:10:30.011775 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_vw_sales_comissao.d9b6c254ab: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.not_null_vw_sales_comissao.d9b6c254ab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select comissao
from "dev"."public"."vw_sales"
where comissao is null



      
    ) dbt_internal_test
19:10:30.145384 [debug] [Thread-1  ]: SQL status: SELECT in 0.13 seconds
19:10:30.150175 [debug] [Thread-1  ]: finished collecting timing info
19:10:30.152875 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_vw_sales_comissao.d9b6c254ab: ROLLBACK
19:10:30.284168 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_vw_sales_comissao.d9b6c254ab: Close
19:10:30.288957 [info ] [Thread-1  ]: 7 of 11 PASS not_null_vw_sales_comissao ........................................ [[32mPASS[0m in 1.56s]
19:10:30.292122 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.not_null_vw_sales_comissao.d9b6c254ab
19:10:30.297756 [debug] [Thread-1  ]: Began running node test.analytics_dbt.not_null_vw_sales_valor_pago.5cd141ad26
19:10:30.309005 [info ] [Thread-1  ]: 8 of 11 START test not_null_vw_sales_valor_pago ................................ [RUN]
19:10:30.319395 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.not_null_vw_sales_valor_pago.5cd141ad26"
19:10:30.340344 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.not_null_vw_sales_valor_pago.5cd141ad26
19:10:30.352351 [debug] [Thread-1  ]: Compiling test.analytics_dbt.not_null_vw_sales_valor_pago.5cd141ad26
19:10:30.388110 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.not_null_vw_sales_valor_pago.5cd141ad26"
19:10:30.400506 [debug] [Thread-1  ]: finished collecting timing info
19:10:30.406473 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.not_null_vw_sales_valor_pago.5cd141ad26
19:10:30.418241 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.not_null_vw_sales_valor_pago.5cd141ad26"
19:10:30.430077 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_vw_sales_valor_pago.5cd141ad26"
19:10:30.433974 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_vw_sales_valor_pago.5cd141ad26: BEGIN
19:10:30.440071 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:10:30.443918 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
19:10:31.649151 [debug] [Thread-1  ]: SQL status: BEGIN in 1.21 seconds
19:10:31.654436 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_vw_sales_valor_pago.5cd141ad26"
19:10:31.657900 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_vw_sales_valor_pago.5cd141ad26: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.not_null_vw_sales_valor_pago.5cd141ad26"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select valor_pago
from "dev"."public"."vw_sales"
where valor_pago is null



      
    ) dbt_internal_test
19:10:31.797476 [debug] [Thread-1  ]: SQL status: SELECT in 0.14 seconds
19:10:31.806905 [debug] [Thread-1  ]: finished collecting timing info
19:10:31.809872 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_vw_sales_valor_pago.5cd141ad26: ROLLBACK
19:10:31.944604 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_vw_sales_valor_pago.5cd141ad26: Close
19:10:31.948583 [info ] [Thread-1  ]: 8 of 11 PASS not_null_vw_sales_valor_pago ...................................... [[32mPASS[0m in 1.63s]
19:10:31.954291 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.not_null_vw_sales_valor_pago.5cd141ad26
19:10:31.959636 [debug] [Thread-1  ]: Began running node test.analytics_dbt.test_singular_nao_negativo
19:10:31.967375 [info ] [Thread-1  ]: 9 of 11 START test test_singular_nao_negativo .................................. [RUN]
19:10:31.975865 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.test_singular_nao_negativo"
19:10:31.980731 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.test_singular_nao_negativo
19:10:31.994723 [debug] [Thread-1  ]: Compiling test.analytics_dbt.test_singular_nao_negativo
19:10:32.009423 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.test_singular_nao_negativo"
19:10:32.059126 [debug] [Thread-1  ]: finished collecting timing info
19:10:32.065633 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.test_singular_nao_negativo
19:10:32.078006 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.test_singular_nao_negativo"
19:10:32.095698 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.test_singular_nao_negativo"
19:10:32.100786 [debug] [Thread-1  ]: On test.analytics_dbt.test_singular_nao_negativo: BEGIN
19:10:32.114711 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:10:32.122300 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
19:10:33.323619 [debug] [Thread-1  ]: SQL status: BEGIN in 1.21 seconds
19:10:33.329128 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.test_singular_nao_negativo"
19:10:33.332676 [debug] [Thread-1  ]: On test.analytics_dbt.test_singular_nao_negativo: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.test_singular_nao_negativo"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select *
    from tb_10_compradores
    where vendas_totais < 0
      
    ) dbt_internal_test
19:10:33.469100 [debug] [Thread-1  ]: SQL status: SELECT in 0.13 seconds
19:10:33.475655 [debug] [Thread-1  ]: finished collecting timing info
19:10:33.479405 [debug] [Thread-1  ]: On test.analytics_dbt.test_singular_nao_negativo: ROLLBACK
19:10:33.612510 [debug] [Thread-1  ]: On test.analytics_dbt.test_singular_nao_negativo: Close
19:10:33.617646 [info ] [Thread-1  ]: 9 of 11 PASS test_singular_nao_negativo ........................................ [[32mPASS[0m in 1.64s]
19:10:33.623308 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.test_singular_nao_negativo
19:10:33.629876 [debug] [Thread-1  ]: Began running node test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
19:10:33.634650 [info ] [Thread-1  ]: 10 of 11 START test unique_my_first_dbt_model_id ............................... [RUN]
19:10:33.646602 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"
19:10:33.658192 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
19:10:33.664452 [debug] [Thread-1  ]: Compiling test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
19:10:33.741534 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"
19:10:33.764654 [debug] [Thread-1  ]: finished collecting timing info
19:10:33.768247 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
19:10:33.777310 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"
19:10:33.787114 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"
19:10:33.791864 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321: BEGIN
19:10:33.796414 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:10:33.801681 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
19:10:34.969526 [debug] [Thread-1  ]: SQL status: BEGIN in 1.17 seconds
19:10:34.976568 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"
19:10:34.979010 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dev"."public"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
19:10:35.110859 [debug] [Thread-1  ]: SQL status: SELECT in 0.13 seconds
19:10:35.117491 [debug] [Thread-1  ]: finished collecting timing info
19:10:35.120119 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
19:10:35.251744 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321: Close
19:10:35.256845 [info ] [Thread-1  ]: 10 of 11 PASS unique_my_first_dbt_model_id ..................................... [[32mPASS[0m in 1.61s]
19:10:35.260129 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
19:10:35.264763 [debug] [Thread-1  ]: Began running node test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
19:10:35.269463 [info ] [Thread-1  ]: 11 of 11 START test unique_my_second_dbt_model_id .............................. [RUN]
19:10:35.278943 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"
19:10:35.290776 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
19:10:35.296578 [debug] [Thread-1  ]: Compiling test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
19:10:35.324713 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"
19:10:35.361794 [debug] [Thread-1  ]: finished collecting timing info
19:10:35.366915 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
19:10:35.382243 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"
19:10:35.394018 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"
19:10:35.397051 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493: BEGIN
19:10:35.400254 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:10:35.403439 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
19:10:36.598786 [debug] [Thread-1  ]: SQL status: BEGIN in 1.2 seconds
19:10:36.601433 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"
19:10:36.604758 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dev"."public"."my_second_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
19:10:36.741459 [debug] [Thread-1  ]: SQL status: SELECT in 0.13 seconds
19:10:36.747430 [debug] [Thread-1  ]: finished collecting timing info
19:10:36.750650 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493: ROLLBACK
19:10:36.883275 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493: Close
19:10:36.890372 [info ] [Thread-1  ]: 11 of 11 PASS unique_my_second_dbt_model_id .................................... [[32mPASS[0m in 1.61s]
19:10:36.898765 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
19:10:36.911960 [debug] [MainThread]: Acquiring new redshift connection "master"
19:10:36.917697 [debug] [MainThread]: Using redshift connection "master"
19:10:36.920930 [debug] [MainThread]: On master: BEGIN
19:10:36.928846 [debug] [MainThread]: Opening a new connection, currently in state closed
19:10:36.933738 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
19:10:38.176169 [debug] [MainThread]: SQL status: BEGIN in 1.25 seconds
19:10:38.179469 [debug] [MainThread]: On master: COMMIT
19:10:38.181975 [debug] [MainThread]: Using redshift connection "master"
19:10:38.185977 [debug] [MainThread]: On master: COMMIT
19:10:38.318833 [debug] [MainThread]: SQL status: COMMIT in 0.13 seconds
19:10:38.322583 [debug] [MainThread]: On master: Close
19:10:38.327612 [info ] [MainThread]: 
19:10:38.330727 [info ] [MainThread]: Finished running 11 tests in 22.96s.
19:10:38.335640 [debug] [MainThread]: Connection 'master' was properly closed.
19:10:38.346123 [debug] [MainThread]: Connection 'test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
19:10:38.424901 [info ] [MainThread]: 
19:10:38.432195 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
19:10:38.438745 [info ] [MainThread]: 
19:10:38.456564 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models/example/schema.yml)[0m
19:10:38.477886 [error] [MainThread]:   Got 1 result, configured to fail if != 0
19:10:38.497169 [info ] [MainThread]: 
19:10:38.504561 [info ] [MainThread]:   compiled SQL at target/compiled/analytics_dbt/models/example/schema.yml/not_null_my_first_dbt_model_id.sql
19:10:38.517097 [info ] [MainThread]: 
19:10:38.526998 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=1 SKIP=0 TOTAL=11
19:10:38.534020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f383c1906a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f383c190670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f383b814040>]}


============================== 2022-05-23 19:10:54.412042 | e40b6e74-12d6-4c84-8848-92e82e66fd9c ==============================
19:10:54.412063 [info ] [MainThread]: Running with dbt=1.1.0
19:10:54.418016 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
19:10:54.426192 [debug] [MainThread]: Tracking: tracking
19:10:54.469142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feae2eeb6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feae2eeb760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feae2eeb790>]}
19:10:54.635168 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
19:10:54.640135 [debug] [MainThread]: Partial parsing: update schema file: analytics_dbt://models/example/schema.yml
19:10:54.674663 [debug] [MainThread]: 1699: static parser successfully parsed tables/tb_10_compradores.sql
19:10:54.716751 [debug] [MainThread]: 1699: static parser successfully parsed views/vw_sales.sql
19:10:54.775004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e40b6e74-12d6-4c84-8848-92e82e66fd9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feae29770d0>]}
19:10:54.826317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e40b6e74-12d6-4c84-8848-92e82e66fd9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feae2e570a0>]}
19:10:54.832629 [info ] [MainThread]: Found 5 models, 5 tests, 0 snapshots, 0 analyses, 194 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
19:10:54.837656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e40b6e74-12d6-4c84-8848-92e82e66fd9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feae2e92ee0>]}
19:10:54.860556 [info ] [MainThread]: 
19:10:54.866805 [debug] [MainThread]: Acquiring new redshift connection "master"
19:10:54.888423 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev_public"
19:10:54.942342 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
19:10:54.945893 [debug] [ThreadPool]: On list_dev_public: BEGIN
19:10:54.949166 [debug] [ThreadPool]: Opening a new connection, currently in state init
19:10:54.953392 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
19:10:56.139136 [debug] [ThreadPool]: SQL status: BEGIN in 1.19 seconds
19:10:56.143712 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
19:10:56.147129 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev_public"} */
select
      'dev' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dev' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
19:10:56.299992 [debug] [ThreadPool]: SQL status: SELECT in 0.15 seconds
19:10:56.309279 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
19:10:56.442216 [debug] [ThreadPool]: On list_dev_public: Close
19:10:56.459799 [debug] [MainThread]: Using redshift connection "master"
19:10:56.463235 [debug] [MainThread]: On master: BEGIN
19:10:56.465848 [debug] [MainThread]: Opening a new connection, currently in state init
19:10:56.469710 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
19:10:57.662730 [debug] [MainThread]: SQL status: BEGIN in 1.2 seconds
19:10:57.665075 [debug] [MainThread]: Using redshift connection "master"
19:10:57.668760 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
19:10:57.835842 [debug] [MainThread]: SQL status: SELECT in 0.16 seconds
19:10:57.841139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e40b6e74-12d6-4c84-8848-92e82e66fd9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feae2f0e640>]}
19:10:57.845082 [debug] [MainThread]: On master: ROLLBACK
19:10:57.979198 [debug] [MainThread]: Using redshift connection "master"
19:10:57.982133 [debug] [MainThread]: On master: BEGIN
19:10:58.245929 [debug] [MainThread]: SQL status: BEGIN in 0.26 seconds
19:10:58.248668 [debug] [MainThread]: On master: COMMIT
19:10:58.251307 [debug] [MainThread]: Using redshift connection "master"
19:10:58.253977 [debug] [MainThread]: On master: COMMIT
19:10:58.385413 [debug] [MainThread]: SQL status: COMMIT in 0.13 seconds
19:10:58.389370 [debug] [MainThread]: On master: Close
19:10:58.394887 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
19:10:58.398813 [info ] [MainThread]: 
19:10:58.424027 [debug] [Thread-1  ]: Began running node test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
19:10:58.429913 [info ] [Thread-1  ]: 1 of 5 START test not_null_my_first_dbt_model_id ............................... [RUN]
19:10:58.441920 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
19:10:58.450978 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
19:10:58.455266 [debug] [Thread-1  ]: Compiling test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
19:10:58.507619 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
19:10:58.518246 [debug] [Thread-1  ]: finished collecting timing info
19:10:58.522114 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
19:10:58.565135 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
19:10:58.575659 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
19:10:58.580072 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710: BEGIN
19:10:58.583791 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:10:58.589619 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
19:10:59.780891 [debug] [Thread-1  ]: SQL status: BEGIN in 1.2 seconds
19:10:59.784289 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
19:10:59.788064 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dev"."public"."my_first_dbt_model"
where id is null



      
    ) dbt_internal_test
19:10:59.922654 [debug] [Thread-1  ]: SQL status: SELECT in 0.13 seconds
19:10:59.931598 [debug] [Thread-1  ]: finished collecting timing info
19:10:59.934997 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
19:11:00.067796 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710: Close
19:11:00.073579 [error] [Thread-1  ]: 1 of 5 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 1.63s]
19:11:00.077089 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
19:11:00.081716 [debug] [Thread-1  ]: Began running node test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
19:11:00.089105 [info ] [Thread-1  ]: 2 of 5 START test not_null_my_second_dbt_model_id .............................. [RUN]
19:11:00.097044 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"
19:11:00.102453 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
19:11:00.114870 [debug] [Thread-1  ]: Compiling test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
19:11:00.134087 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"
19:11:00.149105 [debug] [Thread-1  ]: finished collecting timing info
19:11:00.151856 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
19:11:00.161280 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"
19:11:00.170351 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"
19:11:00.175947 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778: BEGIN
19:11:00.180836 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:11:00.183817 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
19:11:01.361877 [debug] [Thread-1  ]: SQL status: BEGIN in 1.18 seconds
19:11:01.365773 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"
19:11:01.368931 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dev"."public"."my_second_dbt_model"
where id is null



      
    ) dbt_internal_test
19:11:01.507954 [debug] [Thread-1  ]: SQL status: SELECT in 0.14 seconds
19:11:01.513223 [debug] [Thread-1  ]: finished collecting timing info
19:11:01.516725 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778: ROLLBACK
19:11:01.647115 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778: Close
19:11:01.651474 [info ] [Thread-1  ]: 2 of 5 PASS not_null_my_second_dbt_model_id .................................... [[32mPASS[0m in 1.56s]
19:11:01.656659 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
19:11:01.661586 [debug] [Thread-1  ]: Began running node test.analytics_dbt.test_singular_nao_negativo
19:11:01.667742 [info ] [Thread-1  ]: 3 of 5 START test test_singular_nao_negativo ................................... [RUN]
19:11:01.678925 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.test_singular_nao_negativo"
19:11:01.690494 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.test_singular_nao_negativo
19:11:01.695267 [debug] [Thread-1  ]: Compiling test.analytics_dbt.test_singular_nao_negativo
19:11:01.715955 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.test_singular_nao_negativo"
19:11:01.738553 [debug] [Thread-1  ]: finished collecting timing info
19:11:01.746082 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.test_singular_nao_negativo
19:11:01.757610 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.test_singular_nao_negativo"
19:11:01.769613 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.test_singular_nao_negativo"
19:11:01.773755 [debug] [Thread-1  ]: On test.analytics_dbt.test_singular_nao_negativo: BEGIN
19:11:01.778196 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:11:01.781239 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
19:11:02.971599 [debug] [Thread-1  ]: SQL status: BEGIN in 1.19 seconds
19:11:02.976296 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.test_singular_nao_negativo"
19:11:02.979912 [debug] [Thread-1  ]: On test.analytics_dbt.test_singular_nao_negativo: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.test_singular_nao_negativo"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select *
    from tb_10_compradores
    where vendas_totais < 0
      
    ) dbt_internal_test
19:11:03.114718 [debug] [Thread-1  ]: SQL status: SELECT in 0.13 seconds
19:11:03.121130 [debug] [Thread-1  ]: finished collecting timing info
19:11:03.124426 [debug] [Thread-1  ]: On test.analytics_dbt.test_singular_nao_negativo: ROLLBACK
19:11:03.255985 [debug] [Thread-1  ]: On test.analytics_dbt.test_singular_nao_negativo: Close
19:11:03.262177 [info ] [Thread-1  ]: 3 of 5 PASS test_singular_nao_negativo ......................................... [[32mPASS[0m in 1.58s]
19:11:03.269161 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.test_singular_nao_negativo
19:11:03.275740 [debug] [Thread-1  ]: Began running node test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
19:11:03.280730 [info ] [Thread-1  ]: 4 of 5 START test unique_my_first_dbt_model_id ................................. [RUN]
19:11:03.288277 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"
19:11:03.297132 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
19:11:03.303430 [debug] [Thread-1  ]: Compiling test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
19:11:03.335714 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"
19:11:03.347912 [debug] [Thread-1  ]: finished collecting timing info
19:11:03.351108 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
19:11:03.358412 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"
19:11:03.367887 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"
19:11:03.371735 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321: BEGIN
19:11:03.376793 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:11:03.381256 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
19:11:04.562722 [debug] [Thread-1  ]: SQL status: BEGIN in 1.19 seconds
19:11:04.566419 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"
19:11:04.569467 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dev"."public"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
19:11:04.705537 [debug] [Thread-1  ]: SQL status: SELECT in 0.13 seconds
19:11:04.711820 [debug] [Thread-1  ]: finished collecting timing info
19:11:04.715766 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
19:11:04.846847 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321: Close
19:11:04.852880 [info ] [Thread-1  ]: 4 of 5 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 1.57s]
19:11:04.858974 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
19:11:04.864716 [debug] [Thread-1  ]: Began running node test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
19:11:04.873074 [info ] [Thread-1  ]: 5 of 5 START test unique_my_second_dbt_model_id ................................ [RUN]
19:11:04.881590 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"
19:11:04.893187 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
19:11:04.896966 [debug] [Thread-1  ]: Compiling test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
19:11:04.922029 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"
19:11:04.933360 [debug] [Thread-1  ]: finished collecting timing info
19:11:04.936993 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
19:11:04.948649 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"
19:11:04.963077 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"
19:11:04.965967 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493: BEGIN
19:11:04.969515 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:11:04.972522 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
19:11:06.158952 [debug] [Thread-1  ]: SQL status: BEGIN in 1.19 seconds
19:11:06.162244 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"
19:11:06.166224 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dev"."public"."my_second_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
19:11:06.300335 [debug] [Thread-1  ]: SQL status: SELECT in 0.13 seconds
19:11:06.306927 [debug] [Thread-1  ]: finished collecting timing info
19:11:06.313108 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493: ROLLBACK
19:11:06.444771 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493: Close
19:11:06.449251 [info ] [Thread-1  ]: 5 of 5 PASS unique_my_second_dbt_model_id ...................................... [[32mPASS[0m in 1.57s]
19:11:06.454695 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
19:11:06.463332 [debug] [MainThread]: Acquiring new redshift connection "master"
19:11:06.471346 [debug] [MainThread]: Using redshift connection "master"
19:11:06.478490 [debug] [MainThread]: On master: BEGIN
19:11:06.482186 [debug] [MainThread]: Opening a new connection, currently in state closed
19:11:06.492716 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
19:11:07.688068 [debug] [MainThread]: SQL status: BEGIN in 1.21 seconds
19:11:07.692150 [debug] [MainThread]: On master: COMMIT
19:11:07.695239 [debug] [MainThread]: Using redshift connection "master"
19:11:07.698141 [debug] [MainThread]: On master: COMMIT
19:11:07.828582 [debug] [MainThread]: SQL status: COMMIT in 0.13 seconds
19:11:07.833487 [debug] [MainThread]: On master: Close
19:11:07.837864 [info ] [MainThread]: 
19:11:07.842024 [info ] [MainThread]: Finished running 5 tests in 12.97s.
19:11:07.848706 [debug] [MainThread]: Connection 'master' was properly closed.
19:11:07.858175 [debug] [MainThread]: Connection 'test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
19:11:07.907865 [info ] [MainThread]: 
19:11:07.916827 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
19:11:07.923453 [info ] [MainThread]: 
19:11:07.935052 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models/example/schema.yml)[0m
19:11:07.953576 [error] [MainThread]:   Got 1 result, configured to fail if != 0
19:11:07.969463 [info ] [MainThread]: 
19:11:07.990760 [info ] [MainThread]:   compiled SQL at target/compiled/analytics_dbt/models/example/schema.yml/not_null_my_first_dbt_model_id.sql
19:11:08.007359 [info ] [MainThread]: 
19:11:08.023652 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
19:11:08.041915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feae2e92eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feae2e92fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feae2dacf40>]}


============================== 2022-05-23 19:12:40.332200 | 99b9a8d8-fd2b-4f7a-a672-a45679516628 ==============================
19:12:40.332301 [info ] [MainThread]: Running with dbt=1.1.0
19:12:40.338247 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
19:12:40.343385 [debug] [MainThread]: Tracking: tracking
19:12:40.390030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d2bd18400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d2bd184f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d2bd18520>]}
19:12:40.586729 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
19:12:40.591265 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
19:12:40.613465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '99b9a8d8-fd2b-4f7a-a672-a45679516628', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d2bc4ce80>]}
19:12:40.657724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '99b9a8d8-fd2b-4f7a-a672-a45679516628', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d2bc5fa30>]}
19:12:40.663197 [info ] [MainThread]: Found 5 models, 5 tests, 0 snapshots, 0 analyses, 194 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
19:12:40.667864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '99b9a8d8-fd2b-4f7a-a672-a45679516628', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d2bc5f940>]}
19:12:40.692492 [info ] [MainThread]: 
19:12:40.696569 [debug] [MainThread]: Acquiring new redshift connection "master"
19:12:40.740051 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev"
19:12:40.793595 [debug] [ThreadPool]: Using redshift connection "list_dev"
19:12:40.796720 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
  
19:12:40.800519 [debug] [ThreadPool]: Opening a new connection, currently in state init
19:12:40.804779 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
19:12:42.036060 [debug] [ThreadPool]: SQL status: SELECT in 1.24 seconds
19:12:42.041692 [debug] [ThreadPool]: On list_dev: Close
19:12:42.062929 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev_public"
19:12:42.101082 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
19:12:42.104956 [debug] [ThreadPool]: On list_dev_public: BEGIN
19:12:42.107283 [debug] [ThreadPool]: Opening a new connection, currently in state closed
19:12:42.109384 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
19:12:43.317648 [debug] [ThreadPool]: SQL status: BEGIN in 1.21 seconds
19:12:43.321078 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
19:12:43.323156 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev_public"} */
select
      'dev' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dev' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
19:12:43.469525 [debug] [ThreadPool]: SQL status: SELECT in 0.14 seconds
19:12:43.480167 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
19:12:43.612998 [debug] [ThreadPool]: On list_dev_public: Close
19:12:43.629926 [debug] [MainThread]: Using redshift connection "master"
19:12:43.632467 [debug] [MainThread]: On master: BEGIN
19:12:43.634672 [debug] [MainThread]: Opening a new connection, currently in state init
19:12:43.637987 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
19:12:44.807251 [debug] [MainThread]: SQL status: BEGIN in 1.17 seconds
19:12:44.810213 [debug] [MainThread]: Using redshift connection "master"
19:12:44.813805 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
19:12:44.979022 [debug] [MainThread]: SQL status: SELECT in 0.16 seconds
19:12:45.009948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '99b9a8d8-fd2b-4f7a-a672-a45679516628', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d2bc5f7f0>]}
19:12:45.039022 [debug] [MainThread]: On master: ROLLBACK
19:12:45.201221 [debug] [MainThread]: Using redshift connection "master"
19:12:45.207193 [debug] [MainThread]: On master: BEGIN
19:12:45.466924 [debug] [MainThread]: SQL status: BEGIN in 0.25 seconds
19:12:45.484121 [debug] [MainThread]: On master: COMMIT
19:12:45.488439 [debug] [MainThread]: Using redshift connection "master"
19:12:45.504318 [debug] [MainThread]: On master: COMMIT
19:12:45.661430 [debug] [MainThread]: SQL status: COMMIT in 0.13 seconds
19:12:45.664762 [debug] [MainThread]: On master: Close
19:12:45.670332 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
19:12:45.674505 [info ] [MainThread]: 
19:12:45.725714 [debug] [Thread-1  ]: Began running node model.analytics_dbt.my_first_dbt_model
19:12:45.739377 [info ] [Thread-1  ]: 1 of 5 START table model public.my_first_dbt_model ............................. [RUN]
19:12:45.772516 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.my_first_dbt_model"
19:12:45.797376 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.my_first_dbt_model
19:12:45.808489 [debug] [Thread-1  ]: Compiling model.analytics_dbt.my_first_dbt_model
19:12:45.843612 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.my_first_dbt_model"
19:12:45.874126 [debug] [Thread-1  ]: finished collecting timing info
19:12:45.883354 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.my_first_dbt_model
19:12:46.036280 [debug] [Thread-1  ]: Writing runtime SQL for node "model.analytics_dbt.my_first_dbt_model"
19:12:46.050007 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
19:12:46.054172 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: BEGIN
19:12:46.057828 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:12:46.062507 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
19:12:47.294553 [debug] [Thread-1  ]: SQL status: BEGIN in 1.24 seconds
19:12:47.299950 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
19:12:47.303207 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */


  create  table
    "dev"."public"."my_first_dbt_model__dbt_tmp"
    
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
19:12:47.913046 [debug] [Thread-1  ]: SQL status: SELECT in 0.61 seconds
19:12:47.945250 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
19:12:47.948958 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
alter table "dev"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
19:12:48.085681 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.13 seconds
19:12:48.104033 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
19:12:48.108133 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
alter table "dev"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
19:12:48.247197 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.13 seconds
19:12:48.280237 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: COMMIT
19:12:48.283332 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
19:12:48.288911 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: COMMIT
19:12:48.455773 [debug] [Thread-1  ]: SQL status: COMMIT in 0.16 seconds
19:12:48.459229 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
19:12:48.462731 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: BEGIN
19:12:48.596154 [debug] [Thread-1  ]: SQL status: BEGIN in 0.13 seconds
19:12:48.623361 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
19:12:48.625784 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
drop table if exists "dev"."public"."my_first_dbt_model__dbt_backup" cascade
19:12:48.764371 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.13 seconds
19:12:48.771968 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: COMMIT
19:12:48.783781 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
19:12:48.805872 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: COMMIT
19:12:48.969484 [debug] [Thread-1  ]: SQL status: COMMIT in 0.15 seconds
19:12:48.981015 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
19:12:48.991217 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: BEGIN
19:12:49.137475 [debug] [Thread-1  ]: SQL status: BEGIN in 0.13 seconds
19:12:49.140996 [debug] [Thread-1  ]: finished collecting timing info
19:12:49.144896 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: ROLLBACK
19:12:49.276879 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: Close
19:12:49.281546 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '99b9a8d8-fd2b-4f7a-a672-a45679516628', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d2b3aa460>]}
19:12:49.285200 [info ] [Thread-1  ]: 1 of 5 OK created table model public.my_first_dbt_model ........................ [[32mSELECT[0m in 3.51s]
19:12:49.290011 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.my_first_dbt_model
19:12:49.294254 [debug] [Thread-1  ]: Began running node model.analytics_dbt.vw_sales
19:12:49.303926 [info ] [Thread-1  ]: 2 of 5 START view model public.vw_sales ........................................ [RUN]
19:12:49.315030 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.vw_sales"
19:12:49.329873 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.vw_sales
19:12:49.341333 [debug] [Thread-1  ]: Compiling model.analytics_dbt.vw_sales
19:12:49.369675 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.vw_sales"
19:12:49.464747 [debug] [Thread-1  ]: finished collecting timing info
19:12:49.480437 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.vw_sales
19:12:49.590167 [debug] [Thread-1  ]: Writing runtime SQL for node "model.analytics_dbt.vw_sales"
19:12:49.609700 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
19:12:49.613190 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: BEGIN
19:12:49.618215 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:12:49.621390 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
19:12:50.810487 [debug] [Thread-1  ]: SQL status: BEGIN in 1.19 seconds
19:12:50.813679 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
19:12:50.815726 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */


  create view "dev"."public"."vw_sales__dbt_tmp" as (
    with source_sales as (
    select *
    from sales

),

renamed as (
    select
        SALESID AS ID_VENDA,
        LISTID AS ID_LISTA,
        SELLERID AS ID_VENDEDOR,
        BUYERID AS ID_COMPRADOR,
        EVENTID AS ID_EVENTO,
        DATEID AS ID_DATE,
        QTYSOLD AS QUANTIDADE_VENDIDA,
        PRICEPAID AS VALOR_PAGO,
        COMMISSION AS COMISSAO,
        TO_CHAR(saletime, 'dd/mm/yyyy HH24:MI:SS') AS DATA_HORA_VENDA,
        TO_CHAR(saletime, 'HH24:MI:SS') AS HORA_VENDA,
        cast(saletime as date) AS DATA_VENDA

  
    FROM source_sales

)

select * from renamed
  ) ;

19:12:50.953707 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.14 seconds
19:12:50.967747 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
19:12:50.971902 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */
alter table "dev"."public"."vw_sales" rename to "vw_sales__dbt_backup"
19:12:51.107837 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.13 seconds
19:12:51.115804 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
19:12:51.118537 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */
alter table "dev"."public"."vw_sales__dbt_tmp" rename to "vw_sales"
19:12:51.250759 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.13 seconds
19:12:51.256827 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: COMMIT
19:12:51.259959 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
19:12:51.262653 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: COMMIT
19:12:51.421227 [debug] [Thread-1  ]: SQL status: COMMIT in 0.16 seconds
19:12:51.425928 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
19:12:51.428918 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: BEGIN
19:12:51.562540 [debug] [Thread-1  ]: SQL status: BEGIN in 0.13 seconds
19:12:51.571310 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
19:12:51.573813 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */
drop view if exists "dev"."public"."vw_sales__dbt_backup" cascade
19:12:51.708807 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.13 seconds
19:12:51.713188 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: COMMIT
19:12:51.716108 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
19:12:51.719040 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: COMMIT
19:12:51.875068 [debug] [Thread-1  ]: SQL status: COMMIT in 0.15 seconds
19:12:51.878162 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
19:12:51.881090 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: BEGIN
19:12:52.013510 [debug] [Thread-1  ]: SQL status: BEGIN in 0.13 seconds
19:12:52.017014 [debug] [Thread-1  ]: finished collecting timing info
19:12:52.021106 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: ROLLBACK
19:12:52.155488 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: Close
19:12:52.159839 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '99b9a8d8-fd2b-4f7a-a672-a45679516628', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d2b3c4d30>]}
19:12:52.163650 [info ] [Thread-1  ]: 2 of 5 OK created view model public.vw_sales ................................... [[32mCREATE VIEW[0m in 2.85s]
19:12:52.168092 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.vw_sales
19:12:52.173761 [debug] [Thread-1  ]: Began running node model.analytics_dbt.my_second_dbt_model
19:12:52.180150 [info ] [Thread-1  ]: 3 of 5 START view model public.my_second_dbt_model ............................. [RUN]
19:12:52.197030 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.my_second_dbt_model"
19:12:52.209097 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.my_second_dbt_model
19:12:52.215194 [debug] [Thread-1  ]: Compiling model.analytics_dbt.my_second_dbt_model
19:12:52.239008 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.my_second_dbt_model"
19:12:52.277851 [debug] [Thread-1  ]: finished collecting timing info
19:12:52.287448 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.my_second_dbt_model
19:12:52.302074 [debug] [Thread-1  ]: Writing runtime SQL for node "model.analytics_dbt.my_second_dbt_model"
19:12:52.321250 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
19:12:52.325867 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: BEGIN
19:12:52.330377 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:12:52.333939 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
19:12:53.550396 [debug] [Thread-1  ]: SQL status: BEGIN in 1.22 seconds
19:12:53.553386 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
19:12:53.556682 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */


  create view "dev"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."public"."my_first_dbt_model"
where id = 1
  ) ;

19:12:53.692812 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.13 seconds
19:12:53.724039 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
19:12:53.734002 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */
alter table "dev"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
19:12:53.872639 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.13 seconds
19:12:53.877899 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: COMMIT
19:12:53.881017 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
19:12:53.883729 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: COMMIT
19:12:54.046818 [debug] [Thread-1  ]: SQL status: COMMIT in 0.16 seconds
19:12:54.050436 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
19:12:54.053047 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: BEGIN
19:12:54.184804 [debug] [Thread-1  ]: SQL status: BEGIN in 0.13 seconds
19:12:54.192306 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
19:12:54.194669 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */
drop view if exists "dev"."public"."my_second_dbt_model__dbt_backup" cascade
19:12:54.331802 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.13 seconds
19:12:54.340989 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: COMMIT
19:12:54.344678 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
19:12:54.349577 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: COMMIT
19:12:54.509108 [debug] [Thread-1  ]: SQL status: COMMIT in 0.16 seconds
19:12:54.513865 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
19:12:54.517610 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: BEGIN
19:12:54.648977 [debug] [Thread-1  ]: SQL status: BEGIN in 0.13 seconds
19:12:54.652479 [debug] [Thread-1  ]: finished collecting timing info
19:12:54.655498 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: ROLLBACK
19:12:54.786904 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: Close
19:12:54.791944 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '99b9a8d8-fd2b-4f7a-a672-a45679516628', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d29b01460>]}
19:12:54.795749 [info ] [Thread-1  ]: 3 of 5 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 2.60s]
19:12:54.800529 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.my_second_dbt_model
19:12:54.804685 [debug] [Thread-1  ]: Began running node model.analytics_dbt.tb_10_compradores
19:12:54.813037 [info ] [Thread-1  ]: 4 of 5 START table model public.tb_10_compradores .............................. [RUN]
19:12:54.823395 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.tb_10_compradores"
19:12:54.833208 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.tb_10_compradores
19:12:54.838059 [debug] [Thread-1  ]: Compiling model.analytics_dbt.tb_10_compradores
19:12:54.863339 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.tb_10_compradores"
19:12:54.893290 [debug] [Thread-1  ]: finished collecting timing info
19:12:54.898800 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.tb_10_compradores
19:12:54.918153 [debug] [Thread-1  ]: Writing runtime SQL for node "model.analytics_dbt.tb_10_compradores"
19:12:54.935561 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_10_compradores"
19:12:54.939118 [debug] [Thread-1  ]: On model.analytics_dbt.tb_10_compradores: BEGIN
19:12:54.946476 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:12:54.949918 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
19:12:56.163548 [debug] [Thread-1  ]: SQL status: BEGIN in 1.22 seconds
19:12:56.166667 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_10_compradores"
19:12:56.169943 [debug] [Thread-1  ]: On model.analytics_dbt.tb_10_compradores: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.tb_10_compradores"} */


  create  table
    "dev"."public"."tb_10_compradores__dbt_tmp"
    
    
    
  as (
    with sales as (

    select * from "dev"."public"."vw_sales"

),
compradores as (

    SELECT
        (firstname ||' '|| lastname) as Nome_Completo, userid
    FROM users
),

top_10_compradores as (

    SELECT
        compradores.Nome_Completo as Nome_Completo,
        sum(sales.quantidade_vendida) as Vendas_totais,
        sales.comissao as Comissao
    FROM sales INNER JOIN compradores
    ON sales.id_comprador = compradores.userid
    GROUP BY compradores.userid, compradores.Nome_Completo, sales.comissao
    ORDER BY Vendas_totais DESC
    LIMIT 10

)

select * from top_10_compradores
  );
19:13:13.632755 [debug] [Thread-1  ]: SQL status: SELECT in 17.46 seconds
19:13:13.643977 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_10_compradores"
19:13:13.647481 [debug] [Thread-1  ]: On model.analytics_dbt.tb_10_compradores: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.tb_10_compradores"} */
alter table "dev"."public"."tb_10_compradores" rename to "tb_10_compradores__dbt_backup"
19:13:13.782493 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.13 seconds
19:13:13.800729 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_10_compradores"
19:13:13.805058 [debug] [Thread-1  ]: On model.analytics_dbt.tb_10_compradores: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.tb_10_compradores"} */
alter table "dev"."public"."tb_10_compradores__dbt_tmp" rename to "tb_10_compradores"
19:13:13.940444 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.13 seconds
19:13:13.949737 [debug] [Thread-1  ]: On model.analytics_dbt.tb_10_compradores: COMMIT
19:13:13.953471 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_10_compradores"
19:13:13.957947 [debug] [Thread-1  ]: On model.analytics_dbt.tb_10_compradores: COMMIT
19:13:14.133520 [debug] [Thread-1  ]: SQL status: COMMIT in 0.17 seconds
19:13:14.137625 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_10_compradores"
19:13:14.141306 [debug] [Thread-1  ]: On model.analytics_dbt.tb_10_compradores: BEGIN
19:13:14.275896 [debug] [Thread-1  ]: SQL status: BEGIN in 0.13 seconds
19:13:14.285229 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_10_compradores"
19:13:14.288575 [debug] [Thread-1  ]: On model.analytics_dbt.tb_10_compradores: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.tb_10_compradores"} */
drop table if exists "dev"."public"."tb_10_compradores__dbt_backup" cascade
19:13:14.424448 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.13 seconds
19:13:14.428573 [debug] [Thread-1  ]: On model.analytics_dbt.tb_10_compradores: COMMIT
19:13:14.431825 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_10_compradores"
19:13:14.434062 [debug] [Thread-1  ]: On model.analytics_dbt.tb_10_compradores: COMMIT
19:13:14.595213 [debug] [Thread-1  ]: SQL status: COMMIT in 0.16 seconds
19:13:14.597660 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_10_compradores"
19:13:14.600083 [debug] [Thread-1  ]: On model.analytics_dbt.tb_10_compradores: BEGIN
19:13:14.741819 [debug] [Thread-1  ]: SQL status: BEGIN in 0.14 seconds
19:13:14.745688 [debug] [Thread-1  ]: finished collecting timing info
19:13:14.748394 [debug] [Thread-1  ]: On model.analytics_dbt.tb_10_compradores: ROLLBACK
19:13:14.882226 [debug] [Thread-1  ]: On model.analytics_dbt.tb_10_compradores: Close
19:13:14.886617 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '99b9a8d8-fd2b-4f7a-a672-a45679516628', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d2b3c4b50>]}
19:13:14.890075 [info ] [Thread-1  ]: 4 of 5 OK created table model public.tb_10_compradores ......................... [[32mSELECT[0m in 20.06s]
19:13:14.893844 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.tb_10_compradores
19:13:14.900881 [debug] [Thread-1  ]: Began running node model.analytics_dbt.tb_vendas_primeiro_trimestre
19:13:14.908520 [info ] [Thread-1  ]: 5 of 5 START table model public.tb_vendas_primeiro_trimestre ................... [RUN]
19:13:14.921472 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.tb_vendas_primeiro_trimestre"
19:13:14.931925 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.tb_vendas_primeiro_trimestre
19:13:14.940265 [debug] [Thread-1  ]: Compiling model.analytics_dbt.tb_vendas_primeiro_trimestre
19:13:14.973897 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.tb_vendas_primeiro_trimestre"
19:13:15.008445 [debug] [Thread-1  ]: finished collecting timing info
19:13:15.012113 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.tb_vendas_primeiro_trimestre
19:13:15.035398 [debug] [Thread-1  ]: Writing runtime SQL for node "model.analytics_dbt.tb_vendas_primeiro_trimestre"
19:13:15.048161 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_vendas_primeiro_trimestre"
19:13:15.052814 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: BEGIN
19:13:15.056596 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:13:15.062386 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
19:13:16.233214 [debug] [Thread-1  ]: SQL status: BEGIN in 1.18 seconds
19:13:16.236096 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_vendas_primeiro_trimestre"
19:13:16.239009 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.tb_vendas_primeiro_trimestre"} */


  create  table
    "dev"."public"."tb_vendas_primeiro_trimestre__dbt_tmp"
    
    
    
  as (
    -- define o as variáveis meses e ano



-- cria a fonte com os dados de date e converte o  nome das colunas
with source_date as (
    select  dateid as id_date,
            month as mes,
            year as ano
    from date

),
-- cria uma fonte de dados unindo a tabela sales com date
sales_date as (

    select  source_date.mes, 
            sum(quantidade_vendida)
    from  "dev"."public"."vw_sales" sales inner join source_date
    on sales.id_date = source_date.id_date
    where source_date.mes in ('JAN', 'FEB', 'MAR')
    and source_date.ano = '2008'
    group by source_date.mes
)
select * from sales_date
  );
19:13:16.443552 [debug] [Thread-1  ]: SQL status: SELECT in 0.2 seconds
19:13:16.454170 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_vendas_primeiro_trimestre"
19:13:16.458348 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.tb_vendas_primeiro_trimestre"} */
alter table "dev"."public"."tb_vendas_primeiro_trimestre" rename to "tb_vendas_primeiro_trimestre__dbt_backup"
19:13:16.592667 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.13 seconds
19:13:16.599172 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_vendas_primeiro_trimestre"
19:13:16.601713 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.tb_vendas_primeiro_trimestre"} */
alter table "dev"."public"."tb_vendas_primeiro_trimestre__dbt_tmp" rename to "tb_vendas_primeiro_trimestre"
19:13:16.732675 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.13 seconds
19:13:16.744384 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: COMMIT
19:13:16.750925 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_vendas_primeiro_trimestre"
19:13:16.756927 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: COMMIT
19:13:16.924877 [debug] [Thread-1  ]: SQL status: COMMIT in 0.16 seconds
19:13:16.928623 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_vendas_primeiro_trimestre"
19:13:16.931861 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: BEGIN
19:13:17.064059 [debug] [Thread-1  ]: SQL status: BEGIN in 0.13 seconds
19:13:17.071038 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_vendas_primeiro_trimestre"
19:13:17.074098 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.tb_vendas_primeiro_trimestre"} */
drop table if exists "dev"."public"."tb_vendas_primeiro_trimestre__dbt_backup" cascade
19:13:17.206563 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.13 seconds
19:13:17.211951 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: COMMIT
19:13:17.214830 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_vendas_primeiro_trimestre"
19:13:17.217651 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: COMMIT
19:13:17.371767 [debug] [Thread-1  ]: SQL status: COMMIT in 0.15 seconds
19:13:17.375848 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_vendas_primeiro_trimestre"
19:13:17.378937 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: BEGIN
19:13:17.510894 [debug] [Thread-1  ]: SQL status: BEGIN in 0.13 seconds
19:13:17.514318 [debug] [Thread-1  ]: finished collecting timing info
19:13:17.517339 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: ROLLBACK
19:13:17.648090 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: Close
19:13:17.652853 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '99b9a8d8-fd2b-4f7a-a672-a45679516628', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d29b18760>]}
19:13:17.656913 [info ] [Thread-1  ]: 5 of 5 OK created table model public.tb_vendas_primeiro_trimestre .............. [[32mSELECT[0m in 2.73s]
19:13:17.661455 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.tb_vendas_primeiro_trimestre
19:13:17.672900 [debug] [MainThread]: Acquiring new redshift connection "master"
19:13:17.680465 [debug] [MainThread]: Using redshift connection "master"
19:13:17.689944 [debug] [MainThread]: On master: BEGIN
19:13:17.693295 [debug] [MainThread]: Opening a new connection, currently in state closed
19:13:17.701578 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
19:13:18.874244 [debug] [MainThread]: SQL status: BEGIN in 1.18 seconds
19:13:18.877773 [debug] [MainThread]: On master: COMMIT
19:13:18.880322 [debug] [MainThread]: Using redshift connection "master"
19:13:18.883795 [debug] [MainThread]: On master: COMMIT
19:13:19.014493 [debug] [MainThread]: SQL status: COMMIT in 0.13 seconds
19:13:19.018090 [debug] [MainThread]: On master: Close
19:13:19.023258 [info ] [MainThread]: 
19:13:19.027076 [info ] [MainThread]: Finished running 3 table models, 2 view models in 38.33s.
19:13:19.034327 [debug] [MainThread]: Connection 'master' was properly closed.
19:13:19.046219 [debug] [MainThread]: Connection 'model.analytics_dbt.tb_vendas_primeiro_trimestre' was properly closed.
19:13:19.128349 [info ] [MainThread]: 
19:13:19.135995 [info ] [MainThread]: [32mCompleted successfully[0m
19:13:19.146100 [info ] [MainThread]: 
19:13:19.152876 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
19:13:19.163790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d2bcc2df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d29b18e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d29b18dc0>]}


============================== 2022-05-23 19:21:42.127753 | eb6f2fe3-fd24-46f6-a11e-27d6ef7ed8cd ==============================
19:21:42.127773 [info ] [MainThread]: Running with dbt=1.1.0
19:21:42.131728 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
19:21:42.142183 [debug] [MainThread]: Tracking: tracking
19:21:42.190195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f25f287c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f25f28880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f25f288b0>]}
19:21:42.336178 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
19:21:42.339882 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
19:21:42.361636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eb6f2fe3-fd24-46f6-a11e-27d6ef7ed8cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f25e5dee0>]}
19:21:42.400480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eb6f2fe3-fd24-46f6-a11e-27d6ef7ed8cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f25ee5ac0>]}
19:21:42.406255 [info ] [MainThread]: Found 5 models, 5 tests, 0 snapshots, 0 analyses, 194 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
19:21:42.413121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eb6f2fe3-fd24-46f6-a11e-27d6ef7ed8cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f25ee59a0>]}
19:21:42.436220 [info ] [MainThread]: 
19:21:42.449698 [debug] [MainThread]: Acquiring new redshift connection "master"
19:21:42.466963 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev"
19:21:42.532948 [debug] [ThreadPool]: Using redshift connection "list_dev"
19:21:42.537301 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
  
19:21:42.541936 [debug] [ThreadPool]: Opening a new connection, currently in state init
19:21:42.545958 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
19:21:43.863474 [debug] [ThreadPool]: SQL status: SELECT in 1.32 seconds
19:21:43.872754 [debug] [ThreadPool]: On list_dev: Close
19:21:43.881440 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev_public"
19:21:43.903295 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
19:21:43.906583 [debug] [ThreadPool]: On list_dev_public: BEGIN
19:21:43.909181 [debug] [ThreadPool]: Opening a new connection, currently in state closed
19:21:43.912087 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
19:21:45.105315 [debug] [ThreadPool]: SQL status: BEGIN in 1.2 seconds
19:21:45.108341 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
19:21:45.110732 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev_public"} */
select
      'dev' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dev' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
19:21:45.251741 [debug] [ThreadPool]: SQL status: SELECT in 0.14 seconds
19:21:45.258433 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
19:21:45.390360 [debug] [ThreadPool]: On list_dev_public: Close
19:21:45.406480 [debug] [MainThread]: Using redshift connection "master"
19:21:45.409330 [debug] [MainThread]: On master: BEGIN
19:21:45.412249 [debug] [MainThread]: Opening a new connection, currently in state init
19:21:45.415774 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
19:21:46.614674 [debug] [MainThread]: SQL status: BEGIN in 1.2 seconds
19:21:46.617643 [debug] [MainThread]: Using redshift connection "master"
19:21:46.621937 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
19:21:46.789945 [debug] [MainThread]: SQL status: SELECT in 0.16 seconds
19:21:46.795327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eb6f2fe3-fd24-46f6-a11e-27d6ef7ed8cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f25f3c7c0>]}
19:21:46.799407 [debug] [MainThread]: On master: ROLLBACK
19:21:46.932685 [debug] [MainThread]: Using redshift connection "master"
19:21:46.935799 [debug] [MainThread]: On master: BEGIN
19:21:47.202346 [debug] [MainThread]: SQL status: BEGIN in 0.26 seconds
19:21:47.207204 [debug] [MainThread]: On master: COMMIT
19:21:47.209774 [debug] [MainThread]: Using redshift connection "master"
19:21:47.212068 [debug] [MainThread]: On master: COMMIT
19:21:47.344759 [debug] [MainThread]: SQL status: COMMIT in 0.13 seconds
19:21:47.348459 [debug] [MainThread]: On master: Close
19:21:47.352457 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
19:21:47.355450 [info ] [MainThread]: 
19:21:47.383110 [debug] [Thread-1  ]: Began running node model.analytics_dbt.my_first_dbt_model
19:21:47.396164 [info ] [Thread-1  ]: 1 of 5 START table model public.my_first_dbt_model ............................. [RUN]
19:21:47.406957 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.my_first_dbt_model"
19:21:47.418435 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.my_first_dbt_model
19:21:47.430199 [debug] [Thread-1  ]: Compiling model.analytics_dbt.my_first_dbt_model
19:21:47.453003 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.my_first_dbt_model"
19:21:47.471297 [debug] [Thread-1  ]: finished collecting timing info
19:21:47.480164 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.my_first_dbt_model
19:21:47.569372 [debug] [Thread-1  ]: Writing runtime SQL for node "model.analytics_dbt.my_first_dbt_model"
19:21:47.579017 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
19:21:47.582834 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: BEGIN
19:21:47.586752 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:21:47.591374 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
19:21:48.765847 [debug] [Thread-1  ]: SQL status: BEGIN in 1.18 seconds
19:21:48.769370 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
19:21:48.772237 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */


  create  table
    "dev"."public"."my_first_dbt_model__dbt_tmp"
    
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
19:21:48.960254 [debug] [Thread-1  ]: SQL status: SELECT in 0.18 seconds
19:21:48.978149 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
19:21:48.980504 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
alter table "dev"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
19:21:49.112216 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.13 seconds
19:21:49.122558 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
19:21:49.126419 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
alter table "dev"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
19:21:49.259230 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.13 seconds
19:21:49.292220 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: COMMIT
19:21:49.294968 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
19:21:49.297522 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: COMMIT
19:21:49.467955 [debug] [Thread-1  ]: SQL status: COMMIT in 0.17 seconds
19:21:49.471288 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
19:21:49.473945 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: BEGIN
19:21:49.613460 [debug] [Thread-1  ]: SQL status: BEGIN in 0.14 seconds
19:21:49.628415 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
19:21:49.630920 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
drop table if exists "dev"."public"."my_first_dbt_model__dbt_backup" cascade
19:21:49.765900 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.13 seconds
19:21:49.769999 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: COMMIT
19:21:49.772728 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
19:21:49.775773 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: COMMIT
19:21:49.938095 [debug] [Thread-1  ]: SQL status: COMMIT in 0.16 seconds
19:21:49.942689 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
19:21:49.945370 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: BEGIN
19:21:50.077791 [debug] [Thread-1  ]: SQL status: BEGIN in 0.13 seconds
19:21:50.081884 [debug] [Thread-1  ]: finished collecting timing info
19:21:50.084816 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: ROLLBACK
19:21:50.217762 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: Close
19:21:50.223449 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb6f2fe3-fd24-46f6-a11e-27d6ef7ed8cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f255bc220>]}
19:21:50.226529 [info ] [Thread-1  ]: 1 of 5 OK created table model public.my_first_dbt_model ........................ [[32mSELECT[0m in 2.82s]
19:21:50.230334 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.my_first_dbt_model
19:21:50.234921 [debug] [Thread-1  ]: Began running node model.analytics_dbt.vw_sales
19:21:50.241537 [info ] [Thread-1  ]: 2 of 5 START view model public.vw_sales ........................................ [RUN]
19:21:50.249102 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.vw_sales"
19:21:50.262028 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.vw_sales
19:21:50.265322 [debug] [Thread-1  ]: Compiling model.analytics_dbt.vw_sales
19:21:50.272764 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.vw_sales"
19:21:50.298373 [debug] [Thread-1  ]: finished collecting timing info
19:21:50.303964 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.vw_sales
19:21:50.356277 [debug] [Thread-1  ]: Writing runtime SQL for node "model.analytics_dbt.vw_sales"
19:21:50.364028 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
19:21:50.367455 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: BEGIN
19:21:50.370949 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:21:50.374240 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
19:21:51.549022 [debug] [Thread-1  ]: SQL status: BEGIN in 1.18 seconds
19:21:51.552021 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
19:21:51.554663 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */


  create view "dev"."public"."vw_sales__dbt_tmp" as (
    with source_sales as (
    select *
    from sales

),

renamed as (
    select
        SALESID AS ID_VENDA,
        LISTID AS ID_LISTA,
        SELLERID AS ID_VENDEDOR,
        BUYERID AS ID_COMPRADOR,
        EVENTID AS ID_EVENTO,
        DATEID AS ID_DATE,
        QTYSOLD AS QUANTIDADE_VENDIDA,
        PRICEPAID AS VALOR_PAGO,
        COMMISSION AS COMISSAO,
        TO_CHAR(saletime, 'dd/mm/yyyy HH24:MI:SS') AS DATA_HORA_VENDA,
        TO_CHAR(saletime, 'HH24:MI:SS') AS HORA_VENDA,
        cast(saletime as date) AS DATA_VENDA

  
    FROM source_sales

)

select * from renamed
  ) ;

19:21:51.689380 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.13 seconds
19:21:51.697197 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
19:21:51.700004 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */
alter table "dev"."public"."vw_sales" rename to "vw_sales__dbt_backup"
19:21:51.831068 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.13 seconds
19:21:51.841550 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
19:21:51.844745 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */
alter table "dev"."public"."vw_sales__dbt_tmp" rename to "vw_sales"
19:21:51.976511 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.13 seconds
19:21:51.983501 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: COMMIT
19:21:51.986039 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
19:21:51.989132 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: COMMIT
19:21:52.145774 [debug] [Thread-1  ]: SQL status: COMMIT in 0.15 seconds
19:21:52.149524 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
19:21:52.152318 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: BEGIN
19:21:52.288299 [debug] [Thread-1  ]: SQL status: BEGIN in 0.13 seconds
19:21:52.294549 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
19:21:52.297268 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */
drop view if exists "dev"."public"."vw_sales__dbt_backup" cascade
19:21:52.431587 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.13 seconds
19:21:52.436354 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: COMMIT
19:21:52.438743 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
19:21:52.441766 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: COMMIT
19:21:52.597088 [debug] [Thread-1  ]: SQL status: COMMIT in 0.15 seconds
19:21:52.600522 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
19:21:52.603714 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: BEGIN
19:21:52.733741 [debug] [Thread-1  ]: SQL status: BEGIN in 0.13 seconds
19:21:52.737913 [debug] [Thread-1  ]: finished collecting timing info
19:21:52.739965 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: ROLLBACK
19:21:52.873274 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: Close
19:21:52.878773 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb6f2fe3-fd24-46f6-a11e-27d6ef7ed8cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f255b0040>]}
19:21:52.881381 [info ] [Thread-1  ]: 2 of 5 OK created view model public.vw_sales ................................... [[32mCREATE VIEW[0m in 2.63s]
19:21:52.885096 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.vw_sales
19:21:52.890290 [debug] [Thread-1  ]: Began running node model.analytics_dbt.my_second_dbt_model
19:21:52.898038 [info ] [Thread-1  ]: 3 of 5 START view model public.my_second_dbt_model ............................. [RUN]
19:21:52.909253 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.my_second_dbt_model"
19:21:52.916234 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.my_second_dbt_model
19:21:52.920183 [debug] [Thread-1  ]: Compiling model.analytics_dbt.my_second_dbt_model
19:21:52.946278 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.my_second_dbt_model"
19:21:52.954109 [debug] [Thread-1  ]: finished collecting timing info
19:21:52.963582 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.my_second_dbt_model
19:21:52.977199 [debug] [Thread-1  ]: Writing runtime SQL for node "model.analytics_dbt.my_second_dbt_model"
19:21:52.985173 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
19:21:52.989180 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: BEGIN
19:21:52.993198 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:21:52.995501 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
19:21:54.176291 [debug] [Thread-1  ]: SQL status: BEGIN in 1.18 seconds
19:21:54.179078 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
19:21:54.181925 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */


  create view "dev"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."public"."my_first_dbt_model"
where id = 1
  ) ;

19:21:54.316771 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.13 seconds
19:21:54.327765 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
19:21:54.332363 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */
alter table "dev"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
19:21:54.463053 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.13 seconds
19:21:54.470792 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: COMMIT
19:21:54.474260 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
19:21:54.477765 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: COMMIT
19:21:54.634505 [debug] [Thread-1  ]: SQL status: COMMIT in 0.15 seconds
19:21:54.638394 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
19:21:54.640836 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: BEGIN
19:21:54.771108 [debug] [Thread-1  ]: SQL status: BEGIN in 0.13 seconds
19:21:54.777365 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
19:21:54.779961 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */
drop view if exists "dev"."public"."my_second_dbt_model__dbt_backup" cascade
19:21:54.910470 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.13 seconds
19:21:54.916520 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: COMMIT
19:21:54.918982 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
19:21:54.921395 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: COMMIT
19:21:55.071812 [debug] [Thread-1  ]: SQL status: COMMIT in 0.15 seconds
19:21:55.075203 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
19:21:55.078025 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: BEGIN
19:21:55.206584 [debug] [Thread-1  ]: SQL status: BEGIN in 0.13 seconds
19:21:55.210750 [debug] [Thread-1  ]: finished collecting timing info
19:21:55.213287 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: ROLLBACK
19:21:55.344962 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: Close
19:21:55.350109 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb6f2fe3-fd24-46f6-a11e-27d6ef7ed8cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f244e0310>]}
19:21:55.353520 [info ] [Thread-1  ]: 3 of 5 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 2.44s]
19:21:55.357929 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.my_second_dbt_model
19:21:55.362041 [debug] [Thread-1  ]: Began running node model.analytics_dbt.tb_10_compradores
19:21:55.367401 [info ] [Thread-1  ]: 4 of 5 START table model public.tb_10_compradores .............................. [RUN]
19:21:55.377621 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.tb_10_compradores"
19:21:55.387276 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.tb_10_compradores
19:21:55.392679 [debug] [Thread-1  ]: Compiling model.analytics_dbt.tb_10_compradores
19:21:55.413709 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.tb_10_compradores"
19:21:55.435536 [debug] [Thread-1  ]: finished collecting timing info
19:21:55.439879 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.tb_10_compradores
19:21:55.454063 [debug] [Thread-1  ]: Writing runtime SQL for node "model.analytics_dbt.tb_10_compradores"
19:21:55.461977 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_10_compradores"
19:21:55.465370 [debug] [Thread-1  ]: On model.analytics_dbt.tb_10_compradores: BEGIN
19:21:55.468102 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:21:55.470820 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
19:21:56.665548 [debug] [Thread-1  ]: SQL status: BEGIN in 1.2 seconds
19:21:56.668339 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_10_compradores"
19:21:56.671488 [debug] [Thread-1  ]: On model.analytics_dbt.tb_10_compradores: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.tb_10_compradores"} */


  create  table
    "dev"."public"."tb_10_compradores__dbt_tmp"
    
    
    
  as (
    with sales as (

    select * from "dev"."public"."vw_sales"

),
compradores as (

    SELECT
        (firstname ||' '|| lastname) as Nome_Completo, userid
    FROM users
),

top_10_compradores as (

    SELECT
        compradores.Nome_Completo as Nome_Completo,
        sum(sales.quantidade_vendida) as Vendas_totais,
        sales.comissao as Comissao
    FROM sales INNER JOIN compradores
    ON sales.id_comprador = compradores.userid
    GROUP BY compradores.userid, compradores.Nome_Completo, sales.comissao
    ORDER BY Vendas_totais DESC
    LIMIT 10

)

select * from top_10_compradores
  );
19:21:57.145378 [debug] [Thread-1  ]: SQL status: SELECT in 0.47 seconds
19:21:57.154523 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_10_compradores"
19:21:57.157472 [debug] [Thread-1  ]: On model.analytics_dbt.tb_10_compradores: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.tb_10_compradores"} */
alter table "dev"."public"."tb_10_compradores" rename to "tb_10_compradores__dbt_backup"
19:21:57.296829 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.14 seconds
19:21:57.304884 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_10_compradores"
19:21:57.307905 [debug] [Thread-1  ]: On model.analytics_dbt.tb_10_compradores: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.tb_10_compradores"} */
alter table "dev"."public"."tb_10_compradores__dbt_tmp" rename to "tb_10_compradores"
19:21:57.438140 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.13 seconds
19:21:57.451158 [debug] [Thread-1  ]: On model.analytics_dbt.tb_10_compradores: COMMIT
19:21:57.455323 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_10_compradores"
19:21:57.458433 [debug] [Thread-1  ]: On model.analytics_dbt.tb_10_compradores: COMMIT
19:21:57.629499 [debug] [Thread-1  ]: SQL status: COMMIT in 0.17 seconds
19:21:57.634415 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_10_compradores"
19:21:57.636837 [debug] [Thread-1  ]: On model.analytics_dbt.tb_10_compradores: BEGIN
19:21:57.766860 [debug] [Thread-1  ]: SQL status: BEGIN in 0.13 seconds
19:21:57.772948 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_10_compradores"
19:21:57.775603 [debug] [Thread-1  ]: On model.analytics_dbt.tb_10_compradores: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.tb_10_compradores"} */
drop table if exists "dev"."public"."tb_10_compradores__dbt_backup" cascade
19:21:57.907780 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.13 seconds
19:21:57.912922 [debug] [Thread-1  ]: On model.analytics_dbt.tb_10_compradores: COMMIT
19:21:57.915924 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_10_compradores"
19:21:57.919221 [debug] [Thread-1  ]: On model.analytics_dbt.tb_10_compradores: COMMIT
19:21:58.076813 [debug] [Thread-1  ]: SQL status: COMMIT in 0.15 seconds
19:21:58.080058 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_10_compradores"
19:21:58.083456 [debug] [Thread-1  ]: On model.analytics_dbt.tb_10_compradores: BEGIN
19:21:58.213824 [debug] [Thread-1  ]: SQL status: BEGIN in 0.13 seconds
19:21:58.217484 [debug] [Thread-1  ]: finished collecting timing info
19:21:58.220175 [debug] [Thread-1  ]: On model.analytics_dbt.tb_10_compradores: ROLLBACK
19:21:58.349865 [debug] [Thread-1  ]: On model.analytics_dbt.tb_10_compradores: Close
19:21:58.354513 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb6f2fe3-fd24-46f6-a11e-27d6ef7ed8cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f255d6bb0>]}
19:21:58.357825 [info ] [Thread-1  ]: 4 of 5 OK created table model public.tb_10_compradores ......................... [[32mSELECT[0m in 2.98s]
19:21:58.362269 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.tb_10_compradores
19:21:58.367303 [debug] [Thread-1  ]: Began running node model.analytics_dbt.tb_vendas_primeiro_trimestre
19:21:58.374619 [info ] [Thread-1  ]: 5 of 5 START table model public.tb_vendas_primeiro_trimestre ................... [RUN]
19:21:58.388381 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.tb_vendas_primeiro_trimestre"
19:21:58.403491 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.tb_vendas_primeiro_trimestre
19:21:58.409229 [debug] [Thread-1  ]: Compiling model.analytics_dbt.tb_vendas_primeiro_trimestre
19:21:58.434708 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.tb_vendas_primeiro_trimestre"
19:21:58.456081 [debug] [Thread-1  ]: finished collecting timing info
19:21:58.461915 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.tb_vendas_primeiro_trimestre
19:21:58.474952 [debug] [Thread-1  ]: Writing runtime SQL for node "model.analytics_dbt.tb_vendas_primeiro_trimestre"
19:21:58.484400 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_vendas_primeiro_trimestre"
19:21:58.487384 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: BEGIN
19:21:58.490560 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:21:58.494056 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
19:21:59.658995 [debug] [Thread-1  ]: SQL status: BEGIN in 1.17 seconds
19:21:59.662311 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_vendas_primeiro_trimestre"
19:21:59.665037 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.tb_vendas_primeiro_trimestre"} */


  create  table
    "dev"."public"."tb_vendas_primeiro_trimestre__dbt_tmp"
    
    
    
  as (
    -- define o as variáveis meses e ano



-- cria a fonte com os dados de date e converte o  nome das colunas
with source_date as (
    select  dateid as id_date,
            month as mes,
            year as ano
    from date

),
-- cria uma fonte de dados unindo a tabela sales com date
sales_date as (

    select  source_date.mes, 
            sum(quantidade_vendida)
    from  "dev"."public"."vw_sales" sales inner join source_date
    on sales.id_date = source_date.id_date
    where source_date.mes in ('JAN', 'FEB', 'MAR')
    and source_date.ano = '2008'
    group by source_date.mes
)
select * from sales_date
  );
19:21:59.862580 [debug] [Thread-1  ]: SQL status: SELECT in 0.19 seconds
19:21:59.871376 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_vendas_primeiro_trimestre"
19:21:59.874775 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.tb_vendas_primeiro_trimestre"} */
alter table "dev"."public"."tb_vendas_primeiro_trimestre" rename to "tb_vendas_primeiro_trimestre__dbt_backup"
19:22:00.005939 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.13 seconds
19:22:00.015917 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_vendas_primeiro_trimestre"
19:22:00.019297 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.tb_vendas_primeiro_trimestre"} */
alter table "dev"."public"."tb_vendas_primeiro_trimestre__dbt_tmp" rename to "tb_vendas_primeiro_trimestre"
19:22:00.150059 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.13 seconds
19:22:00.157247 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: COMMIT
19:22:00.159681 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_vendas_primeiro_trimestre"
19:22:00.162264 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: COMMIT
19:22:00.328614 [debug] [Thread-1  ]: SQL status: COMMIT in 0.16 seconds
19:22:00.332490 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_vendas_primeiro_trimestre"
19:22:00.335854 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: BEGIN
19:22:00.465280 [debug] [Thread-1  ]: SQL status: BEGIN in 0.13 seconds
19:22:00.475962 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_vendas_primeiro_trimestre"
19:22:00.479410 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.tb_vendas_primeiro_trimestre"} */
drop table if exists "dev"."public"."tb_vendas_primeiro_trimestre__dbt_backup" cascade
19:22:00.615352 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.13 seconds
19:22:00.620547 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: COMMIT
19:22:00.623213 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_vendas_primeiro_trimestre"
19:22:00.626192 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: COMMIT
19:22:00.781530 [debug] [Thread-1  ]: SQL status: COMMIT in 0.15 seconds
19:22:00.784944 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_vendas_primeiro_trimestre"
19:22:00.788127 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: BEGIN
19:22:00.927241 [debug] [Thread-1  ]: SQL status: BEGIN in 0.13 seconds
19:22:00.937535 [debug] [Thread-1  ]: finished collecting timing info
19:22:00.941315 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: ROLLBACK
19:22:01.070963 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: Close
19:22:01.075800 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb6f2fe3-fd24-46f6-a11e-27d6ef7ed8cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f2453daf0>]}
19:22:01.079230 [info ] [Thread-1  ]: 5 of 5 OK created table model public.tb_vendas_primeiro_trimestre .............. [[32mSELECT[0m in 2.69s]
19:22:01.094821 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.tb_vendas_primeiro_trimestre
19:22:01.109378 [debug] [MainThread]: Acquiring new redshift connection "master"
19:22:01.130247 [debug] [MainThread]: Using redshift connection "master"
19:22:01.133674 [debug] [MainThread]: On master: BEGIN
19:22:01.143398 [debug] [MainThread]: Opening a new connection, currently in state closed
19:22:01.149012 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
19:22:02.322079 [debug] [MainThread]: SQL status: BEGIN in 1.18 seconds
19:22:02.324994 [debug] [MainThread]: On master: COMMIT
19:22:02.327641 [debug] [MainThread]: Using redshift connection "master"
19:22:02.330402 [debug] [MainThread]: On master: COMMIT
19:22:02.459969 [debug] [MainThread]: SQL status: COMMIT in 0.13 seconds
19:22:02.463385 [debug] [MainThread]: On master: Close
19:22:02.468198 [info ] [MainThread]: 
19:22:02.471482 [info ] [MainThread]: Finished running 3 table models, 2 view models in 20.02s.
19:22:02.478915 [debug] [MainThread]: Connection 'master' was properly closed.
19:22:02.485049 [debug] [MainThread]: Connection 'model.analytics_dbt.tb_vendas_primeiro_trimestre' was properly closed.
19:22:02.547730 [info ] [MainThread]: 
19:22:02.557619 [info ] [MainThread]: [32mCompleted successfully[0m
19:22:02.567156 [info ] [MainThread]: 
19:22:02.572831 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
19:22:02.584498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f244ce130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f244cefa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f244ceeb0>]}


============================== 2022-05-23 19:34:25.933391 | 5ab25ad7-a230-4d33-b797-a729570d77c9 ==============================
19:34:25.933414 [info ] [MainThread]: Running with dbt=1.1.0
19:34:25.937597 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
19:34:25.947513 [debug] [MainThread]: Tracking: tracking
19:34:26.014754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1e393a7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1e393a880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1e393a8b0>]}
19:34:26.252196 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
19:34:26.257581 [debug] [MainThread]: Partial parsing: updated file: analytics_dbt://tests/test_singular_nao_negativo.sql
19:34:26.413336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5ab25ad7-a230-4d33-b797-a729570d77c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1e37e5fd0>]}
19:34:26.556611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5ab25ad7-a230-4d33-b797-a729570d77c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1e38c4b20>]}
19:34:26.566933 [info ] [MainThread]: Found 5 models, 5 tests, 0 snapshots, 0 analyses, 194 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
19:34:26.573277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5ab25ad7-a230-4d33-b797-a729570d77c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1e384ff10>]}
19:34:26.602914 [info ] [MainThread]: 
19:34:26.612630 [debug] [MainThread]: Acquiring new redshift connection "master"
19:34:26.668144 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev_public"
19:34:26.802393 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
19:34:26.819273 [debug] [ThreadPool]: On list_dev_public: BEGIN
19:34:26.826269 [debug] [ThreadPool]: Opening a new connection, currently in state init
19:34:26.831369 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
19:34:28.105205 [debug] [ThreadPool]: SQL status: BEGIN in 1.28 seconds
19:34:28.108258 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
19:34:28.111655 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev_public"} */
select
      'dev' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dev' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
19:34:28.254114 [debug] [ThreadPool]: SQL status: SELECT in 0.14 seconds
19:34:28.259773 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
19:34:28.391743 [debug] [ThreadPool]: On list_dev_public: Close
19:34:28.411542 [debug] [MainThread]: Using redshift connection "master"
19:34:28.414334 [debug] [MainThread]: On master: BEGIN
19:34:28.416937 [debug] [MainThread]: Opening a new connection, currently in state init
19:34:28.419313 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
19:34:29.610709 [debug] [MainThread]: SQL status: BEGIN in 1.19 seconds
19:34:29.618713 [debug] [MainThread]: Using redshift connection "master"
19:34:29.623225 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
19:34:29.789065 [debug] [MainThread]: SQL status: SELECT in 0.16 seconds
19:34:29.811264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5ab25ad7-a230-4d33-b797-a729570d77c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1e3856f40>]}
19:34:29.825206 [debug] [MainThread]: On master: ROLLBACK
19:34:29.964548 [debug] [MainThread]: Using redshift connection "master"
19:34:29.971226 [debug] [MainThread]: On master: BEGIN
19:34:30.242878 [debug] [MainThread]: SQL status: BEGIN in 0.26 seconds
19:34:30.251648 [debug] [MainThread]: On master: COMMIT
19:34:30.258357 [debug] [MainThread]: Using redshift connection "master"
19:34:30.266268 [debug] [MainThread]: On master: COMMIT
19:34:30.399596 [debug] [MainThread]: SQL status: COMMIT in 0.13 seconds
19:34:30.407009 [debug] [MainThread]: On master: Close
19:34:30.420269 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
19:34:30.430434 [info ] [MainThread]: 
19:34:30.478011 [debug] [Thread-1  ]: Began running node test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
19:34:30.486053 [info ] [Thread-1  ]: 1 of 5 START test not_null_my_first_dbt_model_id ............................... [RUN]
19:34:30.497683 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
19:34:30.503679 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
19:34:30.513366 [debug] [Thread-1  ]: Compiling test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
19:34:30.669872 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
19:34:30.687680 [debug] [Thread-1  ]: finished collecting timing info
19:34:30.692212 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
19:34:30.751663 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
19:34:30.772614 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
19:34:30.777111 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710: BEGIN
19:34:30.784717 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:34:30.790088 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
19:34:32.017331 [debug] [Thread-1  ]: SQL status: BEGIN in 1.23 seconds
19:34:32.019849 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
19:34:32.022667 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dev"."public"."my_first_dbt_model"
where id is null



      
    ) dbt_internal_test
19:34:32.176914 [debug] [Thread-1  ]: SQL status: SELECT in 0.15 seconds
19:34:32.186122 [debug] [Thread-1  ]: finished collecting timing info
19:34:32.188979 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
19:34:32.321932 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710: Close
19:34:32.327786 [error] [Thread-1  ]: 1 of 5 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 1.84s]
19:34:32.334764 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
19:34:32.340224 [debug] [Thread-1  ]: Began running node test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
19:34:32.344982 [info ] [Thread-1  ]: 2 of 5 START test not_null_my_second_dbt_model_id .............................. [RUN]
19:34:32.353168 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"
19:34:32.356765 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
19:34:32.360651 [debug] [Thread-1  ]: Compiling test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
19:34:32.399220 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"
19:34:32.416436 [debug] [Thread-1  ]: finished collecting timing info
19:34:32.421597 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
19:34:32.432112 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"
19:34:32.482228 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"
19:34:32.490030 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778: BEGIN
19:34:32.495448 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:34:32.501195 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
19:34:33.668162 [debug] [Thread-1  ]: SQL status: BEGIN in 1.17 seconds
19:34:33.671328 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"
19:34:33.675213 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dev"."public"."my_second_dbt_model"
where id is null



      
    ) dbt_internal_test
19:34:33.817024 [debug] [Thread-1  ]: SQL status: SELECT in 0.13 seconds
19:34:33.822121 [debug] [Thread-1  ]: finished collecting timing info
19:34:33.826941 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778: ROLLBACK
19:34:33.957564 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778: Close
19:34:33.961985 [info ] [Thread-1  ]: 2 of 5 PASS not_null_my_second_dbt_model_id .................................... [[32mPASS[0m in 1.61s]
19:34:33.966418 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
19:34:33.971584 [debug] [Thread-1  ]: Began running node test.analytics_dbt.test_singular_nao_negativo
19:34:33.976164 [info ] [Thread-1  ]: 3 of 5 START test test_singular_nao_negativo ................................... [RUN]
19:34:33.980822 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.test_singular_nao_negativo"
19:34:33.985505 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.test_singular_nao_negativo
19:34:33.989538 [debug] [Thread-1  ]: Compiling test.analytics_dbt.test_singular_nao_negativo
19:34:33.997399 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.test_singular_nao_negativo"
19:34:34.014191 [debug] [Thread-1  ]: finished collecting timing info
19:34:34.021360 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.test_singular_nao_negativo
19:34:34.046417 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.test_singular_nao_negativo"
19:34:34.075561 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.test_singular_nao_negativo"
19:34:34.082996 [debug] [Thread-1  ]: On test.analytics_dbt.test_singular_nao_negativo: BEGIN
19:34:34.093266 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:34:34.098242 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
19:34:35.315234 [debug] [Thread-1  ]: SQL status: BEGIN in 1.22 seconds
19:34:35.320457 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.test_singular_nao_negativo"
19:34:35.324027 [debug] [Thread-1  ]: On test.analytics_dbt.test_singular_nao_negativo: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.test_singular_nao_negativo"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- testa se existe valore menores que 0 (negativos)
select *
    from tb_10_compradores
    where vendas_totais < 0
      
    ) dbt_internal_test
19:34:35.610451 [debug] [Thread-1  ]: SQL status: SELECT in 0.28 seconds
19:34:35.616999 [debug] [Thread-1  ]: finished collecting timing info
19:34:35.620769 [debug] [Thread-1  ]: On test.analytics_dbt.test_singular_nao_negativo: ROLLBACK
19:34:35.756449 [debug] [Thread-1  ]: On test.analytics_dbt.test_singular_nao_negativo: Close
19:34:35.761042 [info ] [Thread-1  ]: 3 of 5 PASS test_singular_nao_negativo ......................................... [[32mPASS[0m in 1.78s]
19:34:35.766432 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.test_singular_nao_negativo
19:34:35.777209 [debug] [Thread-1  ]: Began running node test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
19:34:35.787790 [info ] [Thread-1  ]: 4 of 5 START test unique_my_first_dbt_model_id ................................. [RUN]
19:34:35.811416 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"
19:34:35.834729 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
19:34:35.842278 [debug] [Thread-1  ]: Compiling test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
19:34:35.905148 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"
19:34:35.917232 [debug] [Thread-1  ]: finished collecting timing info
19:34:35.924442 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
19:34:35.941851 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"
19:34:35.956373 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"
19:34:35.961242 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321: BEGIN
19:34:35.964795 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:34:35.969457 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
19:34:37.135808 [debug] [Thread-1  ]: SQL status: BEGIN in 1.17 seconds
19:34:37.139930 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"
19:34:37.143044 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dev"."public"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
19:34:37.303421 [debug] [Thread-1  ]: SQL status: SELECT in 0.16 seconds
19:34:37.309742 [debug] [Thread-1  ]: finished collecting timing info
19:34:37.312708 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
19:34:37.443038 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321: Close
19:34:37.450001 [info ] [Thread-1  ]: 4 of 5 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 1.64s]
19:34:37.457775 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
19:34:37.463789 [debug] [Thread-1  ]: Began running node test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
19:34:37.468617 [info ] [Thread-1  ]: 5 of 5 START test unique_my_second_dbt_model_id ................................ [RUN]
19:34:37.475798 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"
19:34:37.491857 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
19:34:37.505383 [debug] [Thread-1  ]: Compiling test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
19:34:37.542456 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"
19:34:37.561238 [debug] [Thread-1  ]: finished collecting timing info
19:34:37.573774 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
19:34:37.584421 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"
19:34:37.599065 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"
19:34:37.602823 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493: BEGIN
19:34:37.606194 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:34:37.609524 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
19:34:38.847304 [debug] [Thread-1  ]: SQL status: BEGIN in 1.24 seconds
19:34:38.875709 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"
19:34:38.887364 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dev"."public"."my_second_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
19:34:39.062372 [debug] [Thread-1  ]: SQL status: SELECT in 0.16 seconds
19:34:39.070969 [debug] [Thread-1  ]: finished collecting timing info
19:34:39.073740 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493: ROLLBACK
19:34:39.206713 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493: Close
19:34:39.214066 [info ] [Thread-1  ]: 5 of 5 PASS unique_my_second_dbt_model_id ...................................... [[32mPASS[0m in 1.74s]
19:34:39.221964 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
19:34:39.251240 [debug] [MainThread]: Acquiring new redshift connection "master"
19:34:39.268486 [debug] [MainThread]: Using redshift connection "master"
19:34:39.278762 [debug] [MainThread]: On master: BEGIN
19:34:39.283963 [debug] [MainThread]: Opening a new connection, currently in state closed
19:34:39.291194 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
19:34:40.550491 [debug] [MainThread]: SQL status: BEGIN in 1.27 seconds
19:34:40.554219 [debug] [MainThread]: On master: COMMIT
19:34:40.557240 [debug] [MainThread]: Using redshift connection "master"
19:34:40.561498 [debug] [MainThread]: On master: COMMIT
19:34:40.692623 [debug] [MainThread]: SQL status: COMMIT in 0.13 seconds
19:34:40.695576 [debug] [MainThread]: On master: Close
19:34:40.724142 [info ] [MainThread]: 
19:34:40.734583 [info ] [MainThread]: Finished running 5 tests in 14.11s.
19:34:40.744357 [debug] [MainThread]: Connection 'master' was properly closed.
19:34:40.752405 [debug] [MainThread]: Connection 'test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
19:34:41.025251 [info ] [MainThread]: 
19:34:41.045667 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
19:34:41.058091 [info ] [MainThread]: 
19:34:41.074260 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models/example/schema.yml)[0m
19:34:41.080790 [error] [MainThread]:   Got 1 result, configured to fail if != 0
19:34:41.088618 [info ] [MainThread]: 
19:34:41.098690 [info ] [MainThread]:   compiled SQL at target/compiled/analytics_dbt/models/example/schema.yml/not_null_my_first_dbt_model_id.sql
19:34:41.106692 [info ] [MainThread]: 
19:34:41.123308 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
19:34:41.161943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1e384ff40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1e384fee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1e3798490>]}


============================== 2022-05-23 19:35:43.375958 | ca1220d2-4ba3-4d04-92d9-aa8456ef9fbb ==============================
19:35:43.375981 [info ] [MainThread]: Running with dbt=1.1.0
19:35:43.391087 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
19:35:43.403190 [debug] [MainThread]: Tracking: tracking
19:35:43.477618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3dbfe0d790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3dbfe0d850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3dbfe0d880>]}
19:35:43.664675 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
19:35:43.671220 [debug] [MainThread]: Partial parsing: updated file: analytics_dbt://tests/test_singular_nao_negativo.sql
19:35:43.791197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ca1220d2-4ba3-4d04-92d9-aa8456ef9fbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3dbfcbbfa0>]}
19:35:43.826727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ca1220d2-4ba3-4d04-92d9-aa8456ef9fbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3dbfe2f040>]}
19:35:43.832993 [info ] [MainThread]: Found 5 models, 5 tests, 0 snapshots, 0 analyses, 194 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
19:35:43.837701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ca1220d2-4ba3-4d04-92d9-aa8456ef9fbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3dbfd22fd0>]}
19:35:43.867208 [info ] [MainThread]: 
19:35:43.906256 [debug] [MainThread]: Acquiring new redshift connection "master"
19:35:43.924604 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev_public"
19:35:44.003380 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
19:35:44.007009 [debug] [ThreadPool]: On list_dev_public: BEGIN
19:35:44.010316 [debug] [ThreadPool]: Opening a new connection, currently in state init
19:35:44.014494 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
19:35:45.245358 [debug] [ThreadPool]: SQL status: BEGIN in 1.24 seconds
19:35:45.247940 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
19:35:45.252166 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev_public"} */
select
      'dev' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dev' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
19:35:45.398409 [debug] [ThreadPool]: SQL status: SELECT in 0.14 seconds
19:35:45.405693 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
19:35:45.537803 [debug] [ThreadPool]: On list_dev_public: Close
19:35:45.562566 [debug] [MainThread]: Using redshift connection "master"
19:35:45.566188 [debug] [MainThread]: On master: BEGIN
19:35:45.569873 [debug] [MainThread]: Opening a new connection, currently in state init
19:35:45.573934 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
19:35:46.742707 [debug] [MainThread]: SQL status: BEGIN in 1.17 seconds
19:35:46.745534 [debug] [MainThread]: Using redshift connection "master"
19:35:46.748627 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
19:35:46.910275 [debug] [MainThread]: SQL status: SELECT in 0.16 seconds
19:35:46.918911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ca1220d2-4ba3-4d04-92d9-aa8456ef9fbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3dbfd28eb0>]}
19:35:46.924535 [debug] [MainThread]: On master: ROLLBACK
19:35:47.054731 [debug] [MainThread]: Using redshift connection "master"
19:35:47.058261 [debug] [MainThread]: On master: BEGIN
19:35:47.314296 [debug] [MainThread]: SQL status: BEGIN in 0.25 seconds
19:35:47.317698 [debug] [MainThread]: On master: COMMIT
19:35:47.320488 [debug] [MainThread]: Using redshift connection "master"
19:35:47.324967 [debug] [MainThread]: On master: COMMIT
19:35:47.453936 [debug] [MainThread]: SQL status: COMMIT in 0.13 seconds
19:35:47.457520 [debug] [MainThread]: On master: Close
19:35:47.461955 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
19:35:47.470167 [info ] [MainThread]: 
19:35:47.489812 [debug] [Thread-1  ]: Began running node test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
19:35:47.504787 [info ] [Thread-1  ]: 1 of 5 START test not_null_my_first_dbt_model_id ............................... [RUN]
19:35:47.515719 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
19:35:47.536396 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
19:35:47.545657 [debug] [Thread-1  ]: Compiling test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
19:35:47.644190 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
19:35:47.655577 [debug] [Thread-1  ]: finished collecting timing info
19:35:47.659883 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
19:35:47.697276 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
19:35:47.705896 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
19:35:47.709961 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710: BEGIN
19:35:47.713590 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:35:47.716411 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
19:35:48.902131 [debug] [Thread-1  ]: SQL status: BEGIN in 1.19 seconds
19:35:48.905829 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
19:35:48.908720 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dev"."public"."my_first_dbt_model"
where id is null



      
    ) dbt_internal_test
19:35:49.044727 [debug] [Thread-1  ]: SQL status: SELECT in 0.13 seconds
19:35:49.057335 [debug] [Thread-1  ]: finished collecting timing info
19:35:49.061803 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
19:35:49.195366 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710: Close
19:35:49.201831 [error] [Thread-1  ]: 1 of 5 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 1.69s]
19:35:49.210307 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
19:35:49.216862 [debug] [Thread-1  ]: Began running node test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
19:35:49.222067 [info ] [Thread-1  ]: 2 of 5 START test not_null_my_second_dbt_model_id .............................. [RUN]
19:35:49.234799 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"
19:35:49.244552 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
19:35:49.257258 [debug] [Thread-1  ]: Compiling test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
19:35:49.292308 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"
19:35:49.304912 [debug] [Thread-1  ]: finished collecting timing info
19:35:49.313672 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
19:35:49.323598 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"
19:35:49.333035 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"
19:35:49.338267 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778: BEGIN
19:35:49.344343 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:35:49.347353 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
19:35:50.515885 [debug] [Thread-1  ]: SQL status: BEGIN in 1.17 seconds
19:35:50.518584 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"
19:35:50.521361 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dev"."public"."my_second_dbt_model"
where id is null



      
    ) dbt_internal_test
19:35:50.660664 [debug] [Thread-1  ]: SQL status: SELECT in 0.13 seconds
19:35:50.667829 [debug] [Thread-1  ]: finished collecting timing info
19:35:50.671354 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778: ROLLBACK
19:35:50.802085 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778: Close
19:35:50.808239 [info ] [Thread-1  ]: 2 of 5 PASS not_null_my_second_dbt_model_id .................................... [[32mPASS[0m in 1.58s]
19:35:50.812556 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
19:35:50.819533 [debug] [Thread-1  ]: Began running node test.analytics_dbt.test_singular_nao_negativo
19:35:50.827637 [info ] [Thread-1  ]: 3 of 5 START test test_singular_nao_negativo ................................... [RUN]
19:35:50.841279 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.test_singular_nao_negativo"
19:35:50.853597 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.test_singular_nao_negativo
19:35:50.861081 [debug] [Thread-1  ]: Compiling test.analytics_dbt.test_singular_nao_negativo
19:35:50.875395 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.test_singular_nao_negativo"
19:35:50.909366 [debug] [Thread-1  ]: finished collecting timing info
19:35:50.918765 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.test_singular_nao_negativo
19:35:50.931561 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.test_singular_nao_negativo"
19:35:50.946247 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.test_singular_nao_negativo"
19:35:50.951384 [debug] [Thread-1  ]: On test.analytics_dbt.test_singular_nao_negativo: BEGIN
19:35:50.956424 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:35:50.960296 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
19:35:52.128639 [debug] [Thread-1  ]: SQL status: BEGIN in 1.17 seconds
19:35:52.134203 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.test_singular_nao_negativo"
19:35:52.138357 [debug] [Thread-1  ]: On test.analytics_dbt.test_singular_nao_negativo: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.test_singular_nao_negativo"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- testa se existe valore menores que 0 (negativos)
select count(*)
    from tb_10_compradores
    where vendas_totais < 0
      
    ) dbt_internal_test
19:35:52.276461 [debug] [Thread-1  ]: SQL status: SELECT in 0.13 seconds
19:35:52.282400 [debug] [Thread-1  ]: finished collecting timing info
19:35:52.285313 [debug] [Thread-1  ]: On test.analytics_dbt.test_singular_nao_negativo: ROLLBACK
19:35:52.414546 [debug] [Thread-1  ]: On test.analytics_dbt.test_singular_nao_negativo: Close
19:35:52.418680 [error] [Thread-1  ]: 3 of 5 FAIL 1 test_singular_nao_negativo ....................................... [[31mFAIL 1[0m in 1.58s]
19:35:52.422436 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.test_singular_nao_negativo
19:35:52.428646 [debug] [Thread-1  ]: Began running node test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
19:35:52.433179 [info ] [Thread-1  ]: 4 of 5 START test unique_my_first_dbt_model_id ................................. [RUN]
19:35:52.448714 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"
19:35:52.460355 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
19:35:52.468737 [debug] [Thread-1  ]: Compiling test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
19:35:52.522040 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"
19:35:52.536831 [debug] [Thread-1  ]: finished collecting timing info
19:35:52.542794 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
19:35:52.569351 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"
19:35:52.586347 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"
19:35:52.592203 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321: BEGIN
19:35:52.597141 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:35:52.600655 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
19:35:53.788830 [debug] [Thread-1  ]: SQL status: BEGIN in 1.19 seconds
19:35:53.792606 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"
19:35:53.795654 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dev"."public"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
19:35:53.929934 [debug] [Thread-1  ]: SQL status: SELECT in 0.13 seconds
19:35:53.935867 [debug] [Thread-1  ]: finished collecting timing info
19:35:53.938857 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
19:35:54.071592 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321: Close
19:35:54.076634 [info ] [Thread-1  ]: 4 of 5 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 1.63s]
19:35:54.082229 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
19:35:54.086853 [debug] [Thread-1  ]: Began running node test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
19:35:54.091598 [info ] [Thread-1  ]: 5 of 5 START test unique_my_second_dbt_model_id ................................ [RUN]
19:35:54.100608 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"
19:35:54.105030 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
19:35:54.119816 [debug] [Thread-1  ]: Compiling test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
19:35:54.162439 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"
19:35:54.173575 [debug] [Thread-1  ]: finished collecting timing info
19:35:54.184487 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
19:35:54.196019 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"
19:35:54.207200 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"
19:35:54.216638 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493: BEGIN
19:35:54.220393 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:35:54.224453 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
19:35:55.395117 [debug] [Thread-1  ]: SQL status: BEGIN in 1.17 seconds
19:35:55.399926 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"
19:35:55.403066 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dev"."public"."my_second_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
19:35:55.537750 [debug] [Thread-1  ]: SQL status: SELECT in 0.13 seconds
19:35:55.545034 [debug] [Thread-1  ]: finished collecting timing info
19:35:55.551897 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493: ROLLBACK
19:35:55.685011 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493: Close
19:35:55.690183 [info ] [Thread-1  ]: 5 of 5 PASS unique_my_second_dbt_model_id ...................................... [[32mPASS[0m in 1.59s]
19:35:55.695012 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
19:35:55.714338 [debug] [MainThread]: Acquiring new redshift connection "master"
19:35:55.724331 [debug] [MainThread]: Using redshift connection "master"
19:35:55.732538 [debug] [MainThread]: On master: BEGIN
19:35:55.743708 [debug] [MainThread]: Opening a new connection, currently in state closed
19:35:55.747326 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
19:35:56.935007 [debug] [MainThread]: SQL status: BEGIN in 1.19 seconds
19:35:56.938468 [debug] [MainThread]: On master: COMMIT
19:35:56.942254 [debug] [MainThread]: Using redshift connection "master"
19:35:56.945675 [debug] [MainThread]: On master: COMMIT
19:35:57.081005 [debug] [MainThread]: SQL status: COMMIT in 0.13 seconds
19:35:57.083337 [debug] [MainThread]: On master: Close
19:35:57.087721 [info ] [MainThread]: 
19:35:57.091134 [info ] [MainThread]: Finished running 5 tests in 13.18s.
19:35:57.095279 [debug] [MainThread]: Connection 'master' was properly closed.
19:35:57.104075 [debug] [MainThread]: Connection 'test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
19:35:57.174778 [info ] [MainThread]: 
19:35:57.185570 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
19:35:57.192831 [info ] [MainThread]: 
19:35:57.206528 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models/example/schema.yml)[0m
19:35:57.228397 [error] [MainThread]:   Got 1 result, configured to fail if != 0
19:35:57.249356 [info ] [MainThread]: 
19:35:57.258812 [info ] [MainThread]:   compiled SQL at target/compiled/analytics_dbt/models/example/schema.yml/not_null_my_first_dbt_model_id.sql
19:35:57.265594 [info ] [MainThread]: 
19:35:57.274188 [error] [MainThread]: [31mFailure in test test_singular_nao_negativo (tests/test_singular_nao_negativo.sql)[0m
19:35:57.286137 [error] [MainThread]:   Got 1 result, configured to fail if != 0
19:35:57.294301 [info ] [MainThread]: 
19:35:57.301529 [info ] [MainThread]:   compiled SQL at target/compiled/analytics_dbt/tests/test_singular_nao_negativo.sql
19:35:57.307961 [info ] [MainThread]: 
19:35:57.317202 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=2 SKIP=0 TOTAL=5
19:35:57.361872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3dbfd22f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3dbfd22eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3dbfc6d460>]}


============================== 2022-05-23 19:38:18.275721 | afee4dde-2fe0-4f1a-a21c-91c5f7ad527d ==============================
19:38:18.275832 [info ] [MainThread]: Running with dbt=1.1.0
19:38:18.281004 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
19:38:18.301340 [debug] [MainThread]: Tracking: tracking
19:38:18.345659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32d19ec7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32d19ec880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32d19ec8b0>]}
19:38:18.518390 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
19:38:18.522793 [debug] [MainThread]: Partial parsing: updated file: analytics_dbt://tests/test_singular_nao_negativo.sql
19:38:18.633743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'afee4dde-2fe0-4f1a-a21c-91c5f7ad527d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32d1897fd0>]}
19:38:18.669619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'afee4dde-2fe0-4f1a-a21c-91c5f7ad527d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32d1a0b340>]}
19:38:18.674097 [info ] [MainThread]: Found 5 models, 5 tests, 0 snapshots, 0 analyses, 194 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
19:38:18.678647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'afee4dde-2fe0-4f1a-a21c-91c5f7ad527d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32d1901f10>]}
19:38:18.690864 [info ] [MainThread]: 
19:38:18.702133 [debug] [MainThread]: Acquiring new redshift connection "master"
19:38:18.719532 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev_public"
19:38:18.803519 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
19:38:18.811045 [debug] [ThreadPool]: On list_dev_public: BEGIN
19:38:18.815558 [debug] [ThreadPool]: Opening a new connection, currently in state init
19:38:18.819072 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
19:38:20.023805 [debug] [ThreadPool]: SQL status: BEGIN in 1.21 seconds
19:38:20.027006 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
19:38:20.030497 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev_public"} */
select
      'dev' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dev' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
19:38:20.170354 [debug] [ThreadPool]: SQL status: SELECT in 0.14 seconds
19:38:20.176474 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
19:38:20.305697 [debug] [ThreadPool]: On list_dev_public: Close
19:38:20.320308 [debug] [MainThread]: Using redshift connection "master"
19:38:20.322988 [debug] [MainThread]: On master: BEGIN
19:38:20.325441 [debug] [MainThread]: Opening a new connection, currently in state init
19:38:20.328876 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
19:38:21.612330 [debug] [MainThread]: SQL status: BEGIN in 1.29 seconds
19:38:21.616921 [debug] [MainThread]: Using redshift connection "master"
19:38:21.619834 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
19:38:21.781006 [debug] [MainThread]: SQL status: SELECT in 0.16 seconds
19:38:21.786419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'afee4dde-2fe0-4f1a-a21c-91c5f7ad527d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32d1907f40>]}
19:38:21.789226 [debug] [MainThread]: On master: ROLLBACK
19:38:21.917971 [debug] [MainThread]: Using redshift connection "master"
19:38:21.921805 [debug] [MainThread]: On master: BEGIN
19:38:22.177623 [debug] [MainThread]: SQL status: BEGIN in 0.25 seconds
19:38:22.181639 [debug] [MainThread]: On master: COMMIT
19:38:22.184871 [debug] [MainThread]: Using redshift connection "master"
19:38:22.187641 [debug] [MainThread]: On master: COMMIT
19:38:22.316962 [debug] [MainThread]: SQL status: COMMIT in 0.13 seconds
19:38:22.320144 [debug] [MainThread]: On master: Close
19:38:22.324317 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
19:38:22.330182 [info ] [MainThread]: 
19:38:22.386999 [debug] [Thread-1  ]: Began running node test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
19:38:22.412622 [info ] [Thread-1  ]: 1 of 5 START test not_null_my_first_dbt_model_id ............................... [RUN]
19:38:22.428063 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
19:38:22.447156 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
19:38:22.463739 [debug] [Thread-1  ]: Compiling test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
19:38:22.551273 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
19:38:22.562649 [debug] [Thread-1  ]: finished collecting timing info
19:38:22.570303 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
19:38:22.618240 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
19:38:22.631895 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
19:38:22.638993 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710: BEGIN
19:38:22.641938 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:38:22.645008 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
19:38:23.818716 [debug] [Thread-1  ]: SQL status: BEGIN in 1.18 seconds
19:38:23.824208 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
19:38:23.826993 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dev"."public"."my_first_dbt_model"
where id is null



      
    ) dbt_internal_test
19:38:23.959977 [debug] [Thread-1  ]: SQL status: SELECT in 0.13 seconds
19:38:23.970311 [debug] [Thread-1  ]: finished collecting timing info
19:38:23.973683 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
19:38:24.103631 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710: Close
19:38:24.107011 [error] [Thread-1  ]: 1 of 5 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 1.68s]
19:38:24.112561 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
19:38:24.118343 [debug] [Thread-1  ]: Began running node test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
19:38:24.125032 [info ] [Thread-1  ]: 2 of 5 START test not_null_my_second_dbt_model_id .............................. [RUN]
19:38:24.134800 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"
19:38:24.147423 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
19:38:24.158870 [debug] [Thread-1  ]: Compiling test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
19:38:24.201099 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"
19:38:24.220003 [debug] [Thread-1  ]: finished collecting timing info
19:38:24.225994 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
19:38:24.234640 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"
19:38:24.249608 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"
19:38:24.254910 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778: BEGIN
19:38:24.258263 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:38:24.262065 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
19:38:25.491899 [debug] [Thread-1  ]: SQL status: BEGIN in 1.23 seconds
19:38:25.514560 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"
19:38:25.519172 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dev"."public"."my_second_dbt_model"
where id is null



      
    ) dbt_internal_test
19:38:25.661942 [debug] [Thread-1  ]: SQL status: SELECT in 0.14 seconds
19:38:25.670824 [debug] [Thread-1  ]: finished collecting timing info
19:38:25.674547 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778: ROLLBACK
19:38:25.807261 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778: Close
19:38:25.811922 [info ] [Thread-1  ]: 2 of 5 PASS not_null_my_second_dbt_model_id .................................... [[32mPASS[0m in 1.68s]
19:38:25.816173 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
19:38:25.821674 [debug] [Thread-1  ]: Began running node test.analytics_dbt.test_singular_nao_negativo
19:38:25.828347 [info ] [Thread-1  ]: 3 of 5 START test test_singular_nao_negativo ................................... [RUN]
19:38:25.843856 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.test_singular_nao_negativo"
19:38:25.856971 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.test_singular_nao_negativo
19:38:25.862768 [debug] [Thread-1  ]: Compiling test.analytics_dbt.test_singular_nao_negativo
19:38:25.889664 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.test_singular_nao_negativo"
19:38:25.909333 [debug] [Thread-1  ]: finished collecting timing info
19:38:25.921497 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.test_singular_nao_negativo
19:38:25.933590 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.test_singular_nao_negativo"
19:38:25.950067 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.test_singular_nao_negativo"
19:38:25.953591 [debug] [Thread-1  ]: On test.analytics_dbt.test_singular_nao_negativo: BEGIN
19:38:25.956095 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:38:25.959493 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
19:38:27.143055 [debug] [Thread-1  ]: SQL status: BEGIN in 1.19 seconds
19:38:27.146356 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.test_singular_nao_negativo"
19:38:27.148870 [debug] [Thread-1  ]: On test.analytics_dbt.test_singular_nao_negativo: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.test_singular_nao_negativo"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- testa se existe valore menores que 0 (negativos)
select *
    from tb_10_compradores
    where vendas_totais < 0
      
    ) dbt_internal_test
19:38:27.281679 [debug] [Thread-1  ]: SQL status: SELECT in 0.13 seconds
19:38:27.287917 [debug] [Thread-1  ]: finished collecting timing info
19:38:27.290637 [debug] [Thread-1  ]: On test.analytics_dbt.test_singular_nao_negativo: ROLLBACK
19:38:27.421031 [debug] [Thread-1  ]: On test.analytics_dbt.test_singular_nao_negativo: Close
19:38:27.425627 [info ] [Thread-1  ]: 3 of 5 PASS test_singular_nao_negativo ......................................... [[32mPASS[0m in 1.58s]
19:38:27.429504 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.test_singular_nao_negativo
19:38:27.436485 [debug] [Thread-1  ]: Began running node test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
19:38:27.443973 [info ] [Thread-1  ]: 4 of 5 START test unique_my_first_dbt_model_id ................................. [RUN]
19:38:27.456122 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"
19:38:27.467142 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
19:38:27.485244 [debug] [Thread-1  ]: Compiling test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
19:38:27.532065 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"
19:38:27.549603 [debug] [Thread-1  ]: finished collecting timing info
19:38:27.553445 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
19:38:27.564637 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"
19:38:27.577118 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"
19:38:27.580608 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321: BEGIN
19:38:27.583997 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:38:27.587145 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
19:38:28.756733 [debug] [Thread-1  ]: SQL status: BEGIN in 1.17 seconds
19:38:28.760744 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"
19:38:28.763678 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dev"."public"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
19:38:28.896885 [debug] [Thread-1  ]: SQL status: SELECT in 0.13 seconds
19:38:28.904489 [debug] [Thread-1  ]: finished collecting timing info
19:38:28.907724 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
19:38:29.038285 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321: Close
19:38:29.043503 [info ] [Thread-1  ]: 4 of 5 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 1.59s]
19:38:29.047451 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
19:38:29.051674 [debug] [Thread-1  ]: Began running node test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
19:38:29.063687 [info ] [Thread-1  ]: 5 of 5 START test unique_my_second_dbt_model_id ................................ [RUN]
19:38:29.077579 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"
19:38:29.093325 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
19:38:29.105731 [debug] [Thread-1  ]: Compiling test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
19:38:29.134372 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"
19:38:29.154908 [debug] [Thread-1  ]: finished collecting timing info
19:38:29.159350 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
19:38:29.167683 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"
19:38:29.180013 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"
19:38:29.183647 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493: BEGIN
19:38:29.187529 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:38:29.190892 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
19:38:30.376853 [debug] [Thread-1  ]: SQL status: BEGIN in 1.19 seconds
19:38:30.380493 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"
19:38:30.384391 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dev"."public"."my_second_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
19:38:30.520605 [debug] [Thread-1  ]: SQL status: SELECT in 0.13 seconds
19:38:30.529490 [debug] [Thread-1  ]: finished collecting timing info
19:38:30.532612 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493: ROLLBACK
19:38:30.666173 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493: Close
19:38:30.672282 [info ] [Thread-1  ]: 5 of 5 PASS unique_my_second_dbt_model_id ...................................... [[32mPASS[0m in 1.60s]
19:38:30.678443 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
19:38:30.689946 [debug] [MainThread]: Acquiring new redshift connection "master"
19:38:30.694034 [debug] [MainThread]: Using redshift connection "master"
19:38:30.702484 [debug] [MainThread]: On master: BEGIN
19:38:30.712038 [debug] [MainThread]: Opening a new connection, currently in state closed
19:38:30.718751 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
19:38:31.921860 [debug] [MainThread]: SQL status: BEGIN in 1.21 seconds
19:38:31.926461 [debug] [MainThread]: On master: COMMIT
19:38:31.929595 [debug] [MainThread]: Using redshift connection "master"
19:38:31.932715 [debug] [MainThread]: On master: COMMIT
19:38:32.065769 [debug] [MainThread]: SQL status: COMMIT in 0.13 seconds
19:38:32.069390 [debug] [MainThread]: On master: Close
19:38:32.074301 [info ] [MainThread]: 
19:38:32.077748 [info ] [MainThread]: Finished running 5 tests in 13.37s.
19:38:32.085490 [debug] [MainThread]: Connection 'master' was properly closed.
19:38:32.092677 [debug] [MainThread]: Connection 'test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
19:38:32.161071 [info ] [MainThread]: 
19:38:32.167064 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
19:38:32.175275 [info ] [MainThread]: 
19:38:32.189126 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models/example/schema.yml)[0m
19:38:32.205019 [error] [MainThread]:   Got 1 result, configured to fail if != 0
19:38:32.226190 [info ] [MainThread]: 
19:38:32.249546 [info ] [MainThread]:   compiled SQL at target/compiled/analytics_dbt/models/example/schema.yml/not_null_my_first_dbt_model_id.sql
19:38:32.341282 [info ] [MainThread]: 
19:38:32.357121 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
19:38:32.370261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32d1901f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32d1901ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32d184a490>]}


============================== 2022-05-23 19:44:46.874921 | d0945c8c-52ed-4c3f-945e-36f6faf90f35 ==============================
19:44:46.874943 [info ] [MainThread]: Running with dbt=1.1.0
19:44:46.882245 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
19:44:46.890500 [debug] [MainThread]: Tracking: tracking
19:44:46.933824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc28c6c7670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc28c6c7700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc28c6c7730>]}
19:44:47.106657 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
19:44:47.109797 [debug] [MainThread]: Partial parsing: update schema file: analytics_dbt://models/example/schema.yml
19:44:47.270495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd0945c8c-52ed-4c3f-945e-36f6faf90f35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc28c572af0>]}
19:44:47.311659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd0945c8c-52ed-4c3f-945e-36f6faf90f35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc28c59f3a0>]}
19:44:47.317384 [info ] [MainThread]: Found 5 models, 7 tests, 0 snapshots, 0 analyses, 194 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
19:44:47.323670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd0945c8c-52ed-4c3f-945e-36f6faf90f35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc28c59fac0>]}
19:44:47.347670 [info ] [MainThread]: 
19:44:47.355546 [debug] [MainThread]: Acquiring new redshift connection "master"
19:44:47.381804 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev_public"
19:44:47.422103 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
19:44:47.425974 [debug] [ThreadPool]: On list_dev_public: BEGIN
19:44:47.429965 [debug] [ThreadPool]: Opening a new connection, currently in state init
19:44:47.434544 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
19:44:48.644689 [debug] [ThreadPool]: SQL status: BEGIN in 1.21 seconds
19:44:48.648270 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
19:44:48.651319 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev_public"} */
select
      'dev' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dev' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
19:44:48.809533 [debug] [ThreadPool]: SQL status: SELECT in 0.16 seconds
19:44:48.817928 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
19:44:48.966471 [debug] [ThreadPool]: On list_dev_public: Close
19:44:48.986455 [debug] [MainThread]: Using redshift connection "master"
19:44:48.990239 [debug] [MainThread]: On master: BEGIN
19:44:48.993213 [debug] [MainThread]: Opening a new connection, currently in state init
19:44:48.995835 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
19:44:50.182751 [debug] [MainThread]: SQL status: BEGIN in 1.19 seconds
19:44:50.185372 [debug] [MainThread]: Using redshift connection "master"
19:44:50.188444 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
19:44:50.354672 [debug] [MainThread]: SQL status: SELECT in 0.16 seconds
19:44:50.360853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd0945c8c-52ed-4c3f-945e-36f6faf90f35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc28c592dc0>]}
19:44:50.363667 [debug] [MainThread]: On master: ROLLBACK
19:44:50.495307 [debug] [MainThread]: Using redshift connection "master"
19:44:50.498478 [debug] [MainThread]: On master: BEGIN
19:44:50.758856 [debug] [MainThread]: SQL status: BEGIN in 0.26 seconds
19:44:50.762197 [debug] [MainThread]: On master: COMMIT
19:44:50.764903 [debug] [MainThread]: Using redshift connection "master"
19:44:50.767629 [debug] [MainThread]: On master: COMMIT
19:44:50.900117 [debug] [MainThread]: SQL status: COMMIT in 0.13 seconds
19:44:50.903397 [debug] [MainThread]: On master: Close
19:44:50.908216 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
19:44:50.911324 [info ] [MainThread]: 
19:44:50.935669 [debug] [Thread-1  ]: Began running node test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea
19:44:50.946864 [info ] [Thread-1  ]: 1 of 7 START test nao_negativo_tb_10_compradores_vendas_totais ................. [RUN]
19:44:50.956421 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea"
19:44:50.964646 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea
19:44:50.969768 [debug] [Thread-1  ]: Compiling test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea
19:44:51.001752 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea"
19:44:51.023757 [debug] [Thread-1  ]: finished collecting timing info
19:44:51.027052 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea
19:44:51.076227 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea"
19:44:51.089014 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea"
19:44:51.091836 [debug] [Thread-1  ]: On test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea: BEGIN
19:44:51.095961 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:44:51.099849 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
19:44:52.288188 [debug] [Thread-1  ]: SQL status: BEGIN in 1.19 seconds
19:44:52.291587 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea"
19:44:52.295021 [debug] [Thread-1  ]: On test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

    select *
    from "dev"."public"."tb_10_compradores"
    where vendas_totais < 0


      
    ) dbt_internal_test
19:44:52.429580 [debug] [Thread-1  ]: SQL status: SELECT in 0.13 seconds
19:44:52.437811 [debug] [Thread-1  ]: finished collecting timing info
19:44:52.441460 [debug] [Thread-1  ]: On test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea: ROLLBACK
19:44:52.571586 [debug] [Thread-1  ]: On test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea: Close
19:44:52.578704 [info ] [Thread-1  ]: 1 of 7 PASS nao_negativo_tb_10_compradores_vendas_totais ....................... [[32mPASS[0m in 1.62s]
19:44:52.586560 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea
19:44:52.591364 [debug] [Thread-1  ]: Began running node test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
19:44:52.597642 [info ] [Thread-1  ]: 2 of 7 START test not_null_my_first_dbt_model_id ............................... [RUN]
19:44:52.606514 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
19:44:52.618016 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
19:44:52.627582 [debug] [Thread-1  ]: Compiling test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
19:44:52.669247 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
19:44:52.680538 [debug] [Thread-1  ]: finished collecting timing info
19:44:52.685055 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
19:44:52.693668 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
19:44:52.702405 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
19:44:52.706528 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710: BEGIN
19:44:52.709505 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:44:52.712601 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
19:44:53.904053 [debug] [Thread-1  ]: SQL status: BEGIN in 1.19 seconds
19:44:53.907637 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
19:44:53.910661 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dev"."public"."my_first_dbt_model"
where id is null



      
    ) dbt_internal_test
19:44:54.069133 [debug] [Thread-1  ]: SQL status: SELECT in 0.16 seconds
19:44:54.079525 [debug] [Thread-1  ]: finished collecting timing info
19:44:54.082628 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
19:44:54.216783 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710: Close
19:44:54.221774 [error] [Thread-1  ]: 2 of 7 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 1.62s]
19:44:54.227057 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
19:44:54.233341 [debug] [Thread-1  ]: Began running node test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
19:44:54.237638 [info ] [Thread-1  ]: 3 of 7 START test not_null_my_second_dbt_model_id .............................. [RUN]
19:44:54.243869 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"
19:44:54.250885 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
19:44:54.254534 [debug] [Thread-1  ]: Compiling test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
19:44:54.277269 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"
19:44:54.299565 [debug] [Thread-1  ]: finished collecting timing info
19:44:54.303289 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
19:44:54.315085 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"
19:44:54.327288 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"
19:44:54.332935 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778: BEGIN
19:44:54.336455 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:44:54.339594 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
19:44:55.511460 [debug] [Thread-1  ]: SQL status: BEGIN in 1.18 seconds
19:44:55.514785 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"
19:44:55.518150 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dev"."public"."my_second_dbt_model"
where id is null



      
    ) dbt_internal_test
19:44:55.658199 [debug] [Thread-1  ]: SQL status: SELECT in 0.14 seconds
19:44:55.664694 [debug] [Thread-1  ]: finished collecting timing info
19:44:55.667712 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778: ROLLBACK
19:44:55.798102 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778: Close
19:44:55.802736 [info ] [Thread-1  ]: 3 of 7 PASS not_null_my_second_dbt_model_id .................................... [[32mPASS[0m in 1.56s]
19:44:55.808352 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
19:44:55.821537 [debug] [Thread-1  ]: Began running node test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752
19:44:55.827656 [info ] [Thread-1  ]: 4 of 7 START test not_null_tb_10_compradores_vendas_totais ..................... [RUN]
19:44:55.835122 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752"
19:44:55.838550 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752
19:44:55.843003 [debug] [Thread-1  ]: Compiling test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752
19:44:55.877422 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752"
19:44:55.894079 [debug] [Thread-1  ]: finished collecting timing info
19:44:55.899202 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752
19:44:55.909436 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752"
19:44:55.923077 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752"
19:44:55.929206 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752: BEGIN
19:44:55.933443 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:44:55.937404 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
19:44:57.126162 [debug] [Thread-1  ]: SQL status: BEGIN in 1.19 seconds
19:44:57.131257 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752"
19:44:57.137117 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select vendas_totais
from "dev"."public"."tb_10_compradores"
where vendas_totais is null



      
    ) dbt_internal_test
19:44:57.295834 [debug] [Thread-1  ]: SQL status: SELECT in 0.15 seconds
19:44:57.305956 [debug] [Thread-1  ]: finished collecting timing info
19:44:57.310283 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752: ROLLBACK
19:44:57.442901 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752: Close
19:44:57.449564 [info ] [Thread-1  ]: 4 of 7 PASS not_null_tb_10_compradores_vendas_totais ........................... [[32mPASS[0m in 1.62s]
19:44:57.453606 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752
19:44:57.458619 [debug] [Thread-1  ]: Began running node test.analytics_dbt.test_singular_nao_negativo
19:44:57.465689 [info ] [Thread-1  ]: 5 of 7 START test test_singular_nao_negativo ................................... [RUN]
19:44:57.475596 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.test_singular_nao_negativo"
19:44:57.480657 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.test_singular_nao_negativo
19:44:57.492541 [debug] [Thread-1  ]: Compiling test.analytics_dbt.test_singular_nao_negativo
19:44:57.507963 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.test_singular_nao_negativo"
19:44:57.523000 [debug] [Thread-1  ]: finished collecting timing info
19:44:57.529658 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.test_singular_nao_negativo
19:44:57.541271 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.test_singular_nao_negativo"
19:44:57.550714 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.test_singular_nao_negativo"
19:44:57.556471 [debug] [Thread-1  ]: On test.analytics_dbt.test_singular_nao_negativo: BEGIN
19:44:57.562007 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:44:57.566481 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
19:44:58.741836 [debug] [Thread-1  ]: SQL status: BEGIN in 1.18 seconds
19:44:58.748038 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.test_singular_nao_negativo"
19:44:58.751747 [debug] [Thread-1  ]: On test.analytics_dbt.test_singular_nao_negativo: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.test_singular_nao_negativo"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- testa se existe valore menores que 0 (negativos)
select *
    from tb_10_compradores
    where vendas_totais < 0
      
    ) dbt_internal_test
19:44:58.885097 [debug] [Thread-1  ]: SQL status: SELECT in 0.13 seconds
19:44:58.894714 [debug] [Thread-1  ]: finished collecting timing info
19:44:58.897546 [debug] [Thread-1  ]: On test.analytics_dbt.test_singular_nao_negativo: ROLLBACK
19:44:59.029101 [debug] [Thread-1  ]: On test.analytics_dbt.test_singular_nao_negativo: Close
19:44:59.033010 [info ] [Thread-1  ]: 5 of 7 PASS test_singular_nao_negativo ......................................... [[32mPASS[0m in 1.56s]
19:44:59.037546 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.test_singular_nao_negativo
19:44:59.041868 [debug] [Thread-1  ]: Began running node test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
19:44:59.050647 [info ] [Thread-1  ]: 6 of 7 START test unique_my_first_dbt_model_id ................................. [RUN]
19:44:59.060956 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"
19:44:59.072611 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
19:44:59.080694 [debug] [Thread-1  ]: Compiling test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
19:44:59.112907 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"
19:44:59.122533 [debug] [Thread-1  ]: finished collecting timing info
19:44:59.127400 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
19:44:59.139281 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"
19:44:59.148630 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"
19:44:59.153539 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321: BEGIN
19:44:59.161259 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:44:59.165413 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
19:45:00.344617 [debug] [Thread-1  ]: SQL status: BEGIN in 1.18 seconds
19:45:00.347922 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"
19:45:00.350955 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dev"."public"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
19:45:00.484064 [debug] [Thread-1  ]: SQL status: SELECT in 0.13 seconds
19:45:00.491011 [debug] [Thread-1  ]: finished collecting timing info
19:45:00.494252 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
19:45:00.624298 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321: Close
19:45:00.629175 [info ] [Thread-1  ]: 6 of 7 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 1.57s]
19:45:00.637929 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
19:45:00.653796 [debug] [Thread-1  ]: Began running node test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
19:45:00.659891 [info ] [Thread-1  ]: 7 of 7 START test unique_my_second_dbt_model_id ................................ [RUN]
19:45:00.668875 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"
19:45:00.675082 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
19:45:00.683926 [debug] [Thread-1  ]: Compiling test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
19:45:00.711054 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"
19:45:00.720812 [debug] [Thread-1  ]: finished collecting timing info
19:45:00.728815 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
19:45:00.744231 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"
19:45:00.752348 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"
19:45:00.756381 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493: BEGIN
19:45:00.761489 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:45:00.764518 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
19:45:01.925270 [debug] [Thread-1  ]: SQL status: BEGIN in 1.16 seconds
19:45:01.928236 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"
19:45:01.931152 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dev"."public"."my_second_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
19:45:02.063028 [debug] [Thread-1  ]: SQL status: SELECT in 0.13 seconds
19:45:02.068687 [debug] [Thread-1  ]: finished collecting timing info
19:45:02.072250 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493: ROLLBACK
19:45:02.201285 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493: Close
19:45:02.206053 [info ] [Thread-1  ]: 7 of 7 PASS unique_my_second_dbt_model_id ...................................... [[32mPASS[0m in 1.54s]
19:45:02.211256 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
19:45:02.220841 [debug] [MainThread]: Acquiring new redshift connection "master"
19:45:02.226035 [debug] [MainThread]: Using redshift connection "master"
19:45:02.233055 [debug] [MainThread]: On master: BEGIN
19:45:02.237206 [debug] [MainThread]: Opening a new connection, currently in state closed
19:45:02.240966 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
19:45:03.551145 [debug] [MainThread]: SQL status: BEGIN in 1.31 seconds
19:45:03.553994 [debug] [MainThread]: On master: COMMIT
19:45:03.557110 [debug] [MainThread]: Using redshift connection "master"
19:45:03.560110 [debug] [MainThread]: On master: COMMIT
19:45:03.693422 [debug] [MainThread]: SQL status: COMMIT in 0.13 seconds
19:45:03.697005 [debug] [MainThread]: On master: Close
19:45:03.706651 [info ] [MainThread]: 
19:45:03.711787 [info ] [MainThread]: Finished running 7 tests in 16.35s.
19:45:03.718048 [debug] [MainThread]: Connection 'master' was properly closed.
19:45:03.726682 [debug] [MainThread]: Connection 'test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
19:45:03.775574 [info ] [MainThread]: 
19:45:03.784350 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
19:45:03.806311 [info ] [MainThread]: 
19:45:03.840531 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models/example/schema.yml)[0m
19:45:03.857298 [error] [MainThread]:   Got 1 result, configured to fail if != 0
19:45:03.878422 [info ] [MainThread]: 
19:45:03.885011 [info ] [MainThread]:   compiled SQL at target/compiled/analytics_dbt/models/example/schema.yml/not_null_my_first_dbt_model_id.sql
19:45:03.902702 [info ] [MainThread]: 
19:45:03.912738 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
19:45:03.918439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc28c5e1fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc28c5e1f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc28c5e1dc0>]}


============================== 2022-05-23 19:46:34.308822 | e45ebec7-6147-4064-ba22-5aebb7bf34ef ==============================
19:46:34.308968 [info ] [MainThread]: Running with dbt=1.1.0
19:46:34.340708 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
19:46:34.366646 [debug] [MainThread]: Tracking: tracking
19:46:34.482711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1915268790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1915268850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1915268880>]}
19:46:34.913641 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
19:46:34.918789 [debug] [MainThread]: Partial parsing: update schema file: analytics_dbt://models/example/schema.yml
19:46:35.179827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e45ebec7-6147-4064-ba22-5aebb7bf34ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19151407c0>]}
19:46:35.236218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e45ebec7-6147-4064-ba22-5aebb7bf34ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f191518fe80>]}
19:46:35.245273 [info ] [MainThread]: Found 5 models, 11 tests, 0 snapshots, 0 analyses, 194 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
19:46:35.255377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e45ebec7-6147-4064-ba22-5aebb7bf34ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19151354f0>]}
19:46:35.279249 [info ] [MainThread]: 
19:46:35.301493 [debug] [MainThread]: Acquiring new redshift connection "master"
19:46:35.315783 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev_public"
19:46:35.399905 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
19:46:35.403311 [debug] [ThreadPool]: On list_dev_public: BEGIN
19:46:35.407185 [debug] [ThreadPool]: Opening a new connection, currently in state init
19:46:35.411838 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
19:46:36.644392 [debug] [ThreadPool]: SQL status: BEGIN in 1.24 seconds
19:46:36.647637 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
19:46:36.651310 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev_public"} */
select
      'dev' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dev' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
19:46:36.794565 [debug] [ThreadPool]: SQL status: SELECT in 0.14 seconds
19:46:36.804994 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
19:46:36.938454 [debug] [ThreadPool]: On list_dev_public: Close
19:46:36.978279 [debug] [MainThread]: Using redshift connection "master"
19:46:36.983717 [debug] [MainThread]: On master: BEGIN
19:46:36.986597 [debug] [MainThread]: Opening a new connection, currently in state init
19:46:36.992858 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
19:46:38.213973 [debug] [MainThread]: SQL status: BEGIN in 1.23 seconds
19:46:38.217882 [debug] [MainThread]: Using redshift connection "master"
19:46:38.222070 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
19:46:38.391349 [debug] [MainThread]: SQL status: SELECT in 0.17 seconds
19:46:38.399262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e45ebec7-6147-4064-ba22-5aebb7bf34ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f191518fb20>]}
19:46:38.402861 [debug] [MainThread]: On master: ROLLBACK
19:46:38.536682 [debug] [MainThread]: Using redshift connection "master"
19:46:38.540052 [debug] [MainThread]: On master: BEGIN
19:46:38.804840 [debug] [MainThread]: SQL status: BEGIN in 0.26 seconds
19:46:38.807985 [debug] [MainThread]: On master: COMMIT
19:46:38.810860 [debug] [MainThread]: Using redshift connection "master"
19:46:38.813709 [debug] [MainThread]: On master: COMMIT
19:46:38.947218 [debug] [MainThread]: SQL status: COMMIT in 0.13 seconds
19:46:38.950098 [debug] [MainThread]: On master: Close
19:46:38.955395 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
19:46:38.958985 [info ] [MainThread]: 
19:46:38.984893 [debug] [Thread-1  ]: Began running node test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea
19:46:38.988394 [info ] [Thread-1  ]: 1 of 11 START test nao_negativo_tb_10_compradores_vendas_totais ................ [RUN]
19:46:39.001626 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea"
19:46:39.009383 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea
19:46:39.015968 [debug] [Thread-1  ]: Compiling test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea
19:46:39.048053 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea"
19:46:39.086737 [debug] [Thread-1  ]: finished collecting timing info
19:46:39.091856 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea
19:46:39.152127 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea"
19:46:39.170296 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea"
19:46:39.174822 [debug] [Thread-1  ]: On test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea: BEGIN
19:46:39.178269 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:46:39.181648 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
19:46:40.395646 [debug] [Thread-1  ]: SQL status: BEGIN in 1.22 seconds
19:46:40.401163 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea"
19:46:40.404850 [debug] [Thread-1  ]: On test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

    select *
    from "dev"."public"."tb_10_compradores"
    where vendas_totais < 0


      
    ) dbt_internal_test
19:46:40.540919 [debug] [Thread-1  ]: SQL status: SELECT in 0.13 seconds
19:46:40.549409 [debug] [Thread-1  ]: finished collecting timing info
19:46:40.552587 [debug] [Thread-1  ]: On test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea: ROLLBACK
19:46:40.683361 [debug] [Thread-1  ]: On test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea: Close
19:46:40.688988 [info ] [Thread-1  ]: 1 of 11 PASS nao_negativo_tb_10_compradores_vendas_totais ...................... [[32mPASS[0m in 1.69s]
19:46:40.693317 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea
19:46:40.698702 [debug] [Thread-1  ]: Began running node test.analytics_dbt.nao_negativo_vw_sales_comissao.c9561fd7db
19:46:40.705521 [info ] [Thread-1  ]: 2 of 11 START test nao_negativo_vw_sales_comissao .............................. [RUN]
19:46:40.715056 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.nao_negativo_vw_sales_comissao.c9561fd7db"
19:46:40.721183 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.nao_negativo_vw_sales_comissao.c9561fd7db
19:46:40.728020 [debug] [Thread-1  ]: Compiling test.analytics_dbt.nao_negativo_vw_sales_comissao.c9561fd7db
19:46:40.755466 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.nao_negativo_vw_sales_comissao.c9561fd7db"
19:46:40.774259 [debug] [Thread-1  ]: finished collecting timing info
19:46:40.779423 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.nao_negativo_vw_sales_comissao.c9561fd7db
19:46:40.791266 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.nao_negativo_vw_sales_comissao.c9561fd7db"
19:46:40.804258 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.nao_negativo_vw_sales_comissao.c9561fd7db"
19:46:40.808789 [debug] [Thread-1  ]: On test.analytics_dbt.nao_negativo_vw_sales_comissao.c9561fd7db: BEGIN
19:46:40.812788 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:46:40.818008 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
19:46:41.995587 [debug] [Thread-1  ]: SQL status: BEGIN in 1.18 seconds
19:46:41.999331 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.nao_negativo_vw_sales_comissao.c9561fd7db"
19:46:42.002722 [debug] [Thread-1  ]: On test.analytics_dbt.nao_negativo_vw_sales_comissao.c9561fd7db: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.nao_negativo_vw_sales_comissao.c9561fd7db"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

    select *
    from "dev"."public"."vw_sales"
    where comissao < 0


      
    ) dbt_internal_test
19:46:42.253763 [debug] [Thread-1  ]: SQL status: SELECT in 0.25 seconds
19:46:42.259197 [debug] [Thread-1  ]: finished collecting timing info
19:46:42.262227 [debug] [Thread-1  ]: On test.analytics_dbt.nao_negativo_vw_sales_comissao.c9561fd7db: ROLLBACK
19:46:42.393626 [debug] [Thread-1  ]: On test.analytics_dbt.nao_negativo_vw_sales_comissao.c9561fd7db: Close
19:46:42.399185 [info ] [Thread-1  ]: 2 of 11 PASS nao_negativo_vw_sales_comissao .................................... [[32mPASS[0m in 1.69s]
19:46:42.402851 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.nao_negativo_vw_sales_comissao.c9561fd7db
19:46:42.408529 [debug] [Thread-1  ]: Began running node test.analytics_dbt.nao_negativo_vw_sales_valor_pago.7a9d055b10
19:46:42.414991 [info ] [Thread-1  ]: 3 of 11 START test nao_negativo_vw_sales_valor_pago ............................ [RUN]
19:46:42.425441 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.nao_negativo_vw_sales_valor_pago.7a9d055b10"
19:46:42.439814 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.nao_negativo_vw_sales_valor_pago.7a9d055b10
19:46:42.458637 [debug] [Thread-1  ]: Compiling test.analytics_dbt.nao_negativo_vw_sales_valor_pago.7a9d055b10
19:46:42.481378 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.nao_negativo_vw_sales_valor_pago.7a9d055b10"
19:46:42.490976 [debug] [Thread-1  ]: finished collecting timing info
19:46:42.495314 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.nao_negativo_vw_sales_valor_pago.7a9d055b10
19:46:42.507295 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.nao_negativo_vw_sales_valor_pago.7a9d055b10"
19:46:42.518130 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.nao_negativo_vw_sales_valor_pago.7a9d055b10"
19:46:42.521275 [debug] [Thread-1  ]: On test.analytics_dbt.nao_negativo_vw_sales_valor_pago.7a9d055b10: BEGIN
19:46:42.525788 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:46:42.528712 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
19:46:43.732741 [debug] [Thread-1  ]: SQL status: BEGIN in 1.21 seconds
19:46:43.736356 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.nao_negativo_vw_sales_valor_pago.7a9d055b10"
19:46:43.740095 [debug] [Thread-1  ]: On test.analytics_dbt.nao_negativo_vw_sales_valor_pago.7a9d055b10: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.nao_negativo_vw_sales_valor_pago.7a9d055b10"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

    select *
    from "dev"."public"."vw_sales"
    where valor_pago < 0


      
    ) dbt_internal_test
19:46:43.999013 [debug] [Thread-1  ]: SQL status: SELECT in 0.26 seconds
19:46:44.004905 [debug] [Thread-1  ]: finished collecting timing info
19:46:44.008505 [debug] [Thread-1  ]: On test.analytics_dbt.nao_negativo_vw_sales_valor_pago.7a9d055b10: ROLLBACK
19:46:44.182871 [debug] [Thread-1  ]: On test.analytics_dbt.nao_negativo_vw_sales_valor_pago.7a9d055b10: Close
19:46:44.189143 [info ] [Thread-1  ]: 3 of 11 PASS nao_negativo_vw_sales_valor_pago .................................. [[32mPASS[0m in 1.76s]
19:46:44.195607 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.nao_negativo_vw_sales_valor_pago.7a9d055b10
19:46:44.205493 [debug] [Thread-1  ]: Began running node test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
19:46:44.213332 [info ] [Thread-1  ]: 4 of 11 START test not_null_my_first_dbt_model_id .............................. [RUN]
19:46:44.222476 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
19:46:44.231974 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
19:46:44.240637 [debug] [Thread-1  ]: Compiling test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
19:46:44.275430 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
19:46:44.289443 [debug] [Thread-1  ]: finished collecting timing info
19:46:44.292741 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
19:46:44.302044 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
19:46:44.311374 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
19:46:44.314659 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710: BEGIN
19:46:44.318890 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:46:44.322105 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
19:46:45.541317 [debug] [Thread-1  ]: SQL status: BEGIN in 1.22 seconds
19:46:45.547947 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
19:46:45.554576 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dev"."public"."my_first_dbt_model"
where id is null



      
    ) dbt_internal_test
19:46:45.696471 [debug] [Thread-1  ]: SQL status: SELECT in 0.14 seconds
19:46:45.723345 [debug] [Thread-1  ]: finished collecting timing info
19:46:45.734093 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
19:46:45.885756 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710: Close
19:46:45.894711 [error] [Thread-1  ]: 4 of 11 FAIL 1 not_null_my_first_dbt_model_id .................................. [[31mFAIL 1[0m in 1.67s]
19:46:45.915504 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
19:46:45.923939 [debug] [Thread-1  ]: Began running node test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
19:46:45.930865 [info ] [Thread-1  ]: 5 of 11 START test not_null_my_second_dbt_model_id ............................. [RUN]
19:46:45.948747 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"
19:46:45.955253 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
19:46:45.961927 [debug] [Thread-1  ]: Compiling test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
19:46:46.010849 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"
19:46:46.115159 [debug] [Thread-1  ]: finished collecting timing info
19:46:46.124161 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
19:46:46.143833 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"
19:46:46.168150 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"
19:46:46.175873 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778: BEGIN
19:46:46.182419 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:46:46.189127 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
19:46:47.400115 [debug] [Thread-1  ]: SQL status: BEGIN in 1.22 seconds
19:46:47.410780 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"
19:46:47.416449 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dev"."public"."my_second_dbt_model"
where id is null



      
    ) dbt_internal_test
19:46:47.566283 [debug] [Thread-1  ]: SQL status: SELECT in 0.14 seconds
19:46:47.584901 [debug] [Thread-1  ]: finished collecting timing info
19:46:47.589738 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778: ROLLBACK
19:46:47.727065 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778: Close
19:46:47.790325 [info ] [Thread-1  ]: 5 of 11 PASS not_null_my_second_dbt_model_id ................................... [[32mPASS[0m in 1.84s]
19:46:47.804383 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
19:46:47.825293 [debug] [Thread-1  ]: Began running node test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752
19:46:47.830218 [info ] [Thread-1  ]: 6 of 11 START test not_null_tb_10_compradores_vendas_totais .................... [RUN]
19:46:47.857977 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752"
19:46:47.866977 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752
19:46:47.878368 [debug] [Thread-1  ]: Compiling test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752
19:46:48.052422 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752"
19:46:48.096546 [debug] [Thread-1  ]: finished collecting timing info
19:46:48.113813 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752
19:46:48.312800 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752"
19:46:48.404464 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752"
19:46:48.412038 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752: BEGIN
19:46:48.423503 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:46:48.431907 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
19:46:49.674871 [debug] [Thread-1  ]: SQL status: BEGIN in 1.25 seconds
19:46:49.679326 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752"
19:46:49.690074 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select vendas_totais
from "dev"."public"."tb_10_compradores"
where vendas_totais is null



      
    ) dbt_internal_test
19:46:49.823024 [debug] [Thread-1  ]: SQL status: SELECT in 0.13 seconds
19:46:49.832261 [debug] [Thread-1  ]: finished collecting timing info
19:46:49.836227 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752: ROLLBACK
19:46:49.966898 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752: Close
19:46:49.972611 [info ] [Thread-1  ]: 6 of 11 PASS not_null_tb_10_compradores_vendas_totais .......................... [[32mPASS[0m in 2.12s]
19:46:49.977664 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752
19:46:49.982239 [debug] [Thread-1  ]: Began running node test.analytics_dbt.not_null_vw_sales_comissao.d9b6c254ab
19:46:49.992801 [info ] [Thread-1  ]: 7 of 11 START test not_null_vw_sales_comissao .................................. [RUN]
19:46:50.004511 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.not_null_vw_sales_comissao.d9b6c254ab"
19:46:50.013302 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.not_null_vw_sales_comissao.d9b6c254ab
19:46:50.020737 [debug] [Thread-1  ]: Compiling test.analytics_dbt.not_null_vw_sales_comissao.d9b6c254ab
19:46:50.040559 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.not_null_vw_sales_comissao.d9b6c254ab"
19:46:50.054321 [debug] [Thread-1  ]: finished collecting timing info
19:46:50.059182 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.not_null_vw_sales_comissao.d9b6c254ab
19:46:50.069145 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.not_null_vw_sales_comissao.d9b6c254ab"
19:46:50.082420 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_vw_sales_comissao.d9b6c254ab"
19:46:50.085779 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_vw_sales_comissao.d9b6c254ab: BEGIN
19:46:50.089420 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:46:50.092924 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
19:46:51.276815 [debug] [Thread-1  ]: SQL status: BEGIN in 1.19 seconds
19:46:51.279269 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_vw_sales_comissao.d9b6c254ab"
19:46:51.283098 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_vw_sales_comissao.d9b6c254ab: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.not_null_vw_sales_comissao.d9b6c254ab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select comissao
from "dev"."public"."vw_sales"
where comissao is null



      
    ) dbt_internal_test
19:46:51.442255 [debug] [Thread-1  ]: SQL status: SELECT in 0.16 seconds
19:46:51.454125 [debug] [Thread-1  ]: finished collecting timing info
19:46:51.457523 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_vw_sales_comissao.d9b6c254ab: ROLLBACK
19:46:51.594303 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_vw_sales_comissao.d9b6c254ab: Close
19:46:51.602214 [info ] [Thread-1  ]: 7 of 11 PASS not_null_vw_sales_comissao ........................................ [[32mPASS[0m in 1.60s]
19:46:51.610927 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.not_null_vw_sales_comissao.d9b6c254ab
19:46:51.621473 [debug] [Thread-1  ]: Began running node test.analytics_dbt.not_null_vw_sales_valor_pago.5cd141ad26
19:46:51.628939 [info ] [Thread-1  ]: 8 of 11 START test not_null_vw_sales_valor_pago ................................ [RUN]
19:46:51.634800 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.not_null_vw_sales_valor_pago.5cd141ad26"
19:46:51.658454 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.not_null_vw_sales_valor_pago.5cd141ad26
19:46:51.679166 [debug] [Thread-1  ]: Compiling test.analytics_dbt.not_null_vw_sales_valor_pago.5cd141ad26
19:46:51.818260 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.not_null_vw_sales_valor_pago.5cd141ad26"
19:46:51.843013 [debug] [Thread-1  ]: finished collecting timing info
19:46:51.870931 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.not_null_vw_sales_valor_pago.5cd141ad26
19:46:51.986372 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.not_null_vw_sales_valor_pago.5cd141ad26"
19:46:52.131689 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_vw_sales_valor_pago.5cd141ad26"
19:46:52.142605 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_vw_sales_valor_pago.5cd141ad26: BEGIN
19:46:52.146752 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:46:52.151816 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
19:46:53.334905 [debug] [Thread-1  ]: SQL status: BEGIN in 1.19 seconds
19:46:53.339443 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_vw_sales_valor_pago.5cd141ad26"
19:46:53.343681 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_vw_sales_valor_pago.5cd141ad26: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.not_null_vw_sales_valor_pago.5cd141ad26"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select valor_pago
from "dev"."public"."vw_sales"
where valor_pago is null



      
    ) dbt_internal_test
19:46:53.504969 [debug] [Thread-1  ]: SQL status: SELECT in 0.16 seconds
19:46:53.528923 [debug] [Thread-1  ]: finished collecting timing info
19:46:53.533946 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_vw_sales_valor_pago.5cd141ad26: ROLLBACK
19:46:53.667383 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_vw_sales_valor_pago.5cd141ad26: Close
19:46:53.673150 [info ] [Thread-1  ]: 8 of 11 PASS not_null_vw_sales_valor_pago ...................................... [[32mPASS[0m in 2.04s]
19:46:53.677776 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.not_null_vw_sales_valor_pago.5cd141ad26
19:46:53.684340 [debug] [Thread-1  ]: Began running node test.analytics_dbt.test_singular_nao_negativo
19:46:53.689209 [info ] [Thread-1  ]: 9 of 11 START test test_singular_nao_negativo .................................. [RUN]
19:46:53.693644 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.test_singular_nao_negativo"
19:46:53.698342 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.test_singular_nao_negativo
19:46:53.708254 [debug] [Thread-1  ]: Compiling test.analytics_dbt.test_singular_nao_negativo
19:46:53.718261 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.test_singular_nao_negativo"
19:46:53.735889 [debug] [Thread-1  ]: finished collecting timing info
19:46:53.740987 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.test_singular_nao_negativo
19:46:53.765881 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.test_singular_nao_negativo"
19:46:53.775466 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.test_singular_nao_negativo"
19:46:53.779150 [debug] [Thread-1  ]: On test.analytics_dbt.test_singular_nao_negativo: BEGIN
19:46:53.782290 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:46:53.786330 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
19:46:55.029575 [debug] [Thread-1  ]: SQL status: BEGIN in 1.25 seconds
19:46:55.108244 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.test_singular_nao_negativo"
19:46:55.136796 [debug] [Thread-1  ]: On test.analytics_dbt.test_singular_nao_negativo: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.test_singular_nao_negativo"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- testa se existe valore menores que 0 (negativos)
select *
    from tb_10_compradores
    where vendas_totais < 0
      
    ) dbt_internal_test
19:46:55.306193 [debug] [Thread-1  ]: SQL status: SELECT in 0.13 seconds
19:46:55.312010 [debug] [Thread-1  ]: finished collecting timing info
19:46:55.316151 [debug] [Thread-1  ]: On test.analytics_dbt.test_singular_nao_negativo: ROLLBACK
19:46:55.449156 [debug] [Thread-1  ]: On test.analytics_dbt.test_singular_nao_negativo: Close
19:46:55.461654 [info ] [Thread-1  ]: 9 of 11 PASS test_singular_nao_negativo ........................................ [[32mPASS[0m in 1.77s]
19:46:55.475631 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.test_singular_nao_negativo
19:46:55.487571 [debug] [Thread-1  ]: Began running node test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
19:46:55.497660 [info ] [Thread-1  ]: 10 of 11 START test unique_my_first_dbt_model_id ............................... [RUN]
19:46:55.511059 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"
19:46:55.522965 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
19:46:55.530042 [debug] [Thread-1  ]: Compiling test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
19:46:55.599469 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"
19:46:55.628940 [debug] [Thread-1  ]: finished collecting timing info
19:46:55.631970 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
19:46:55.641872 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"
19:46:55.651176 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"
19:46:55.656455 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321: BEGIN
19:46:55.664098 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:46:55.668487 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
19:46:56.875158 [debug] [Thread-1  ]: SQL status: BEGIN in 1.21 seconds
19:46:56.879131 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"
19:46:56.883942 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dev"."public"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
19:46:57.017781 [debug] [Thread-1  ]: SQL status: SELECT in 0.13 seconds
19:46:57.044958 [debug] [Thread-1  ]: finished collecting timing info
19:46:57.055951 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
19:46:57.216486 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321: Close
19:46:57.240373 [info ] [Thread-1  ]: 10 of 11 PASS unique_my_first_dbt_model_id ..................................... [[32mPASS[0m in 1.73s]
19:46:57.260513 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
19:46:57.288244 [debug] [Thread-1  ]: Began running node test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
19:46:57.298990 [info ] [Thread-1  ]: 11 of 11 START test unique_my_second_dbt_model_id .............................. [RUN]
19:46:57.310857 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"
19:46:57.331151 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
19:46:57.341049 [debug] [Thread-1  ]: Compiling test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
19:46:57.476397 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"
19:46:57.560687 [debug] [Thread-1  ]: finished collecting timing info
19:46:57.583079 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
19:46:57.611261 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"
19:46:57.635639 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"
19:46:57.648514 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493: BEGIN
19:46:57.728573 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:46:57.742107 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
19:46:59.107696 [debug] [Thread-1  ]: SQL status: BEGIN in 1.38 seconds
19:46:59.114340 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"
19:46:59.122253 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dev"."public"."my_second_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
19:46:59.271692 [debug] [Thread-1  ]: SQL status: SELECT in 0.14 seconds
19:46:59.291171 [debug] [Thread-1  ]: finished collecting timing info
19:46:59.306152 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493: ROLLBACK
19:46:59.452411 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493: Close
19:46:59.471932 [info ] [Thread-1  ]: 11 of 11 PASS unique_my_second_dbt_model_id .................................... [[32mPASS[0m in 2.16s]
19:46:59.487794 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
19:46:59.524408 [debug] [MainThread]: Acquiring new redshift connection "master"
19:46:59.539966 [debug] [MainThread]: Using redshift connection "master"
19:46:59.549523 [debug] [MainThread]: On master: BEGIN
19:46:59.564043 [debug] [MainThread]: Opening a new connection, currently in state closed
19:46:59.577470 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
19:47:00.802770 [debug] [MainThread]: SQL status: BEGIN in 1.24 seconds
19:47:00.806170 [debug] [MainThread]: On master: COMMIT
19:47:00.809688 [debug] [MainThread]: Using redshift connection "master"
19:47:00.812984 [debug] [MainThread]: On master: COMMIT
19:47:00.949822 [debug] [MainThread]: SQL status: COMMIT in 0.13 seconds
19:47:00.953045 [debug] [MainThread]: On master: Close
19:47:00.958569 [info ] [MainThread]: 
19:47:00.962638 [info ] [MainThread]: Finished running 11 tests in 25.66s.
19:47:00.975661 [debug] [MainThread]: Connection 'master' was properly closed.
19:47:00.978423 [debug] [MainThread]: Connection 'test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
19:47:01.024038 [info ] [MainThread]: 
19:47:01.030643 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
19:47:01.042541 [info ] [MainThread]: 
19:47:01.049237 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models/example/schema.yml)[0m
19:47:01.057497 [error] [MainThread]:   Got 1 result, configured to fail if != 0
19:47:01.064489 [info ] [MainThread]: 
19:47:01.076149 [info ] [MainThread]:   compiled SQL at target/compiled/analytics_dbt/models/example/schema.yml/not_null_my_first_dbt_model_id.sql
19:47:01.082313 [info ] [MainThread]: 
19:47:01.089747 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=1 SKIP=0 TOTAL=11
19:47:01.097161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f190efc45b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f191518ffa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f191518ff70>]}


============================== 2022-05-23 19:52:13.536808 | 29b1ee3b-71fd-4395-9a0b-da885bde449c ==============================
19:52:13.536944 [info ] [MainThread]: Running with dbt=1.1.0
19:52:13.547229 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'compile': True, 'which': 'generate', 'rpc_method': 'docs.generate', 'indirect_selection': 'eager'}
19:52:13.559503 [debug] [MainThread]: Tracking: tracking
19:52:13.611783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc152a4a730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc152a4a7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc152a4a7f0>]}
19:52:13.761323 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
19:52:13.765094 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
19:52:13.783343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '29b1ee3b-71fd-4395-9a0b-da885bde449c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc152906af0>]}
19:52:13.826436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '29b1ee3b-71fd-4395-9a0b-da885bde449c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1529ff640>]}
19:52:13.831140 [info ] [MainThread]: Found 5 models, 11 tests, 0 snapshots, 0 analyses, 194 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
19:52:13.835987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '29b1ee3b-71fd-4395-9a0b-da885bde449c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1529ff7f0>]}
19:52:13.871836 [info ] [MainThread]: 
19:52:13.881357 [debug] [MainThread]: Acquiring new redshift connection "master"
19:52:13.925918 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev_public"
19:52:13.971272 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
19:52:13.975343 [debug] [ThreadPool]: On list_dev_public: BEGIN
19:52:13.978501 [debug] [ThreadPool]: Opening a new connection, currently in state init
19:52:13.982390 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
19:52:15.205577 [debug] [ThreadPool]: SQL status: BEGIN in 1.23 seconds
19:52:15.209096 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
19:52:15.211659 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev_public"} */
select
      'dev' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dev' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
19:52:15.356338 [debug] [ThreadPool]: SQL status: SELECT in 0.14 seconds
19:52:15.362561 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
19:52:15.495465 [debug] [ThreadPool]: On list_dev_public: Close
19:52:15.513971 [debug] [MainThread]: Using redshift connection "master"
19:52:15.516544 [debug] [MainThread]: On master: BEGIN
19:52:15.519656 [debug] [MainThread]: Opening a new connection, currently in state init
19:52:15.523681 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
19:52:16.859699 [debug] [MainThread]: SQL status: BEGIN in 1.34 seconds
19:52:16.862827 [debug] [MainThread]: Using redshift connection "master"
19:52:16.865537 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
19:52:17.034091 [debug] [MainThread]: SQL status: SELECT in 0.17 seconds
19:52:17.039530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '29b1ee3b-71fd-4395-9a0b-da885bde449c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1529ff2b0>]}
19:52:17.043017 [debug] [MainThread]: On master: ROLLBACK
19:52:17.176524 [debug] [MainThread]: On master: Close
19:52:17.182041 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
19:52:17.185485 [info ] [MainThread]: 
19:52:17.205404 [debug] [Thread-1  ]: Began running node model.analytics_dbt.my_first_dbt_model
19:52:17.217263 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.my_first_dbt_model"
19:52:17.227889 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.my_first_dbt_model
19:52:17.235755 [debug] [Thread-1  ]: Compiling model.analytics_dbt.my_first_dbt_model
19:52:17.255725 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.my_first_dbt_model"
19:52:17.267803 [debug] [Thread-1  ]: finished collecting timing info
19:52:17.273779 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.my_first_dbt_model
19:52:17.278552 [debug] [Thread-1  ]: finished collecting timing info
19:52:17.284504 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.my_first_dbt_model
19:52:17.288769 [debug] [Thread-1  ]: Began running node model.analytics_dbt.vw_sales
19:52:17.295301 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.vw_sales"
19:52:17.299336 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.vw_sales
19:52:17.302649 [debug] [Thread-1  ]: Compiling model.analytics_dbt.vw_sales
19:52:17.312890 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.vw_sales"
19:52:17.321549 [debug] [Thread-1  ]: finished collecting timing info
19:52:17.325256 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.vw_sales
19:52:17.327501 [debug] [Thread-1  ]: finished collecting timing info
19:52:17.331235 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.vw_sales
19:52:17.333761 [debug] [Thread-1  ]: Began running node test.analytics_dbt.test_singular_nao_negativo
19:52:17.337211 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.test_singular_nao_negativo"
19:52:17.340289 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.test_singular_nao_negativo
19:52:17.344222 [debug] [Thread-1  ]: Compiling test.analytics_dbt.test_singular_nao_negativo
19:52:17.351671 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.test_singular_nao_negativo"
19:52:17.362498 [debug] [Thread-1  ]: finished collecting timing info
19:52:17.365640 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.test_singular_nao_negativo
19:52:17.368991 [debug] [Thread-1  ]: finished collecting timing info
19:52:17.373293 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.test_singular_nao_negativo
19:52:17.379045 [debug] [Thread-1  ]: Began running node model.analytics_dbt.my_second_dbt_model
19:52:17.382982 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.my_second_dbt_model"
19:52:17.385818 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.my_second_dbt_model
19:52:17.390363 [debug] [Thread-1  ]: Compiling model.analytics_dbt.my_second_dbt_model
19:52:17.399637 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.my_second_dbt_model"
19:52:17.411699 [debug] [Thread-1  ]: finished collecting timing info
19:52:17.415692 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.my_second_dbt_model
19:52:17.419389 [debug] [Thread-1  ]: finished collecting timing info
19:52:17.425317 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.my_second_dbt_model
19:52:17.428475 [debug] [Thread-1  ]: Began running node test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
19:52:17.432161 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
19:52:17.435075 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
19:52:17.437717 [debug] [Thread-1  ]: Compiling test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
19:52:17.470173 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
19:52:17.478673 [debug] [Thread-1  ]: finished collecting timing info
19:52:17.481413 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
19:52:17.485773 [debug] [Thread-1  ]: finished collecting timing info
19:52:17.491197 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
19:52:17.495278 [debug] [Thread-1  ]: Began running node test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
19:52:17.500628 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"
19:52:17.504425 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
19:52:17.511713 [debug] [Thread-1  ]: Compiling test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
19:52:17.530507 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"
19:52:17.541410 [debug] [Thread-1  ]: finished collecting timing info
19:52:17.546155 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
19:52:17.550531 [debug] [Thread-1  ]: finished collecting timing info
19:52:17.556942 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
19:52:17.561063 [debug] [Thread-1  ]: Began running node model.analytics_dbt.tb_10_compradores
19:52:17.565543 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.tb_10_compradores"
19:52:17.568748 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.tb_10_compradores
19:52:17.571986 [debug] [Thread-1  ]: Compiling model.analytics_dbt.tb_10_compradores
19:52:17.581800 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.tb_10_compradores"
19:52:17.588638 [debug] [Thread-1  ]: finished collecting timing info
19:52:17.591810 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.tb_10_compradores
19:52:17.595039 [debug] [Thread-1  ]: finished collecting timing info
19:52:17.600310 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.tb_10_compradores
19:52:17.603844 [debug] [Thread-1  ]: Began running node model.analytics_dbt.tb_vendas_primeiro_trimestre
19:52:17.609161 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.tb_vendas_primeiro_trimestre"
19:52:17.612747 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.tb_vendas_primeiro_trimestre
19:52:17.616015 [debug] [Thread-1  ]: Compiling model.analytics_dbt.tb_vendas_primeiro_trimestre
19:52:17.628282 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.tb_vendas_primeiro_trimestre"
19:52:17.636665 [debug] [Thread-1  ]: finished collecting timing info
19:52:17.640109 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.tb_vendas_primeiro_trimestre
19:52:17.643149 [debug] [Thread-1  ]: finished collecting timing info
19:52:17.646897 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.tb_vendas_primeiro_trimestre
19:52:17.650102 [debug] [Thread-1  ]: Began running node test.analytics_dbt.nao_negativo_vw_sales_comissao.c9561fd7db
19:52:17.653327 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.nao_negativo_vw_sales_comissao.c9561fd7db"
19:52:17.656487 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.nao_negativo_vw_sales_comissao.c9561fd7db
19:52:17.659551 [debug] [Thread-1  ]: Compiling test.analytics_dbt.nao_negativo_vw_sales_comissao.c9561fd7db
19:52:17.671759 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.nao_negativo_vw_sales_comissao.c9561fd7db"
19:52:17.681185 [debug] [Thread-1  ]: finished collecting timing info
19:52:17.684581 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.nao_negativo_vw_sales_comissao.c9561fd7db
19:52:17.687990 [debug] [Thread-1  ]: finished collecting timing info
19:52:17.692376 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.nao_negativo_vw_sales_comissao.c9561fd7db
19:52:17.696531 [debug] [Thread-1  ]: Began running node test.analytics_dbt.nao_negativo_vw_sales_valor_pago.7a9d055b10
19:52:17.700901 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.nao_negativo_vw_sales_valor_pago.7a9d055b10"
19:52:17.705107 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.nao_negativo_vw_sales_valor_pago.7a9d055b10
19:52:17.708195 [debug] [Thread-1  ]: Compiling test.analytics_dbt.nao_negativo_vw_sales_valor_pago.7a9d055b10
19:52:17.720979 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.nao_negativo_vw_sales_valor_pago.7a9d055b10"
19:52:17.729337 [debug] [Thread-1  ]: finished collecting timing info
19:52:17.733646 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.nao_negativo_vw_sales_valor_pago.7a9d055b10
19:52:17.736406 [debug] [Thread-1  ]: finished collecting timing info
19:52:17.741101 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.nao_negativo_vw_sales_valor_pago.7a9d055b10
19:52:17.744813 [debug] [Thread-1  ]: Began running node test.analytics_dbt.not_null_vw_sales_comissao.d9b6c254ab
19:52:17.750238 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.not_null_vw_sales_comissao.d9b6c254ab"
19:52:17.753128 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.not_null_vw_sales_comissao.d9b6c254ab
19:52:17.755719 [debug] [Thread-1  ]: Compiling test.analytics_dbt.not_null_vw_sales_comissao.d9b6c254ab
19:52:17.769548 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.not_null_vw_sales_comissao.d9b6c254ab"
19:52:17.777814 [debug] [Thread-1  ]: finished collecting timing info
19:52:17.781487 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.not_null_vw_sales_comissao.d9b6c254ab
19:52:17.784789 [debug] [Thread-1  ]: finished collecting timing info
19:52:17.788802 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.not_null_vw_sales_comissao.d9b6c254ab
19:52:17.791842 [debug] [Thread-1  ]: Began running node test.analytics_dbt.not_null_vw_sales_valor_pago.5cd141ad26
19:52:17.795545 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.not_null_vw_sales_valor_pago.5cd141ad26"
19:52:17.798877 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.not_null_vw_sales_valor_pago.5cd141ad26
19:52:17.801711 [debug] [Thread-1  ]: Compiling test.analytics_dbt.not_null_vw_sales_valor_pago.5cd141ad26
19:52:17.812947 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.not_null_vw_sales_valor_pago.5cd141ad26"
19:52:17.820403 [debug] [Thread-1  ]: finished collecting timing info
19:52:17.824194 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.not_null_vw_sales_valor_pago.5cd141ad26
19:52:17.827289 [debug] [Thread-1  ]: finished collecting timing info
19:52:17.833315 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.not_null_vw_sales_valor_pago.5cd141ad26
19:52:17.837389 [debug] [Thread-1  ]: Began running node test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
19:52:17.843187 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"
19:52:17.846017 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
19:52:17.848710 [debug] [Thread-1  ]: Compiling test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
19:52:17.860792 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"
19:52:17.869150 [debug] [Thread-1  ]: finished collecting timing info
19:52:17.872297 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
19:52:17.876166 [debug] [Thread-1  ]: finished collecting timing info
19:52:17.866112 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
19:52:17.871262 [debug] [Thread-1  ]: Began running node test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
19:52:17.876544 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"
19:52:17.880138 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
19:52:17.883609 [debug] [Thread-1  ]: Compiling test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
19:52:17.898881 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"
19:52:17.912594 [debug] [Thread-1  ]: finished collecting timing info
19:52:17.916565 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
19:52:17.919932 [debug] [Thread-1  ]: finished collecting timing info
19:52:17.928642 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
19:52:17.931961 [debug] [Thread-1  ]: Began running node test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea
19:52:17.936391 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea"
19:52:17.941773 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea
19:52:17.947222 [debug] [Thread-1  ]: Compiling test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea
19:52:17.965037 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea"
19:52:17.976876 [debug] [Thread-1  ]: finished collecting timing info
19:52:17.981039 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea
19:52:17.987289 [debug] [Thread-1  ]: finished collecting timing info
19:52:17.991897 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea
19:52:17.995210 [debug] [Thread-1  ]: Began running node test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752
19:52:17.999103 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752"
19:52:18.002177 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752
19:52:18.005707 [debug] [Thread-1  ]: Compiling test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752
19:52:18.015869 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752"
19:52:18.026784 [debug] [Thread-1  ]: finished collecting timing info
19:52:18.030070 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752
19:52:18.033042 [debug] [Thread-1  ]: finished collecting timing info
19:52:18.037298 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752
19:52:18.043446 [debug] [MainThread]: Connection 'master' was properly closed.
19:52:18.046795 [debug] [MainThread]: Connection 'test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752' was properly closed.
19:52:18.081121 [info ] [MainThread]: Done.
19:52:18.177880 [debug] [MainThread]: Acquiring new redshift connection "generate_catalog"
19:52:18.182981 [info ] [MainThread]: Building catalog
19:52:18.199257 [debug] [ThreadPool]: Acquiring new redshift connection "dev.information_schema"
19:52:18.271727 [debug] [ThreadPool]: Using redshift connection "dev.information_schema"
19:52:18.275746 [debug] [ThreadPool]: On dev.information_schema: BEGIN
19:52:18.278782 [debug] [ThreadPool]: Opening a new connection, currently in state init
19:52:18.284847 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
19:52:19.468598 [debug] [ThreadPool]: SQL status: BEGIN in 1.19 seconds
19:52:19.472003 [debug] [ThreadPool]: Using redshift connection "dev.information_schema"
19:52:19.474517 [debug] [ThreadPool]: On dev.information_schema: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "dev.information_schema"} */

    

    with late_binding as (
      select
        'dev'::varchar as table_database,
        table_schema,
        table_name,
        'LATE BINDING VIEW'::varchar as table_type,
        null::text as table_comment,

        column_name,
        column_index,
        column_type,
        null::text as column_comment
      from pg_get_late_binding_view_cols()
        cols(table_schema name, table_name name, column_name name,
             column_type varchar,
             column_index int)
        order by "column_index"
    ),

    early_binding as (
        select
            'dev'::varchar as table_database,
            sch.nspname as table_schema,
            tbl.relname as table_name,
            case tbl.relkind
                when 'v' then 'VIEW'
                else 'BASE TABLE'
            end as table_type,
            tbl_desc.description as table_comment,
            col.attname as column_name,
            col.attnum as column_index,
            pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
            col_desc.description as column_comment

        from pg_catalog.pg_namespace sch
        join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
        join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
        left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
        left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
        where (upper(sch.nspname) = upper('public'))
            and tbl.relkind in ('r', 'v', 'f', 'p')
            and col.attnum > 0
            and not col.attisdropped
    ),

    table_owners as (

        select
            'dev'::varchar as table_database,
            schemaname as table_schema,
            tablename as table_name,
            tableowner as table_owner

        from pg_tables

        union all

        select
            'dev'::varchar as table_database,
            schemaname as table_schema,
            viewname as table_name,
            viewowner as table_owner

        from pg_views

    ),

    unioned as (

        select *
        from early_binding

        union all

        select *
        from late_binding

    )

    select *,
        table_database || '.' || table_schema || '.' || table_name as table_id

    from unioned
    join table_owners using (table_database, table_schema, table_name)

    where (upper(table_schema) = upper('public'))

    order by "column_index"
19:52:19.667700 [debug] [ThreadPool]: SQL status: SELECT in 0.19 seconds
19:52:19.684542 [debug] [ThreadPool]: Using redshift connection "dev.information_schema"
19:52:19.687776 [debug] [ThreadPool]: On dev.information_schema: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "dev.information_schema"} */
select has_table_privilege(current_user, 'svv_table_info', 'SELECT') as can_select
19:52:19.819413 [debug] [ThreadPool]: SQL status: SELECT in 0.13 seconds
19:52:19.836507 [debug] [ThreadPool]: Using redshift connection "dev.information_schema"
19:52:19.839297 [debug] [ThreadPool]: On dev.information_schema: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "dev.information_schema"} */
select
        "database" || '.' || "schema" || '.' || "table" as table_id,

        'Encoded'::text as "stats:encoded:label",
        encoded as "stats:encoded:value",
        'Indicates whether any column in the table has compression encoding defined.'::text as "stats:encoded:description",
        true as "stats:encoded:include",

        'Dist Style' as "stats:diststyle:label",
        diststyle as "stats:diststyle:value",
        'Distribution style or distribution key column, if key distribution is defined.'::text as "stats:diststyle:description",
        true as "stats:diststyle:include",

        'Sort Key 1' as "stats:sortkey1:label",
        -- handle 0xFF byte in response for interleaved sort styles
        case
            when sortkey1 like 'INTERLEAVED%' then 'INTERLEAVED'::text
            else sortkey1
        end as "stats:sortkey1:value",
        'First column in the sort key.'::text as "stats:sortkey1:description",
        (sortkey1 is not null) as "stats:sortkey1:include",

        'Max Varchar' as "stats:max_varchar:label",
        max_varchar as "stats:max_varchar:value",
        'Size of the largest column that uses a VARCHAR data type.'::text as "stats:max_varchar:description",
        true as "stats:max_varchar:include",

        -- exclude this, as the data is strangely returned with null-byte characters
        'Sort Key 1 Encoding' as "stats:sortkey1_enc:label",
        sortkey1_enc as "stats:sortkey1_enc:value",
        'Compression encoding of the first column in the sort key.' as "stats:sortkey1_enc:description",
        false as "stats:sortkey1_enc:include",

        '# Sort Keys' as "stats:sortkey_num:label",
        sortkey_num as "stats:sortkey_num:value",
        'Number of columns defined as sort keys.' as "stats:sortkey_num:description",
        (sortkey_num > 0) as "stats:sortkey_num:include",

        'Approximate Size' as "stats:size:label",
        size * 1000000 as "stats:size:value",
        'Approximate size of the table, calculated from a count of 1MB blocks'::text as "stats:size:description",
        true as "stats:size:include",

        'Disk Utilization' as "stats:pct_used:label",
        pct_used / 100.0 as "stats:pct_used:value",
        'Percent of available space that is used by the table.'::text as "stats:pct_used:description",
        true as "stats:pct_used:include",

        'Unsorted %' as "stats:unsorted:label",
        unsorted / 100.0 as "stats:unsorted:value",
        'Percent of unsorted rows in the table.'::text as "stats:unsorted:description",
        (unsorted is not null) as "stats:unsorted:include",

        'Stats Off' as "stats:stats_off:label",
        stats_off as "stats:stats_off:value",
        'Number that indicates how stale the table statistics are; 0 is current, 100 is out of date.'::text as "stats:stats_off:description",
        true as "stats:stats_off:include",

        'Approximate Row Count' as "stats:rows:label",
        tbl_rows as "stats:rows:value",
        'Approximate number of rows in the table. This value includes rows marked for deletion, but not yet vacuumed.'::text as "stats:rows:description",
        true as "stats:rows:include",

        'Sort Key Skew' as "stats:skew_sortkey1:label",
        skew_sortkey1 as "stats:skew_sortkey1:value",
        'Ratio of the size of the largest non-sort key column to the size of the first column of the sort key.'::text as "stats:skew_sortkey1:description",
        (skew_sortkey1 is not null) as "stats:skew_sortkey1:include",

        'Skew Rows' as "stats:skew_rows:label",
        skew_rows as "stats:skew_rows:value",
        'Ratio of the number of rows in the slice with the most rows to the number of rows in the slice with the fewest rows.'::text as "stats:skew_rows:description",
        (skew_rows is not null) as "stats:skew_rows:include"

    from svv_table_info
    where (upper(schema) = upper('public'))
19:52:21.979796 [debug] [ThreadPool]: SQL status: SELECT in 2.14 seconds
19:52:22.057013 [debug] [ThreadPool]: On dev.information_schema: ROLLBACK
19:52:22.189208 [debug] [ThreadPool]: On dev.information_schema: Close
19:52:22.345323 [info ] [MainThread]: Catalog written to /usr/app/analytics_edz_dbt/target/catalog.json
19:52:22.351885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1520b1af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc150863dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc150863490>]}
19:52:23.132213 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
19:52:23.135875 [debug] [MainThread]: Connection 'dev.information_schema' was properly closed.


============================== 2022-05-23 19:53:50.711949 | d82c2bfa-8df1-47d3-88b3-e4810c0664ed ==============================
19:53:50.712008 [info ] [MainThread]: Running with dbt=1.1.0
19:53:50.716382 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'port': 8080, 'open_browser': True, 'which': 'serve', 'indirect_selection': 'eager'}
19:53:50.723958 [debug] [MainThread]: Tracking: tracking
19:53:50.762226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f338c50d730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f338c50d7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f338c50d7f0>]}
19:53:50.840124 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
19:53:50.843958 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
19:53:50.847037 [info ] [MainThread]: 
19:53:50.854318 [info ] [MainThread]: 
19:53:50.860267 [info ] [MainThread]: Press Ctrl+C to exit.
